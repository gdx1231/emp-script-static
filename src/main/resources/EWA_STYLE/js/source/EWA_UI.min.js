var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){a=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}return globalThis};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var e=b.length,f=a.length;c=Math.max(0,Math.min(c|0,b.length));for(var g=0;g<f&&c<e;)if(b[c++]!=a[g++])return!1;return g>=f}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,a,"endsWith");a+="";void 0===c&&(c=b.length);c=Math.max(0,Math.min(c|0,b.length));for(var e=a.length;0<e&&0<c;)if(b[--c]!=a[--e])return!1;return 0>=e}},"es6","es3");"undefined"==typeof EWA&&(EWA={});EWA.UI=EWA.UI||{};
EWA.UI.Postion=function(a){if(null==a)return null;var b=a,c;var d=c=0;do d+=1*b.offsetLeft,c+=1*b.offsetTop,"DIV"==b.tagName&&(d-=b.scrollLeft,c-=b.scrollTop),b=b.offsetParent;while(null!=b&&"BODY"!=b.tagName&&"HTML"!=b.tagName);b=c+1*a.offsetHeight;return{X:d,Y:b,Left:d,Top:c,Width:a.offsetWidth,Height:a.offsetHeight,Right:d+a.offsetWidth,Bottom:b}};
var EWA$UI$COMMON$Move={OnMouseDown:function(a,b,c,d,e){a.setAttribute("D",1);b=EWA$UI$COMMON.Move._Event(a,b);c=EWA$UI$COMMON.Move._EventXY(b);if(null==d||d)a.setAttribute("X",c.X),a.setAttribute("SX",c.X);if(null==e||e)a.setAttribute("Y",c.Y),a.setAttribute("SY",c.Y);"undefined"!=typeof b.preventDefault&&b.preventDefault();"undefined"!=typeof b.stopPropagation?b.stopPropagation():b.cancelBubble=!0},OnMouseUp:function(a){a.setAttribute("D",0)},OnMouseOut:function(a){"1"==a.getAttribute("D")&&a.setAttribute("D",
0)},OnMouseMove:function(a,b){if("1"==a.getAttribute("D")){b=EWA$UI$COMMON.Move._Event(a,b);var c=EWA$UI$COMMON.Move._EventXY(b);if(null!=a.getAttribute("X")){var d=1*a.getAttribute("X");d=c.X-d;a.style.left=1*a.style.left.replace("px","")+d+"px";a.setAttribute("X",c.X)}null!=a.getAttribute("Y")&&(d=1*a.getAttribute("Y"),d=c.Y-d,a.style.top=1*a.style.top.replace("px","")+d+"px",a.setAttribute("Y",c.Y));"undefined"!=typeof b.preventDefault&&b.preventDefault();"undefined"!=typeof b.stopPropagation?
b.stopPropagation():b.cancelBubble=!0}},_Event:function(a,b){return b?b:a.ownerDocument.parentWindow.event},_EventXY:function(a){return EWA.B.IE?{X:a.x,Y:a.y}:{X:a.pageX,Y:a.pageY}}},EWA$UI$COMMON={Move:EWA$UI$COMMON$Move,GetMousePosition:function(a){null==a&&(a=event);return EWA.B.IE?{X:a.x,Y:a.y}:{X:a.pageX,Y:a.pageY}},CreateObject:function(a,b,c,d){a=a.document.createElement(b);null!=c&&0<c.trim().length&&(EWA.B.IE?a.style.cssText=c:a.setAttribute("style",c));null!=d&&d.appendChild(a);return a},
SetStyle:function(a,b){EWA.B.IE?a.style.cssText=b:a.setAttribute("style",b)},GetPosition:function(a){var b=a,c;var d=c=0;do d+=1*b.offsetLeft,c+=1*b.offsetTop,"DIV"==b.tagName&&(d-=b.scrollLeft,c-=b.scrollTop),b=b.offsetParent;while(null!=b&&"BODY"!=b.tagName&&"HTML"!=b.tagName);c+=1*a.offsetHeight;return{X:d,Y:c}},Dispose:function(a){if(EWA.B.IE){if(null!=a.attributes)for(var b=0;b<a.attributes.length;b+=1)null!=a.attributes[b]&&"function"==typeof a.attributes[b]&&(a.attributes[b]=null);for(b=0;b<
a.childNodes.length;b+=1)EWA$UI$COMMON.Dispose(a.childNodes[b])}},Drop:function(a){EWA$UI$COMMON.Dispose(a);a.parentNode.removeChild(a)},AniExpand:function(a,b,c,d,e){if(null==d||0>=d)d=10;var f=0,g=b/(1*d),h=c/(1*d),k=a.clientWidth+b,m=a.clientHeight+c,l=window.setInterval(function(){var b=EWA$UI$COMMON.GetObjSize(a);if(f<d-1){var c=b.H+h,p=b.W+g;c>m&&(c=m);p>k&&(p=k);EWA$UI$COMMON.SetSize(a,p,c)}else EWA$UI$COMMON.SetSize(a,k,m);p=EWA$UI$COMMON.GetObjSize(a);c=p.W-b.W;p=p.H-b.H;b=EWA$UI$COMMON.GetPosition(a);
b.Y=b.Y-a.clientHeight-1*a.style.borderTopWidth.replace("px","")-1*a.style.borderBottomWidth.replace("px","");"LEFT_TOP"!=e&&("LEFT_BOTTOM"==e?(p=b.Y-p,c=b.X,EWA$UI$COMMON.MoveTo(a,c,p)):"RIGHT_TOP"==e?(p=b.Y,c=b.X-c,EWA$UI$COMMON.MoveTo(a,c,p)):"RIGHT_BOTTOM"==e?(p=b.Y-p,c=b.X-c,EWA$UI$COMMON.MoveTo(a,c,p)):(p=1*b.Y-p/2,c=1*b.X-c/2,EWA$UI$COMMON.MoveTo(a,c,p),EWA._TmpAniObj=a));f++;f>=d&&(window.clearInterval(l),EWA.UI.Utils.AniExpandCompleateFunction&&(EWA.UI.Utils.AniExpandCompleateFunction(),
EWA.UI.Utils.AniExpandCompleateFunction=null))},12)},AniExpandTo:function(a,b,c,d,e){if(null==d||0>=d)d=10;var f=EWA$UI$COMMON.GetObjSize(a);this.AniExpand(a,b-f.W,c-f.H,d,e)},SetSize:function(a,b,c){a.style.width=b+"px";a.style.height=c+"px"},MoveTo:function(a,b,c){a.style.left=b+"px";a.style.top=c+"px"},MoveCenter:function(a){var b=this._GetOwnerWindow(a),c=this.GetObjSize(a);b=this.GetDocSize(b);this.MoveTo(a,(b.W-c.W)/2,(b.H-c.H)/2)},GetObjSize:function(a){return{H:a.clientHeight,W:a.clientWidth}},
GetDocSize:function(a){null==a&&(a=window);var b=a.document;return{W:b.body.clientWidth,H:"CSS1Compat"==b.compatMode?b.documentElement.clientHeight:b.body.clientHeight,SH:a.document.body.scrollTop,SW:a.document.body.scrollLeft}},_GetOwnerWindow:function(a){return EWA.B.IE?a.ownerDocument.parentWindow:a.ownerDocument.defaultView}};EWA.UI.Utils=EWA$UI$COMMON;EWA.UI.ImgResize=function(a,b,c){};
function EWA_ChkIframeOk(a,b){var c=a.contentWindow;c.location&&"about:blank"!=c.location.href&&c.document&&"complete"==c.document.readyState?b&&b(c,a):setTimeout(function(){EWA_ChkIframeOk(a,b)},111)}
EWA.UI.Utils.FadeIn=function(a,b,c,d,e){a!=b&&(b.setAttribute("alpha",100),a.style.display="",a.style.zIndex=-1E3,a.style.filter="Alpha(Opacity=100)",a.style.opacity=1,b.style.zIndex=1E3,b.style.display="",b.style.filter="Alpha(Opacity=100)",b.style.opacity=1,EWA.UI.Utils.FADE_IN_OBJ=a,EWA.UI.Utils.FADE_OUT_OBJ=b,EWA.UI.Utils.FADE_STEP=c,EWA.UI.Utils.FADE_TIME_SPAN=d,EWA.UI.Utils.FADE_AFTER=e,window.setTimeout(EWA.UI.Utils.FadeInTimer,EWA.UI.Utils.FADE_TIME_SPAN))};
EWA.UI.Utils.FadeInTimer=function(){try{var a=1*EWA.UI.Utils.FADE_OUT_OBJ.getAttribute("alpha")-EWA.UI.Utils.FADE_STEP;EWA.UI.Utils.FADE_OUT_OBJ.setAttribute("alpha",a);if(0>=a){EWA.UI.Utils.FADE_OUT_OBJ.style.display="none";EWA.UI.Utils.FADE_OUT_OBJ.setAttribute("alpha",0);EWA.UI.Utils.FADE_OUT_OBJ.style.filter="Alpha(Opacity=100)";EWA.UI.Utils.FADE_OUT_OBJ.style.opacity=1;EWA.UI.Utils.FADE_AFTER.ChangeAfter();EWA.UI.Utils.FADE_IN_OBJ=null;EWA.UI.Utils.FADE_OUT_OBJ=null;EWA.UI.Utils.FADE_STEP=null;
EWA.UI.Utils.FADE_TIME_SPAN=null;EWA.UI.Utils.FADE_AFTER=null;return}EWA.UI.Utils.FADE_OUT_OBJ.style.filter="Alpha(Opacity="+a+")";EWA.UI.Utils.FADE_OUT_OBJ.style.opacity=1*a/100}catch(b){}window.setTimeout(EWA.UI.Utils.FadeInTimer,EWA.UI.Utils.FADE_TIME_SPAN)};
function EWA_UI_ExcelClass(){this._Tb=null;this._HeaderRowSize=1;this._ClassName="";this._LeftColSize=1;this._ScrollParent=this._LeftHeader=this._DivLeft=this._DivTop=this._Height=this._Left=this._Top=null;this.Init=function(a,b,c,d,e){this._Tb=a;var f=$(a).offset();this._Top=f.top;this._Left=f.left;this._Height=$(a).parent()[0].clientHeight;this._HeaderRowSize=b;this._LeftColSize=c;this._ClassName=d;this._ScrollParent=e||document.body;this._Create()};this._Create=function(){var a=this._Tb,b=a.cloneNode(!0);
b.removeAttribute("onmouseout");b.removeAttribute("onmousedown");b.removeAttribute("onmouseover");$(b).css("width",$(a).width());for(var c=b.rows.length-1;c>=this._HeaderRowSize;c--)b.deleteRow(c);for(var d=0;d<this._HeaderRowSize;d++){var e=b.rows[d],f=a.rows[d];for(c=0;c<e.cells.length;c++){var g=f.cells[c];$(e.cells[c]).css("width",$(g).width())}}this._DivTop=document.createElement("div");this._DivTop.id="tb_header_con"+this._ClassName;c={position:"fixed",display:"none",top:0,left:this._Left+0,
overflow:"hidden"};$(this._DivTop).css(c);$(this._DivTop).append(b);$(this._Tb).parent().append(this._DivTop);this._LeftHeader=this._Left+0;b=a.cloneNode(!0);b.removeAttribute("onmouseout");b.removeAttribute("onmousedown");b.removeAttribute("onmouseover");$(b).find("td").attr("id",null);a=a.rows[0].cells[0].offsetWidth+2;this._DivLeft=document.createElement("div");this._DivLeft.id="tb_sidebar_con"+this._ClassName;this._DivLeft.appendChild(b);this._DivLeft.style.position="fixed";this._DivLeft.style.top=
this._Top+"px";this._DivLeft.style.left=this._Left+"px";this._DivLeft.style.overflow="hidden";this._DivLeft.style.width=a+"px";this._DivLeft.style.height=this._Height+"px";$(this._Tb).parent().append(this._DivLeft);var h=this;try{this._ScrollParent.onscroll=function(){try{h.OnScroll()}catch(k){console.log(k)}}}catch(k){console.log(k)}console.log(this._ScrollParent.onscroll)};this.OnScroll=function(){this._ScrollParent.scrollTop>this._Top&&(this._ScrollParent.scrollTop<this._Top+this._Height||this._ScrollParent!=
document.body)?(this._DivTop.style.display="",$(this._DivTop).css({left:this._LeftHeader-this._ScrollParent.scrollLeft})):this._DivTop.style.display="none";$(this._DivLeft).css({top:this._Top-this._ScrollParent.scrollTop,height:this._Height+this._ScrollParent.scrollTop})}}
EWA.UI.Move=function(){this._BackgroundObjectList=[];this._MoveObjectList=[];this._MaxIndex=199999;this.IsMoveY=this.IsMoveX=!0;this.MoveStep=1;this.Init=function(a){addEvent(document.body,"mousedown",function(b){a.OnMouseDown(b)});addEvent(document.body,"mousemove",function(b){a.OnMouseMove(b)});addEvent(document.body,"mouseup",function(b){a.OnMouseUp(b)});EWA_COMMON_MV_OBJECT=null};this.AddBackgroundObjs=function(a){for(var b=0;b<a.length;b++)this.AddBackgroundObj(a[b])};this.ReCalcBackgroundObjs=
function(){for(var a=0;a<this._BackgroundObjectList.length;a++){var b=this._BackgroundObjectList[a],c=EWA.UI.Utils.GetPosition(b.obj),d=EWA.UI.Utils.GetObjSize(b.obj);b.x0=c.X;b.x1=c.X+d.W;b.y0=c.Y-d.H;b.y1=c.Y}};this.AddBackgroundObj=function(a){var b=EWA.UI.Utils.GetPosition(a),c=EWA.UI.Utils.GetObjSize(a);this._BackgroundObjectList.push({x0:b.X,x1:b.X+c.W,y0:b.Y-c.H,y1:b.Y,obj:a})};this.CheckBackgroundObj=function(a,b){for(var c in this._BackgroundObjectList){var d=this._BackgroundObjectList[c];
if(d.x0<=a&&d.x1>=a&&d.y0<=b&&d.y1>=b)return d}};this.ClearLastBackgroundObj=function(){this.LastCheckedBackground&&(this.LastCheckedBackground.obj.style.backgroundColor=this.LastCheckedBackground.obj.getAttribute("_mv_last_bc"),this.LastCheckedBackground=null)};this.ClearAll=function(){for(var a=0;a<this._MoveObjectList.length;a++){var b=this._MoveObjectList[a];b.B.parentNode&&b.B.parentNode.removeChild(b.B)}this._MoveObjectList=[]};this.AddMoveObject=function(a,b,c,d,e,f){a.setAttribute("ewa_move",
1);a.setAttribute("ewa_move_type","MOVE");d=null==d?null:EWA.UI.Postion(d);this._MoveObjectList.push({A:a,B:b,JS:c,T:"MOVE",MOVE_X:!0,MOVE_Y:!0,L:d,JSM:e,JS_MOUSE_DOWN:f})};this.AddMoveObjectX=function(a,b,c,d,e,f){a.setAttribute("ewa_move",1);a.setAttribute("ewa_move_type","MOVE");d=null==d?null:EWA.UI.Postion(d);this._MoveObjectList.push({A:a,B:b,JS:c,T:"MOVE",MOVE_X:!0,MOVE_Y:!1,L:d,JSM:e,JS_MOUSE_DOWN:f})};this.AddMoveObjectY=function(a,b,c,d,e,f){a.setAttribute("ewa_move",1);a.setAttribute("ewa_move_type",
"MOVE");d=null==d?null:EWA.UI.Postion(d);this._MoveObjectList.push({A:a,B:b,JS:c,T:"MOVE",MOVE_X:!1,MOVE_Y:!0,L:d,JSM:e,JS_MOUSE_DOWN:f})};this.AddSizeObject=function(a,b,c,d,e,f,g){a.setAttribute("ewa_move",1);a.setAttribute("ewa_move_type","SIZE");b.style.width=b.clientWidth+"px";d=null==d?null:EWA.UI.Postion(d);e=e?EWA.UI.Postion(b):null;this._MoveObjectList.push({A:a,B:b,JS:c,T:"SIZE",L:d,M:e,JSM:f,JS_MOUSE_DOWN:g})};this.OnMouseDown=function(a){var b=this._GetEventTarget(a);null!=b&&(b=this._GetObject(b),
null!=b&&"1"==b.A.getAttribute("ewa_move")&&(a=this._GetEventXY(a),this._MaxIndex++,b.B.style.zIndex=this._MaxIndex,b.B.setAttribute("_EWA_MOUSE_DOWN",1),b.B.setAttribute("_EWA_MOUSE_X",a.X),b.B.setAttribute("_EWA_MOUSE_Y",a.Y),"absolute"!=$(b.B).css("position")&&(a=$(b.B).position(),b.B.style.position="absolute",b.B.style.left=a.left+"px",b.B.style.top=a.top+"px"),EWA_COMMON_MV_OBJECT=b,this.ReCalcBackgroundObjs(),b.JS_MOUSE_DOWN&&b.JS_MOUSE_DOWN(b)))};this.OnMouseMove=function(a){if(null!=EWA_COMMON_MV_OBJECT){var b=
EWA_COMMON_MV_OBJECT,c=b.B;if("1"==c.getAttribute("_EWA_MOUSE_DOWN")){a=this._GetEventXY(a);var d=1*c.getAttribute("_EWA_MOUSE_X"),e=1*c.getAttribute("_EWA_MOUSE_Y"),f=a.X-d,g=a.Y-e;if(!(Math.abs(f)<this.MoveStep&&Math.abs(g)<this.MoveStep)){e=b.L;d=1*$(c).css("left").replace("px","")+f;var h=1*$(c).css("top").replace("px","")+g;if("MOVE"==b.T)null==e?(0>d&&(d=0),0>h&&(h=0)):(f=c.offsetWidth,g=c.offsetHeight,d<e.Left?d=e.Left:d+f>e.Right&&(d=e.Right-f),f=e.Right-(d+f),h<e.Top?h=e.Top:h+g>e.Bottom&&
(h=e.Bottom-g),e=e.Bottom-(h+g),c.setAttribute("ewa_mv_left",d.fm(0)),c.setAttribute("ewa_mv_top",h.fm(0)),c.setAttribute("ewa_mv_bottom",e.fm(0)),c.setAttribute("ewa_mv_right",f.fm(0))),this.IsMoveX&&b.MOVE_X&&(c.style.left=d+"px"),this.IsMoveY&&b.MOVE_Y&&(c.style.top=h+"px");else{var k=1*c.style.width.replace("px","")+f,m=1*c.style.height.replace("px","")+g;10>k&&(k=10);10>m&&(m=10);if(null!=e)if(null!=b.M){var l=1*b.M.Width/b.M.Height;if(1==l){c.style.width.replace("px","");a=Math.sqrt(f*f+g*g);
if(0<g||0>f)a*=-1;a={left:$(c).position().left-a/4,top:$(c).position().top-a/4,width:$(c).width()+a/2,height:$(c).height()+a/2};if(a.height+a.top>e.Bottom||a.top<e.Top||a.left+a.width>e.Right||a.left<e.Left||50>a.width)return;$(c).css(a);b.JSM&&b.JSM(b.B,b.A);return}f=k/m;f>l?m=k/l:f<l&&(k=m*l);d+k>e.Right&&(k=e.Right-d,m=k/l);h+m>e.Bottom&&(m=e.Bottom-h,k=m*l)}else d+k>e.Right&&(k=e.Right-d),h+m>e.Bottom&&(m=e.Bottom-h);this.IsMoveX&&(c.style.width=k+"px");this.IsMoveY&&(c.style.height=m+"px")}c.setAttribute("_EWA_MOUSE_X",
a.X);c.setAttribute("_EWA_MOUSE_Y",a.Y);b.JSM&&b.JSM(b.B,b.A);(b=this.CheckBackgroundObj(a.X,a.Y))?b!=this.LastCheckedBackground&&(this.LastCheckedBackground&&(this.LastCheckedBackground.obj.style.backgroundColor=this.LastCheckedBackground.obj.getAttribute("_mv_last_bc")),this.LastCheckedBackground=b,b.obj.setAttribute("_mv_last_bc",b.obj.style.backgroundColor),b.obj.style.backgroundColor="lightyellow"):this.LastCheckedBackground&&(this.LastCheckedBackground.obj.style.backgroundColor=this.LastCheckedBackground.obj.getAttribute("_mv_last_bc"))}}}};
this.OnMouseUp=function(a){a=EWA_COMMON_MV_OBJECT;if(null!=a){for(var b=0;b<this._MoveObjectList.length;b++)this._MoveObjectList[b].B.setAttribute("_EWA_MOUSE_DOWN",0);null!=a.JS&&a.JS(a.B,a.A);EWA_COMMON_MV_OBJECT=null}};this._GetObject=function(a){for(var b=0;b<this._MoveObjectList.length;b++){var c=this._MoveObjectList[b].A;if(c==a)return this._MoveObjectList[b]}for(b=0;b<this._MoveObjectList.length;b++){c=this._MoveObjectList[b].A;c=c.getElementsByTagName(a.tagName);for(var d=0;d<c.length;d++){var e=
this._MoveObjectList[b];if(c[d]==a)return e}}return null};this._GetEventTarget=function(a){return EWA.B.IE?event.srcElement:a.target};this._GetEventXY=function(a){return EWA.B.IE?{X:a.x,Y:a.y}:{X:a.pageX,Y:a.pageY}}};function EWA_UI_MenuItemClass(){this.Group=this.Cmd=this.Txt=this.Img=null}
function EWA_UI_MenuClass(a){this.ClassName=a;this.MenuShowType="";this.Dialog=null;this.Dialogs=[];this.clickedItem=this._ItemsDiv=this._LastObj=null;this.Click=function(a,c){"LEFT"!=this.MenuShowType&&(null!=this._LastObj&&(this._LastObj.className=this._LastObj.className.replace("_mv1","")),this._LastObj=null,"undefined"!=typeof a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,this._HiddenDialogs());EWA.C.Utils.RunCmd(c)};this.OnClick=function(a,c){this.clickedItem=c;if("LEFT"==this.MenuShowType){var b=
c.parentNode,e=c.parentNode.parentNode.childNodes[1];if(null==e)return;0==e.childNodes.length?(this._LastCkObj&&(this._LastCkObj.style.backgroundColor=""),b.style.backgroundColor="#ccc",this._LastCkObj=b):(e.style.display="none"==e.style.display?"":"none",window.event?a.cancelBubble=!0:a.stopPropagation())}else if(""==c.getAttribute("EWA_MF_PID")&&(this._HiddenDialogs(),0>=this.Dialogs.length&&this.Dialogs.push(this._CreateDialog()),0<this._ShowPullDownMenu(c,this.Dialogs[0]))){this.ShowByObject(c,
this.Dialogs[0],0);return}this.Click(a,c)};this._CalcLevel=function(a){for(var b=0;""!=a.getAttribute("EWA_MF_PID");)if(b+=1,a=document.getElementById(a.getAttribute("EWA_MF_PID")),null==a)return null;return b};this._ShowPullDownMenu=function(a,c){for(var b=$X(c.FrameContent).childNodes[0].rows[0].cells[0];0<b.childNodes.length;)this._ItemsDiv.appendChild(b.childNodes[0]);for(var e=[],f=0;f<this._ItemsDiv.childNodes.length;f++){var g=this._ItemsDiv.childNodes[f];0<g.innerHTML.toUpperCase().indexOf("<HR")||
(g.style.paddingRight="10px");g.getAttribute("EWA_MF_PID")==a.id&&e.push(g)}a=e.length;for(f=0;f<e.length;f++){b.appendChild(e[f]);if(this._CheckChildren(e[f].id)){g=e[f].childNodes[0].rows[0].cells[2];if(null==g.getAttribute("gdx")||""==g.getAttribute("gdx"))g.innerHTML+=" +",g.setAttribute("gdx","gdx");e[f].setAttribute("EWA_MF_CHILD","1")}else e[f].setAttribute("EWA_MF_CHILD","0");e[f]=null}e.length=0;$X(c.FrameContent).childNodes[0].style.height="auto";return a};this._CheckChildren=function(a){for(var b=
0;b<this._ItemsDiv.childNodes.length;b++)if(this._ItemsDiv.childNodes[b].getAttribute("EWA_MF_PID")==a)return!0;return!1};this.InstallMenus=function(a,c,d){if("METRO"==d){var b=[],f={};$(".ewa_menu_m").each(function(){var a=$(this),c={};c.id=a.attr("id");c.pid=a.attr("EWA_MF_PID");c.url=a.attr("EWA_CMD");c.icon=a.find(".ewa_menu_m0").attr("class");c.title=a.text().trim();c.icon&&(c.icon=c.icon.replace("ewa_menu_m0","").trim());""==c.pid?(c.pid="0",c.subs=[],f[c.id]=c,b.push(c)):f[c.pid].subs.push(c)});
EWA_UI_Metro.menus=b;EWA_UI_Metro.add_menus(b,"EWA_FRAME_MAIN","item",null,null,!0)}else{this.MenuShowType=d;d=$X(a);var g=$X(c);if(null==g)alert("MenuShow defined error ("+c+")");else{this._ItemsDiv=d;c=[];g.innerHTML="<table onselectstart='return false' style='cursor:pointer;-moz-user-select:none;' border=0 cellspacing=0 cellpadding=0></table>";g=g.childNodes[0];for(var h=0;h<d.childNodes.length;h++){var k=d.childNodes[h];"DIV"==k.tagName&&""==k.getAttribute("EWA_MF_PID")&&c.push(k)}if(""==this.MenuShowType||
"TOP"==this.MenuShowType)for(g.insertRow(-1),h=0;h<c.length;h++)g.rows[0].insertCell(-1).appendChild(c[h]);else g.style.width="100%",this._InstallMenusLeft(g,d,c,a);c.length=0;c=null}}};this._InstallMenusLeft=function(a,c,d,e){for(var b=0;b<d.length;b++){var g=a.insertRow(-1).insertCell(-1);e=document.createElement("div");e.innerHTML='<div class="ewa_lmenu_bar" des="rq1"></div><div  des="rq2"></div>';e.childNodes[1].style.paddingLeft="5px";g.appendChild(e);d[b].style.height="100%";e.childNodes[0].appendChild(d[b]);
0<b&&(e.childNodes[1].style.display="none")}for(a=c.childNodes;0<c.childNodes.length;)d=a[0],b=d.getAttribute("EWA_MF_PID"),e=document.createElement("div"),e.innerHTML='<div class="ewa_lmenu_bar1"></div><div style="padding-left:4px;display:none"></div>',$X(b).parentNode.parentNode.childNodes[1].appendChild(e),e.childNodes[0].appendChild(d)};this._CreateDialog=function(){var a=new EWA_UI_DialogClass;a.Create();a.SetHtml("<table class='ewa_menu_down' border=0 width=100 cellspacing=0 cellpadding=0 onmousemove='window."+
this.ClassName+".IsOut=false;' onmouseout='window."+this.ClassName+".IsOut=true; window.setTimeout(function(){var a=window."+this.ClassName+";a.AutoHidden();},1410);' onselectstart='return false' style='cursor:pointer;-moz-user-select:none;' ><tr><td></td></tr></table>");return a};this.AutoHidden=function(){this.IsOut&&this._HiddenDialogs()};this.Create=function(a){if(null!=a&&0!=a.length){this.Dialog=new EWA_UI_DialogClass;this.Dialog.Create();var b=[];b.push("<div class='ewa_menu_box' onmousemove='window."+
this.ClassName+".IsOut=false;' onmouseout='window."+this.ClassName+".IsOut=true; var t1=new Date().getTime(); if(t1-$(this).attr(&quot;open_time&quot;)>1000){ window.setTimeout(function(){var a=window."+this.ClassName+";a.AutoHidden(this);},1410);}'  onselectstart='return false' style='width:120px;cursor:pointer;-moz-user-select:none;'>");for(var d=0;d<a.length;d+=1){var e=a[d];b.push("<div class='ewa_menu_m' EWA_MG=\""+e.Group+"\" style='cursor:pointer' EWA_CMD=\""+e.Cmd+"\" onclick='"+this.ClassName+
".Click(event,this);' onmouseover='"+this.ClassName+".MouseOver(this);'><table boder=0 width=100% cellpadding=0 cellspacing=0>");0<=e.Txt.toUpperCase().indexOf("<HR")?b.push("<tr><td colspan=2 style='white-space:nowrap'>"+e.Txt+"</td></tr></table></div>"):(b.push("<tr><td class='ewa_menu_m0'>"),e=a[d].Img,null!=e&&0>e.indexOf("index=0,size=0")&&0<e.trim().length&&(0<=e.indexOf("fa")?b.push('<i class="'+e+'"></i>'):b.push('<img src="'+a[d].Img+'">')),b.push("</td><td class='ewa_menu_m1' style='white-space:nowrap'>"+
a[d].Txt+"</td></tr></table></div>"))}b.push("</div>");this.Dialog.SetHtml(b.join(""))}};this.HiddenMemu=function(){this.Dialog.Show(!1);EWA.UI.CurMenu=null};this.ShowByObject=function(a,c,d){var b=EWA.UI.Utils.GetPosition(a);this.SHOW_BY_OBJECT=a;c=c||this.Dialog;null==d||0==d?c.Move(b.X,b.Y):c.Move(b.X+a.offsetWidth-5,b.Y-a.offsetHeight+4);c.Show(!0);$(c.GetFrame()).find(".ewa_menu_box").attr("open_time",(new Date).getTime());c.ResizeByContent()};this.ShowByMouse=function(a,c){if(this.Dialog){var b=
0,e=$X(this.Dialog.FrameContent).childNodes[0];if(null==c)b=e.childNodes.length;else for(var f=0;f<e.childNodes.length;f++)e.childNodes[f].getAttribute("EWA_MG")==c||null==c||""==c?(e.childNodes[f].style.display="",b++):e.childNodes[f].style.display="none";0<b?(c=a.x?a.x:a.pageX,a=a.y?a.y:a.pageY,a+=document.body.scrollTop,c+=document.body.scrollLeft,this.Dialog.Move(c,a),this.Dialog.Show(!0),this.Dialog.ResizeByContent()):this.Dialog.Show(!1)}};this.MouseOver=function(a){null!=this._LastObj&&("LEFT"==
this.MenuShowType?this._LastObj.parentNode.className=this._LastObj.parentNode.className.replace("_mv",""):this._LastObj.className=this._LastObj.className.replace("_mv1",""));if("LEFT"==this.MenuShowType)this._LastObj=a,this._LastObj.parentNode.className+="_mv";else{this._LastObj=a;this.IsOut=!1;this._LastObj.className+="_mv1";null==EWA.UI.CurMenu&&(EWA.UI.CurMenu=this);var b=this._CalcLevel(a);"1"==a.getAttribute("EWA_MF_CHILD")&&(this.Dialogs.length<=b&&this.Dialogs.push(this._CreateDialog()),this._ShowPullDownMenu(a,
this.Dialogs[b]),this.ShowByObject(a,this.Dialogs[b],b))}};this._HiddenDialogs=function(){null!=this.Dialog&&this.Dialog.Show(!1);for(var a=0;a<this.Dialogs.length;a++){this.Dialogs[a].Show(!1);for(var c=$X(this.Dialogs[a].FrameContent).childNodes[0].rows[0].cells[0];0<c.childNodes.length;)this._ItemsDiv.appendChild(c.childNodes[0])}};this._InitEvent=function(){"LEFT"!=this.MenuShowType&&(EWA.B.IE?document.body.attachEvent("onclick",function(){"undefined"!=typeof EWA.UI.CurMenu&&EWA.UI.CurMenu._HiddenDialogs()}):
document.body.addEventListener("click",function(){"undefined"!=typeof EWA.UI.CurMenu&&EWA.UI.CurMenu._HiddenDialogs()}))}}
var EWA_UI_Metro={show_title:function(a){if(""==a.getAttribute("_title")||null==a.getAttribute("_title")){var b=a.title;if(""==b||null==b)return;a.setAttribute("_title",b);a.title=""}$(".pop_title div").html(a.getAttribute("_title"));b=$(a).offset();a=$(a).width();var c=$(".pop_title").height(),d=$(".pop_title").width();$(".pop_title").css("top",b.top-c-8);$(".pop_title").show();$(".pop_title").css("left",b.left-(d-a)/2)},item_click:function(a){var b=$(a);a=b.attr("u");b=b.attr("_title");a&&(a.startsWith("js:")?
(a=a.replace("js:",""),eval(a)):(0<a.indexOf("/")||(a=0<=a.indexOf("?")?EWA.CP+"/EWA_STYLE/cgi-bin/"+a:EWA.CP+"/EWA_STYLE/cgi-bin/?"+a),top.AddTab(a,b)))},add_menus:function(a,b,c,d,e,f){this.g_menu_cols=window.g_menu_cols||6;this.g_menu_rows=window.g_menu_rows||3;this.menuLoadInRight=window.menuLoadInRight||!1;d=d||this.g_menu_cols;e=e||this.g_menu_rows;for(var g=0;g<a.length;g++){var h=a[g];if(h&&h.icon&&0<h.icon.indexOf("gear")){a[g]=null;a[d*e-1]=h;break}}var k=document.createElement("table");
$X(b).innerHTML="";$X(b).className="ewa-metro-menu";$X(b).appendChild(k);$($X(b)).append('<div class="pop_title" style="display: none;"><div>-</div><p></p></div>');$($X(b)).css("background","transparent").css("border",0);k.align="center";var m=0,l=[];for(g=0;g<e;g++){var n=b+"_htr_"+g;h=k.insertRow(-1);h.id=n;var q=h.insertCell(-1);q.colSpan=d;h.style.display="none";q.id=n+"a";q=k.insertRow(-1);for(var p=0;p<d;p++){h=a[m];m++;var r=this.add_menu_item(q,h,f,m,c,n);h&&(r.id="M_"+h.id);r&&h&&(null==
h.all||1==h.all)&&l.push(r.innerHTML)}}!this._is_load_main_menu&&this.menuLoadInRight&&(parent.$("#RIGHT").html(l.join("")),parent.$("#RIGHT .item").each(function(){$(this).append($(this).attr("_title"));$(this).attr("onmouseout",null);$(this).attr("onmouseover",null);$(this).attr("onclick","EWA_UI_Metro.right_show_menu_sub(this,event)")}));this._is_load_main_menu=!0},add_menu_item:function(a,b,c,d,e,f){if(c||b){var g=a.insertCell(-1);g.innerHTML="<div class='"+e+"'><i id='memu_item_"+d+"'></i></div>"}if(b)return a=
$(g).find("i"),c=a.parent(),b.icon&&0<b.icon.trim().length?0==b.icon.indexOf("fa")?a.attr("class",b.icon):(c.append("<table width=100% height=100%><tr><td align=center><img style='max-width:90%;max-height:90%' src='"+b.icon+"' /></td></tr></table>"),a.hide()):b.img&&(c.append("<table width=100% height=100%><tr><td align=center><img  src='"+b.img+"' /></td></tr></table>"),a.hide()),c.attr("_title",b.title),c.attr("onmouseover","EWA_UI_Metro.show_title(this)"),c.attr("onmouseout","$('.pop_title').hide()"),
c.attr("hid",f),b.url?(c.attr("u",b.url),c.attr("onclick","EWA_UI_Metro.item_click(this,event)")):b.subs&&(c.attr("subs",JSON.stringify(b.subs)),c.attr("onclick","EWA_UI_Metro.show_menu_sub(this,event)")),g.id="M_"+b.id,g},show_menu_sub:function(a){var b=$(a),c=b.attr("class"),d=b.attr("hid");window.last_open&&window.last_open!=a&&window.last_open.click();if(1==b.attr("is_open"))b.attr("is_open","0"),$X(d).style.display="none",window.last_open=null,b.attr("class",c.split(" ")[0]);else{b.attr("is_open",
"1");var e=JSON.parse(a.getAttribute("subs"));$X(d).style.display="";$X(d).style.opacity=0;EWA_UI_Metro.add_menus(e,d+"a","item_sub",9,Math.round(e.length/9+.4),!1);b.attr("class",c+" open");$($X(d)).animate({opacity:1},300);window.last_open=a;EWA_UI_Metro.load_msg_sub()}this.show_menu_sub_after&&this.show_menu_sub_after(a)},css:function(){if(!this._css_setted){var a=[];a.push(".nav_box {");a.push("margin: auto;");a.push("margin-top: 50px;");a.push("}");a.push(".nav_box .item {");a.push("margin: 5px;");
a.push("background-color: #08c;");a.push("width: 140px;");a.push("height: 140px;");a.push("text-align: center;");a.push("color: #fff;");a.push("transition-duration: 0.3s;");a.push("-webkit-transition-duration: 0.3s;");a.push("cursor: pointer;");a.push("position: relative;");a.push("}");a.push(".nav_box .item .msg {");a.push("position: absolute;");a.push("top: -8px;");a.push("right: -8px;");a.push("height: 18px;");a.push("border-radius: 10px;");a.push("background-color: red;");a.push("color: #fff;");
a.push("line-height: 18px;");a.push("text-align: center;");a.push("min-width: 18px;");a.push("padding: 2px;");a.push("box-shadow: 1px 1px 13px rgba(0, 0, 245, 0.7);");a.push("}");a.push(".nav_box .open {");a.push("-webkit-transform: rotate(45deg) scale(0.7);");a.push("-webkit-transition-duration: 0.7s;");a.push("transform: rotate(45deg) scale(0.7);");a.push("transition-duration: 0.7s;");a.push("}");a.push(".nav_box .open i {");a.push("transform: rotate(-45deg);");a.push("-webkit-transform: rotate(-45deg);");
a.push("}");a.push(".nav_box .item:hover {");a.push("background-color: #fff;");a.push("color: #08c;");a.push("-webkit-transition-duration: 0.3s;");a.push("transition-duration: 0.3s;");a.push("}");a.push(".nav_box .item i {");a.push("line-height: 140px;");a.push("font-size: 60px;");a.push("}");a.push(".nav_box .item img {");a.push("max-height: 100px;");a.push("max-width: 100px;");a.push("}");a.push(".nav_box .item_sub {");a.push("margin: 12px;");a.push("background-color: darkorange;");a.push("width: 70px;");
a.push("height: 70px;");a.push("text-align: center;");a.push("color: #fff;");a.push("-webkit-transition-duration: 0.3s;");a.push("transition-duration: 0.3s;");a.push("cursor: pointer;");a.push("position: relative;");a.push("}");a.push(".nav_box .item_sub .msg {");a.push("position: absolute;");a.push("top: -8px;");a.push("right: -8px;");a.push("height: 18px;");a.push("border-radius: 10px;");a.push("background-color: #fff;");a.push("color: red;");a.push("line-height: 18px;");a.push("text-align: center;");
a.push("min-width: 18px;");a.push("padding: 2px;");a.push("box-shadow: 1px 1px 13px rgba(255, 0, 0, 0.7);");a.push("}");a.push(".nav_box .item_sub i {");a.push("line-height: 70px;");a.push("font-size: 30px;");a.push("}");a.push(".nav_box .item_sub:hover {");a.push("background-color: #fff;");a.push("color: darkorange;");a.push("-webkit-transition-duration: 0.3s;");a.push("transition-duration: 0.3s;");a.push("}");a.push(".pop_title{ position: absolute;min-width: 50px;display: none;z-index: 212;white-space: nowrap;}");
a.push(".pop_title div {position: relative;width: 100%;z-index: 2;height: 30px;line-height: 30px;text-align: center;background-color: #8D8804;padding: 0 4px;border-radius: 5px;color: #fff;}");a.push(".pop_title p {");a.push("position: relative;");a.push("padding: 0px;");a.push("height: 12px;");a.push("width: 12px;");a.push("transform: rotate(45deg);");a.push("-webkit-transform: rotate(45deg);");a.push("margin: auto;");a.push("margin-top: -6px;");a.push("z-index: 1;");a.push("background-color: #8D8804;");
a.push("}");var b=document.createElement("style");b.textContent=a.join("\n");document.getElementsByTagName("head")[0].appendChild(b);this._css_setted=!0}},right_show_menu_sub:function(a,b){b=b||event;if("item"==(b.target||b.srcElement).className){b=$(a);var c=this.right_add_menu_subs(a);window.last_open&&window.last_open!=a&&window.last_open.click();1==b.attr("is_open")?(b.attr("is_open","0"),c&&(c.style.display="none"),window.last_open=null):(b.attr("is_open","1"),c&&(c.style.display=""),window.last_open=
a)}},right_add_menu_subs:function(a){var b=("M_"+Math.random()).replace(".","");a.id=a.id||b;var c=a.id+"_s";if($X(c))return $X(c);var d;(b=a.getAttribute("subs"))&&(d=JSON.parse(b));if(d&&0!=d.length){b=document.createElement("div");b.id=c;a.appendChild(b);for(a=0;a<d.length;a++){c=d[a];var e=document.createElement("p");$(e).attr({onclick:"EWA_UI_Metro.right_item_click(this)",_title:c.title,u:c.url});e.innerHTML="<b class='"+c.icon+"'></b><span>"+c.title+"</span>";b.appendChild(e)}return b}this.right_item_click(a)},
right_item_click:function(a){var b=$(a);a=b.attr("u");b=b.attr("_title");a&&(0<a.indexOf("/")||(a=0<=a.indexOf("?")?EWA.CP+"/EWA_STYLE/cgi-bin/"+a:EWA.CP+"/EWA_STYLE/cgi-bin/?"+a),AddTab(a,b))},load_msg_sub:function(){}},__Menu={C:EWA_UI_MenuClass,OnMouseOver:function(a){null!=__Menu._LastObj&&(__Menu._LastObj.style.backgroundColor="");__Menu._LastObj=a;a.style.backgroundColor="#DDD"},OnClick:function(a,b){null!=__Menu._LastObj&&(__Menu._LastObj.style.backgroundColor="");__Menu._LastObj=null;"undefined"!=
typeof a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;if(0<b.id.indexOf("_EWA_MF_")&&0<b.id.indexOf("*")){a=b.id.split("*")[0];a=document.getElementById(a);for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];d.getAttribute("EWA_MF_PID")==a.id&&alert(d.innerHTML)}}EWA.C.Utils.RunCmd(b)}};EWA.UI.Menu=__Menu;var __EMP_TIP_TIMER_SHOW,__EMP_TIP_CLASS;function EMP_TIP_HIDE(){window.clearInterval(__EMP_TIP_TIMER_SHOW);__EMP_TIP_CLASS._Hidden();__EMP_TIP_TIMER_SHOW=null}
function EWA_UI_TipClass(a){this.ParentWindow=window;this.TipFrame=null;this.Alpha=0;this.IsShow=!0;this._Id="__EWA_TIP_"+a;this._BakFrame=this._BakTable=this._ForTable=this._ShowDocument=null;this._InitTipFrame=function(){var a=this._InitDiv(),c=this._InitTable();this._ForTable=c;this._InitTableImgForground(c);a.appendChild(c);this._BakTable=c=this._InitTable();this._InitTableImgBackground(c);a.appendChild(c);this.TipFrame=a;this.ParentWindow.document.body.appendChild(a);__EMP_TIP_CLASS=this};this._InitDiv=
function(){var a=this.ParentWindow.document.createElement("div");a.id=this._Id;a.style.zIndex="1998";a.style.display="none";a.className="ewa-tip";a.innerHTML=EWA.B.IE?"<iframe src='javascript:false' style=\"position:absolute; visibility:inherit; top:0px; left:0px; width:1px; height:1px; z-index:-1; filter='progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)';\"></iframe>":'<div style="position:absolute; visibility:inherit; top:0px; left:0px; width:1px; height:1px; z-index:-1;"></div>';this._BakFrame=
a.childNodes[0];return a};this._CreateImgHtml=function(a,c,d){return"<img src='"+((null==EWA.RV_STATIC_PATH?EWA.CP:EWA.RV_STATIC_PATH)+"/EWA_STYLE/images/tip/"+a)+"' width="+c+" height="+d+">"};this._SetBackgound=function(a,c){a.style.backgroundImage="url('"+((null==EWA.RV_STATIC_PATH?EWA.CP:EWA.RV_STATIC_PATH)+"/EWA_STYLE/images/tip/"+c)+"')";a.style.backgroundRepeat="repeat-x"};this._InitTableImgForground=function(a){a.className="ewa-tip-for";a.rows[2].cells[1].onmouseover=function(){window.clearInterval(__EMP_TIP_TIMER_SHOW);
__EMP_TIP_TIMER_SHOW=null;this.bgColor="#FFCC66"};a.onmouseout=function(){window.clearInterval(__EMP_TIP_TIMER_SHOW);__EMP_TIP_TIMER_SHOW=null;__EMP_TIP_CLASS.HiddenTip();this.rows[2].cells[1].bgColor="white"};a.rows[0].cells[0].className="ewa-tip-arrow";a.rows[1].cells[0].className="ewa-tip-tl";a.rows[1].cells[1].className="ewa-tip-tm";a.rows[1].cells[2].className="ewa-tip-tr";a.rows[2].cells[0].className="ewa-tip-l";a.rows[2].cells[1].className="ewa-tip-m";a.rows[2].cells[2].className="ewa-tip-r";
a.rows[3].cells[0].className="ewa-tip-bl";a.rows[3].cells[1].className="ewa-tip-bm";a.rows[3].cells[2].className="ewa-tip-br"};this._InitTableImgBackground=function(a){};this._InitTable=function(){var a=this.ParentWindow.document.createElement("table"),c=a.insertRow(-1);c.insertCell(-1);for(var d=0;3>d;d++){c=a.insertRow(-1);for(var e=0;3>e;e++)c.insertCell(-1).style.fontSize=1==d&&1==e?"12px":"1px"}c=a.insertRow(-1);c.insertCell(-1);a.border=0;a.cellSpacing=0;a.cellPadding=0;a.style.fontSize="1px";
a.rows[0].cells[0].colSpan=3;a.rows[4].cells[0].colSpan=3;return a};this.ShowTip=function(a,c,d){window.clearInterval(__EMP_TIP_TIMER_SHOW);__EMP_TIP_TIMER_SHOW=null;this.TipFrame.style.display="";this._ForTable.rows[2].cells[1].innerHTML=a;a=this._ForTable.offsetWidth;this._ForTable.style.width=this._ForTable.rows[2].cells[1].offsetWidth+12+"px";var b=c-a/4+14;0>b?b=12:null!=this._ShowDocument&&a+b>this._ShowDocument.body.offsetWidth&&(b=this._ShowDocument.body.offsetWidth-a-2);this.TipFrame.style.left=
b+"px";this.TipFrame.style.top=d+3+"px";b=c-b;c=b+3;var f="/EWA_STYLE/images/tip/image048.gif";d="/EWA_STYLE/images/tip/image013.png";b<a/2&&0<b-32&&(f="/EWA_STYLE/images/tip/image050.gif",d="/EWA_STYLE/images/tip/image015.png",b-=32,0>b&&(b=4),c=b-3);a=document.all?6:9;var g=null==EWA.RV_STATIC_PATH?EWA.CP:EWA.RV_STATIC_PATH;this._ForTable.rows[0].cells[0].innerHTML="<img src='"+g+f+"' width=32 height=21 style='position: relative; left: "+b+"px; top: "+a+"px'>";b="<img src='"+g+d+"' width=37 height=21 style='position: relative; left: "+
c+"px; top: "+a+"px'>";document.all&&(b="<div style=\"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+(g+d)+"', sizingMethod='scale'); position: relative; left: "+c+"px; top: "+a+'px; width:37px; height:21px"></DIv>');this._BakTable.rows[0].cells[0].innerHTML=b;this.TipFrame.style.display=""};this.HiddenTip=function(){__EMP_TIP_CLASS=this;null!=__EMP_TIP_TIMER_SHOW&&window.clearInterval(__EMP_TIP_TIMER_SHOW);__EMP_TIP_TIMER_SHOW=window.setInterval(EMP_TIP_HIDE,500)};this.GetObjectLocation=
function(a,c){a=EWA.UI.Utils.GetPosition(a);return[a.X,a.Y]};this._Hidden=function(){this.TipFrame.style.display="none"};this._InitTipFrame()}
function EWA_UI_LinkClass(a,b){this.LinkObj1=a;this.LinkObj2=b;this.LinkObj=null;this._Style="2px solid blue";this.getSize=function(a){var b=EWA$UI$COMMON.GetPosition(a);return{X:b.X,Y:b.Y,W:a.offsetWidth,H:a.offsetHeight}};this._CreateLinkObj=function(){var a=document.createElement("table");EWA.B.IE?a.style.cssText="position: absolute; width: 100px; height: 100px; z-index: -11; left: 693px; top: 174px;font-size:1px;":a.setAttribute("style","position: absolute; width: 100px; height: 100px; z-index: -11; left: 693px; top: 174px;font-size:1px;");
a.cellSpacing=0;for(var b=a.cellPadding=0;2>b;b++)for(var e=a.insertRow(-1),f=0;2>f;f++)e.insertCell(-1).innerHTML="&nbsp;";document.body.appendChild(a);this.LinkObj=a};this.Link=function(){null==this.LinkObj&&this._CreateLinkObj();this.LinkObj.rows[0].cells[0].style.border="";this.LinkObj.rows[0].cells[1].style.border="";this.LinkObj.rows[1].cells[0].style.border="";this.LinkObj.rows[1].cells[1].style.border="";var a=this.getSize(this.LinkObj1),b=this.getSize(this.LinkObj2);if(a.X+a.W<b.X){var e=
a.X+a.W;var f=b.X-a.X-a.W;this.LinkObj.rows[0].cells[0].style.width=f/2+"px"}else a.X<b.X?(e=a.X-20,f=b.X-a.X+20,this.LinkObj.rows[0].cells[0].style.width="20px"):a.X>=b.X&&a.X<b.X+b.W?(e=b.X-20,f=a.X-b.X+20,this.LinkObj.rows[0].cells[0].style.width="20px"):(e=b.X+b.W,f=a.X-b.X-b.W,this.LinkObj.rows[0].cells[0].style.width=f/2+"px");if(a.Y<b.Y){var g=b.Y-b.H/2-a.Y+a.H/2;var h=a.Y-a.H/2}else g=a.Y-a.H/2-b.Y+b.H/2,h=b.Y-b.H/2;this.LinkObj.style.width=f+"px";this.LinkObj.style.height=g+"px";this.LinkObj.style.left=
e+"px";this.LinkObj.style.top=h+"px";h=this.LinkObj.rows[0].cells[0];e=this.LinkObj.rows[0].cells[1];g=this.LinkObj.rows[1].cells[0];f=this.LinkObj.rows[1].cells[1];a.Y<b.Y?a.X+a.W<b.X?(h.style.borderTop=this._Style,h.style.borderRight=this._Style,g.style.borderRight=this._Style,f.style.borderBottom=this._Style):(a.X<b.X?(h.style.borderTop=this._Style,h.style.borderLeft=this._Style,g.style.borderLeft=this._Style,f.style.borderBottom=this._Style):a.X>=b.X&&a.X<b.X+b.W?(h.style.borderTop=this._Style,
h.style.borderLeft=this._Style,g.style.borderLeft=this._Style,e.style.borderTop=this._Style):(e.style.borderTop=this._Style,h.style.borderRight=this._Style,g.style.borderRight=this._Style),g.style.borderBottom=this._Style):a.X+a.W<b.X?(e.style.borderTop=this._Style,h.style.borderRight=this._Style,g.style.borderRight=this._Style,g.style.borderBottom=this._Style):a.X<b.X?(h.style.borderTop=this._Style,e.style.borderTop=this._Style,h.style.borderLeft=this._Style,g.style.borderLeft=this._Style,g.style.borderBottom=
this._Style):a.X>=b.X&&a.X<b.X+b.W?(h.style.borderTop=this._Style,h.style.borderLeft=this._Style,g.style.borderLeft=this._Style,f.style.borderBottom=this._Style,g.style.borderBottom=this._Style):(h.style.borderTop=this._Style,h.style.borderRight=this._Style,g.style.borderRight=this._Style,f.style.borderBottom=this._Style)}}
function EWA_UI_TabsClass(a){this._ClassName=a;this._Index=0;this._ContentsParent=this._TabsParent=null;this._IdTabTag="__EWA_TAB_HEAD_";this._IdFrameTag="__EWA_TAB_FRAME_";this.CurrentWindow=null;this._CurId="";this.CreateTab=function(a,c){var b=this._CheckExist(a);if(null==b){b=this._Index;var e=this._CreateTabHead(a,c||"...");a=this._CreateIframe(a);this._Index++;c||EWA_ChkIframeOk(a,function(a,b){a=a.document.title;$(e).find(".bg_c span:eq(0)").text(a)})}this.ShowTab(b)};this._CreateTabHead=function(a,
c){var b=this._Index,e=this._TabsParent.ownerDocument.createElement("table");e.cellPadding=0;e.cellSpacing=0;e.border=0;e.setAttribute("ewa_tab_url",a);e.title="\u53cc\u51fb\u5173\u95ed\u7a97\u53e3\r\n\u53f3\u952e\u5237\u65b0\u5f53\u524d\u7a97\u53e3";a=e.insertRow(-1);a.insertCell(-1).className="bg_l";var f=a.insertCell(-1);f.className="bg_c";f.innerHTML="<nobr><span>"+c+"</span><b class='ewa_tab_close'></b></nobr></div>";f.getElementsByTagName("b")[0].onclick=function(){var a=this.parentNode.parentNode.parentNode.parentNode.parentNode,
b=a.id.split("_");b=b[b.length-1];eval("window."+a.getAttribute("ewa_class_name")).RemoveTab(b)};a.insertCell(-1).className="bg_r";e.id=this._IdTabTag+b;e.className="ewa_tab_act";e.setAttribute("ewa_class_name",this._ClassName);e.onclick=function(){if(0==e.getAttribute("ewa_tab_act")){var a=this.id.split("_");a=a[a.length-1];eval("window."+this.getAttribute("ewa_class_name")).ShowTab(a)}};e.ondblclick=function(){var a=this.id.split("_");a=a[a.length-1];eval("window."+this.getAttribute("ewa_class_name")).RemoveTab(a)};
e.onselectstart=function(){return!1};e.oncontextmenu=function(a){this.onclick();EWA.B.IE?window.event.returnValue=!1:a.preventDefault();a=this.id.split("_");var b="__EWA_TAB_FRAME_"+a[a.length-1];a=new EWA_UrlClass;b=$X(b).contentWindow;a.SetUrl(b.location.href);a.RemoveParameter("________r");a.AddParameter("________r",Math.random());b.location.href=a.GetUrl();return!1};EWA.B.IE||(e.onmousedown=function(a){"undefined"!=typeof a.preventDefault&&a.preventDefault()});this._TabsParent.appendChild(e);
return e};this._CreateIframe=function(a){var b=this._ContentsParent.ownerDocument.createElement("IFRAME");b.frameBorder=0;b.width="100%";b.height="100%";b.src=a;b.id=this._IdFrameTag+this._Index;this._ContentsParent.appendChild(b);return b};this.RemoveCurrentTab=function(){this.RemoveTab(this._CurId)};this.RemoveTab=function(a){for(var b=9999999999999,d,e=this._ContentsParent.getElementsByTagName("iframe"),f=null,g=0;g<e.length;g++){var h=e[g];h.id!=this._IdFrameTag+a?b>1*h.getAttribute("ewa_tab_show_seq")&&
(b=1*h.getAttribute("ewa_tab_show_seq"),d=h.id):f=h}this._ContentsParent.removeChild(f);a=this._TabsParent.ownerDocument.getElementById(this._IdTabTag+a);this._TabsParent.removeChild(a);null!=d&&(d=d.split("_"),d=d[d.length-1],null!=this._ContentsParent.ownerDocument.getElementById(this._IdTabTag+d)&&this.ShowTab(d))};this._CheckExist=function(a){for(var b=this._TabsParent.childNodes,d=0;d<b.length;d++){var e=b[d];if(e.getAttribute("ewa_tab_url")==a)return a=e.id.split("_"),a[a.length-1]}return null};
this.ShowTab=function(a){this._CurId=a;var b=this._ContentsParent.getElementsByTagName("iframe");this.CurrentWindow=null;for(var d,e,f,g,h=0;h<b.length;h++){var k=b[h],m=k.id.split("_");m=k.ownerDocument.getElementById(this._IdTabTag+m[m.length-1]);k.id==this._IdFrameTag+a?(this.CurrentWindow=k.contentWindow,d=m,e=k):("none"!=k.style.display&&(f=m,g=k),m=1*k.getAttribute("ewa_tab_show_seq")+1,k.setAttribute("ewa_tab_show_seq",m))}this.showTabBeforeCallback&&this.showTabBeforeCallback(d,e,f,g)?console.log("showTabBeforeCallback return stop next"):
(d.className="ewa_tab_act",d.setAttribute("ewa_tab_act",1),e.setAttribute("ewa_tab_show_seq",0),e.style.display="",e.style.zIndex=1,(a=e.getAttribute("s_top"))&&k.contentWindow.document.scrollingElement&&(k.contentWindow.document.scrollingElement.scrollTop=1*a),g&&(f.className="ewa_tab_dact",f.setAttribute("ewa_tab_act",0),g.style.display="none",g.style.zIndex=0,k.contentWindow.document.scrollingElement&&(a=k.contentWindow.document.scrollingElement.scrollTop,g.setAttribute("s_top",a))),this.showTabAfterCallback&&
this.showTabCallback(d,e,f,g))};this.Init=function(a,c){if(!EWA.B.IE)try{a.style.MozUserFocus="ignore",a.style.MozUserInput="disabled",a.style.MozUserSelect="none"}catch(e){}var b=a.ownerDocument.createElement("table");b.style.width="100%";b.style.height="100%";b.onselectstart=function(){return!1};b.cellSpacing=0;b.cellPadding=0;b.insertRow(-1).insertCell(-1).vAlign="bottom";b.className="ewa_tab";a.appendChild(b);this._ContentsParent=c;this._TabsParent=b.rows[0].cells[0];b=null}}
function EWA_UI_DialogClass(){this.zIndex=999;this.Id=null;this.Height=this.Width="200px";this.Top=this.Left="-1000px";this.Offset="5";this.ShadowColor="#777777";this.IsShowTitle=!1;this.IsCanMove=!0;this.AutoSize=this.IsCover=!1;this.DisposeOnClose=!0;this._WindowIndex=this._CreateWindowIndex=this.CreateWindow=this.FrameTitle=this.FrameContent=this.Frame=null;this.GetFrame=function(){return this.GetObject(this.Frame)};this.GetFrameContent=function(){return this.GetObject(this.FrameContent)};this.GetFrameTitle=
function(){return this.GetObject(this.FrameTitle)};this.GetObject=function(a){return null==a?null:this.CreateWindow.$X(a)};this.SetHtml=function(a){this.GetFrameContent().innerHTML=a};this.SetObject=function(a){this.GetFrameContent().appendChild(a)};this.SetTitle=function(a){null!=this.GetFrameTitle()&&(this.GetFrameTitle().innerHTML=a)};this.ScrollMoveDiv=function(){var a=this.GetFrame();if(null!=a){var b=a.ownerDocument,c=b.body.scrollLeft;b=b.body.scrollTop;var d=1*a.getAttribute("_SCROLL_X"),
e=1*a.getAttribute("_SCROLL_Y");a.style.left=c-d+$X(this.Frame).offsetLeft+"px";a.style.top=b-e+$X(this.Frame).offsetTop+"px";a.setAttribute("_SCROLL_X",c);a.setAttribute("_SCROLL_Y",b)}};this.MoveBottom=function(a){var b=$(a).offset();b.Y=b.top+$(a).height();b.X=b.left;var c=a.ownerDocument,d=c.parentWindow?c.parentWindow:c.defaultView;if(d==this.CreateWindow){var e=document.body.clientWidth;c=document.body.clientHeight;var f=b.X;d=b.Y;var g=1*(this.Height+"").replace("px",""),h=1*(this.Width+"").replace("px",
"");b.Y+a.clientHeight+g>c&&(d=b.Y-a.clientHeight-g);b.X+h>e&&(f=e-h-a.clientWidth);EWA.B.PAD&&(f=0);this.Move(f,d+4)}else f=d._EWA_DialogWnd._Dialog.GetFrame(),e=f.offsetLeft,c=f.offsetTop,g=this.GetFrame(),g.setAttribute("_SCROLL_X",f.getAttribute("_SCROLL_X")),g.setAttribute("_SCROLL_Y",f.getAttribute("_SCROLL_Y")),a=$(a).height(),f=b.X+e,EWA.B.PAD&&(f=0),e=d._EWA_DialogWnd._Dialog.GetFrameTitle().clientHeight,this.Move(f,b.Y+c+a+e)};this.Move=function(a,b){var c=this.GetFrame();null!=c&&EWA.UI.Utils.MoveTo(c,
a,0>b?0:b)};this.MoveCenter=function(){var a=this.GetFrame(),b=a.clientWidth,c=a.clientHeight,d=EWA.UI.Utils.GetDocSize(this.CreateWindow);c=(d.H-c)/2-40;b=(d.W-b)/2;0>b&&(b=0);0>c&&(c=0);var e=d.SH;d=d.SW;a.setAttribute("_SCROLL_X",d);a.setAttribute("_SCROLL_Y",e);this.Move(b+d,c+e)};this.ResizeByContent=function(){var a=this.GetFrame(),b=this.GetFrameContent().childNodes[0];if("IFRAME"==b.tagName){var c=b.contentWindow;c&&c.document&&c.document.body&&(c=c.document.getElementById("Test1"))&&(b=c)}c=
this.GetFrameContent().parentNode.parentNode.parentNode;var d=1*$(c).css("border-left-width").replace("px","")+1*$(c).css("border-right-width").replace("px","");var e=1*$(c).css("border-top-width").replace("px","")+1*$(c).css("border-bottom-width").replace("px","");this._calc_frame_table=d;c=$(b).width();c+=d;b=$(b).height()+e;d=1*a.style.left.replace("px","");a=1*a.style.top.replace("px","");c+d>this.CreateWindow.document.body.clientWidth&&this.Move(this.CreateWindow.document.body.clientWidth-c-
20,a);this.Resize(c,b,!0)};this.Resize=function(a,b,c){if(this.IsShowTitle){var d=this.GetFrameTitle();b+=$(d).parent().height()}var e=d=0;c||(c=this.GetFrameContent().parentNode.parentNode.parentNode,this._calc_frame_table=d=1*$(c).css("border-left-width").replace("px","")+1*$(c).css("border-right-width").replace("px",""),e=1*$(c).css("border-top-width").replace("px","")+1*$(c).css("border-bottom-width").replace("px",""));a+=d;b+=e;c=this.GetFrame();c.style.width=a+"px";c.style.height=b+"px";for(d=
0;d<c.childNodes.length;d+=1)e=c.childNodes[d],e.style.width=a+"px",e.style.height=b+"px",0<e.id.indexOf("divContent")&&(e.style.overflow="hidden");this.GetFrameContent();a=this.GetObject(this._DivCover);$(a).css("background-image","none");$(a).attr("background-image","none")};this.Show=function(a){var b=this.GetFrame();a?(b.style.display="",this.IsShowTitle&&this.AutoSize&&(_EWA_DIALOG_ON_TIMER=this,this.TimerHandle=window.setInterval(function(){var a=_EWA_DIALOG_ON_TIMER;window.clearInterval(a.TimerHandle);
var b=a.GetFrame(),e=a.GetFrameContent(),f=e.childNodes[0].offsetWidth,g=a.GetObject(a._FrameFore).offsetHeight;b.style.width=f+"px";b.style.height=g+"px";a.GetObject(a._FrameBack1)&&(a.GetObject(a._FrameBack1).style.width=f+"px",a.GetObject(a._FrameBack1).style.height=g+"px");a.GetObject(a._FrameBack2)&&(a.GetObject(a._FrameBack2).style.width=f+"px",a.GetObject(a._FrameBack2).style.height=g+3+"px");if(a=e.childNodes[0])a.style.width=f-2+"px",a.style.height=g-2+"px";a=_EWA_DIALOG_ON_TIMER=null;f=
a.GetObject(this._DivCover);$(f).css("background-image","none");$(f).attr("background-image","none")},32))):b.style.display="none";b=oCover=null};this.Dispose=function(){this.CreateWindow&&(this.CreateWindow._EWA_DIALOGS[this._CreateWindowIndex]=null,_EWA_DIALOGS[this._WindowIndex]=null,null!=this._DivCover&&(EWA$UI$COMMON.Drop(this.GetObject(this._DivCover)),this._DivCover=null),this.GetObject(this.Frame).innerHTML="",EWA$UI$COMMON.Drop(this.GetObject(this.Frame)),this.CreateWindow=null,EWA.B.IE&&
CollectGarbage())};this.SetZIndex=function(a){this.CreateWindow._EWA_UI_DIALOG_COVERINDEX+=a;this.zIndex=this.CreateWindow._EWA_UI_DIALOG_COVERINDEX;this.GetObject(this.Frame).style.zIndex=this.zIndex};this.CreateId=function(){var a=Math.random();return(new Date).getTime()+"_"+a};this.Create=function(){null==this.CreateWindow&&(this.CreateWindow=window);this.IsCover&&this._CreateCover();var a=this.CreateId(),b=this.CreateWindow;null==b._EWA_UI_DIALOG_COVERINDEX&&(b._EWA_UI_DIALOG_COVERINDEX=0);b._EWA_UI_DIALOG_COVERINDEX+=
1;this.zIndex=b._EWA_UI_DIALOG_COVERINDEX;var c=EWA$UI$COMMON.CreateObject(b,"div","display:none; "+(window.EWA_UI_DIALOG_FIXED?"position:fixed":"position:absolute")+"; width:"+this.Width+"; height:"+this.Height+"; z-index:"+this.zIndex+"; left:"+this.Left+"; top:"+this.Top+";",b.document.body);c.setAttribute("EWA_NAME","DIV_FRAME");c.className="ewa-dialog";c.id=a+"divFrame";this.Frame=c.id;var d=EWA$UI$COMMON.CreateObject(b,"div","position: absolute; width: 100%; height: 100%; left: 0px; top: 0px;",
c);d.setAttribute("EWA_NAME","DIV_BACK1");d.id=a+"divBack1";this._FrameBack1=d.id;if(null!=this.ShadowColor&&""!=this.ShadowColor){var e=EWA$UI$COMMON.CreateObject(b,"div","position: absolute; background-color:"+this.ShadowColor+"; width:100%; height:100%; left:"+this.Offset+"px; top: "+(1*this.Offset+2)+"px;",c);e.style.filter="alpha(opacity=50)";e.style.opacity=.5;e.id=a+"divBack2";this._FrameBack2=e.id}EWA.B.IE&&(d.innerHTML="<iframe src='javascript:false' style=\"position:absolute;top:0px;left:0px;width:100%; height:100%; z-index:-1; filter='progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)';\"></iframe>",
null!=this.ShadowColor&&""!=this.ShadowColor&&(e.innerHTML="<iframe src='javascript:false' style=\"position:absolute;top:0px;left:0px;width:100%; height:100%; z-index:-1; filter='progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)';\"></iframe>"));c.setAttribute("_SCROLL_X",0);c.setAttribute("_SCROLL_Y",0);this._CreateContent();$(c).append("<i style='z-index:"+this.zIndex+"0' onclick='this.parentNode.style.display=\"none\"' class='ewa-dialog-close'></i>");this.CreateWindow._EWA_DIALOGS||(this.CreateWindow._EWA_DIALOGS=
[],addEvent(this.CreateWindow,"scroll",EWA.UI.DialogOnScroll));window._EWA_DIALOGS||(_EWA_DIALOGS=[],addEvent(window,"scroll",EWA.UI.DialogOnScroll));this._CreateWindowIndex=this.CreateWindow._EWA_DIALOGS.length;this.CreateWindow._EWA_DIALOGS[this._CreateWindowIndex]=this;this._WindowIndex=_EWA_DIALOGS.length;_EWA_DIALOGS[this._WindowIndex]=this};this._CreateContent=function(){var a=this.CreateId(),b=EWA$UI$COMMON.CreateObject(null==this.CreateWindow?window:this.CreateWindow,"div","position: absolute; width: 100%; height: 100%; z-index: 2; left: 0px; top: 0px;  background-color:white",
this.GetFrame());b.setAttribute("EWA_NAME","CONTENT");b.className="EWA_POP_MAIN";b.id=a+"divContent";if(this.IsShowTitle){var c=" EWA_WND_ID='"+this.Id+"'",d="this.ownerDocument.parentWindow";EWA.B.IE||(d="this.ownerDocument.defaultView");if(this.IsCanMove){var e=d+"._EWA_UI_WINDOW_LIST[this.getAttribute('EWA_WND_ID')]._OpenerWindow.EWA$UI$COMMON$Move.";c=c+(' onmousedown="'+e+'OnMouseDown(this.parentNode.parentNode,event,true,true);" onmousemove="')+(e+'OnMouseMove(this.parentNode.parentNode,event,true,true);" onmouseup="')+
(e+'OnMouseUp(this.parentNode.parentNode);" onmouseout="try{')+(e+"OnMouseOut(this.parentNode.parentNode);}catch(e){}\" style='cursor:pointer' ")}e="<img src='"+(null==EWA.RV_STATIC_PATH?"/EmpScriptV2":EWA.RV_STATIC_PATH)+"/EWA_STYLE/images/dialog/but_1.gif' style='cursor:pointer'  onmouseover=\"var m=this.src.lastIndexOf('.');var s = this.src.substring(0, m);if(s.substring(s.length - 1).toUpperCase() == 'C'){return;}s+='c'+this.src.substring(m);this.src = s;\"";if(this.DisposeOnClose){var f=' ondblclick="'+
d+"._EWA_UI_WINDOW_LIST['"+this.Id+"'].CloseWindow();\"";d=' onclick="'+d+"._EWA_UI_WINDOW_LIST['"+this.Id+"'].CloseWindow();\""}else f=' ondblclick="'+d+"._EWA_UI_WINDOW_LIST['"+this.Id+"']._Dialog.Show(false);\"",d=' onclick="'+d+"._EWA_UI_WINDOW_LIST['"+this.Id+"']._Dialog.Show(false);\"";c="<table unselectable='on' onselectstart='return false;' style='cursor:pointer;margin-bottom:1px;width:100%;height:100%;-moz-user-select:none;' cellpadding='0' cellspacing='0' "+c+"><tr><td "+(f+" class='EWA_POP_TITLE_L'>...</td><td class='EWA_POP_TITLE_R' align=\"right\">")+
(e+" onmouseout =\"var m=this.src.lastIndexOf('.');var s = this.src.substring(0, m - 1);s = s + this.src.substring(m);this.src = s;\""+(d+" /></td></tr><tr><td class='EWA_POP_CNT' colspan=\"2\" valign=top></td></tr></table>"));b.innerHTML=c;c=a+"FrameContent";this.FrameContent=b.childNodes[0].rows[1].cells[0].id=c;a+="FrameTitle";this.FrameTitle=b.childNodes[0].rows[0].cells[0].id=a;this._FrameFore=b.id}else this.FrameContent=b.id};this._CreateCover=function(){var a=this.CreateWindow;null==a._EWA_UI_DIALOG_COVERINDEX&&
(a._EWA_UI_DIALOG_COVERINDEX=1E7);a._EWA_UI_DIALOG_COVERINDEX+=1;var b=a.document.createElement("div");b.style.cssText="display:block; width:100%; height:100%; ";b.setAttribute("style","display:block; width:100%; height:100%; ");b.style.zIndex=a._EWA_UI_DIALOG_COVERINDEX;b.className="ewa-ui-dialog-cover";b.id=this.CreateId()+"_DivCover";this._DivCover=b.id;a.document.body.appendChild(b)}}
function EWA_UI_PopWindowClass(a,b){this._DivCover=null;this._Dialog=new EWA_UI_DialogClass;this._Dialog.DisposeOnClose=b;this.OpendDialogs=[];this.ClassName=this._Name=this.Id=null;this._Url="about:blank";this._ParentWindow=a;this._OpenerWindow=window;this.OpendObject=EWA.B.IE?window.event?window.event.srcElement:null:null;this._CallBack=null;this.SetCallBack=function(a){this._CallBack=a};this._ReturnBack=null;this.SetReturnBack=function(a){this._ReturnBack=a};this.GetReturnBack=function(){return this._ReturnBack};
this.Show=function(a){this._Dialog.Show(a)};this.Hidden=function(){this._Dialog.Show(!1)};this.CloseWindow=function(){for(var a=0;a<this.OpendDialogs.length;a+=1)this.OpendDialogs[a].Dispose(),this.OpendDialogs[a]=null;this._Dialog.Dispose();if(this._OpenerWindow)try{this._OpenerWindow.document.body.focus(),this.OpendObject&&this.OpendObject.focus()}catch(d){}this.Dispose()};this.Dispose=function(){if(null!=this._CallBack)try{this._CallBack.Dispose()}catch(d){}if(null!=this._ReturnBack)try{this._ReturnBack.Dispose()}catch(d){}try{var a=
this.GetIframeWindow();a&&(a._EWA_DialogWnd=null)}catch(d){}if(this._OpenerWindow)try{this._OpenerWindow.EWA.UI.Dialog.WND[this.Id]=null,this._ParentWindow._EWA_UI_WINDOW_LIST[this.Id]=null}catch(d){}try{this._Dialog.Dispose(),this._ReturnBack=this._CallBack=this.OpendObject=this._OpenerWindow=this._ParentWindow=this._Dialog=null}catch(d){}EWA.B.IE&&CollectGarbage()};this.SetNewSize=function(a,b){this._Dialog.Resize(a,b)};this.Move=function(a,b){this._Dialog.Move(a,b)};this.MoveCenter=function(){this._Dialog.MoveCenter()};
this.GetIframeWindow=function(){if(null!=this._ParentWindow){var a="__EMP_COMMON_IFRAME"+this._Name;if(EWA.B.IE)var b=this._ParentWindow.frames[a];else for(var e=0;e<this._ParentWindow.frames.length;e+=1)if(this._ParentWindow.frames[e].name==a){b=this._ParentWindow.frames[e];break}return b}};this.SetCaption=function(a){this._Dialog.SetTitle(a)};this.SetUrl=function(a){"about:blank"!=a&&(this.GetIframeWindow().location=a)};this.Create=function(a,b,e){this._Name=e;this._CreateDialog(a,b);null==this._ParentWindow._EWA_UI_WINDOW_LIST&&
(this._ParentWindow._EWA_UI_WINDOW_LIST={});this._ParentWindow._EWA_UI_WINDOW_LIST[this.Id]=this};this._CreateDialog=function(a,b){this._Dialog.Id=this.Id;this._Dialog.Width=a;this._Dialog.Height=b;this._Dialog.CreateWindow=this._ParentWindow;this._Dialog.IsShowTitle=!0;this._Dialog.IsCanMove=!0;this._Dialog.IsCover=!0;this._Dialog.Create();this._Dialog.Show(!0);this.SetHtml("<iframe style='width:100%;height:100%;' name='__EMP_COMMON_IFRAME"+this._Name+'\' frameborder=0 src="about:blank"></iframe>')};
this.SetHtml=function(a){this._Dialog.SetHtml(a)};this.ResizeByContent=function(){this._Dialog.ResizeByContent()}}EWA.UI.DialogOnScroll=function(){if(!window.EWA_UI_DIALOG_FIXED&&"undefined"!=typeof _EWA_DIALOGS)for(var a=0;a<_EWA_DIALOGS.length;a+=1)if(null!=_EWA_DIALOGS[a])try{_EWA_DIALOGS[a].ScrollMoveDiv()}catch(b){_EWA_DIALOGS[a]=null}};
function EWA_Command(){this.CmdWindow=window;this.Cmd=null;this.CmdArgus=[];this.IsRunAuto=!1;this.Run=function(){if("function"==(typeof this.Cmd).toLowerCase())this.Cmd(this.CmdArgus);else{var a=this.CmdWindow.eval(this.Cmd);null==a?alert("EWA_Command.Cmd undefined! Pls check call method"):a(this.CmdArgus)}};this.Dispose=function(){for(var a=0;a<this.CmdArgus.length;a++)this.CmdArgus[a]=null;this.CmdArgus.length=0;this.Cmd=this.CmdWindow=this.CmdArgus=null}}
var __Dialog={D:EWA_UI_DialogClass,C:EWA_UI_PopWindowClass,WND:{},WNDCUR:null,CMD:EWA_Command,Pop:function(a,b,c){b=new EWA_UI_PopWindowClass(window,!0);"undefined"!=typeof _EWA_DialogWnd&&(b.CreateWindow=_EWA_DialogWnd._ParentWindow);b.Width=172;b.Height=200;b.ShadowColor="";__Cal.WND=new EWA_CalendarClass;"undefined"==typeof _EWA_DialogWnd?b.CreateWindow=window:(b.CreateWindow=_EWA_DialogWnd._ParentWindow,_EWA_DialogWnd.OpendDialogs[_EWA_DialogWnd.OpendDialogs.length]=b);b.Create();b.SetHtml(a);
b.MoveCenter();b.Show(!0);return b},_GetTopWindow:function(){for(var a=window;a.parent!=a;)a=a.parent;return 0<=a.document.documentElement.innerHTML.toUpperCase().indexOf("<FRAMESET")?window:a},_DialogMointer:function(){var a=EWA.UI.Dialog.WNDCUR;__Dialog.TimerInc++;if(!(null==a&&100<__Dialog.TimerInc)&&null!=a){var b=a.GetIframeWindow();null==b?(window.clearInterval(a._TimerHandle),EWA.UI.Dialog.WNDCUR=null):b.location.href!=a._Url&&(b.document.readyState?"complete"==b.document.readyState&&(window.clearInterval(a._TimerHandle),
EWA.UI.Dialog._SetTitle(a)):null!=b.document.body&&(b=b.document.documentElement.innerHTML,b=b.toLowerCase(),0<b.indexOf("</body>")||0<b.indexOf("</html>"))&&(0==a._IncNoIe?a._IncNoIe=1:EWA.UI.Dialog._SetTitle(a)))}},_SetTitle:function(a){if(null!=a){var b=a.GetIframeWindow();b._EWA_DialogWnd=a;a._Url=b.location.href;a.SetCaption(b.document.title);b.document.getElementsByTagName("INPUT");b.document.body.onunload=function(){try{this._EWA_DialogWnd._Url=""}catch(d){}};var c=__Dialog._SetInputFocus(b.document);
c||__Dialog._SetTextAreaFocus(b.document);c||b.document.body.focus();__Dialog._SetClose(b.document);b.document.body.style.margin="0px";b.document.body.style.overflow="hidden";a._Dialog.ResizeByContent();a.MoveCenter();null!=a._CallBack&&a._CallBack.Run();b=null}},_SetClose:function(a){for(var b=a.getElementsByTagName("INPUT"),c=0;c<b.length;c+=1){var d=b[c].type.toLowerCase();"button"!=d&&"submit"!=d||__Dialog._SetCloseFunction(b[c])}b=a.getElementsByTagName("BUTTON");for(c=0;c<b.length;c++)__Dialog._SetCloseFunction(b[c])},
_SetCloseFunction:function(a){var b=a.value.trim().toLowerCase();"button"==a.tagName.toLowerCase()&&(b=a.innerHTML);!(0<=b.indexOf("\u5173\u95ed")||0<=b.indexOf("\u53d6\u6d88")||0<=b.indexOf("close")||0<=b.indexOf("cancel"))||null!=a.onclick&&0<=a.onclick.toString().indexOf("EWA")||(a.onclick=function(){var a=this.ownerDocument;(a.parentWindow?a.parentWindow:a.defaultView)._EWA_DialogWnd.CloseWindow()})},_SetInputFocus:function(a){a=a.getElementsByTagName("INPUT");for(var b=0;b<a.length;b+=1){var c=
a[b],d=c.type.toLowerCase();if("text"==d||"password"==d)if(d=c.parentNode.innerHTML,!(null!=d&&0<=d.toString().indexOf("EWA.F.I.Date")))try{return c.focus(),a=null,!0}catch(e){}}return!1},_SetTextAreaFocus:function(a){a=a.getElementsByTagName("TEXTAREA");for(var b=0;b<a.length;b+=1)try{return a[b].focus(),a=null,!0}catch(c){}return!1},OpenReloadClose:function(a,b,c,d,e,f,g){EWA.UI.Dialog.OpenFrame(a,b,c,d,e,"RELOAD_PARENT,CLOSE_SELF",f,g)},OpenReload:function(a,b,c,d,e,f,g){EWA.UI.Dialog.OpenFrame(a,
b,c,d,e,"RELOAD_PARENT",f,g)},OpenReloadClear:function(a,b,c,d,e,f,g){EWA.UI.Dialog.OpenFrame(a,b,c,d,e,"RELOAD_PARENT,CLEAR_SELF",f,g)},OpenFrame:function(a,b,c,d,e,f,g,h){null==f&&(f="");__Dialog[a]||(__Dialog[a]={});__Dialog[a].AfterMsg=null==g?"":g;if("yes"==h&&EWA.F&&EWA.F.FOS[a]&&EWA.F.FOS[a].Url){h=new EWA_UrlClass(EWA.F.FOS[a].Url);h.RemoveEwa();e=new EWA_UrlClass("a1?"+e);for(var k in e._Paras)g=e.GetParameter(k),h.AddParameter(k,g);e=h.GetParas()}f="EWA_P_BEHAVIOR="+f+"&EWA_PARENT_FRAME="+
a;a=EWA.UI.Dialog.GetUrl(b,c,e?e+"&"+f:f);EWA.UI.Dialog.OpenWindow(a,b+"-"+c,100,50,d)},OpenWindow:function(a,b,c,d,e,f,g,h){var k=void 0===h?!0:h;var m=e?window:EWA.UI.Dialog._GetTopWindow();e=a;null!=e&&"about:blank"!=e&&(e=0<a.indexOf("?")?e+("&_r="+Math.random()):e+("?_r="+Math.random()));e=e.replace(/\|/ig,"%7c");a="_EWA_UI_DIALOG_"+b;EWA.UI.Dialog.WND[a]=null;EWA.UI.Dialog.WND[a]=new EWA.UI.Dialog.C(m,k);k=EWA.UI.Dialog.WND[a];k.Id=a;k.DisposeOnClose=h;k.Create(c,d,b);null!=e&&k.SetUrl(e);null!=
f&&k.SetCallBack(f);null!=g&&k.SetReturnBack(g);__Dialog.TimerInc=0;k._TimerHandle=window.setInterval(EWA.UI.Dialog._DialogMointer,155);k._IncNoIe=0;EWA.UI.Dialog.WNDCUR=k;return EWA.UI.Dialog.WND[a]},GetUrl:function(a,b,c){return EWA.CP+"/EWA_STYLE/cgi-bin/?XMLNAME="+a.toURL()+"&ITEMNAME="+b.toURL()+"&"+c}};
EWA.OW={Dia:null,PWin:null,Frame:null,Close:function(){EWA.OW.Dia?EWA.OW.Dia.CloseWindow():alert("Dialog not Load")},Load:function(){EWA.OW.Dia=window._EWA_DialogWnd;EWA.OW.PWin=EWA.OW.Dia?EWA.OW.Dia._OpenerWindow:null;EWA.OW.Frame=EWA.OW.PWin?EWA.OW.PWin.EWA.F.FOS[EWA.OW.PWin.EWA.F.CID]:null}};EWA.UI.Dialog=__Dialog;
function EWA_UI_DiaNewClass(){this.Id=null;this.IS_AUTO_SIZE=!0;this._GetIndex=function(){var a=window;null==a._EWA_UI_DIALOG_COVERINDEX&&(a._EWA_UI_DIALOG_COVERINDEX=1E7);a._EWA_UI_DIALOG_COVERINDEX++;return a._EWA_UI_DIALOG_COVERINDEX};this._GetCover=function(){return $X(this.Id+"_cover")};this.Create=function(a,b,c,d,e,f,g){this._isUrl=e;this._width=a;this._height=b;this._title=c;this._content=d;this._noHeader=f;var h=this._GetIndex();this.index=h;this.Id=("_EWA_UI_DIA_"+Math.random()).replace(".",
"");var k=["<div id='"+this.Id+"' class='ewa-ui-dialog'>"];k.push("<div id='"+this.Id+"_cover'  class='ewa-ui-dialog-cover' style='position: fixed;z-index: "+h+";'></div>");h=" EWA_WND_ID='"+this.Id+"'";h+=' onmousedown="window.EWA$UI$COMMON$Move.OnMouseDown(this.parentNode.parentNode,event,true,true);" onmousemove="window.EWA$UI$COMMON$Move.OnMouseMove(this.parentNode.parentNode,event,true,true);" onmouseup="window.EWA$UI$COMMON$Move.OnMouseUp(this.parentNode.parentNode);" onmouseout="window.EWA$UI$COMMON$Move.OnMouseOut(this.parentNode.parentNode);"';
k.push("<div id='"+this.Id+"_box'  class='ewa-ui-dialog-box'  style='position: fixed;z-index: "+this._GetIndex()+";'>");k.push("<div style='position:relative;'>");f?k.push("<div id='"+this.Id+"_title' class='ewa-ui-dialog-title-noheader' style=''><a href='javascript:class_"+this.Id+".Close();' class='fa' style='text-decoration:none;padding:2px 2px 3px 3px;display:block'>&#xf00d</a></div>"):k.push("<div  id='"+this.Id+"_title'  class='ewa-ui-dialog-title'"+h+" style=''><span style='margin-left: 5px;'></span><a href='javascript:class_"+
this.Id+".Close();' class='fa' style=''>&#xf00d</a></div>");k.push("<div  id='"+this.Id+"_content' class='ewa-ui-dialog-content' style='width: 100%;overflow: auto;'></div>");k.push("</div>");k.push("</div>");k.push("</div>");$("body").append(k.join(""));$(".ewa-ui-dialog-title a.fa").css({color:"#aaa"}).hover(function(){$(this).css({color:"orangered"})},function(){$(this).css({color:"#aaa"})});$("#"+this.Id+"_box");this.SetSize(a,b);this.SetTitle(c);this.ShowCover(!0);this.MoveCenter();window["class_"+
this.Id]=this;this.SetContent(d,e,g);return this};this.SetSize=function(a,b){var c=$("#"+this.Id+"_content");b=b?b:200;c.css("width",a?a:400);c.css("height",b);0<$("#"+this.Id+"_title span").length&&$("#"+this.Id+"_title").height()};this.SetTitle=function(a){a&&$("#"+this.Id+"_title span").html(a)};this.getTitleContainer=function(){var a=$("#"+this.Id+"_title");return 0==a.length?null:a[0]};this.SetContent=function(a,b,c){var d=$("#"+this.Id+"_content");b?(a='<iframe style="width:100%;height:100%" frameborder="0" src="'+
a+'"></iframe>',d.css("overflow","hidden")):$(this._GetCover()).css("background-image","none");d.html(a);if(b){var e=this;setTimeout(function(){e._ChkIframeLoaded(c)},222)}else c&&c(this)};this.SetObject=function(a,b){var c=$("#"+this.Id+"_content");$(this._GetCover()).css("background-image","none");b||c.html("");c.append(a)};this._ChkIframeLoaded=function(a){var b=$("#"+this.Id+"_content iframe");if(0!=b.length){b=b[0];try{if(b.contentWindow&&b.contentWindow.document&&"complete"==b.contentWindow.document.readyState&&
b.contentWindow.$)try{this._IframeLoaded(b.contentWindow,a)}catch(d){this._IframeLoaded(b.contentWindow,a)}else{var c=this;setTimeout(function(){c._ChkIframeLoaded(a)},222)}}catch(d){console.log(d)}}};this._IframeLoaded=function(a,b){a._EWA_DialogWnd=this;this.SetTitle(a.document.title);new EWA_UrlClass(a.location.href);this.IS_AUTO_SIZE&&this.AutoSize();this.MoveCenter();var c=this;a=a.$.find("button,input");for(var d=0;d<a.length;d++){var e=a[d],f=!1;if(e.id&&0<=e.id.toLowerCase().indexOf("close"))f=
!0;else{var g=e.value||e.innerHTML;g&&(0<=g.indexOf("\u5173\u95ed")||0<=g.indexOf("\u53d6\u6d88"))&&(f=!0)}f&&(e.onclick=function(){c.Close()})}$(this._GetCover()).css("background-image","none");b&&b(this)};this.AutoSize=function(){var a=$(this.getContent());if(this._isUrl){if(a=a.find("iframe"),a=a[0].contentWindow,a.$){var b=a.$("#Test1");0<b.length&&(a=b.outerWidth(),b=b.outerHeight(),this.SetSize(a,b),this.MoveCenter())}}else b=a.find("#Test1"),0<b.length?(a=b.outerWidth(),b=b.outerHeight()):
(b=cnt[0].scrollHeight,a=cnt[0].scrollWidth),this.SetSize(a,b),this.MoveCenter()};this.getContent=function(){return $("#"+this.Id+"_content")[0]};this.getMain=function(){return $("#"+this.Id+"_box")[0]};this.ShowCover=function(a){var b=$("#"+this.Id+"_cover");if(a){a=$(window).width();var c=$(window).height();b.css("width",a);b.css("height",c);b.show()}else b.hide()};this.MoveCenter=function(){var a=$(window).width(),b=$(window).height(),c=$("#"+this.Id+"_box"),d=c.width();c=c.height();a=(a-d)/2;
b=(b-c)/2;0>a&&(a=0);0>b&&(b=0);this.Move(a,b)};this.Move=function(a,b){var c=$("#"+this.Id+"_box");c.css("top",b);c.css("left",a)};this.Close=function(){this.IsCloseAsHidden?$("#"+this.Id).hide():this.Dispose()};this.Dispose=function(){$("#"+this.Id).remove();window["class_"+this.Id]=null;delete window["class_"+this.Id]};this.Show=function(){this.IsCloseAsHidden?$("#"+this.Id).show():alert("\u8bf7\u8bbe\u7f6e\u53c2\u6570 IsCloseAsHidden=true")}}
$Dialog=function(a,b,c,d,e,f){var g=!(c&&d),h=new EWA_UI_DiaNewClass;h.IS_AUTO_SIZE=g;h.Create(c,d,b,a,!0,e,f);h.MoveCenter();return h};$DialogHtml=function(a,b,c,d,e,f){var g=new EWA_UI_DiaNewClass;g.Create(c,d,b,a,!1,e);g.MoveCenter();f&&f(g,id);return g};
$DialogInstall=function(a,b,c,d,e,f){var g=EWA_Utils.tempId("dialogInstall"),h=$DialogHtml("<div id='"+g+"'></div>","",c,d,e);$Install(a,g,function(){var a=!(c&&d);if(e||b)a&&h.AutoSize(),f&&f(h,n);else{var g=h.getContent(),l=$(g).find(".EWA_TABLE");if(0!=l.length&&l[0].id){var n=l[0].id;l=n.replace("EWA_FRAME_","").replace("EWA_LF_","");if(EWA&&EWA.F&&EWA.F.FOS&&EWA.F.FOS[l])if(l=EWA.F.FOS[l].Title,n.startsWith("EWA_LF_"))var q=0,p=setInterval(function(){q++;if(90<q)window.clearInterval(p),a&&h.AutoSize(),
f&&f(h,n);else{var b=$(g).find(".ewa_lf_func");if(0!=b.length){window.clearInterval(p);var c=h.getTitleContainer();if(c){b.css({"background-color":"transparent",display:"block","float":"left","font-size":"14px"});var d=b.find(".ewa_lf_func_caption");d.css("color","#08c");d.text(d.text().replace("[","").replace("]","").trim());$(c).find("span:eq(0)").remove();$(c).append(b).css("border-bottom","1px solid #eee")}a&&h.AutoSize();f&&f(h,n)}}},10);else l&&h.SetTitle(l),a&&h.AutoSize(),f&&f(h,n);else a&&
h.AutoSize(),f&&f(h,n)}else a&&h.AutoSize(),f&&f(h,n)}});return h};
function EWA_UI_CalendarYearClass(){this.Create=function(a,b,c,d,e){console.log(b,c,d);this.classId=("CY"+Math.random()).replace(".","");EWA.UI.CalendarYear=EWA.UI.CalendarYear||{};EWA.UI.CalendarYear[this.classId]=this;$($X(a)).append('<div class="ewa-ui-calendar-year" id="'+this.classId+'"></div>');a=$("#"+this.classId);var f=new EWA_CalendarClass,g=new Date;b&&c&&(g=new Date(b,c-1,1));b=c=g.getMonth();e||(b=3*Math.round(c/3-.5));e=g.getFullYear();if(!d||0>=d)d=12;for(g=1;g<=d;g++){if("enus"==EWA.LANG){var h=
b+1+"/"+e;f.SetDate("dd/MM/yyyy"==_EWA_G_SETTINGS.DATE?"01/"+(b+1)+"/"+e:b+1+"/01/"+e)}else h=e+"-"+(b+1),f.SetDate(h+"-01");c=f.CreateCalendar();var k=this.classId+"_"+e+"_"+b;c.id=k;c.setAttribute("yearmonth",e+(10>b?"0":"")+b);a.append(c);$(c.rows[3]).remove();$(c.rows[0].cells[1]).remove();h="<a href='javascript:EWA.UI.CalendarYear."+this.classId+'.chooeseMonth("'+k+"\",event)'>"+h+"</a>";$(c.rows[0].cells[0]).html(h);$(c).find("th").attr("onclick","EWA.UI.CalendarYear."+this.classId+".chooeseWeek('"+
k+"',this, event)");b++;12==b&&(b=0,e++);$(c).find("th:eq(0)").addClass("rq-sun");$(c).find("th:eq(6)").addClass("rq-sat")}a.append('<div style="clear:both"></div>');a.find(".ewa-ui-days td").attr("onclick","EWA.UI.CalendarYear."+this.classId+".Click(this,event)");_EWA_CALENDAR_ITEM=f};this.chooeseWeek=function(a,b,c){var d=b.cellIndex;a=$("#"+a).find(".ewa-ui-days")[0];for(var e=$(b).attr("chooese"),f=[],g=1;g<a.rows.length;g++){var h=a.rows[g].cells[d];0!=h.childNodes.length&&(e?$(h).removeClass("ewa-ui-calendar-year-chooese").attr("chooese",
null):$(h).addClass("ewa-ui-calendar-year-chooese").attr("chooese",1),f.push($(h).find("div:eq(0)").attr("title")))}e?$(b).attr("chooese",null):$(b).attr("chooese",1);this.ClickEvent&&this.ClickEvent(f,!e,c)};this.chooeseMonth=function(a,b){var c=$("#"+a),d=c.attr("all1"),e=[];d?(c.attr("all1",null),$("#"+a+" .ewa-ui-days .ewa-ui-calendar-year-chooese").each(function(){$(this).removeClass("ewa-ui-calendar-year-chooese").attr("chooese",null);e.push($(this).find("div:eq(0)").attr("title"))}),c.find("th").attr("chooese",
null)):(c.attr("all1","yes"),$("#"+a+" .ewa-ui-days tr:gt(0) td div[title]").parent().each(function(){$(this).addClass("ewa-ui-calendar-year-chooese").attr("chooese",1);e.push($(this).find("div:eq(0)").attr("title"))}),c.find("th").attr("chooese",1));this.ClickEvent&&this.ClickEvent(e,!d,b)};this.SetChooeses=function(a,b){for(var c in a){var d=a[c][b];d&&(d=d.split(" ")[0],$("#"+this.classId+" .ewa-ui-days td div[title='"+d+"']").parent().addClass("ewa-ui-calendar-year-chooese").attr("chooese",1))}$("#"+
this.classId+" .ewa-ui-date").each(function(){$(this).find(".ewa-ui-calendar-year-chooese").length==$(this).find("td div[title]").length&&($(this).attr("all1","yes"),$(this).find("th").attr("chooese","yes"))})};this.GetChooeses=function(a){var b=[];(a?$(a):$("#"+this.classId+" .ewa-ui-days")).find(".ewa-ui-calendar-year-chooese").each(function(){b.push($(this).find("div:eq(0)").attr("title"))});return b};this.GetUnChooeses=function(a){var b=[];(a?$(a):$("#"+this.classId+" .ewa-ui-days")).find("td").each(function(){if(!$(this).attr("chooese")){var a=
$(this).find("div:eq(0)").attr("title");a&&b.push(a)}});return b};this.Click=function(a,b){if(""!=a.innerHTML.trim()){if($(a).attr("chooese")){$(a).removeClass("ewa-ui-calendar-year-chooese").attr("chooese",null);var c=!1}else $(a).addClass("ewa-ui-calendar-year-chooese").attr("chooese",1),c=!0;this.ClickEvent&&(a=[$(a).find("div:eq(0)").attr("title")],this.ClickEvent(a,c,b))}};this.ClickEvent=function(a,b,c){console.log("overwrite xxx.ClickEvent(rqs,   isChecked, evt)")}}
function EWA_UI_CalendarYearGroupClass(){this.denysBefore=function(a){a=new EWA_DateClass(a);for(var b=1;1500>b;b++){var c=a.AddDays(-1);c=c.split(" ")[0];if(0==this.denyDay(c).length)break}};this.denysAfter=function(a){a=new EWA_DateClass(a);for(var b=1;1500>b;b++){var c=a.AddDays(1);c=c.split(" ")[0];if(0==this.denyDay(c).length)break}};this.denyDay=function(a){a=$("#"+this.classId).find(".ewa-ui-days td").find("div[title='"+a+"']").parent();a.addClass("ewa-ui-calendar-year-deny").attr("deny",1);
return a};this.unDenyDay=function(a){a=$("#"+this.classId).find(".ewa-ui-days td").find("div[title='"+a+"']").parent();a.removeClass("ewa-ui-calendar-year-deny").attr("deny",null);return a};this.CUR_GROUP_NAME=null;this.setGroupName=function(a){a?(this.CUR_GROUP_NAME="CYG_"+a.replace(/:|\?|\.|=|;|\(|\)|\-/ig,""),this.CUR_GROUP_NAME_O=a):this.CUR_GROUP_NAME_O=this.CUR_GROUP_NAME=null};this.Create=function(a,b,c,d,e,f,g){this.classId=("CY"+Math.random()).replace(".","");EWA.UI.CalendarYear=EWA.UI.CalendarYear||
{};EWA.UI.CalendarYear[this.classId]=this;$($X(a)).append('<div class="ewa-ui-calendar-year" id="'+this.classId+'"></div>');a=$("#"+this.classId);var h=new Date;b&&c&&(h=new Date(b,c-1,1));b=c=h.getMonth();e||(b=3*Math.round(c/3-.5));e=h.getFullYear();if(!d||0>=d)d=12;h=new EWA_CalendarClass;for(c=1;c<=d;c++){var k=b+1;if("enus"==EWA.LANG){var m=k+"/"+e;h.SetDate("dd/MM/yyyy"==_EWA_G_SETTINGS.DATE?"01/"+k+"/"+e:k+"/01/"+e)}else m=e+"-"+(b+1),h.SetDate(m+"-01");var l=h.CreateCalendar(),n=e+(10>k?"0":
"")+k;k=this.classId+"_"+n;l.id=k;l.setAttribute("yearmonth",n);a.append(l);$(l.rows[3]).remove();$(l.rows[0].cells[1]).remove();m="<a href='javascript:EWA.UI.CalendarYear."+this.classId+'.chooeseMonth("'+k+"\",event)'>"+m+"</a>";$(l.rows[0].cells[0]).html(m);$(l).find("th").attr("onclick","EWA.UI.CalendarYear."+this.classId+".chooeseWeek('"+k+"',this, event)");b++;12==b&&(b=0,e++);$(l).find("th:eq(0)").addClass("rq-sun");$(l).find("th:eq(6)").addClass("rq-sat")}a.append('<div style="clear:both"></div>');
a.find(".ewa-ui-days td").attr("onclick","EWA.UI.CalendarYear."+this.classId+".Click(this,event)");_EWA_CALENDAR_ITEM=h;f&&this.denysBefore(f);g&&this.denysAfter(g)};this.getChooeseName=function(){return this.CUR_GROUP_NAME?this.CUR_GROUP_NAME:"chooese"};this.addOrRemoveMark=function(a,b,c){var d=this.getChooeseName();b?($(a).find("."+d).remove(),$(a).attr(d,null),this.unMarkEvent&&this.unMarkEvent(a,c)):0==$(a).find("."+d).length&&($(a).append("<nobr class='ewa-ui-calendar-year-item "+d+"'></nobr>"),
$(a).attr(d,1),this.markEvent&&this.markEvent(a,c));$(a).removeClass("N1").removeClass("N2").removeClass("N3").removeClass("N4").removeClass("N5").removeClass("N6").removeClass("N7").removeClass("N8").removeClass("N9").removeClass("NP");b=$(a).find(".ewa-ui-calendar-year-item").length;0<b?($(a).addClass("ewa-ui-calendar-year-chooese"),b=10>b?"N N"+b:"N NP",$(a).addClass(b)):$(a).removeClass("ewa-ui-calendar-year-chooese").removeClass("N")};this.chooeseWeek=function(a,b,c){for(var d=$("#"+a).find(".ewa-ui-days")[0],
e=this.getChooeseName(),f=[],g=b.cellIndex,h=!0,k=!1,m=1;m<d.rows.length;m++){var l=d.rows[m].cells[g];if(0!=l.childNodes.length&&($(l).attr("deny")||(k=!0),$(l).attr(e)||(h=!1),k&&!h))break}if(!k)$Tip("\u6ca1\u6709\u53ef\u9009\u7684\u65e5\u671f");else if(!this.ClickBeforeEvent||this.ClickBeforeEvent(a,b,c,"WEEK")){for(m=1;m<d.rows.length;m++)l=d.rows[m].cells[g],0==l.childNodes.length||$(l).attr("deny")||(a=$(l).find("div:eq(0)").attr("title"),f.push(a),this.addOrRemoveMark(l,h,a));h?$(b).attr(e,
null):$(b).attr(e,1);this.ClickEvent&&this.ClickEvent(f,!h,c)}};this.chooeseMonth=function(a,b){for(var c=$("#"+a+" .ewa-ui-days")[0],d=this.getChooeseName(),e=!0,f=!1,g=1;g<c.rows.length;g++){for(var h=c.rows[g],k=0;k<h.cells.length;k++){var m=h.cells[k];0!=m.childNodes.length&&(f||$(m).attr("deny")||(f=!0),$(m).attr(d)||(e=!1))}if(!e&&f)break}if(!f)$Tip("\u6ca1\u6709\u53ef\u9009\u7684\u65e5\u671f");else if(!this.ClickBeforeEvent||this.ClickBeforeEvent(a,null,b,"MONTH")){a=[];for(g=1;g<c.rows.length;g++)for(h=
c.rows[g],k=0;k<h.cells.length;k++)m=h.cells[k],0==m.childNodes.length||$(m).attr("deny")||(d=$(m).find("div:eq(0)").attr("title"),a.push(d),this.addOrRemoveMark(m,e,d));this.ClickEvent&&this.ClickEvent(a,!e,b)}};this.SetChooeses=function(a,b,c,d){this._RQ_MAP=null;var e=$("#"+this.classId);e.find(".ewa-ui-days td");for(var f in a){var g=a[f],h=g[b];if(h){c&&this.setGroupName(g[c]);h=h.split(" ")[0];var k=this.findTdByRq(h);k&&0<k.length?(this.addOrRemoveMark(k,!1,h),d&&d(k[0],h,g)):console.log("\u65e0\u6548\u7684\u65e5\u671f"+
h)}}this._RQ_MAP=null;e.find(".ewa-ui-date").each(function(){$(this).find(".ewa-ui-calendar-year-chooese").length==$(this).find("td div[title]").length&&($(this).attr("all1","yes"),$(this).find("th").attr("chooese","yes"))})};this.findTdByRq=function(a){if(!a)return null;if(!this._RQ_MAP)this._RQ_MAP={};else if(this._RQ_MAP[a])return this._RQ_MAP[a];var b=a.replace(/-/ig,""),c=b.substring(0,6);c=$("#"+this.classId+" table[yearmonth='"+c+"']");if(0==c.length)return this._RQ_MAP[a]=null;this._RQ_MAP[a]=
c.find("div[date='"+b+"']").parent();return this._RQ_MAP[a]};this.GetChooeses=function(a){var b=[];(a?$(a):$("#"+this.classId+" .ewa-ui-days")).find(".ewa-ui-calendar-year-chooese").each(function(){b.push($(this).find("div:eq(0)").attr("title"))});return b};this.GetUnChooeses=function(a){var b=[];(a?$(a):$("#"+this.classId+" .ewa-ui-days")).find("td").each(function(){if(!$(this).attr("chooese")){var a=$(this).find("div:eq(0)").attr("title");a&&b.push(a)}});return b};this.Click=function(a,b){if(!$(a).attr("deny")&&
""!=a.innerHTML.trim()&&(!this.ClickBeforeEvent||this.ClickBeforeEvent(a.id,a,b,"DAY"))){var c=$(a).find("div:eq(0)").attr("title"),d=this.getChooeseName();d=$(a).attr(d);this.addOrRemoveMark(a,d,c);this.ClickEvent&&this.ClickEvent([c],!d,b)}};this.ClickBeforeEvent=function(a,b,c,d){console.log("overwrite xxx.ClickBeforeEvent(id, obj, evt, type)");return!0};this.ClickEvent=function(a,b,c){console.log("overwrite xxx.ClickEvent(rqs,   isChecked, evt)")}}
function EWA_CalendarClass(){this._Weeks=_EWA_G_SETTINGS.WEEKS.split(",");this._Days=[31,28,31,30,31,30,31,31,30,31,30,31];this._Months=_EWA_G_SETTINGS.MONTHS.split(",");this._CurDate=new Date;this._SelectMinute=this._SelectHour=this._SelectYear=this._SelectMonth=this._DaysTable=null;this.CreateWindow=window;this.IsShowTime=!1;this.Dialog=this.Object=null;this.ChangeDate=function(){this._SetNewDate(this._SelectYear.value,this._SelectMonth.value,1);this._WriteDays(!1)};this._SetNewDate=function(a,
b,c){if(!a){a=this._SelectYear.value;b=this._SelectMonth.value;c=this._DaysTable.getAttribute("EMP_CURRENT_DAY");var d=(0==(a-2008)%4&&0!=a%100||0==a%400)&&1==b?29:this._Days[b];c>d&&(c=d)}this._CurDate=new Date(a,b,c);this.IsShowTime&&(a=this._SelectMinute.value,this._CurDate.setHours(this._SelectHour.value),this._CurDate.setMinutes(a))};this.SetDate=function(a){a=a.split(" ");var b=a[0].split("-");3>b.length&&(b=a[0].split("/"));3>b.length&&(b=a[0].split("."));3==b.length&&(b[0]=parseInt(b[0]),
"0"==b[1].substring(0,1)&&(b[1]=b[1].substring(1)),"0"==b[2].substring(0,1)&&(b[2]=b[2].substring(1)),b[1]=parseInt(b[1]),b[2]=parseInt(b[2]),"NaN"!=b[0]+""&&"NaN"!=b[1]+""&&"NaN"!=b[2]+""&&("ENUS"==EWA.LANG.toUpperCase()?this._CurDate="dd/MM/yyyy"==_EWA_G_SETTINGS.DATE?new Date(b[2],b[1]-1,b[0]):new Date(b[2],b[0]-1,b[1]):this._CurDate=new Date(b[0],b[1]-1,b[2]),1<a.length&&(b=a[1].split(":"),this._CurDate.setHours(b[0]),1<b.length&&this._CurDate.setMinutes(b[1]),2<b.length&&this._CurDate.setSeconds(b[2].split(".")[0]))),
a=this._CurDate.getDate(),this._DaysTable&&this._DaysTable.setAttribute("EMP_CURRENT_DAY",a))};this._CreateTime=function(){var a=this._CurDate,b=this.CreateWindow.document.createElement("div"),c=this.CreateWindow.document.createElement("select"),d=this.CreateWindow.document.createElement("select"),e=this.CreateWindow.document.createElement("span");e.innerHTML="\u65f6\u95f4 ";var f=this.CreateWindow.document.createElement("span");f.innerHTML=":";for(var g=0;24>g;g++){var h=10>g?"0"+g:g+"";c.options[c.options.length]=
new Option(h,h)}c.value=a.getHours();b.appendChild(e);b.appendChild(c);b.appendChild(f);b.appendChild(d);c=this.CreateWindow.document.createElement("span");c.innerHTML="&nbsp;";e=this.CreateWindow.document.createElement("span");e.style.cursor="pointer";e.style.color="blue";e.setAttribute("IS_ALL",0);e.onclick=function(){d.options.length=0;if(1==this.getAttribute("IS_ALL")){for(var b=0;12>b;b++){var c=(100+5*b+"").substring(1);d.options[d.options.length]=new Option(c,c)}b=a.getMinutes();b=0==b%5?b:
5*(parseInt(b/5)+1);d.value=(100+b+"").substring(1);this.setAttribute("IS_ALL",0);this.innerHTML="\u5168\u90e8"}else{for(b=0;60>b;b++)c=(100+b+"").substring(1),d.options[d.options.length]=new Option(c,c);b=a.getMinutes();d.value=(100+b+"").substring(1);this.setAttribute("IS_ALL",1);this.innerHTML="\u6bcf5\u5206\u949f"}};b.appendChild(c);b.appendChild(e);return b};this.CreateTime=function(){var a=[];a.push("<table border=0 class='ewa-ui-date-picker' style='border:1px solid #aaa' bgcolor='#E1E1E1' onselectstart='return false'>");
a.push("<tr><td><nobr></nobr></td></tr>");a.push("</table>");var b=this.CreateWindow.document.createElement("DIV");b.innerHTML=a.join("");a=b.childNodes[0].rows[0].cells[0].childNodes[0];for(var c=this._CreateTime();0<c.childNodes.length;)a.appendChild(c.childNodes[0]);c=a.getElementsByTagName("span")[3];c.setAttribute("IS_ALL",1);c.click();c.style.display="none";c=this.CreateWindow.document.createElement("input");c.type="button";if("enus"==EWA.LANG.toLowerCase()){c.value="Ok";var d="Clear"}else c.value=
"\u786e\u5b9a",d="\u6e05\u9664";c.onclick=function(){var a=EWA.B.IE?this.ownerDocument.parentWindow:this.ownerDocument.defaultView,b=this.parentNode.getElementsByTagName("select"),c=a._EWA_CALENDAR_ITEM.Object.value;b=b[0].value+":"+b[1].value;a._EWA_CALENDAR_ITEM.Object.value=b;a._EWA_CALENDAR_ITEM.Dialog.Show(!1);c!=b&&($(a._EWA_CALENDAR_ITEM.Object).trigger("keyup"),$(a._EWA_CALENDAR_ITEM.Object).trigger("blur"))};a.appendChild(c);c="<a href='javascript:void(0)' style='margin:0 5px;color:#08c;font-size:12px;'>"+
d+"</a>";$(a).append(c);$(a).find("a").click(function(){var a=EWA.B.IE?this.ownerDocument.parentWindow:this.ownerDocument.defaultView,b=a._EWA_CALENDAR_ITEM.Object.value;a._EWA_CALENDAR_ITEM.Object.value="";a._EWA_CALENDAR_ITEM.Dialog.Show(!1);""!=b&&($(a._EWA_CALENDAR_ITEM.Object).trigger("keyup"),$(a._EWA_CALENDAR_ITEM.Object).trigger("blur"))});$(a).append("<b class='fa fa-close' style='color:#666;font-size:12px;'></b>");$(a).find("b").click(function(){(EWA.B.IE?this.ownerDocument.parentWindow:
this.ownerDocument.defaultView)._EWA_CALENDAR_ITEM.Dialog.Show(!1)});return b.childNodes[0]};this.CreateCalendar=function(a){this.IsShowTime=a;var b=[];b.push("<table border=0 class='ewa-ui-date' onselectstart='return false'>");b.push("<tr>");b.push("<td height=28>"+this._CreateMonth()+"</td>");b.push("<td align=right>"+this._CreateYear()+"</td>");b.push("</tr>");b.push("<tr><td colspan=2>"+this._CreateDaysTable()+"</td></tr>");b.push("<tr style='display:none'><td colspan=2></td></tr>");b.push("<tr><td colspan=2>"+
this._CreateToDay()+"</td></tr>");b.push("</table>");var c=this.CreateWindow.document.createElement("DIV");c.innerHTML=b.join("");this._DaysTable=c.childNodes[0].rows[1].cells[0].childNodes[0];b=c.getElementsByTagName("select");this._SelectMonth=b[0];this._SelectYear=b[1];this._WriteDays();if(a){a=c.childNodes[0].rows[2];a.style.display="";a=a.cells[0];for(b=this._CreateTime();0<b.childNodes.length;)a.appendChild(b.childNodes[0]);a.getElementsByTagName("span")[3].click();this._SelectHour=a.getElementsByTagName("select")[0];
this._SelectMinute=a.getElementsByTagName("select")[1]}return c.childNodes[0]};this._CreateToDay=function(){var a={};"enus"==EWA.LANG.toLowerCase()?(a.today="Today",a.empty_title="Empty",a.empty="Empty",a.close="Close"):(a.today="\u8bbe\u7f6e\u4e3a\u4eca\u5929",a.empty_title="\u6e05\u7a7a\u65e5\u671f",a.empty="\u7a7a",a.close="\u5173\u95ed");var b="<div class='ewa-ui-date-today-day' title='"+a.today+"' onclick='_EWA_CALENDAR_ITEM.Object.value=this.innerHTML;if(_EWA_CALENDAR_ITEM.Object.onkeyup!=null)_EWA_CALENDAR_ITEM.Object.onkeyup();if(_EWA_CALENDAR_ITEM.Object.onblur!=null)_EWA_CALENDAR_ITEM.Object.onblur();_EWA_CALENDAR_ITEM.Dialog.Show(false);'>"+
this.GetDate(new Date)+"</div>";var c="<table border=0 class='ewa-ui-date-today' width=100%><tr><td class='ewa-ui-date-today-day' onclick='_EWA_CALENDAR_ITEM.Object.value=$(this).next().text();if(_EWA_CALENDAR_ITEM.Object.onkeyup!=null)_EWA_CALENDAR_ITEM.Object.onkeyup();if(_EWA_CALENDAR_ITEM.Object.onblur!=null)_EWA_CALENDAR_ITEM.Object.onblur();_EWA_CALENDAR_ITEM.Dialog.Show(false);'>"+(_EWA_G_SETTINGS.Today+"</td>");c=c+("<td>"+b+"</td><td><div class='ewa-ui-date-today-clear' title='")+(a.empty_title+
"' onclick='_EWA_CALENDAR_ITEM.Object.value=\"\";if(_EWA_CALENDAR_ITEM.Object.onkeyup!=null)_EWA_CALENDAR_ITEM.Object.onkeyup();if(_EWA_CALENDAR_ITEM.Object.onblur!=null)_EWA_CALENDAR_ITEM.Object.onblur();_EWA_CALENDAR_ITEM.Dialog.Show(false);'>"+a.empty+"</div></td>");c+="<td align=right><div class='ewa-ui-date-close' title='"+a.close+"' onclick='_EWA_CALENDAR_ITEM.Hidden()'><b>X</b></div></td>";return c+"</tr></table>"};this.MarkDay=function(){for(var a=1*this._DaysTable.getAttribute("EMP_CURRENT_DAY"),
b=1;b<this._DaysTable.rows.length;b+=1)for(var c=this._DaysTable.rows[b],d=0;d<c.cells.length;d+=1){var e=c.cells[d];0<e.childNodes.length&&1*GetInnerText(e.childNodes[0])==a?this.MarkSelected(e):this.MarkUnSelected(e)}};this.MarkSelected=function(a){$(a).addClass("ewa-ui-date-selected")};this.MarkUnSelected=function(a){$(a).removeClass("ewa-ui-date-selected")};this.MarkBlur=function(a){$(a).addClass("ewa-ui-date-blur")};this.MarkUnBlur=function(a){$(a).removeClass("ewa-ui-date-blur")};this._CreateMonth=
function(){for(var a=this._CreatePervNext(),b="<select onchange='_EWA_CALENDAR_ITEM.ChangeDate();'>",c=this._CurDate.getMonth(),d=0;d<this._Months.length;d+=1)b=d==c?b+("<option value='"+d+"' selected>"+this._Months[d]+"</option>"):b+("<option value='"+d+"'>"+this._Months[d]+"</option>");return a=a.replace("[$]",b+"</select>")};this._CreateYear=function(){for(var a=this._CurDate.getFullYear(),b=this._CreatePervNext(),c=["<select onchange='_EWA_CALENDAR_ITEM.ChangeDate();'>"],d=1900;2050>=d;d+=1)d==
a?c.push("<option value='"+d+"' selected>"+d+"</option>"):c.push("<option value='"+d+"'>"+d+"</option>");c.push("</select>");return b=b.replace("[$]",c.join(""))};this._CreatePervNext=function(){return"<table cellpadding=0 cellspacing=0 border=0><tr><td><div class='ewa-ui-date-prev'  onclick='var o=this.parentNode;var o1=o.nextSibling.childNodes[0];if(o1.selectedIndex>0){o1.value=o1.value*1-1;o1.onchange();}o=o1=null'><b class='fa fa-caret-left'></b></div></td><td>[$]</td><td><div class='ewa-ui-date-next' onclick='var o=this.parentNode;var o1=o.previousSibling.childNodes[0];if(o1.options.length-1>o1.selectedIndex){o1.value=o1.value*1+1;o1.onchange();}o=o1=null'><b class='fa fa-caret-right'></div></td></tr></table>"};
this._WriteDays=function(a){if(this.__LAST__WriteDaysDate!=this._CurDate){this.__LAST__WriteDaysDate=this._CurDate;var b=this._CreateDays();this._CurDate.getDate();var c=this._CurDate.getMonth(),d=this._CurDate.getFullYear();this._SelectMonth.value=c;this._SelectYear.value=d;var e=c+1;10>e&&(e="0"+e);c=d+"-"+e+"-DD";var f=this._CurDate.getFullYear()+""+e;null!=EWA.LANG&&"ENUS"==EWA.LANG.toUpperCase()&&(c="dd/MM/yyyy"==_EWA_G_SETTINGS.DATE?"DD/"+e+"/"+d:e+"/DD/"+d);for(e=1;e<this._DaysTable.rows.length;e+=
1){for(var g=this._DaysTable.rows[e],h=0;h<g.cells.length;h+=1)d=g.cells[h],d.innerHTML=null==b[e]||null==b[e][h]?"":"<div date='"+(f+b[e][h])+"' title='"+c.replace("DD",b[e][h])+"'>"+b[e][h]+"</div>",this.MarkUnSelected(d);""==$(g).text()?$(g).hide():$(g).show()}}a&&this.MarkDay()};this._CreateDaysTable=function(){var a=[];a[0]="<table class='ewa-ui-days' align ='center' border=0 cellpadding=1 cellspacing=1 EMP_CURRENT_DAY='"+this._CurDate.getDate()+"'>";for(var b=0;7>b;b+=1){a.push("<tr>");for(var c=
0;7>c;c+=1)0==b?a.push("<th>"+this._Weeks[c]+"</th>"):(a.push("<td onmouseover='if(this.innerHTML.length>0)_EWA_CALENDAR_ITEM.MarkBlur(this);'"),a.push(" onmouseout='if(this.innerHTML.length>0)_EWA_CALENDAR_ITEM.MarkUnBlur(this);'"),a.push(" onclick='_EWA_CALENDAR_ITEM.Clicked(this);'></td>"));a.push("</tr>")}a.push("</table>");return a.join("")};this.Clear=function(){this.Object.value="";this.Hidden()};this.Hidden=function(a){if(null!=this.Object.onblur&&!a)this.Object.onblur();this.Object=null;
this.Dialog.Show(!1)};this.Clicked=function(a){if(0<a.innerHTML.length){this._DaysTable.setAttribute("EMP_CURRENT_DAY",a.childNodes[0].innerHTML);this._SetNewDate();this.MarkDay();this.Object.value=this.GetDate();if(null!=this.Object.onkeyup)this.Object.onkeyup();if(null!=this.Object.onblur)this.Object.onblur();if(null!=this.Object.onchange)this.Object.onchange();this.Hidden(!0)}};this.GetDate=function(a){var b=_EWA_G_SETTINGS.DATE;null==a&&(a=this._CurDate);var c=a.getFullYear(),d=a.getMonth()+1,
e=a.getDate();10>d&&(d="0"+d);10>e&&(e="0"+e);b=b.replace("yyyy",c);b=b.replace("MM",d);b=b.replace("dd",e);this.IsShowTime&&(d=a.getHours(),a=a.getMinutes(),b+=" "+(10>d?"0"+d:d)+":"+(10>a?"0"+a:a));return b};this._CreateDays=function(){var a=(new Date(this._CurDate.getFullYear(),this._CurDate.getMonth(),1)).getDay(),b=1,c=[];c[0]=this._Weeks;for(var d=1,e=this._getCurMonthDays(),f=0;49>f;f+=1){if(0==f||7==a)c[d]=[],d+=1;7==a&&(a=0);if(b<=e)c[d-1][a]=10>b?"0"+b:b+"";else break;b+=1;a+=1}return c};
this._getCurMonthDays=function(){return(0==(this._CurDate.getFullYear()-2008)%4&&0!=(this._CurDate.getFullYear()-400)%100||0==(this._CurDate.getFullYear()-400)%400)&&1==this._CurDate.getMonth()?29:this._Days[this._CurDate.getMonth()]}}
var __Cal={C:EWA_CalendarClass,WND:null,WND_PARENT:null,WND_DIA:null,Pop:function(a,b){var c="WND_PARENT/Pop/"+b;__Cal[c]||(__Cal[c]={});c=__Cal[c];c.OBJ=a;if(null==c.WND){console.log("create instance");var d=c.WND_DIA=new EWA_UI_DialogClass;d.Width=172;d.Height=200;d.ShadowColor="";c.WND=new EWA_CalendarClass;"undefined"==typeof _EWA_DialogWnd?d.CreateWindow=window:(d.CreateWindow=_EWA_DialogWnd._ParentWindow,_EWA_DialogWnd.OpendDialogs[_EWA_DialogWnd.OpendDialogs.length]=d);d.CreateWindow._EWA_CALENDAR_ITEM=
c.WND;d.Create();c.WND.CreateWindow=d.CreateWindow;c.WND.SetDate(a.value);b=c.WND.CreateCalendar(b);d.SetObject(b);c.WND.Dialog=d}console.log("show instance");c.WND.SetDate(a.value);c.WND._WriteDays(!0);c.WND.Dialog.SetZIndex(10);c.WND.Object=a;c.WND_DIA.MoveBottom(a);c.WND_DIA.Show(!0)},PopTime:function(a){__Cal["WND_PARENT/PopTime/"]||(__Cal["WND_PARENT/PopTime/"]={});var b=__Cal["WND_PARENT/PopTime/"];b.OBJ=a;if(null==b.WND){var c=b.WND_DIA=new EWA_UI_DialogClass;c.Width=180;c.Height=20;c.ShadowColor=
"";b.WND=new EWA_CalendarClass;"undefined"==typeof _EWA_DialogWnd?c.CreateWindow=window:(c.CreateWindow=_EWA_DialogWnd._ParentWindow,_EWA_DialogWnd.OpendDialogs[_EWA_DialogWnd.OpendDialogs.length]=c);c.CreateWindow._EWA_CALENDAR_ITEM=b.WND;c.Create();b.WND.CreateWindow=c.CreateWindow;b.WND.SetDate(a.value);var d=b.WND.CreateTime();c.SetObject(d);b.WND.Dialog=c}b.WND.CreateWindow._EWA_CALENDAR_ITEM.Object=a;b.WND.CreateWindow._EWA_CALENDAR_ITEM.Dialog=b.WND_DIA;b.WND.SetDate(a.value);b.WND.Dialog.SetZIndex(10);
b.WND.Object=a;b.WND_DIA.MoveBottom(a);b.WND_DIA.Show(!0)}};EWA.UI.Calendar=__Cal;
function EWA_UI_MsgClass(a,b){this._IsSelfWindow=b;this._Dialog=null;this._Msg=a;this._Buttons=[];this._Caption=null;this._Icon="MSG_ICON";this.SetIcon=function(a){this._Icon=a};this.SetCaption=function(a){this._Caption=a};this.AddButton=function(a,b){this._Buttons.push({Text:a,Event:b})};this.AddButtons=function(a){if(null!=a)for(var b=0;b<a.length;b++)this._Buttons.push(a[b])};this._Init=function(){this._Dialog=__Dialog.OpenWindow("about:blank",Math.random(),500,200,this._IsSelfWindow);this._Dialog._FromMsgClass=
this;this._Dialog.SetHtml(this._CreateHtml());this._Dialog.SetCaption(this._Caption);var a=this._Dialog._Dialog.GetFrameContent().getElementsByTagName("table")[0],b=this._Dialog._Dialog.GetFrame();b.style.width=a.clientWidth+"px";b.style.height=a.clientHeight+"px"};this._CreateHtml=function(){var a=[];a.push("<table border=0 class='MSG_INFO'>");a.push("<tr><td rowspan=2 style='width:130px;' align='center'>");a.push("<div class='"+this._Icon+"'>&nbsp;</div></td>");a.push("<td class='MSG_TEXT'>");a.push(this._Msg);
a.push("</td></tr>");a.push("<tr><td class='MSG_BUTS'>");var b=this._CloseWindowJs();if(0<this._Buttons.length){a.push("<hr><table><tr>");for(var e=0;e<this._Buttons.length;e++){var f=this._Buttons[e];a.push("<td>");var g="<button _ewa_msg_default='"+(f.Default?1:0)+"'  type='button' _ewa_dialog_='"+this._Dialog.Id+"' ";g=f.Event&&"function"==typeof f.Event?g+(" onclick=\"_EWA_UI_WINDOW_LIST[this.getAttribute('_ewa_dialog_')]._FromMsgClass.fire("+e+')">'+f.Text+"</button>"):g+(' onclick="'+(f.Event?
f.Event+";"+b:b)+'">'+f.Text+"</button>");a.push(g);a.push("</td>")}a.push("</tr></table>")}a.push("</td></tr></table>");return a.join("")};this.fire=function(a){if((a=this._Buttons[a])&&a.Event)try{a.Event(this)}catch(d){console.log(d)}this.Hidden()};this._CloseWindowJs=function(){return"var a=this.getAttribute('_ewa_dialog_'); _EWA_UI_WINDOW_LIST[a].CloseWindow();"};this.Show=function(a,b){null==this._Dialog&&this._Init();if(a)if(a=this._Dialog._ParentWindow.document.getElementsByTagName("button"),
b){var c=[];for(b=0;b<a.length;b++){var d=$(a[b]);d.attr("_ewa_dialog_")==this._Dialog.Id&&(d.prop("disabled",!0),c.push(d))}setTimeout(function(){for(var a in c)c[a].prop("disabled",!1)},435)}else for(this._Dialog.ResizeByContent(),this._Dialog.MoveCenter(),b=0;b<a.length;b++)if(1==a[b].getAttribute("_ewa_msg_default")&&a[b].getAttribute("_ewa_dialog_")==this._Dialog.Id){a[b].focus();break}};this.Hidden=function(){this.Show(!1);this._Dialog.CloseWindow()}}
EWA.UI.Msg={IS_IN_APP:!1,C:EWA_UI_MsgClass,Show:function(a,b,c,d){if(0<a.indexOf("(")&&0<a.indexOf(")"))try{a=eval(a)}catch(e){console.log(a)}a=new EWA_UI_MsgClass(a);a.SetCaption(c);a.AddButtons(b);a.SetIcon(d);a.Show(!0,EWA.UI.Msg.IS_IN_APP);return a},ShowInfo:function(a,b,c){__EWA_MSG__=EWA.UI.Msg.Show(a,b,c,"MSG_ICON");$(__EWA_MSG__._Dialog._Dialog.GetFrame()).addClass("ewa-msg-info");return __EWA_MSG__},ShowError:function(a,b){var c=[];c[0]={Text:_EWA_INFO_MSG["BUT.OK"],Event:null,Default:!0};
__EWA_MSG__=EWA.UI.Msg.Show(a,c,b,"ERR_ICON");$(__EWA_MSG__._Dialog._Dialog.GetFrame()).addClass("ewa-msg-err");return __EWA_MSG__},Alter:function(a,b){var c=[];c[0]={Text:_EWA_INFO_MSG["BUT.OK"],Event:null,Default:!0};__EWA_MSG__=EWA.UI.Msg.Show(a,c,b,"MSG_ICON");$(__EWA_MSG__._Dialog._Dialog.GetFrame()).addClass("ewa-msg-alert");return __EWA_MSG__},Alert:function(a,b){var c=[];c[0]={Text:_EWA_INFO_MSG["BUT.OK"],Event:null,Default:!0};__EWA_MSG__=EWA.UI.Msg.Show(a,c,b,"MSG_ICON");$(__EWA_MSG__._Dialog._Dialog.GetFrame()).addClass("ewa-msg-alert");
return __EWA_MSG__},Confirm:function(a,b,c,d){var e=[];e[0]={Text:_EWA_INFO_MSG["BUT.YES"],Event:c};e[1]={Text:_EWA_INFO_MSG["BUT.NO"],Event:d,Default:!0};__EWA_MSG__=EWA.UI.Msg.Show(a,e,b,"QUS_ICON");$(__EWA_MSG__._Dialog._Dialog.GetFrame()).addClass("ewa-msg-confirm");return __EWA_MSG__},_Tip:function(a,b,c,d){var e=document.createElement("table");document.body.appendChild(e);$(e).css(b);b=e.insertRow(-1).insertCell(-1);$(b).css(c);if(d&&d instanceof Function){b.innerHTML='<i class="fa fa-refresh fa-spin"></i> '+
a;var f=setInterval(function(){d()&&(window.clearInterval(f),$(e).animate({opacity:0},200,function(){$(e).remove()}))},300)}else{b.innerHTML=a;if(!d||isNaN(d))d=1500;setTimeout(function(){$(e).animate({opacity:0},200,function(){$(e).remove()})},d)}},Tip:function(a,b){var c={width:300,height:80,padding:10,"background-color":"rgba(10,20,30,0.7)",position:"fixed",top:"50%",left:"50%","margin-left":-150,"margin-top":-60,"border-radius":10,"z-index":window._EWA_UI_DIALOG_COVERINDEX?window._EWA_UI_DIALOG_COVERINDEX+
10:1E6,color:"#fff"};EWA.B.IE&&9>1*EWA.B.VERSION&&(c.filter="progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr='#77000000',EndColorStr='#77000000')");EWA.UI.Msg._Tip(a,c,{"text-align":"center","font-size":16,"line-height":1.5},b)},TipBR:function(a,b){var c={height:20,padding:2,"background-color":"rgba(222,222,0,0.7)",position:"fixed",bottom:5,right:5,"border-radius":1,"z-index":window._EWA_UI_DIALOG_COVERINDEX?window._EWA_UI_DIALOG_COVERINDEX+10:1E6,color:"#111"};EWA.B.IE&&9>
1*EWA.B.VERSION&&(c.filter="progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr='#66000000',EndColorStr='#66000000')");EWA.UI.Msg._Tip(a,c,{"text-align":"center","font-size":12,"line-height":1.5},b)},TipBL:function(a,b){var c={height:20,padding:2,"background-color":"rgba(222,222,0,0.7)",position:"fixed",bottom:5,left:5,"border-radius":1,"z-index":window._EWA_UI_DIALOG_COVERINDEX?window._EWA_UI_DIALOG_COVERINDEX+10:1E6,color:"#111"};EWA.B.IE&&9>1*EWA.B.VERSION&&(c.filter="progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr='#66000000',EndColorStr='#66000000')");
EWA.UI.Msg._Tip(a,c,{"text-align":"center","font-size":12,"line-height":1.5},b)},TipTL:function(a,b){var c={height:20,padding:2,"background-color":"rgba(222,222,0,0.7)",position:"fixed",top:5,left:5,"border-radius":1,"z-index":window._EWA_UI_DIALOG_COVERINDEX?window._EWA_UI_DIALOG_COVERINDEX+10:1E6,color:"#111"};EWA.B.IE&&9>1*EWA.B.VERSION&&(c["background-color"]="filter:progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr='#00000000',EndColorStr='#66000000')");EWA.UI.Msg._Tip(a,
c,{"text-align":"center","font-size":12,"line-height":1.5},b)},TipTR:function(a,b){var c={height:20,padding:2,"background-color":"rgba(222,222,0,0.7)",position:"fixed",top:5,right:5,"border-radius":1,"z-index":window._EWA_UI_DIALOG_COVERINDEX?window._EWA_UI_DIALOG_COVERINDEX+10:1E6,color:"#111"};EWA.B.IE&&9>1*EWA.B.VERSION&&(c["background-color"]="filter:progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr='#00000000',EndColorStr='#66000000')");EWA.UI.Msg._Tip(a,c,{"text-align":"center",
"font-size":12,"line-height":1.5},b)}};$Mark=function(a,b){var c=1E3*b||3E3,d="<div class='ewa-mark' style='transition-duration:"+(b||3)+"s;'></div>";$(a).each(function(){var a=$(d),b=$(this).offset();b={left:b.left+2,top:b.top-2,width:$(this).outerWidth(),height:$(this).outerHeight()};a.css(b);$("body").append(a);setTimeout(function(){a.css("opacity",0)},10);setTimeout(function(){a.remove()},c+10)})};$Confirm=EWA.UI.Msg.Confirm;$Tip=EWA.UI.Msg.Tip;$TipBR=EWA.UI.Msg.TipBR;$TipBL=EWA.UI.Msg.TipBL;
$TipTR=EWA.UI.Msg.TipTR;$TipTL=EWA.UI.Msg.TipTL;
function EWA_UI_FlowChartClass(){this.DEF_CHART_WIDTH=200;this.DEF_CHART_HEIGHT=50;this.DEF_BG_COLOR="#08c";this.DEF_COLOR="#fff";this.Create=function(a,b,c,d,e,f,g,h){this.PID=a;this.FIELD_ID=c;this.FIELD_TEXT=d;this.CHART_WIDTH=e||this.DEF_CHART_WIDTH;this.CHART_HEIGHT=f||this.DEF_CHART_HEIGHT;this.BG_COLOR=g||this.DEF_BG_COLOR;this.COLOR=h||this.DEF_COLOR;this.OFF=Math.round(this.CHART_HEIGHT*Math.sqrt(2)/2);this._CreateCss();c=["<div style='z-index:1;padding-left:"+this.OFF+"px;height:"+this.CHART_HEIGHT+
"px;position:relative;margin:auto;width:"+(this.CHART_WIDTH*b.length-(this.OFF-4)*(b.length-1)+4)+"px'>"];for(d=0;d<b.length;d++)e=this._CreateChart(b[d],d,d==b.length-1),c.push(e);c.push("</div>");$X(a)?$($X(a)).append(c.join("")):$("body").append(c.join(""))};this._CreateCss=function(){var a=this.CHART_HEIGHT,b=this.OFF,c=Math.round(b);this.CSS={main:"position:relative;margin-left:-"+(b-4)+"px;float:left;z-index:[ZINDEX];height:"+a+"px;width:[WIDTH]px;overflow:hidden;",leftbox:"background-color:[BGCOLOR];float:left;width:"+
c+"px;height:"+a+"px;overflow:hidden",leftarrow:"background: #fff;margin-left: -"+b+"px;width:"+a+"px;height:"+a+"px;-webkit-transform: rotate(45deg);transform: rotate(45deg);",center:"height:"+a+"px;float:left;text-overflow: ellipsis;overflow: hidden;line-height:"+a+"px;background-color:[BGCOLOR];width:"+(this.CHART_WIDTH-2*c)+"px;text-align:center;font-size:16px",centertd:"color:[COLOR];text-overflow: ellipsis;overflow: hidden;width:100%;text-align:center;font-size:16px",rightbox:"float:right;width:"+
c+"px;height:"+a+"px;overflow:hidden",rightarrow:"background:[BGCOLOR];margin-left: -"+c+"px;width:"+a+"px;height:"+a+"px;-webkit-transform: rotate(45deg);transform: rotate(45deg);"}};this._CreateChart=function(a,b,c){console.log(a);var d=[],e=this.CSS.main.replace("[ZINDEX]",1E3-b).replace("[LEFT]",(this.CHART_WIDTH-20)*b);e=e.replace("[WIDTH]",this.CHART_WIDTH);d.push("<div id='"+a[this.FIELD_ID]+"' style='"+e+"'>");var f=a.bgColor||this.BG_COLOR;e=this.CSS.leftbox.replace("[BGCOLOR]",f);var g=
this.CSS.center.replace("[BGCOLOR]",f);f=this.CSS.rightarrow.replace("[BGCOLOR]",f);var h=this.CSS.centertd.replace("[COLOR]",a.color||this.COLOR);d.push("<div style='"+e+"'>");d.push("<div style='"+this.CSS.leftarrow+"'></div>");d.push("</div>");d.push("<table border=0 cellpadding=0 cellspacing=0  style='"+g+"'><tr><td style='"+h+"'>");"function"==typeof this.FIELD_TEXT?(a=this.FIELD_TEXT(a,b,c),d.push(a)):d.push(a[this.FIELD_TEXT]);d.push("</td></tr></table>");d.push("<div style='"+this.CSS.rightbox+
"'>");d.push("<div style='"+f+"'></div>");d.push("</div>");d.push("</div>");return d.join("")}}
var EWA_UI_HtmlEditorConfig={OPT_PopImgProperties:!0,OPT_ImageResizes:null,fonts:[{name:"\u5fae\u8f6f\u96c5\u9ed1",font:"Microsoft YaHei"},{name:"\u5b8b\u4f53",font:"\u5b8b\u4f53"},{name:"Arial",font:"Arial"},{name:"STHeiti",font:"STHeiti"}],formats:[{name:"H1",format:"h1"},{name:"H2",format:"h2"},{name:"H3",format:"h3"},{name:"H4",format:"h4"},{name:"H5",format:"h5"},{name:"\u666e\u901a",format:"p"}],sizes:[{name:"\u8d85\u5927",size:"7"},{name:"\u7279\u5927",size:"6"},{name:"\u5927",size:"5"},{name:"\u6807\u51c6",
size:"4"},{name:"\u5c0f",size:"3"},{name:"\u7279\u5c0f",size:"2"},{name:"\u7279\u5c0f",size:"1"}],css:"img{max-width:100%}html{background:#2f2f2f}body{width: 800px; padding:10px 20px; margin: auto; box-shadow: rgb(241, 241, 241) 1px 1px 13px; font-size:14px; box-sizing: border-box;overflow-y: scroll;   font-family: 'Microsoft YaHei', STHeiti, \u5fae\u8f6f\u96c5\u9ed1, tahoma, Verdana, Arial, sans-serif, \u5b8b\u4f53; background: rgb(255, 255, 255);}",colors:"#ffffff #000000 #eeece1 #1f497d #4f81bd #c0504d #9bbb59 #8064a2 #4bacc6 #f79646 #f2f2f2 #7f7f7f #ddd9c3 #c6d9f0 #dbe5f1 #f2dcdb #ebf1dd #e5e0ec #dbeef3 #fdeada #d8d8d8 #595959 #c4bd97 #8db3e2 #b8cce4 #e5b9b7 #d7e3bc #ccc1d9 #b7dde8 #fbd5b5 #bfbfbf #3f3f3f #938953 #548dd4 #95b3d7 #d99694 #c3d69b #b2a2c7 #92cddc #fac08f #a5a5a5 #262626 #494429 #17365d #366092 #953734 #76923c #5f497a #31859b #e36c09 #7f7f7f #0c0c0c #1d1b10 #0f243e #244061 #632423 #4f6128 #3f3151 #205867 #974806 #c00000 #ff0000 #ffc000 #ffff00 #92d050 #00b050 #00b0f0 #0070c0 #002060 #7030a0".split(" "),
buts:{FormatBlock:{id:"fn_FormatBlock",cmd:"PopFormatBlock",title:"\u683c\u5f0f","class":"fa fa-header"},FontSize:{id:"fn_FontSize",cmd:"PopFontSize",title:"\u5b57\u9ad4\u5927\u5c0f","class":"fa fa-text-height"},FontName:{id:"fn_FontName",cmd:"PopFont",title:"\u5b57\u4f53","class":"fa fa-font"},BOLD:{id:"st_bold",cmd:"BOLD",title:"BOLD","class":"fa fa-bold"},ITALIC:{id:"st_italic",cmd:"ITALIC",title:"ITALIC","class":"fa fa-italic"},UNDERLINE:{id:"st_underline",cmd:"UNDERLINE",title:"UNDERLINE","class":"fa fa-underline"},
InsertOrderedList:{id:"st_insertorderedlist",cmd:"InsertOrderedList",title:"InsertOrderedList","class":"fa fa-list-ol"},InsertunOrderedList:{id:"st_insertunorderedlist",cmd:"InsertunOrderedList",title:"InsertunOrderedList","class":"fa fa-list-ul"},INDENT:{id:"st_indent",cmd:"INDENT",title:"INDENT","class":"fa fa-indent"},Outdent:{id:"st_outdent",cmd:"Outdent",title:"Outdent","class":"fa fa-outdent"},JustifyLEFT:{id:"st_justifyleft",cmd:"JustifyLEFT",title:"\u5de6\u5bf9\u9f50","class":"fa fa-align-left"},
JustifyCENTER:{id:"st_justifycenter",cmd:"JustifyCENTER",title:"\u5c45\u4e2d","class":"fa fa-align-center"},JustifyRIGHT:{id:"st_justifyright",cmd:"JustifyRIGHT",title:"\u53f3\u5bf9\u9f50","class":"fa fa-align-right"},CreateLink:{id:"st_createlink",cmd:"CreateLink",title:"\u521b\u5efa\u94fe\u63a5","class":"fa fa-chain"},CODE_TXT:{id:"code_txt",cmd:"CODE_TXT",title:"\u6e90\u4ee3\u7801","class":"fa fa-html5"},eraser:{id:"eraser",cmd:"eraser",title:"\u6e05\u9664\u683c\u5f0f","class":"fa fa-eraser"},
ForColor:{id:"fn_ForColor",cmd:"PopForColor",title:"\u5b57\u9ad4\u984f\u8272","class":"fa fa-font ewa-editor-for"},BackColor:{id:"fn_BackColor",cmd:"PopBackColor",title:"\u80cc\u666f\u984f\u8272","class":"fa fa-font ewa-editor-bg"},Img:{id:"fn_Img",cmd:"PopImg",title:"\u5716\u7247","class":"fa fa-camera"},FullScreen:{id:"fn_FullScreen",cmd:"FullScreen",title:"\u5168\u5c4f","class":"fa fa-square-o"},Word2Html:{id:"fn_Word2Html",cmd:"Word2Html",title:"\u8f6c\u6362Word","class":"fa fa-file-word-o"}},
defaultConf:[["FontName","FormatBlock","FontSize"],["BOLD","ITALIC","UNDERLINE"],["InsertOrderedList","InsertunOrderedList"],["JustifyLEFT","JustifyCENTER","JustifyRIGHT"],["INDENT","Outdent"],["CreateLink","eraser"],["ForColor","BackColor"],["Word2Html","Img","FullScreen"],["CODE_TXT"]],pop:function(a,b){for(var c in __Cal)0==c.indexOf("EDITOR_Pop_")&&__Cal[c].WND.Show(!1);c="EDITOR_Pop_"+(a?a.id:"");__Cal[c]||(__Cal[c]={});var d=__Cal[c];d.OBJ=a;if(null==d.WND){var e=d.WND=new EWA_UI_DialogClass;
e.Width=172;e.Height=50;e.ShadowColor="";e.CreateWindow=window;e.CreateWindow._EWA_CALENDAR_ITEM=d.WND;e.Create();e.SetHtml(b);$(e.GetFrameContent()).find("a").attr("onclick",'__Cal["'+c+'"].WND.Show(false);');$('div[ewa_name="DIV_BACK1"]').hide()}d.WND.SetZIndex(10);a?(d.WND.Object=a,d.WND.MoveBottom(a)):d.WND.MoveCenter();d.WND.Show(!0);return d},pop1:function(a,b,c,d){a="EDITOR_Pop_"+a;__Cal[a]||(__Cal[a]={});var e=__Cal[a];if(null==e.WND){var f=e.WND=new EWA_UI_DialogClass;f.Width=c;f.Height=
d;f.ShadowColor="";"undefined"==typeof _EWA_DialogWnd?f.CreateWindow=window:(f.CreateWindow=_EWA_DialogWnd._ParentWindow,_EWA_DialogWnd.OpendDialogs[_EWA_DialogWnd.OpendDialogs.length]=f);f.CreateWindow._EWA_CALENDAR_ITEM=e.WND;f.Create()}e.WND.SetHtml(b);$(e.WND.GetFrameContent()).find("#butClose").attr("onclick",'__Cal["'+a+'"].WND.Show(false);');e.WND.SetZIndex(10);e.WND.MoveCenter();e.WND.Show(!0);return e}};
function EWA_UI_HtmlEditorClass(){this.DEF_CHART_WIDTH=200;this.DEF_CHART_HEIGHT=50;this.DEF_BG_COLOR="#08c";this.DEF_COLOR="#fff";this.OBJ_REPLACE=null;this.pasteClass=new EWA_MiscPasteToolClass;this._CreateFonts=function(){for(var a=["<table class='ewa-editor-pop'>"],b=0;b<EWA_UI_HtmlEditorConfig.fonts.length;b++){var c=EWA_UI_HtmlEditorConfig.fonts[b];a.push("<tr><td>");a.push("<a style='font-size:16px;line-height:1.5;font-family:"+c.font+"' href='javascript:"+this.Id+'.executeSetFont("'+c.font+
"\")'>"+c.name+"</a>");a.push("</td></tr>")}a.push("</table>");return a.join("\n")};this._CreateFormats=function(){for(var a=["<table class='ewa-editor-pop'>"],b=0;b<EWA_UI_HtmlEditorConfig.formats.length;b++){var c=EWA_UI_HtmlEditorConfig.formats[b];a.push("<tr><td>");a.push("<"+c.format+"><a href='javascript:"+this.Id+'.executeSetFormat("'+c.format+"\")'>"+c.name+"</a></"+c.format+">");a.push("</td></tr>")}a.push("</table>");return a.join("\n")};this._CreateFontSizes=function(){for(var a=["<table class='ewa-editor-pop'>"],
b=0;b<EWA_UI_HtmlEditorConfig.sizes.length;b++){var c=EWA_UI_HtmlEditorConfig.sizes[b];a.push("<tr><td>");a.push("<font size="+c.size+"><a href='javascript:"+this.Id+'.executeFontSize("'+c.size+"\")'>"+c.name+"</a></font>");a.push("</td></tr>")}a.push("</table>");return a.join("\n")};this.executeFontSize=function(a){$("#"+this.BoxId+" iframe:eq(0)");this.execDocumentCommand("FontSize",!1,a)};this.executeSetFont=function(a){$("#"+this.BoxId+" iframe:eq(0)");this.execDocumentCommand("FontName",!1,a)};
this.executeSetFormat=function(a){$("#"+this.BoxId+" iframe:eq(0)");this.execDocumentCommand("FormatBlock",!1,a)};this.executeForColor=function(a){$("#"+this.BoxId+" iframe:eq(0)");this.execDocumentCommand("ForeColor",!1,a)};this.executeBackColor=function(a){var b=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow;this.execDocumentCommand("BackColor",!1,a);$(b.document.body).css("background","#fff")};this.execDocumentCommand=function(a,b,c){$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow.document.execCommand(a,
b,c);this.executeAfterEvent(a,c)};this.executeImages=function(a){for(var b=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow,c=0,d=0,e=this,f=0;f<a.files.length;f++){var g=a.files[f];if(g.type&&0==g.type.indexOf("image/")){c++;var h=new FileReader;h.onloadend=function(a){var f=new Image;f.src=a.target.result;f.style.maxWidth="100%";b.document.body.appendChild(f);d++;d==c&&(e.pasteClass.target=b.document.body,e.pasteClass.processAsHtml(),e.pasteClass.process());e.executeAfterEvent("executeImages",
f)};h.readAsDataURL(g)}}};this.executeWord=function(a){for(var b=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow,c=EWA.CP+(EWA.CP.endsWith("/")?"":"/")+"EWA_STYLE/cgi-bin/_re_/?method=2Html",d=this,e=0;e<a.files.length;e++){var f=a.files[e],g=f.name.lastIndexOf(".");if(0<g){if(g=f.name.substring(g).toLowerCase(),".doc"!=g&&".docx"!=g&&".xls"!=g&&".xlsx"!=g&&".odt"!=g){$Tip("\u4ec5\u652f\u6301 doc/docx/xls/xlsx/odt\u6587\u4ef6");break}}else{$Tip("\u4ec5\u652f\u6301 doc/docx/xls/xlsx/odt\u6587\u4ef6");
break}g=new FileReader;g.onloadend=function(a){var e={};e.src=a.target.result;c+="&name="+f.name.toURL();a=$X(d.BoxId).parentNode;var g=d.BoxId+"_cover",h='<div id="'+g+'" style="width:100%;height:100%" class="ewa-ui-dialog-cover"></div>';$(a).css("position","relative").append(h);$JP(c,e,function(a){a.rst?(b.document.body.innerHTML=a.cnt,$(b.document.body).find("img").each(function(){$(this).attr("src",a.img_root+$(this).attr("src"))}),$("#"+g).remove(),$Tip("\u5904\u7406\u5b8c\u6210"),d.executeAfterEvent("executeWord",
a)):$Tip(a.msg)})};g.readAsDataURL(f)}};this.PopFontSize=function(a){var b=this._CreateFontSizes();EWA_UI_HtmlEditorConfig.pop(a,b)};this.PopFont=function(a){var b=this._CreateFonts();EWA_UI_HtmlEditorConfig.pop(a,b)};this.PopFormatBlock=function(a){var b=this._CreateFormats();EWA_UI_HtmlEditorConfig.pop(a,b)};this.PopForColor=function(a){var b=this._CreateColorBox("executeForColor");EWA_UI_HtmlEditorConfig.pop(a,b)};this.PopBackColor=function(a){var b=this._CreateColorBox("executeBackColor");EWA_UI_HtmlEditorConfig.pop(a,
b)};this.PopImg=function(){};this.FullScreen=function(){var a=$("#"+this.BoxId);if(a.attr("isfull")){var b=a.attr("old_css");a.attr("style",b).attr("isfull","")}else{window._EWA_UI_DIALOG_COVERINDEX?_EWA_UI_DIALOG_COVERINDEX++:_EWA_UI_DIALOG_COVERINDEX=999;var c=_EWA_UI_DIALOG_COVERINDEX;b=a.attr("style");a.attr("old_css",b).attr("isfull","1");a.css({position:"fixed",left:0,top:0,right:0,bottom:0,width:"100%",height:"100%","z-index":c})}};this._CreateColorBox=function(a){for(var b=["<table class='ewa-editor-pop'><tr>"],
c=0;c<EWA_UI_HtmlEditorConfig.colors.length;c++){0<c&&0==c%10&&b.push("</tr><tr>");var d=EWA_UI_HtmlEditorConfig.colors[c];b.push("<td><a href='javascript:"+this.Id+"."+a+'("'+d+"\")' class='ewa-edit-pop-color' style='background:"+d+"'>&nbsp;</a></td>")}b.push("</table>");return b.join("\n")};this.Word2Html=function(){};this.GetHtml=function(){var a=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow,b=$("#"+this.BoxId+" iframe:eq(1)")[0].contentWindow;return"none"==$("#"+this.BoxId+" iframe:eq(0)").css("display")?
a.document.body.innerHTML=b.getText():a.document.body.innerHTML};this.GetText=function(){var a=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow,b=$("#"+this.BoxId+" iframe:eq(1)")[0].contentWindow;return"none"==$("#"+this.BoxId+" iframe:eq(0)").css("display")?a.document.body.innerHTML=b.getText():a.document.body.innerText};this.Create=function(a){this.OBJ_REPLACE=a;this.Id=("EWA_Html_"+Math.random()).replace(".","_");this.BoxId=this.Id+"box";window[this.Id]=this;EWA.F.FOS[this.Id]=this;var b=a.value||
a.innerHTML,c=$(a).height(),d={border:"1px solid #ccc",position:"relative",width:$(a).width(),height:c,overflow:"hidden"};"1"==a.getAttribute("EWA_DHTML")&&(d.width="100%");c=document.createElement("table");c.id=this.BoxId;$(c).css(d).addClass("ewa-editor").attr("cellpadding",0).attr("cellspacing",0);d=c.insertRow(-1).insertCell(-1);d.className="ewa-editor-buts";var e=c.insertRow(-1).insertCell(-1);$(e).css("position","static").css("opacity",1).addClass("ewa-ui-dialog-cover");var f=[],g=EWA_UI_HtmlEditorConfig.defaultConf,
h;for(h in g){0<h&&f.push("<span class='ewa-editor-but-spt '>|</span>");for(var k in g[h]){var m=this._CreateButton(EWA_UI_HtmlEditorConfig.buts[g[h][k]]);f.push(m)}}d.innerHTML=f.join("");a.parentNode.insertBefore(c,a);a.style.display="none";this._CreateIframe(e,b,a);a="<input onchange='"+this.Id+".executeImages(this)' multiple accept='image/jpeg,image/png,image/bmp' type=file  style='width:30px;height:30px;position:absolute;top:4px;left:0px;opacity:0.0'>";$("#"+this.BoxId).find("a[id=fn_Img]").append(a);
a="<input onchange='"+this.Id+".executeWord(this)' accept='doc,docx,odt' type=file  style='width:30px;height:30px;position:absolute;top:4px;left:0px;opacity:0.0'>";$("#"+this.BoxId).find("a[id=fn_Word2Html]").append(a);this.executeAfterEvent("init","ok");if(window.__Cal)for(h in __Cal)0==h.indexOf("EDITOR_Pop_")&&delete window.__Cal[h]};this._CreateIframe=function(a,b,c){a.innerHTML="<iframe id='"+this.Id+"cntent' frameborder=0 width=100% height=100%></iframe><iframe id='"+this.Id+"code' src0='"+
(EWA.RV_STATIC_PATH||"/EmpScriptV2")+"/EWA_STYLE/editor/CodeMirror/index.html' style='display: none; width: 100%; height: 100%' frameborder=0></iframe>";var d=this;setTimeout(function(){var a=$("#"+d.BoxId+" iframe:eq(0)"),c=a[0].contentWindow,g=c.document;g.body.style.minHeight=a.height()+"px";840>a.width()&&(g.body.style.boxSizing="border-box",g.body.style.width="100%");a=g.createElement("style");a.textContent=EWA_UI_HtmlEditorConfig.css;g.getElementsByTagName("head")[0].appendChild(a);a=EWA.CP+
(EWA.CP.endsWith("/")?"":"/")+"EWA_STYLE/cgi-bin/_re_/index.jsp?method=HtmlImages";EWA_UI_HtmlEditorConfig.OPT_ImageResizes&&(a+="&ImageReiszes="+EWA_UI_HtmlEditorConfig.OPT_ImageResizes.toURL());d.pasteClass.bind(c.document.body,a,function(a){d.executeAfterEvent("HtmlImages",a)});g.contentEditable=!0;g.designMode="on";g.body.innerHTML=b;$(g.body).css(EWA_UI_HtmlEditorConfig.css);EWA_UI_HtmlEditorConfig.OPT_PopImgProperties&&(g.onmousedown=function(a){a=a||event;a=a.target||a.srcElement;"IMG"==a.tagName&&
d.PopImgProperties(a)});$(g.body).bind("cut",function(){setTimeout(function(){d.executeAfterEvent("cut")},10)});$(g.body).bind("keyup",function(){d.executeAfterEvent("keyup")});$(g.body).bind("paste",function(){setTimeout(function(){d.executeAfterEvent("paste")},10)});$(g.body).bind("undo",function(){d.executeAfterEvent("undo")});$(g.body).bind("redo",function(){d.executeAfterEvent("redo")})},411)};this.PopImgProperties=function(a){var b=["<table style='background:rgba(0,0,0,0.77);color:#f1f1f1;' border=0 width=300 height=140>"];
b.push("</tr><td colspan=2 align=center>\u8bbe\u5b9a\u56fe\u7247\u5c5e\u6027</td></tr>");b.push("<tr><td>\u5c3a\u5bf8\uff1a</td><td><input name='width' value='"+a.width+"' size=4 maxlength=4> x ");b.push("<input name='height' value='"+a.height+"' size=4 maxlength=4>");b.push("</td></tr>");b.push("<tr><td>\u6d6e\u52a8\uff1a</td><td><select name='float'><option value=''></option>");b.push("<option value='left'>\u5de6</option>");b.push("<option value='right'>\u53f3</option>");b.push("</select></td></tr>");
b.push("<tr><td>\u8fb9\u754c\uff1a</td><td><input name='margin' value='2' size=4 maxlength=2> \u50cf\u7d20 ");b.push("</td></tr>");b.push("<tr><td>\u8fb9\u754c\uff1a</td><td><input type='checkbox' name='bt'> \u8bbe\u4e3a\u6807\u9898\u56fe ");b.push("</td></tr>");b.push("</tr><td colspan=2 align=center><input type=button value='\u786e\u5b9a' id='butOk'>&nbsp;");b.push("<input type=button onclick='$(this).parentsUntil(\"div[ewa_name=DIV_FRAME]\").last().parent().hide()' value='\u5173\u95ed'></td></tr>");
b.push("</table>");var c=EWA_UI_HtmlEditorConfig.pop1(a.getAttribute("_tmp_id"),b.join(""),300,150).WND.GetFrameContent(),d=this;$(c).find("#butOk").bind("click",function(){$(this.parentNode).find("#butClose").click();var b=$(c).find("[name=width]").val();""!=b?a.width=b:$(a).attr("width",null);b=$(c).find("[name=height]").val();""!=b?a.height=b:$(a).attr("height",null);b=$(c).find("[name=float]").val();$(a).css("float",b);$(a).css("margin",$(c).find("[name=margin]").val()+"px");$(c).find("[name=bt]")[0].checked&&
(b=a.src.replace(location.origin,""),b=b.replace("//","/"),$("#NWS_HEAD_PIC").val(b),d.userSetHeaderPic&&d.userSetHeaderPic(b))})};this._CreateButton=function(a){try{return"<a href='javascript:void(0)' class='btn "+a["class"]+"' onclick='"+this.Id+".execute(this)' id='"+a.id+"' cmd='"+a.cmd+"' title='"+a.title+"'></a>"}catch(b){return console.log(a),""}};this.showCode=function(a){var b=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow,c=$("#"+this.BoxId+" iframe:eq(1)")[0].contentWindow;b=c.style_html(b.document.body.innerHTML,
4," ",80);a.setAttribute("tag","txt");c.editor?c.editor.setValue(b):(__VAL__=b,__TYPE__="html",c.aa())};this.execute=function(a){var b=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow,c=$("#"+this.BoxId+" iframe:eq(1)")[0].contentWindow,d=b.document,e=a.getAttribute("cmd");if(0==a.id.indexOf("st_"))"CreateLink"==e?d.execCommand(e,!0,null):d.execCommand(e,!1,null);else if(0==a.id.indexOf("fn_"))this[e](a);else if("eraser"==e)this.executeEraser();else if("CODE_TXT"==e){var f=a.getAttribute("tag"),
g=$("#"+this.BoxId+" iframe:eq(0)");d=$("#"+this.BoxId+" iframe:eq(1)");if(f)g.show(),d.hide(),a.setAttribute("tag",""),b.document.body.innerHTML=c.getText();else if(g.hide(),d.show(),d.attr("src0")){b=d.attr("src0");d.attr("src",b);d.removeAttr("src0");var h=this;this._WAIT_CODE_LOAD_COMPLETE=setInterval(function(){"complete"==c.document.readyState&&(window.clearInterval(h._WAIT_CODE_LOAD_COMPLETE),h._WAIT_CODE_LOAD_COMPLETE=null,h.showCode(a))},100)}else this.showCode(a)}else"IMG"==a.id?insertImg(window):
("CreateLink"==a.id?b.document.execCommand(a.id,!0,null):b.document.execCommand(a.id,!1,null),b.document.body.focus());this.executeAfterEvent(e)};this.executeEraser=function(){var a=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow.document.body;$(a).find("p,h1,h2,h3,h4,h5").each(function(){0==$(this).find("img").length&&(this.innerText=this.innerText,""==this.innerText.trimEx()&&$(this).remove())});$(a).find("div,font,span,a").each(function(){0==$(this).find("img").length&&""==this.innerText.trimEx()&&
$(this).remove()});$(a).find("script").remove();$(a).find("style").remove();$(a).find("link").remove();$(a).find("meta").remove();$(a).find("title").remove();$(a).find("colgroup").remove();$(a).find("*").attr("style",null).attr("class",null).attr("face",null).attr("size",null).attr("href",null).attr("onerror",null).attr("onload",null).attr("onclick",null).attr("onmousedown",null).attr("onmouseover",null).attr("onmouseout",null).attr("color",null).attr("className",null);this.OBJ_REPLACE.value=a.innerHTML=
a.innerHTML.replace(/\x3c!--[\w\W\r\n]*?--\x3e/gim,"")};this.executeAfterEvent=function(a,b){var c=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow.document.body;if("init"!=a||"ok"!=b)this.OBJ_REPLACE.value=c.innerHTML;this.userAfterEvent&&this.userAfterEvent(a,b,c)};this.userAfterEvent=function(a,b,c){}}
function EWA_MiscPasteToolClass(){this.target=document.body;this.handleUrl=null;this.images=[];this.paste=function(a){if((a=a.originalEvent)&&a.clipboardData&&a.clipboardData.items&&0<a.clipboardData.items.length)for(var b=0;b<a.clipboardData.items.length;b++){var c=a.clipboardData.items[b];if("image/png"==c.type)this.processAsPaste(c);else if("text/html"==c.type){var d=this;a.clipboardData.getData("text/html")&&setTimeout(function(){d.processAsHtml();d.process()},311);break}}};this.processAsPaste=
function(a){var b=new FileReader,c=this;b.onloadend=function(){var a=null,b={};$(c.target).find("img").each(function(){b[this.src]=!0});c.target.ownerDocument.execCommand("InsertImage",!1,this.result);$(c.target).find("img").each(function(){null!=a||b[this.src]||(a=this)});if(a){var f=c.tmpId(a);c.images.push({id:f,src:a.src,mode:"base64"});c.process()}else console.log("not img")};b.readAsDataURL(a.getAsFile())};this.processAsHtml=function(){var a=this.target,b=this;$(a).find("img").each(function(){if(!this.getAttribute("_tmp_id")){var a=
b.tmpId(this);this.src&&0!=this.src.indexOf(location.origin)&&b.images.push({id:a,src:this.src,mode:0==this.src.indexOf("data:image")?"base64":"normal"})}});this.processRemoveComments();$(a).find("*").each(function(){var a=$(this).css("background-image");a&&(a=a.replace("url(","").replace(")",""))&&a.startsWith("http://")&&b.images.push({id:EWA_MiscPasteTool.tmpId(this),src:a,mode:"background"});$(this).attr({onclick:null,onload:null,onkeydown:null,onkeyup:null,onerror:null,onmousedown:null,onmouseout:null,
onmouseover:null,onkeypress:null,onblur:null,onscroll:null})})};this.processRemoveComments=function(a){null==a&&(a=this.target);var b=[],c;for(c in a.childNodes){var d=a.childNodes[c];8==d.nodeType||"SCRIPT"==d.tagName||"LINK"==d.tagName||"STYLE"==d.tagName||"IFRAME"==d.tagName?b.push(d):"SPAN"==d.tagName&&(GetInnerText(d)||b.push(d))}for(c in b)a.removeChild(b[c]);for(c in a.childNodes)d=a.childNodes[c],1==d.nodeType&&d.childNodes&&this.processRemoveComments(d)};this.tmpId=function(a){if(a.getAttribute("_tmp_id"))return a.getAttribute("_tmp_id");
var b=("r_"+Math.random()).replace(".","");a.setAttribute("_tmp_id",b);$(a).css("max-width","100%");return b};this.process=function(){if(0!=this.images.length){var a={d:JSON.stringify(this.images)};this.images=[];var b=this;$JP(this.handleUrl,a,function(a){if(a.rst)for(var c=0;c<a.rsts.length;c++){var e=a.rsts[c],f=e.id,g=e.local;"background"==e.mode?$(b.target).find('[_tmp_id="'+f+'"]').css("background-image","url("+g+")"):$(b.target).find('img[_tmp_id="'+f+'"]').attr("src",g)}else $Tip("\u5904\u7406\u9519\u8bef");
b.handleUrlAfterEvent&&b.handleUrlAfterEvent(a)})}};this.bind=function(a,b,c){if(b){this.handleUrl=b;this.images=[];this.target=a;var d=this;$(document).ready(function(){$(a).bind("paste",function(a){d.paste(a)})});this.handleUrlAfterEvent=c?c:null}else alert("\u8bf7\u5b9a\u4e49\u63d0\u4ea4\u5730\u5740")}}
function EWA_UI_MapClass(a,b){this.cfg=a;this._FromId=b;this.showFull=function(){var a="div$"+this._FromId+"$MAP1",b=a+"d";if(!$X(a)){var e="<div class='ewa-map-full' id='"+a+"'><div class='ewa-map-full-cnt' id='"+b+"'></div><p title='\u9000\u51fa\u5168\u5c4f' onclick='$(this.parentNode).hide();' class='fa fa-power-off' id='"+a+"1p'></p></div>";$("body").append(e)}$($X(a)).show();this.gps1=new EWA_GMapClass;this.gps1.init(14);e=this.getLngLat();a=e[0];e=e[1];a&&e?this.gps1.showMap(b,a,e,$X(this._FromId).value):
this.search_addr($X(this._FromId),this.gps1,b)};this.getLngLat=function(){if(this.cfg.lng)var a=$X(this.cfg.lng).value;else(a=$($X(this._FromId+"_LNG")).val())||(home_lang=$($X(this._FromId.split("_")[0]+"_LNG")).val());if(this.cfg.lat)var b=$X(this.cfg.lat).value;else(b=$($X(this._FromId+"_LAT")).val())||(b=$($X(this._FromId.split("_")[0]+"_LAT")).val());return[a,b]};this.init=function(){var a=this._FromId+"$MAPClass",b="div$"+this._FromId+"$MAP",e=this;addEvent($X(this._FromId),"blur",function(){e.search_addr(this,
e.gps,b)});var f=$X(this._FromId).parentNode.parentNode,g=f.parentNode.insertRow(f.rowIndex+1).insertCell(-1);g.innerHTML="<div class='ewa-map-small'><div class='ewa-map-small-cnt' id='"+b+"'></div><div class='ewa-map-full-but' title='\u5168\u5c4f\u67e5\u770b' onclick='"+a+".showFull()'><b class='fa fa-square-o'></b></div></div>";g.colSpan=f.cells.length;g.className="ewa-map-small-td";this.gps=new EWA_GMapClass;this.gps.init(10);f=this.getLngLat();a=f[0];f=f[1];a&&f?this.gps.showMap(b,a,f,$X(this._FromId).value):
this.search_addr($X(this._FromId),this.gps,b)};this.setSearchResult=function(a,b,e){this.cfg.lng?$X(this.cfg.lng).value=a.Q_LNG:($X(this._FromId+"_LNG")&&($X(this._FromId+"_LNG").value=a.Q_LNG),$X(this._FromId.split("_")[0]+"_LNG")&&($X(this._FromId.split("_")[0]+"_LNG").value=a.Q_LNG));this.cfg.lat?$X(this.cfg.lat).value=a.Q_LAT:($X(this._FromId+"_LAT")&&($X(this._FromId+"_LAT").value=a.Q_LAT),$X(this._FromId.split("_")[0]+"_LAT")&&($X(this._FromId.split("_")[0]+"_LAT").value=a.Q_LAT));this.cfg.zip?
$X(this.cfg.zip).value=a.Q_ZIP||"":($X(this._FromId+"_ZIP")&&($X(this._FromId+"_ZIP").value=a.Q_ZIP),$X(this._FromId.split("_")[0]+"_ZIP")&&($X(this._FromId.split("_")[0]+"_ZIP").value=a.Q_ZIP));this.cfg.province?$X(this.cfg.province).value=a.Q_STATE||"":($X(this._FromId+"_STATE")&&($X(this._FromId+"_STATE").value=a.Q_STATE),$X(this._FromId.split("_")[0]+"_STATE")&&($X(this._FromId.split("_")[0]+"_STATE").value=a.Q_STATE));this.cfg.city&&($X(this.cfg.city).value=a.Q_CITY||"");this.cfg.country&&($X(this.cfg.country).value=
a.Q_COUNTRY||"");e=b.showMap(e,a.Q_LNG,a.Q_LAT,a.Q_SEARCH);b.map.setCenter(e);this.searchResultAfter&&this.searchResultAfter(a)};this.search_addr=function(a,b,e){a=a.value;if(""!=a){var c=this;a=[a];c.cfg.city&&a.push($X(c.cfg.city).value);c.cfg.province&&a.push($X(c.cfg.province).value);c.cfg.country&&a.push($X(c.cfg.country).value);a=a.join(", ");b.getGpsFromAddress(a,function(a,d,f){c.setSearchResult(f,b,e)})}}}
function EWA_UI_PicViewClass(){this.id=("EWAUIPicView"+Math.random()).replace(".","Gdx");this.t_start=-1;this.dist_base=0;this.is_move=!1;this.table=null;this.prevIdx=-1;this.setImg=function(a){$(a).attr("mw",a.width).attr("mh",a.height).css("margin-left",0).css("margin-top","0");$(a).parent().css("background-image","none")};this.addPic=function(a){var b=this.table.rows[0].cells.length,c=this.table.rows[0].insertCell(b);c.align="center";var d="<img style='max-width:100%;max-height:100%' onload='"+
this.id+".setImg(this)' id='"+(this.id+"_"+b)+"' ";d+=" src1='"+a+"'>";$(c).hide().css({"background-image":"url('/static/images/loading2.gif')","background-position":"center center","background-repeat":"no-repeat"});c.innerHTML=d;$(this.table1).find("td").append("<b>&bull;</b>");0==b?this.changePhoto(0):$(this.table1).show();this.total=b+1};this.changePhoto=function(a){if(this.prevIdx!=a){if(0<=this.prevIdx){var b=$("#"+this.id+"_"+this.prevIdx);$(b).parent().hide();$(this.table1).find("b:eq("+this.prevIdx+
")").css("color","#ccc")}this.prevIdx=a;b=$("#"+this.id+"_"+a);if(b.attr("src1"))b.attr("src",b.attr("src1")),b.attr("scr1",""),b[0].setAttribute("src1","");else{try{if(b.attr("mw")){var c=1*b.attr("mw");b.attr("mh");b.css("width",c).css("height".mh)}}catch(d){console.log(d)}b.css("margin-left",0).css("margin-top",0).attr("r",null).attr("rold",null).css("transform","scale(1)")}b.parent().show();$(this.table1).find("b:eq("+a+")").css("color","yellow")}};this.close=function(){$(this.table).parent().remove();
delete window[this.id]};this.create=function(){window[this.id]=this;var a=document.createElement("div"),b=document.createElement("table");b.insertRow(-1);var c=document.createElement("table");c.insertRow(-1).insertCell(-1).align="center";var d=document.createElement("div");d.innerHTML="<b class='fa fa-close'></b>";$(a).css({position:"fixed",top:0,left:0,width:"100%",height:"100%","z-index":99999999,background:"rgba(0, 0, 0, 0.9)"});$(b).css({position:"absolute",left:0,top:0,height:"100%",width:"100%",
"table-layout":"fixed"});$(c).css({position:"absolute",left:0,height:30,width:"100%",overflow:"hidden",bottom:"5px","z-index":3,color:"#ccc","font-size":"30px",display:"none"});$(d).css({position:"absolute",right:20,top:30,height:40,width:40,"line-height":"40px",overflow:"hidden","z-index":4,color:"darkred","font-size":"30px","text-align":"center",display:"block"}).attr("onclick",this.id+".close()");this.table=b;this.table1=c;$(a).append(b);$(a).append(c);$(a).append(d);$("body").append(a);var e=
this;b.ontouchstart=function(a){1==a.targetTouches.length?e.t_start=a:2==a.targetTouches.length&&(e.t_start1=a,e.dist_base=0);e.is_move=!1;a.preventDefault();a.stopPropagation()};b.ontouchmove=function(a){if(2==a.targetTouches.length){e.t_start1a=a;var b=a.targetTouches[0].pageX-e.t_start1.pageX,c=a.targetTouches[0].pageY-e.t_start1.pageY,d=a.targetTouches[1].pageX-e.t_start1.pageX,f=a.targetTouches[1].pageY-e.t_start1.pageY;c=Math.sqrt((b-d)*(b-d)+(c-f)*(c-f));0==e.dist_base?e.dist_base=c:(c/=e.dist_base,
b=$(a.target).attr("rold"),c*=b?1*b:1,1>=c&&(c=1),5<c&&(c=5),$(a.target).css("transform","scale("+c+")").attr("r",c),1==c&&$(a.target).css("margin-left",0).css("margin-top",0))}else if(1==a.targetTouches.length){c=$(a.target).attr("r");if(null==c||1==c)return;b=a.pageX-e.t_start.pageX;c=a.pageY-e.t_start.pageY;f=1*$(a.target).css("margin-left").replace("px","");d=1*$(a.target).css("margin-top").replace("px","");b=f+b;c=d+c;$(a.target).css("margin-left",b).css("margin-top",c);e.t_start=a;e.is_move=
!0}a.preventDefault();a.stopPropagation()};b.ontouchend=function(a){a.preventDefault();a.stopPropagation();if(e.t_start){var b=a.pageX-e.t_start.pageX,c=a.timeStamp-e.t_start.timeStamp;-50>b&&244>c?(b=e.prevIdx,b++,b==e.total&&(b=0),e.changePhoto(b)):50<b&&244>c?(b=e.prevIdx,b--,0>b&&(b=e.total-1),e.changePhoto(b)):10>Math.abs(b)&&150>c&&!e.is_move&&e.click_page()}console.log(e.t_start1);e.t_start1&&(b=$(a.target).attr("r"),console.log(b),$(a.target).attr("rold",b));e.t_start=null;e.t_start1=null}}}
function EWA_UI_H5FrameSet(){this.Create=function(a,b){this.Id=a;this.FrameType=b;this.LOC_ID="EWA_UI_H5FrameSet_"+this.Id;this.ParentDiv=$("#F0_"+this.Id).parent();this.objOne=this.ParentDiv.find(".ewa-frameset-one");this.objTwo=this.ParentDiv.find(".ewa-frameset-two");this.objSplit=this.ParentDiv.find(".ewa-frameset-split");this.objCover=this.ParentDiv.find(".ewa-frameset-cover");"H5"==b?this.CreateMoveH5():this.CreateMoveV5();window.localStorage[this.LOC_ID]&&this.ChangeLocation(1*window.localStorage[this.LOC_ID])};
this._GetMoveInstance=function(){if(window.__EWA_MOVE_EWA_UI_H5FrameSetInstance)return window.__EWA_MOVE_EWA_UI_H5FrameSetInstance;window.__EWA_MOVE_EWA_UI_H5FrameSetInstance=new EWA.UI.Move;window.__EWA_MOVE_EWA_UI_H5FrameSetInstance.NAME="__EWA_MOVE_EWA_UI_H5FrameSetInstance";window.__EWA_MOVE_EWA_UI_H5FrameSetInstance.Init(window.__EWA_MOVE_EWA_UI_H5FrameSetInstance);return window.__EWA_MOVE_EWA_UI_H5FrameSetInstance};this.CreateMoveV5=function(){this.mv1=this._GetMoveInstance();var a=this.objSplit[0],
b=this;this.mv1.AddMoveObjectY(a,a,function(a){b.objCover.hide();b.objSplit.css("z-index",1)},document.body,function(a,d){a=1*$(a).css("top").replace("px","");b.ChangeLocation(a);window.localStorage[b.LOC_ID]=a},function(){b.objCover.show()})};this.CreateMoveH5=function(){this.mv1=this._GetMoveInstance();var a=this.objSplit[0],b=this;this.mv1.AddMoveObjectX(a,a,function(a){b.objCover.hide();b.objSplit.css("z-index",1)},document.body,function(a,d){a=1*$(a).css("left").replace("px","");b.ChangeLocation(a);
window.localStorage[b.LOC_ID]=a},function(){b.objCover.show()})};this.ChangeLocation=function(a){"H5"==this.FrameType?(this.objOne.css("width",a),this.objTwo.css("left",a+1),this.objSplit.css("left",a)):(this.objOne.css("height",a),this.objTwo.css("top",a+1),this.objSplit.css("top",a))}}
var EWA_UI_Dock={dockObj:null,dockTitleObj:null,menuMap:{},init:function(a){var b=["<div class='ewa-dock'><table class='ewa-dock-table'><tr>"],c;for(c in a){var d=a[c],e=EWA_Utils.tempId("_EWA_UI_Dock_");this.menuMap[e]=d;var f=this.getMenuText(d);f=this.filterHtml(f);b.push("<td class='ewa-dock-item-td' ><div class='ewa-dock-item-div' id='"+e+"' _title=\""+f+"\" onclick='EWA_UI_Dock.click(this)' onmouseover='EWA_UI_Dock.showTitle(this)' onmouseout='EWA_UI_Dock.hideTitle(this)'><div class='ewa-dock-item-icon "+
d.ICON+"'></div></div></td>")}b.push("</tr></table></div>");this.dockObj=$(b.join(""));this.dockTitleObj=$('<div class="ewa-dock-title" style="display: none;"><div>--</div><p></p></div>');$("body").append(this.dockObj).append(this.dockTitleObj)},click:function(a){var b=this.menuMap[a.id];b||console.log("menu ["+a.id+"]?");b.CMD?b.CMD instanceof Function?b.CMD(a):eval(b.CMD):console.log("NO CMD in menu",b)},getMenuText:function(a){return a.TEXT},filterHtml:function(a){return a.replace(/</ig,"&lt;").replace(/>/ig,
"&gt;").replace(/"/ig,"&quot;")},showTitle:function(a){if(""==a.getAttribute("_title")||null==a.getAttribute("_title")){var b=a.title;if(""==b||null==b)return;a.setAttribute("_title",b);a.title=""}this.dockTitleObj.find("div:eq(0)").html(a.getAttribute("_title"));b=$(a).offset();a=$(a).width();var c=this.dockTitleObj.height(),d=this.dockTitleObj.width();this.dockTitleObj.css("top",b.top-c-8);this.dockTitleObj.show();this.dockTitleObj.css("left",b.left-(d-a)/2)},hideTitle:function(){this.dockTitleObj.hide()}},
EWA_Behavior={RELOAD_PARENTA:function(a){var b=window.parent;try{b.EWA.F.FOS[a]&&b.EWA.F.FOS[a].Reload?b.EWA.F.FOS[a].Reload():b.location=b.location.href}catch(c){b.location=b.location.href}},RELOAD_PARENT:function(a){if(null!=window._EWA_DialogWnd){var b=_EWA_DialogWnd._OpenerWindow;if(null==b.EWA.F.FOS)_EWA_DialogWnd.CloseWindow(),b.location.href=b.location.href;else try{b.EWA.F.FOS[a]&&b.EWA.F.FOS[a]?b.EWA.F.FOS[a].Reload(window.location.href):b.location=b.location.href}catch(c){b.location=b.location.href}}},
CLOSE_SELF:function(){null==window._EWA_DialogWnd?self.close():_EWA_DialogWnd.CloseWindow()},CLEAR_SELF:function(){self.document.forms[0].reset()}};
function EWA_PostBehavior(a,b){if(0>a.indexOf("RELOAD_PARENTA"))try{if(!window._EWA_DialogWnd){console.log("not parent window");return}if(window.STOP_RELOAD){window.STOP_RELOAD=!1;return}var c=_EWA_DialogWnd._OpenerWindow,d=c.__Dialog[b];d&&null!=d.AfterMsg&&0<d.AfterMsg.length&&c.EWA.UI.Msg.Alert(d.AfterMsg,_EWA_INFO_MSG["EWA.SYS.CHOOSE_ITEM_TITLE"])}catch(e){console.log(e)}a=a.split(",");for(c=0;c<a.length;c+=1)EWA_Behavior[a[c]](b)}EWA.UI.Ext=EWA.UI.Ext||{};
EWA.UI.Ext.FileIco=function(a){null==EWA.RV_STATIC_PATH&&console.log("EWA.RV_STATIC_PATH not defined! (EWA.UI.Ext.FileIco )");var b=EWA.RV_STATIC_PATH+"/EWA_STYLE/images/file_png/",c="gnote.png";null==a&&(a="");a=a.toLowerCase();0>a.indexOf(".")&&(a="."+a);".doc"==a||".docx"==a?c="MSWD.png":".xls"==a||".xlsx"==a?c="XCEL.png":".ppt"==a||".pptx"==a?c="PPT3.png":".txt"==a||".cvs"==a||".pom"==a?c="Edit.png":".zip"==a||".rar"==a||".7z"==a?c="zip.png":".pdf"==a?c="ACR_App.png":".odt"==a?c="openoffice.png":
".html"==a&&(c="html.png");return b+c};EWA.UI.Ext.FileExt=function(a){if(null==a)return"";a=a.toLowerCase();var b=a.lastIndexOf("."),c="";0<b&&(c=a.substring(b));return c};EWA.UI.Ext.FileLen=function(a){return null==a||isNaN(a)?a||"":1073741824<a?Math.round(a/1073741824*100)/100+"G":1048576<a?Math.round(a/1048576*100)/100+"M":1024<a?Math.round(a/1024*100)/100+"K":a+"B"};
EWA.UI.Ext.Mobile=function(a){if(a){var b=a.id||"R"+Math.random();a.id=b;b="__mobile_"+b;$(a).attr("mobile_id",b);if(!$X(b)){var c=[];c.push("<table class='ewa-text-help-box' border=0 cellpadding=3 cellspacing=0 id='"+b+"'>");c.push("<tr><td>");c.push(EWA.UI.Ext.IdCard1(3));c.push("</td><td>-</td><td>");c.push(EWA.UI.Ext.IdCard1(4));c.push("</td><td>-</td><td>");c.push(EWA.UI.Ext.IdCard1(4));c.push("</td><td><i></i></td></tr></table>");$("body").append(c.join(""));c=$X(b);$(c).find("td").css("background-color",
"#fff").attr("align","center");$(a).attr("maxLength",11)}c=$X(b);addEvent(a,"focus",function(){var a=$(this).attr("mobile_id");a=$($X(a)).show();a.css("top",$(this).offset().top-a.height()-7);a.css("left",$(this).offset().left);EWA.UI.Ext.Mobile2(this)});addEvent(a,"blur",function(){var a=$(this).attr("mobile_id");$($X(a)).hide()});addEvent(a,"keyup",function(){EWA.UI.Ext.Mobile2(this)})}};
EWA.UI.Ext.Mobile2=function(a){var b=$(a).attr("mobile_id");b=$($X(b));a=a.value;var c=b.find("div");c.html("");for(var d=!0,e=0;e<a.length;e++){var f=a.substring(e,e+1),g="";isNaN(f)&&(g="red",d=!1);c[e]&&(c[e].innerHTML="<span style='font-size:16px;color:"+g+"'>"+f+"</span>")}a.length==c.length&&d?b.find("i").html("<font color=green>\u6b63\u786e</font>"):b.find("i").html("<font color=red>\u9519\u8bef</font>")};
EWA.UI.Ext.IdCard=function(a){if(a){var b=a.id||"R"+Math.random();a.id=b;b="__sfz_"+b;$(a).attr("sfz_id",b);if(!$X(b)){var c=[];c.push("<table class='ewa-text-help-box' border=0 cellpadding=1 cellspacing=1 id='"+b+"'>");c.push("</tr><td height=18>\u5730\u533a</td><td >\u5e74</td><td>\u6708</td><td>\u65e5</td><td>\u987a\u5e8f\u53f7</td></tr>");c.push("<tr><td>");c.push(EWA.UI.Ext.IdCard1(6));c.push("</td><td>");c.push(EWA.UI.Ext.IdCard1(4));c.push("</td><td>");c.push(EWA.UI.Ext.IdCard1(2));c.push("</td><td>");
c.push(EWA.UI.Ext.IdCard1(2));c.push("</td><td>");c.push(EWA.UI.Ext.IdCard1(4));c.push("</td></tr><tr><td colspan=5>\u72b6\u6001 <i></i></td></tr></table>");$("body").append(c.join(""));c=$X(b);$(c).find("td").css("background-color","#fff").attr("align","center");$(a).attr("maxLength",18)}c=$X(b);addEvent(a,"focus",function(){var a=$(this).attr("sfz_id");a=$($X(a)).show();a.css("top",$(this).offset().top-a.height()-8);a.css("left",$(this).offset().left);EWA.UI.Ext.IdCard2(this)});addEvent(a,"blur",
function(){var a=$(this).attr("sfz_id");$($X(a)).hide()});addEvent(a,"keyup",function(){EWA.UI.Ext.IdCard2(this)})}};EWA.UI.Ext.IdCard1=function(a){for(var b=[],c=0;c<a;c++)b.push("<div></div>");return b.join("")};
EWA.UI.Ext.IdCard2=function(a){var b=[1,31,28,31,30,31,30,31,31,30,31,30,31],c=$(a).attr("sfz_id");c=$($X(c)).show();var d=a.value,e=c.find("div");e.html("");for(var f=!0,g=[],h=[],k=[],m=[],l=0;l<d.length;l++){var n=d.substring(l,l+1),q="";6>l?g.push(n):6<=l&&10>l?h.push(n):10<=l&&12>l?k.push(n):12<=l&&14>l&&m.push(n);17>l?isNaN(n)&&(q="red",f=!1):"x"!=n&&"X"!=n&&isNaN(n)&&(q="red",f=!1);e[l]&&(e[l].innerHTML="<span style='font-size:16px;color:"+q+"'>"+n+"</span>")}g=h.join("");h=[];if(isNaN(g))f=
!1,h.push("\u5e74:"+g);else{if(1900>g||2100<g){f=!1;for(l=6;10>l;l++)$(e[l]).find("span").css("color","red");h.push("\u5e74:"+g)}b[2]=0==(g-1996)%4?29:28}k=k.join("");ismonth1=!0;if(isNaN(k))f=ismonth1=!1,h.push("\u6708:"+k);else if(1>k||12<k){ismonth1=f=!1;for(l=10;12>l;l++)$(e[l]).find("span").css("color","red");h.push("\u6708:"+k)}m=m.join("");if(isNaN(m))f=!1;else if(ismonth1&&(1>m||m>b[1*k])){f=!1;for(l=12;14>l;l++)$(e[l]).find("span").css("color","red");h.push("\u65e5:"+m)}d.length==e.length&&
f?(c.find("i").html("<font color=green>\u6b63\u786e</font>"),b={YEAR:g,MONTH:k,DAY:m,SEX:1*$(e[16]).text()%2},$(a).attr("sfz_json",JSON.stringify(b))):c.find("i").html("<font color=red>"+h.join(", ")+"\u9519\u8bef</font>")};

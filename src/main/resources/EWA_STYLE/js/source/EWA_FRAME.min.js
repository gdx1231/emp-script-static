var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){a=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}return globalThis};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");"undefined"==typeof EWA&&(EWA={});
EWA.F={FOS:{},GetFOSOne:function(){for(var a in EWA.F.FOS)return EWA.F.FOS[a]},getSubEwas:function(a){var b=[];$(a).find(".EWA_TABLE").each(function(){var a=$(this).attr("id");a&&(a=a.replace("EWA_FRAME_","").replace("EWA_LF_",""),(a=EWA.F.FOS[a])&&b.push(a))});return b},U:{WND:null},Cmd:function(){this.EWA_ACTION=null;this.EWA_NO_CONTENT=this.EWA_AJAX="1";this.EWA_TREE_TEXT=this.EWA_TREE_PARENT_KEY=this.EWA_TREE_KEY=null;this.EWA_AFTER_EVENT=""},Install:function(a,b,c,d,e){b=(window.EWA_CGI?window.EWA_CGI:
EWA.CP+"/EWA_STYLE/cgi-bin/")+"?xmlName="+b+"&itemName="+c+"&EWA_FRAMESET_NO=1&EWA_AJAX=INSTALL&"+d;(new EWA.C.Ajax).Install(b,"_r=1",a,e)},InstallHtml:function(a,b,c){var d=$X(a);if(null==d)alert("Object ["+a+"] not found");else{d.innerHTML=b;try{EWA.C.Utils.JsRegisters(rst)}catch(e){console.log(e)}if(null!=c)try{c(a)}catch(e){console.log(e)}}}};
EWA.F.POP={AJAX:null,PostBehavior:function(a,b,c){var d=EWA.F.FOS[a];if(null==d)alert("Object EWA.F.FOS."+a+" not exists!");else if(d=null==d.Url?d._Url:d.Url,null==d)alert("Object EWA.F.FOS."+a+".Url not exists!");else{a="EWA_AJAX=1&EWA_NO_CONTENT=1&EWA_ACTION="+c;if(null!=b)for(c=0;c<b.length;c+=1){var e=b[c].Name,f=b[c].Value;null!=e&&""!=e&&null!=f&&""!=f&&(f=encodeURIComponent(f),a=a+"&"+e+"="+f)}EWA.F.POP.AJAX=new EWA.C.Ajax;EWA.F.POP.AJAX.LoadingType="image";EWA.F.POP.AJAX.Post(d,a,EWA.F.POP.CallBack)}},
CallBack:function(){var a=EWA.F.POP.AJAX;if(4==a._Http.readyState)if(a.HiddenWaitting(),200==a._Http.status){if(a=a._Http.responseText,EWA.F.CheckCallBack(a))try{eval(a)}catch(b){alert(a)}}else alert("ERROR:\r\n"+a._Http.statusText)}};
EWA.F.CheckCallBack=function(a){if(0<=a.indexOf("\x3c!--EWA_ERROR_INFOMATION--\x3e")){if(1==EWA.SHOW_ERROR){var b=EWA.UI.Dialog.OpenWindow("","ERROR",800,400),c=b.GetIframeWindow();c.document.designMode="on";c.document.open();c.document.write(a);c.document.close();c.document.designMode="off";b.SetCaption("ERROR Information")}return!1}return!0};EWA.F.ST={};
EWA.F.ST.SaveStatus=function(a,b){var c=EWA.CP+"/EWA_STYLE/cgi-bin/_st_/";c=c.replace("//","/");var d=new EWA.C.Ajax;d.AddParameter("U",document.location.href);d.AddParameter("T",b);d.AddParameter("V",a);d.AddParameter("M","1");d.PostNew(c,function(){});d.HiddenWaitting()};
EWA.F.ST.GetStatus=function(a,b){var c=EWA.CP+"/EWA_STYLE/cgi-bin/_st_/";c=c.replace("//","/");EWA.F.ST.Ajax=new EWA.C.Ajax;EWA.F.ST.Ajax.AddParameter("U",document.location.href);EWA.F.ST.Ajax.AddParameter("T",a);EWA.F.ST.Ajax.AddParameter("M","0");EWA.F.ST.Ajax.FrameClass=b;EWA.F.ST.Ajax.PostNew(c,EWA.F.GetStatusCallBack)};
EWA.F.GetStatusCallBack=function(){var a=EWA.F.ST.Ajax;4==a._Http.readyState&&(a.HiddenWaitting(),200==a._Http.status?(eval(a._Http.responseText),a.FrameClass.LoadStatus()):alert("ERROR:\r\n"+a._Http.statusText),EWA.F.ST.Ajax=null)};
EWA.F.Ajax={TIMER_ID:null,AJAX_LIST:[],_GetId:function(a){var b=this.AJAX_LIST.length;this.AJAX_LIST[b]=a;return b},_StartMonitor:function(){null==this.TIMER_ID&&(this.TIMER_ID=window.setInterval(this._Moninter,100))},_Moninter:function(){for(var a=!0,b=0;b<EWA.F.Ajax.AJAX_LIST.length;b++){var c=EWA.F.Ajax.AJAX_LIST[b];null==c||c.isStop||EWA.F.Ajax._CallBack(c)||(a=!1)}a&&(window.clearInterval(EWA.F.Ajax.TIMER_ID),EWA.F.Ajax.TIMER_ID=null)},_CallBack:function(a){var b=a.ajax;if(4!=b._Http.readyState)return!1;
a.isStop=!0;b.HiddenWaitting();a.ret=200==b._Http.status?b._Http.responseText:"ERROR:\r\n"+b._Http.statusText;a.ReplaceObject();return!0},Install:function(a,b){this.replaceId=b;this.CLASS_NAME="EWA.F.Ajax.Install";this.ajax=new EWA.C.Ajax;this.ret=null;this.isStop=!0;this.id=EWA.F.Ajax._GetId(this);this.ajax.Get(a,function(){});this.isStop=!1;EWA.F.Ajax._StartMonitor();this.ReplaceObject=function(){$X(this.replaceId).innerHTML=this.ret;this.AddScripts()};this.AddScripts=function(){var a=this.ret.match(/<script(.|\n|\r)*?>(.|\n|\r)*?<\/script(.|\n|\r)*?>/ig);
if(null!=a)for(var b=document.getElementsByTagName("head")[0]||document.documentElement,e=0;e<a.length;e++){var f=a[e];f=f.replace(/<script(.|\n|\r)*?>/ig,"").replace(/<\/script(.|\n|\r)*?>/ig,"").trim();if(0!=f.length)try{var g=document.createElement("script");g.type="text/javascript";EWA.B.IE?g.text=f:g.appendChild(document.createTextNode(f));b.insertBefore(g,b.firstChild);b.removeChild(g)}catch(h){}}}}};
EWA.F.U.Upload=function(a,b,c){var d=new EWA.UI.Dialog.CMD;d.CmdArgus[0]=c;d.CmdArgus[1]="UPFILE";EWA.UI.Dialog.OpenWindow(EWA.CP+"/EWA_STYLE/cgi-bin/_up_/?xmlName="+a+"&ITEMNAME="+b+"&FROMITEM="+c.id,"upfile",420,310,!1,null,d)};EWA.F.Tip=function(a){var b=_EWA_INFO_MSG[a];null==b&&(b=a);null!=b&&""!=b.trim()&&alert(b)};EWA.F.I={};
EWA.F.I.DropList=function(a){null==EWA.F.FOS[a.id]&&(EWA.F.FOS[a.id]=new EWA_FrameItemClass);EWA.F.FOS[a.id].DropList(a);$(a).next().val("");a.getAttribute("_check_blank")||(a.setAttribute("_check_blank","haha"),addEvent(a,"blur",function(){if(""==$(this).next().val()){this.value="";var a=$(this).next().attr("afterevent");if(a)if(window[a])window[a]("","",$(this).next()[0],this);else try{eval(a)("","",$(this).next()[0],this)}catch(c){console.log(c)}}}))};
EWA.F.I.Date=function(a,b){EWA.F.FOS[a.id]=new EWA.UI.Calendar.Pop(a,b)};function EWA_Parameters(){this.ParaNames=[];this.ParaValues=[];this.Add=function(a,b){null!=a&&""!=a.trim()&&(this.ParaNames[this.ParaNames.length]=a.trim(),this.ParaValues[this.ParaValues.length]=b)};this.GetString=function(){for(var a="",b=0;b<this.ParaNames.length;b=1+b)0<a.length&&(a+="&"),a+=encodeURIComponent(this.ParaValues[b]);return a}}
function EWA_FrameInstallClass(a,b,c,d){this.Xml=new EWA.C.Xml;this.XmlName=b;this.ItemName=c;this.Parameters=d;this.Install=function(b){null==b&&(b=this.GetUrl());this.Xml.LoadXmlFile(b);var c=this.Xml.GetElement("FrameData"),d=this.Xml.GetElementAttribute(c,"Type"),e=this.Xml.GetElementAttribute(c,"ClassName");c=this.Xml.GetElement("Css",c);c=this.Xml.GetElementText(c);document.write(c);"TREE"==d.toUpperCase()&&(b=new EWA.F.T.C(a,e,b),eval(e+"=c"),EWA.F.FOS[e]=b,b.CreateByXml(this.Xml))};this.GetUrl=
function(){var a=EWA.CP+"/EWA_STYLE/cgi-bin/?XMLNAME=";a+=this.XmlName.toURL()+"&ITEMNAME="+this.ItemName.toURL();a+="&EWA_AJAX=XML";null!=this.Parameters&&(a+="&"+this.Parameters.GetString());return a}}
function EWA_FrameCommonItems(){this._ClassXml=null;this.Items={};this._EWA_JS_ALERT_DEFAULT={MaxMinLength:"\u957f\u5ea6\u5e94\u5728{MinLength}-{MaxLength}\u4e4b\u95f4 ",MaxMinValue:"\u503c\u5e94\u5728({MinValue} - {MaxValue})\u4e4b\u95f4",IsMustInput:"*"};this.Init=function(a){this._ClassXml=a;a=a.GetElements("root/XItem");var b=!1;if(this.F){var c=new EWA_UrlClass;c.SetUrl(this.F.Url);"M"==c.GetParameter("EWA_MTYPE")&&(b=!0)}for(c=0;c<a.length;c++){var d=this.GetItemValue(a[c],"Name","Name"),e=
d.toUpperCase(),f=a[c];this.Items[e]=f;var g=this.GetItemValue(f,"DataItem","Valid");g&&"MOBILE"==g.toUpperCase()?EWA.UI.Ext.Mobile($X(e)):g&&"IDCARD"==g.toUpperCase()&&EWA.UI.Ext.IdCard($X(e));b&&(e=this.GetItemValue(f,"DataItem","DisableOnModify"))&&"YES"==e.toUpperCase()&&(d=$X(d))&&(d.setAttribute("disabled","disabled"),d.getAttribute("DlsShow")&&$(d).prev().attr("disabled","disabled"))}};this.GetItem=function(a){a=a.toUpperCase().trim();return this.Items[a]};this.GetItemValue=function(a,b,c){if(null==
a)return null;a=this._ClassXml.GetElement(b+"/Set",a);return null==a?null:a.getAttribute(c)};this.GetDescription=function(a){a=$(this.GetItem(a)).find("DescriptionSet Set[Lang="+EWA.LANG+"]");return{Info:a.attr("Info"),Memo:a.attr("Memo")}};this.GetValue=function(a,b,c){a=this.GetItem(a);return this.GetItemValue(a,b,c)};this.CheckValid=function(a,b){if("SPAN"==a.tagName||"IMG"==a.tagName)return!0;var c=this.GetItem(a.id),d=[];if(null==b)return!0;var e=this._CheckMustInput(a,b,c);e?d.push(e):EWA_FrameRemoveAlert(a);
(e=this._CheckMaxMinLength(a,b,c))?d.push(e):EWA_FrameRemoveAlert(a);(e=this._CheckDataValid(a,b,c))?d.push(e):EWA_FrameRemoveAlert(a);(e=this._CheckDataType(a,b,c))?d.push(e):EWA_FrameRemoveAlert(a);(e=this._CheckMaxMinValue(a,b,c))?d.push(e):EWA_FrameRemoveAlert(a);(e=this._CheckPassword(a,b,c))?d.push(e):EWA_FrameRemoveAlert(a);(e=this._CheckExtent(a,b,c))?d.push(e):EWA_FrameRemoveAlert(a);if(0==d.length)return EWA_FrameRemoveAlert(a),!0;EWA_FrameShowAlert(a,d.join(", "));return!1};this._CheckExtent=
function(a,b,c){b=null;a=a.getAttribute("EWA_VALID_EX");a=null==a?"":a;0<a.length&&(b=a);return b};this._CheckDataType=function(a,b,c){if(""==b.trim())return null;var d=null;c=this.GetItemValue(c,"DataItem","DataType");null==c||"NUMBER"!=c.toUpperCase()&&"INT"!=c.toUpperCase()||(0<=b.indexOf(",")&&(b=b.replace(/,/ig,""),a.value=b),/^[0-9.-]{0,120}$/.test(b)||(d=_EWA_INFO_MSG["EWA.SYS.INVALID_NUMBER_FORMAT"]));return d};this._CheckPassword=function(a,b,c){if("input"!=a.tagName.toLowerCase()||"password"!=
a.type.toLowerCase())return null;c=$("#USR_PWD").parentsUntil("form").last().find("input[type=password]");b=null;for(var d=a.id,e=0;e<c.length;e+=1)if("password"==c[e].type&&c[e]!=a&&c[e].id==d+"1"){b=c[e];break}c=null;null!=b&&(b.value!=a.value?(isok=!1,c=_EWA_INFO_MSG["EWA.F.PASSWORD"]):EWA_FrameRemoveAlert(b));return c};this._CheckMustInput=function(a,b,c){var d=null;"1"==this.GetItemValue(c,"IsMustInput","IsMustInput")&&0==b.length&&(d=(d=_EWA_JS_ALERT.IsMustInput)?d.replace("{Name}",a.id):"*");
return d};this._CheckMaxMinLength=function(a,b,c){if(!b)return null;var d=this.GetItemValue(c,"MaxMinLength","MaxLength");c=this.GetItemValue(c,"MaxMinLength","MinLength");d=null==d?-1:parseInt(d);c=null==c?-1:parseInt(c);var e=!0;!isNaN(d)&&0<d&&b.length>d&&(e=!1);e&&!isNaN(c)&&0<c&&b.length<c&&(e=!1);b=null;e||(b=_EWA_JS_ALERT.MaxMinLength||this._EWA_JS_ALERT_DEFAULT.MaxMinLength,b=b.replace("{Name}",a.id),b=b.replace("{MaxLength}",d),b=b.replace("{MinLength}",c));return b};this._CheckDataValid=
function(a,b,c){a=this.GetItemValue(c,"DataItem","Valid");if(null==a||""==a.trim())return"";if(0<b.length)return a=_EWA_VALIDS[a.toUpperCase().trim()],null==a?"":a.REGEX.test(b)?"":a.MSG};this._CheckMaxMinValue=function(a,b,c){a=this.GetItemValue(c,"MaxMinValue","MaxValue");c=this.GetItemValue(c,"MaxMinValue","MinValue");var d=null==a||""==a.trim()?null:1*a,e=null==c||""==c.trim()?null:1*c,f=!0;null!=d&&(f=1*b<=d?!0:!1);null!=e&&(f=1*b>=e?f&1:!1);if(f)return"";errorInfo=_EWA_JS_ALERT.MaxMinValue||
this._EWA_JS_ALERT_DEFAULT.MaxMinValue;errorInfo=errorInfo.replace("{MaxValue}",a);return errorInfo=errorInfo.replace("{MinValue}",c)};this.GetObjectValue=function(a){var b=a.tagName.toUpperCase(),c=a,d="";if("DIV"==b&&"REPT"==a.getAttribute("TAG")){a=a.getElementsByTagName("input");for(var e=0;e<a.length;e+=1)a[e].checked&&(0<d.length&&(d+=","),d+=a[e].value);return d}if("DIV"==b&&"1"==a.getAttribute("EWA_DHTML"))return d=a.getElementsByTagName("iframe")[0].contentWindow,c=d.document.getElementsByTagName("textarea"),
d=0<c.length&&"none"!=c[0].style.display?c[0].value:d.frames[0].document.body.innerHTML,null!=location.search&&0>location.search.toUpperCase().indexOf("EWA_DHTML_HOST")&&(e="http:\\/\\/"+eval("document.location.host")),e=eval("/"+e+"/ig"),d=d.replace(e,""),a=a.getElementsByTagName("input")[0],a.value=d,a.value;if("SELECT"==b)return d="",0<=c.options.selectedIndex&&(d=c.options[c.options.selectedIndex].value),d;if("TEXTAREA"==b&&"none"==c.style.display)d=a.value;else if("INPUT"==b&&"IMG_UPLOAD"==c.getAttribute("ewa_tag"))d=
"/"!=EWA.CP?c.value.replace(EWA.CP,""):c.value,d=d.replace("//","/");else if("INPUT"==b&&"ht5upload"==c.getAttribute("ewa_tag")){a=c.getAttribute("val_ref");try{d=eval("(function(){var a="+a+";return a;})()")}catch(f){console.log(a),console.log(f),d=""}}else d="INPUT"!=b||"checkbox"!=c.type&&"radio"!=c.type?c.value:c.checked?c.value:"";return d}}function EWA_FrameResourceDescription(){this.Memo=this.Info=this.Lang=null}
function EWA_FrameResoure(){this.Name=null;this.Descriptions={};this.GetDescription=function(){var a=this.Descriptions[EWA.LANG];if(null==a)for(var b in this.Description)return this.Description[b];return a};this.GetInfo=function(){var a=this.GetDescription();return null==a?null:a.Info};this.GetMemo=function(){var a=this.GetDescription();return null==a?null:a.Memo}}
function EWA_FrameResoures(){this.Init=function(a){var b=a.GetElements("root/PageInfo");if(null!=b){for(var c=0;c<b.length;c+=1){var d=new EWA_FrameResoure;d.Name=b[c].getAttribute("Name");for(var e=a.GetElements("Set",b[c]),f=0;f<e.length;f++){var g=new EWA_FrameResourceDescription;g.Info=e[f].getAttribute("Info");g.Memo=e[f].getAttribute("Memo");g.Lang=e[f].getAttribute("Lang");d.Descriptions[g.Lang]=g}this[d.Name]=d}this.ReplaceResById();this.ReplaceRes()}};this.ReplaceResById=function(){for(var a in this){var b=
this[a],c=$X(a);c&&("input"==c.tagName.toLowerCase()?c.value=b.GetInfo():c.innerHTML=b.GetInfo(),c.title=b.GetMemo())}};this.ReplaceRes=function(){var a=[];a.push(document.getElementsByTagName("div"));a.push(document.getElementsByTagName("span"));a.push(document.getElementsByTagName("input"));a.push(document.getElementsByTagName("button"));for(var b=0;b<a.length;b++)for(var c=a[b],d=0;d<c.length;d+=1){var e=c[d].getAttribute("res");if(null!=e&&(e=e.trim(),0==e.indexOf("EWA.F.FOS")&&(0<e.indexOf(".Resources.")||
0<e.indexOf(".Resources[")))){var f="";try{f=eval(e)}catch(g){f=g.message}"INPUT"==c[d].tagName?c[d].value=f:c[d].innerHTML=f}}a.length=0}}
function EWA_FrameClass(){this._Ajax=this.Xml=null;this.ItemList=new EWA_FrameCommonItems;this.Resources={};this.ReloadAfter=this._Id=this._ValidExObj=this._ValidExFail=this._ValidExOk=this.Url=null;this.isShowPostWaitting=!0;this.setDisable=function(){var a=$("#EWA_FRAME_"+this._Id);a.find("input,textarea,select,label").each(function(){this.disabled||"hidden"==this.type||(this.disabled=!0,this.setAttribute("ewadisabled",1))});a.find(".EWA_DHTML").each(function(){if("DIV"==this.tagName)var a=$(this).find("iframe")[0].contentWindow,
c=setInterval(function(){if("complete"==a.document.readyState){window.clearInterval(c);a.frames[0].document.body.contentEditable=!1;a.frames[0].document.body.style.backgroundColor="#eee";var b=a.document.getElementsByClassName("but")[0];b.style.pointerEvents="none";b.style.filter="grayscale(1) opacity(0.8)"}},300);else if("TEXTAREA"==this.tagName){var d=$(this).parent();c=setInterval(function(){var a=d.find("iframe");0<a.length&&(a=a[0].contentWindow)&&"complete"==a.document.readyState&&(window.clearInterval(c),
a.document.body.contentEditable=!1,a.document.body.style.backgroundColor="#eee",d.find(".ewa-editor").attr("ewadisabled",1))},300)}})};this.setEnable=function(){var a=$("#EWA_FRAME_"+this._Id);a.find("input,textarea,select,label").each(function(){this.disabled&&this.getAttribute("ewadisabled")&&(this.disabled=!1,this.removeAttribute("ewadisabled"))});a.find(".EWA_DHTML").each(function(){if("DIV"==this.tagName){var a=$(this).find("iframe")[0].contentWindow;a.frames[0].document.body.contentEditable=
!0;a.frames[0].document.body.style.backgroundColor="";a=a.document.getElementsByClassName("but")[0];a.style.pointerEvents="";a.style.filter=""}else if("TEXTAREA"==this.tagName){var c=$(this).parent();a=c.find("iframe")[0].contentWindow;a.document.body.contentEditable=!0;a.document.body.style.backgroundColor="";c.find(".ewa-editor").removeAttr("ewadisabled")}})};this.convertFilterCheckbox=function(a,b,c,d,e,f){function g(a){var b=$("<nobr></nobr>");q.append(b);q.append(" ");var c=$(a).parent();a=$(a).attr("id")+
"_"+r;c.attr("id",a);b.append(c.children());b.attr("ref_id",a)}function h(a){a=$(a).parent();var b=a.attr("ref_id");b&&($("#"+b).append(a.children()),a.remove())}var k={},l=$("#EWA_FRAME_"+this._Id+" .ewa-row-"+a),m=$("#EWA_FRAME_"+this._Id+" .ewa-row-"+b),q=$("<div class='ewa-filter-checked'></div>");l.find("#"+a).prepend(q).addClass("ewa-filter-chks");var r=this._Id;c||(c="PY");l.find("input[type=checkbox]").each(function(){var a=JSON.parse($(this).attr("json"))[c];a&&(a=a.toUpperCase().trim().substring(0,
1),k[a]||(k[a]=[]),k[a].push(this.id),this.checked&&g(this),$(this).on("change",function(){this.checked?g(this):h(this)}))});a="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");b=["<a class='ewa-filter-char ewa-filter-char-all' code=''>ALL</a>"];for(var p in a){var n=a[p],u=k[n];u&&b.push("<a class='ewa-filter-char' code='"+n+"'>"+n+"<span class='ewa-filter-char-num'>("+u.length+")</span></a>")}m.find(".EWA_TD_M").html(b.join(" "));d&&(l.find(".EWA_TD_L").hide(),l.find(".EWA_TD_M").attr("colspan",2));m.find("a.ewa-filter-char").on("click",
function(){var a=$(this).attr("code");l.find("input[type=checkbox]").each(function(){a?this.checked?q.append($(this).parent()):($(this).parent().attr("ref_id")&&h(this),$(this).parent().hide()):$(this).parent().show()});if(a){for(var b=k[a],c=0;c<b.length;c++)l.find("#"+b[c]).parent().show();f&&f(this,l,m)}});e&&e(l,m)};this.createFilterCheckbox=function(a,b,c,d,e,f,g){var h=this;$J(d,function(d){h.createFilterCheckboxByData(a,b,c,d,e,f,g)})};this.createFilterCheckboxByData=function(a,b,c,d,e,f,g){var h=
{},k=k?"[]":c.split(",");c={};for(var l in k)c[k[l]]=1;k=[];var m=[],q=a.id;for(l in d){var r=d[l],p=r[e];p&&(p=p.replace(/</ig,"&lt;"));var n=r[f];n&&(n=n.replace(/</ig,"&lt;"));var u=r[g],w=c[p],v=[];v.push("<nobr class='ewa-filter-chk' style='float:left;margin-right:4px'>");v.push('<input class="ewa-filter-chkbox" type="checkbox" ');w&&v.push(" checked ");r=q+"_"+l;v.push(' value="'+p+'" id="'+r+'" name="'+q+'"><label ');v.push(' for="'+r+'">'+n+"</label></nobr>");w?m.push(v.join("")):k.push(v.join(""));
b&&(p=u?u.substring(0,1).toUpperCase():"",h[p]||(h[p]=[]),h[p].push(r))}a.innerHTML=m.join(" ")+" "+k.join(" ");if(b){d=['<a href="javascript:void(0)">ALL</a>'];for(l="A".charCodeAt();l<="Z".charCodeAt();l++)e=String.fromCharCode(l),h[e]&&d.push('<a href="javascript:void(0)">'+e+"</a>");b.innerHTML=d.join(" ");$(b).find("a").each(function(){var b=$(this).text();"ALL"!=b&&$(this).attr("ids",h[b].join(","));$(this).on("click",function(){if("ALL"==$(this).text())$(a).find("nobr.ewa-filter-chk").show();
else{var b=$(this).attr("ids").split(","),c={},d;for(d in b)c[b[d]]=1;$(a).find("input.ewa-filter-chkbox").each(function(){this.checked||c[this.id]?$(this).parent().show():$(this).parent().hide()})}})})}};this.hiddenNoContentRow=function(){var a=$("#EWA_FRAME_"+this._Id);a.find(".EWA_TD_M").each(function(){if(""==$(this).text()&&0==$(this).find("img,a,input[type=text],input[type=button],textarea").length){$(this).parent().hide();var b=$(this).find("*:eq(0)").attr("id");b&&a.find(".ewa-row-"+b).hide().attr("hiddennocontentrow",
1)}})};this.itemReload=function(a,b,c){if(a){var d=new EWA_UrlClass(this.Url);d.AddParameter("EWA_AJAX","SELECT_RELOAD");d.AddParameter("EWA_RELOAD_ID",a);d=d.GetUrl();$J(d,function(d){if(d.RST){var e=d.ITEM.LST,g=$X(a);g.options.length=0;for(var h in e){var k=e[h];k=new Option(k.T,k.V);g.options[g.options.length]=k}b&&(g.value=b);if(c)try{c(d,g)}catch(l){console.log(l)}}else $Tip(d.ERR)})}};this._checkSelectOptionsChange=function(){if(this._SelectFilters){var a=this;this.isSelectFilter&&setTimeout(function(){a._checkSelectOptionsChange()},
311);for(var b in this._SelectFilters){var c=this._SelectFilters[b];$($X(c.id)).html()!=c.html&&a._selectOptionsChangeed(c)}setTimeout(function(){a._checkSelectOptionsChange()},311)}};this._selectOptionsChangeed=function(a){console.log("changed");var b=$("#EWA_FRAME_"+this._Id+" select#"+a.id),c="initSelectFilter"+this._Id+"-"+a.id+"-filter",d="initSelectFilter"+this._Id+"-"+a.id+"-filter2",e=this._initSelectFilterCreateCode(a.codeJsonFrom,b);$("#"+c).html(e);$("#"+d).html("");a.html=b.html()};this._initSelectFilterCreateCode=
function(a,b){var c=["<option value=''>ALL</option>"];if(a){var d={},e=[];b.find("option").each(function(){if(""!=this.value){var b;this.hasAttribute("para_"+a)?b=this.getAttribute("para_"+a):this.getAttribute("json")&&(b=JSON.parse(this.getAttribute("json"))[a]);b&&!d[b]&&(d[b]=!0,e.push(b))}});var f=e.sort(),g;for(g in f)b=f[g],b=b.replace(/>/ig,"&lt;").replace(/"/,"&quot;"),c.push('<option value="'+b+'">'+b+"</option>")}else for(g="A".charCodeAt();g<="Z".charCodeAt();g++)b=String.fromCharCode(g),
c.push('<option value="'+b+'">'+b+"</option>");return c.join("")};this.initSelectFilter=function(a,b,c,d){if(!this["INIT_SELECT_FILTER"+a]){this["INIT_SELECT_FILTER"+a]=!0;var e=$("#EWA_FRAME_"+this._Id+" select#"+a),f=e.parent(),g="initSelectFilter"+this._Id+"-"+a+"-filter",h="initSelectFilter"+this._Id+"-"+a+"-filter2",k="initSelectFilter"+this._Id+"-"+a+"-filter-table";$X(k)&&(f.append(e),$($X(k)).remove());f.addClass("ewa-select-filter");g=["<table id='"+k+"' cellpadding=0 cellspacing=0 width=100%><tr><td class='ewa-select-filter-char'><select class='EWA_SELECT' style='margin-right:4px' id='"+
g+"' onchange='EWA.F.FOS[\""+this._Id+'"]._chCode(this,"'+b+'","'+c+"\")'>"];k=this._initSelectFilterCreateCode(d,e);g.push(k);g.push("</select><select id='"+h+"' style='display:none'></select></td><td class='ewa-select-filter-target'></td></tr></table>");f.prepend(g.join(""));f.find(".ewa-select-filter-target").append(e);this._SelectFilters||(this._SelectFilters={});f={};f.html=e.html();f.id=a;f.filterType=b;f.filterFrom=c;f.codeJsonFrom=d;this._SelectFilters[f.id]=f}};this._chCode=function(a,b,
c){this.isSelectFilter=!0;var d=$(a).next(),e=$(a).parent().parent().find(".ewa-select-filter-target select");0==d[0].options.length&&d.html(e.html());if(""==a.value)e.html(d.html());else{for(var f=["<option></option>"],g=1;g<d[0].options.length;g++){var h=d[0].options[g];this._chCodeFilter(h,b,c,a.value)&&f.push(GetOuterHTML(h))}e.html(f.join(""));this._SelectFilters[e[0].id].html=e.html();this.isSelectFilter=!1}};this._chCodeFilter=function(a,b,c,d){"json"==b?(a=JSON.parse(a.getAttribute("json"))[c],
"ADM_LID"==c&&(c=a.split("."),a=c[c.length-1])):a="text"==b?a.text:a.value;return a?a.substring(0,d.length).toUpperCase()==d.toUpperCase()?!0:!1:!1};this.setUnMust=function(a){(a=this.ItemList.Items[a])&&a.getElementsByTagName("IsMustInput")[0].getElementsByTagName("Set")[0].setAttribute("IsMustInput",0)};this.setMust=function(a){(a=this.ItemList.Items[a])&&a.getElementsByTagName("IsMustInput")[0].getElementsByTagName("Set")[0].setAttribute("IsMustInput",1)};this.RedrawCreateSpans=function(){for(var a=
$("#EWA_FRAME_"+this._Id+" tr"),b=0;b<a.length;b++){var c=a[b];if("none"!=c.style.display)for(var d=0,e=!1,f=c.cells.length-1;0<=f;f--){var g=c.cells[f];"none"==g.style.display?e?d++:(d=1,e=!0):e&&(g.colSpan=d+1,e=!1)}}EWA_FrameShowAlert=EWA_FrameShowAlert1;EWA_FrameRemoveAlert=EWA_FrameRemoveAlert1;$("#EWA_FRAME_"+this._Id+" .ewa_d1").each(function(){this.title=this.innerHTML});for(var h in this.ItemList.Items)a=this.GetItemDescription(h).Memo,null!=a&&0<a.trim().length&&($("#"+h).attr("placeHolder",
a),$("#"+h).attr("title",a));this.RedrawChangWidth()};this.GetItemDescription=function(a){return this.ItemList.GetDescription(a)};this.ShowPlaceHolder=function(a){$("#EWA_FRAME_"+this._Id).addClass("ewa-frame-cols-"+a);for(var b in this.ItemList.Items){var c=this.ItemList.GetValue(b,"Name","Name");if(c=this.GetObject(c)){c=$(c);var d=this.GetItemDescription(b),e=d.Memo,f=d.Info;d=null;1==a?(d=f,null!=e&&0<e.trim().length&&e!=d&&("smsValid"==c.attr("ewa_tag")?d=e:(e="<div class='ewa-item-memo'>"+e+
"</div>",c.parentsUntil("tr").last().append(e))),c.hasClass("ewa-switch")&&c.prepend("<div class='ewa-switch-info'>"+d+"</div>")):2==a&&null!=e&&0<e.trim().length&&(d=e);d&&("hidden"==c[0].type?c.prev().attr("placeholder",d):"SELECT"==c[0].tagName?0<c[0].options.length&&""==c[0].options[0].value&&(c[0].options[0].text="-- "+d+" --",c[0].options[0].value=""):(c.attr("placeHolder",d),c.attr("title",d)))}}};this.RedrawChangWidth=function(){var a=$("#EWA_FRAME_"+this._Id),b=a.find(".ewa_msg_box")[0].colSpan/
2,c=(a.width()-90*b)/b;$(a).find(".ewa_redraw_ctl").each(function(){var a=this.colSpan||1;$(this).css("width",c*a)});var d=this;addEvent(window,"size",function(){d.RedrawChangWidth()})};this.Mearge=function(a,b,c){console.log("\u62fc\u5199\u9519\u8bef\uff1a\u8bf7\u7528 Merge");this.Merge(a,b,c)};this.Merge=function(a,b,c){if(a||b){var d=$("#EWA_FRAME_"+this._Id),e=d.find("#"+a),f=d.find("#"+b);if(0==e.length)console.log("Mearge:"+a+"\u4e0d\u5b58\u5728");else if(0==f.length)console.log("Mearge:"+b+
"\u4e0d\u5b58\u5728");else{var g=!1,h=d.find(".ewa-row-"+b+" .EWA_TD_M"),k=null;0==h.length&&(g=!0,h=d.find(".ewa-row-"+b+" .EWA_TD_1"),k=d.find(".ewa-row-"+b+" .EWA_TD"),1==k.length&&(g=!0),b=k.html(),k.html("<table cellpadding=0 cellspacing=0 width=100%><tr><td style='width:50%'></td><td style='display:none'></td><td style='width:50%'></td></tr></table>"),k.find("td:eq(0)").html(b));if(0==h.length)alert("target parent not exists");else{var l="border-box"==e.css("box-sizing")?0:1*e.css("padding-left").replace("px",
"")+1*e.css("padding-right").replace("px",""),m="border-box"==e.css("box-sizing")?0:1*f.css("padding-left").replace("px","")+1*f.css("padding-right").replace("px","");d.find(".ewa-row-"+a).hide();null==c&&(c=" - ");var q=h.width(),r=e[0].tagName,p=f[0].tagName;e.parent().hasClass("ewa-select-filter-target")&&(e=d.find(".ewa-row-"+a+" .EWA_TD_M table:eq(0)"),r="SELECT_WITH_FILTER");var n=0;b=null;c&&(h.append('<span class="mearge-span">'+c+"</span>"),g&&k.find("table:eq(0) td:eq(1)").html('<span class="mearge-span">'+
c+"</span>").show(),b=h.find(".mearge-span"),n=b.width()+1+1*b.css("padding-left").replace("px","")+1*b.css("padding-right").replace("px","")+1*b.css("margin-left").replace("px","")+1*b.css("margin-right").replace("px",""));r==p?(c=(q-n)/2-l-2,e.css("width",c),f.css("width",c),g&&k.find("table:eq(0) td:eq(2), table:eq(0) td:eq(0)").css("width",c)):"SELECT"==r?(e.css("width",100),f.css("width",q-n-l-m-2-2-e.width())):"SELECT_WITH_FILTER"==r?(e.css("width",200),f.css("width",q-n-l-m-2-2-e.width())):
"SELECT"==p&&(f.css("width",100),e.css("width",q-n-l-m-2-2-e.width()));f.css("float","left");b&&b.css("float","left");e.css("float","right");h.append(e);h.addClass("ewa-frame-merge");g&&(a=d.find(".ewa-row-"+a+" .EWA_TD").html(),k.find("table:eq(0) td:eq(2)").html(a))}}}};this.MergeExp=function(a,b,c,d){if(b){var e=b.match(/@@[a-zA-Z0-9\-\._:]*\b/ig),f=[],g=b;b={};for(var h=$("#EWA_FRAME_"+this._Id),k=0;k<e.length;k++){var l=e[k];f.push(l);var m=l.replace("@@","");g=g.replace(l,"<span class='ewa-row-merge ewa-row-merge-"+
m+"' mid=\""+l+'"></span>');m!=a&&h.find(".ewa-row-"+m).hide();b[m]=this.GetItemDescription(m).Info}e=document.createElement("div");e.style.display="none";e.innerHTML=g;document.body.appendChild(e);l=h.find('[id="'+a+'"]');if(0==l.length)console.log("not find "+a);else{a=l.parent();for(var q in f)k=f[q],l=k.replace("@@",""),g=h.find('[id="'+l+'"]'),0==g.length?console.log("not found [id="+l+"]"):(k=$(e).find('span[mid="'+k+'"]'),"placeholder"==c?g.attr("placeholder",b[l]):c&&(k.append("<span class='ewa-row-merge-memo'></span>"),
k.find(".ewa-row-merge-memo").text(b[l])),k.append(g));for(;0<e.childNodes.length;)a.append(e.childNodes[0]);$(e).remove();d&&d(a)}}else console.log("mergeExp \u6ca1\u6709\u8bbe\u7f6e")};this.MergeItems=function(){for(var a in this.MeargeMap){var b=this.MeargeMap[a],c=$X("_ewa_tr$"+a);if(c){for(var d=c.cells.length,e=$(c.cells[0]);1<c.cells.length;)e.append(c.cells[1].innerHTML),c.removeChild(c.cells[1]);c.cells[0].colSpan=d;c=[];for(d=0;d<b.length;d++){for(var f=$X("_ewa_tr$"+b[d]),g=["<nobr>"],
h=0;h<f.cells.length;h++)g.push(f.cells[h].innerHTML);g.push("</nobr>");c.push(g.join(" "));f.parentNode.removeChild(f)}e.append(c.join(" "))}}};this.LoadJson=function(a,b){null!=a&&$J(this.Url+"&EWA_ACTION="+a+"&EWA_AJAX=JSON",b)};this.DoAction=function(a,b,c,d,e,f){EWA.F.CID=this._Id;if(null!=b&&""!=b.trim()){if(null!=c&&0<c.trim().length)if(a=_EWA_INFO_MSG[c],null!=a&&""!=a){if(!window.confirm(a))return}else if(!window.confirm(c))return;this.DoPostBefore();this._Ajax=this.CreateAjax(null,!0);this._Ajax.LoadingType=
"image";this._Ajax.AddParameter("EWA_AJAX","1");this._Ajax.AddParameter("EWA_ACTION",b);this._Ajax.AddParameter("EWA_ID",this._Id);this._Ajax.AddParameter("EWA_NO_CONTENT","1");this._Ajax.AddParameter("EWA_ACTION_TIP",d);null!=f&&0<f.trim().length?(this._Ajax.AddParameter("EWA_AFTER_EVENT",f),this.StopAjaxAfterReload=!0,this._Ajax.AddParameter("EWA_ACTION_RELOAD","0")):this.StopAjaxAfterReload=!1;if(null!=e&&0<e.length)for(b=0;b<e.length;b+=1)this._Ajax.AddParameter(e[b].Name,e[b].Value);e=new EWA.C.Url;
e.SetUrl(this.Url);e=e.RemoveParameter("EWA_ACTION");this._Ajax.PostNew(e,EWA.F.FOS[EWA.F.CID]._CallBackJs)}};this.GuideShowCreate=function(a){this._GroupInfos=a;var b=$X("EWA_FRAME_"+this._Id);a=a.length-1;b.setAttribute("EWA_GUIDE_IDX","0");b.setAttribute("EWA_GUIDE_IDX_MAX",a);b.rows[b.rows.length-1].style.display="none";100<b.clientHeight&&(b.parentNode.style.height=b.clientHeight+"px");a=document.createElement("input");a.id="ewa_but_"+Math.random();a.type="button";a.value="\u4e0a\u4e00\u6b65";
a.style.display="none";a.onclick=function(){var a=b.getAttribute("EWA_GUIDE_IDX");if(0==1*a)$Tip("\u5230\u5934\u4e86");else{var c=b.id.replace("EWA_FRAME_","");EWA.F.FOS[c].GuidePrevBefore&&EWA.F.FOS[c].GuidePrevBefore(a,this,b);EWA.F.FOS[c].GuideShow(1*a-1);EWA.F.FOS[c].GuidePrevAfter&&EWA.F.FOS[c].GuidePrevAfter(a,this,b)}};var c=document.createElement("input");c.id="ewa_but_"+Math.random();c.type="submit";c.value="\u4e0b\u4e00\u6b65";c.onclick=function(){var a=b.getAttribute("EWA_GUIDE_IDX"),c=
b.id.replace("EWA_FRAME_","");EWA.F.FOS[c].GuideShowCheck(a)&&(EWA.F.FOS[c].GuideNextBefore&&EWA.F.FOS[c].GuideNextBefore(a,this,b),"ok"==this.getAttribute("ewa_guide_method")?$F(b,"input","type","submit")[0].click():EWA.F.FOS[c].GuideShow(1*a+1),EWA.F.FOS[c].GuideNextAfter&&EWA.F.FOS[c].GuideNextAfter(a,this,b))};var d=b.parentNode.parentNode.parentNode.parentNode.insertRow(-1).insertCell(-1);d.appendChild(a);d.appendChild(c);d.className="EWA_FRAME_GROUP_BUTTONS";tdTitle=b.parentNode.parentNode.parentNode.parentNode.insertRow(0).insertCell(-1);
d="ewa_title_"+Math.random();for(var e=[],f=0;f<this._GroupInfos.length;f++)e.push('<div style="float:left" id="ewa_'+this._Id+"_"+f+'">'+(f+1)+". "+this._GroupInfos[f].DES+"</div>");tdTitle.innerHTML="<div style='text-align:left'>"+e.join(" <div style='float:left;color:#aaa'>&nbsp;&gt;&nbsp;</div> ")+"</div><div id='"+d+"'></div>";tdTitle.className="EWA_FRAME_GROUP_TITLE";b.setAttribute("EWA_GUIDE_ID_PREV",a.id);b.setAttribute("EWA_GUIDE_ID_NEXT",c.id);b.setAttribute("EWA_GUIDE_ID_TITLE",d);this.GuideShowTitle(0);
a=document.createElement("div");100<b.clientHeight&&(a.style.width=b.clientWidth+"px",a.style.height=b.clientHeight+20+"px",a.style.overflow="auto");b.parentNode.appendChild(a);a.appendChild(b);b.parentNode.className="EWA_GROUP_GUIDE"};this.GuideShowTitle=function(a){for(var b=$X("EWA_FRAME_"+this._Id).getAttribute("EWA_GUIDE_IDX_MAX"),c=0;c<=b;c++){var d="ewa_"+this._Id+"_"+c;c==a?($X(d).style.color="blue",$X(d).style.borderBottom="2px solid green"):($X(d).style.color="green",$X(d).style.borderBottom=
"2px")}};this.GuideShowCheck=function(a){var b=!0,c=null,d;for(d in this.ItemList.Items){var e=this.ItemList.GetItemValue(this.ItemList.Items[d],"Name","Name"),f=$X(e);null==f?alert(e+" not exists"):(e=this._GetTr(f),null!=e&&e.getAttribute("groupindex")==a&&((b&=this.CheckValid(f))||null!=c||(c=f)))}null!=c&&c.focus();return b};this._GetTr=function(a){for(var b=0;100>b;){b++;a=a.parentNode;try{if("TR"==a.tagName.toUpperCase()&&null!=a.getAttribute("id")&&0==a.getAttribute("id").indexOf("_ewa_tr$"))return a}catch(c){break}}return null};
this.GuideShow=function(a){this.GuideShowTitle(a);var b=$X("EWA_FRAME_"+this._Id);if(b.getAttribute("EWA_GUIDE_IDX")!=a){var c=b.getAttribute("EWA_GUIDE_IDX_MAX"),d=b.getAttribute("EWA_GUIDE_ID_PREV"),e=b.getAttribute("EWA_GUIDE_ID_NEXT");a==c?($X(e).value="\u786e\u5b9a",$X(e).setAttribute("ewa_guide_method","ok")):($X(e).value="\u4e0b\u4e00\u6b65",$X(e).setAttribute("ewa_guide_method",""));0==a?$X(d).style.display="none":$X(d).style.display="";b.setAttribute("EWA_GUIDE_IDX",a);this._ShowHidenGroup(b,
a)}};this._ShowHidenGroup=function(a,b){for(var c=0;c<a.rows.length-1;c++){var d=a.rows[c];if(null!=d.getAttribute("groupIndex")&&""!=d.getAttribute("groupIndex")){var e=1*d.getAttribute("groupIndex");d.style.display=b==e?"":"none"}}};this.GroupShow=function(a,b){if(!(0<a.className.indexOf("1"))){this.GroupShowBefore&&this.GroupShowBefore(a,b);for(var c=$X("EWA_FRAME_"+this._Id),d=a.parentNode.parentNode,e=0;e<c.rows.length;e++){var f=c.rows[e];if(f!=d&&!(1==f.cells.length&&f.cells[0].className&&
0<=f.cells[0].className.indexOf("EWA_TD_B"))&&"1"!=f.getAttribute("hiddennocontentrow")){var g=0;null!=f.getAttribute("groupIndex")&&""!=f.getAttribute("groupIndex")&&(g=1*f.getAttribute("groupIndex"));f.style.display=b==g?"":"none"}}c=d.getElementsByTagName("div");for(e=0;e<c.length;e++)d=c[e],d.className=d==a?d.className+"1":d.className.replace("1","");this.GroupShowAfter&&this.GroupShowAfter(a,b)}};this.DoActionJSON=function(a,b,c,d){EWA.F.CID=this._Id;this._Ajax=new EWA.C.Ajax;this._Ajax.LoadingType=
"image";this._Ajax.AddParameter("EWA_AJAX","JSON");this._Ajax.AddParameter("EWA_ACTION",a);this._Ajax.AddParameter("EWA_ID",this._Id);this._Ajax.AddParameter("EWA_JSON_NAME",b);this._AjaxJsonAfter=null!=d?d:null;if(null!=c&&0<c.length)for(a=0;a<c.length;a+=1)this._Ajax.AddParameter(c[a].Name,c[a].Value);c=new EWA.C.Url;c.SetUrl(this.Url);c=c.RemoveParameter("EWA_ACTION");this._Ajax.PostNew(c,EWA.F.FOS[EWA.F.CID]._CallBackJs)};this._CallBackJs=function(){var a=EWA.F.FOS[EWA.F.CID],b=a._Ajax;if(4==
b._Http.readyState)if(b.HiddenWaitting(),200==b._Http.status){if(b=b._Http.responseText,EWA.F.CheckCallBack(b)){eval(b);a._AjaxJsonAfter&&(a._AjaxJsonAfter(),a._AjaxJsonAfter=null);try{a.ReloadAfter&&a.ReloadAfter(b)}catch(c){alert(b)}}}else alert("ERROR:\r\n"+b._Http.statusText)};this.RewriteInfo=function(a,b,c,d){for(a=0;a<info.length;a++){var e=info[a],f=e[b];if($X(f)){var g="TD"==$X(f).parentNode.tagName?$X(f).parentNode:$X(f).parentNode.parentNode;"IMG_UPLOAD"==$X(f).getAttribute("ewa_tag")&&
(g=$X(f).parentNode.parentNode.parentNode.parentNode.parentNode.parentNode);f=g.parentNode;null==e[c]||""==e[c].trim()?f.style.display="none":3==f.cells.length?(f.cells[2].innerHTML=e[d],f.cells[0].innerHTML=e[c]):1==f.cells.length&&(f=f.previousSibling,3==f.nodeType&&(f=f.previousSibling),f.cells[1].innerHTML=e[d],f.cells[0].innerHTML=e[c])}}};this._HiddenMemo=function(a,b){var c=a.parentNode.parentNode;b=!1;"none"==c.style.display&&(b=!0);c.style.display="none";c.id="tr_"+a.id;c=c.previousSibling;
3==c.nodeType&&(c=c.previousSibling);c.style.display="none";a="<span id=tab_"+a.id+' class="ewa_merge_tab" onclick="EWA.F.FOS[\''+this._Id+"'].ShowMemo(this.id);\">"+c.cells[0].innerHTML+"</span>";return b?"":a};this.ShowMemo=function(a){for(var b=$X(this._Id+"__ewa_meger").getElementsByTagName("SPAN"),c=0;c<b.length;c++){var d=b[c].id.replace("tab_","tr_");"ewa_merge_tab1"==b[c].className&&(b[c].className="ewa_merge_tab",$X(d).style.display="none");b[c].id==a&&(b[c].className="ewa_merge_tab1",$X(d).style.display=
"")}};this.MergeMemo=function(){var a=$X("EWA_FRAME_"+this._Id).getElementsByTagName("textarea");if(0!=a.length&&"1"!=a[0].getAttribute("ewa_merge")){for(var b=[],c=0;c<a.length;c++){var d=this._HiddenMemo(a[c]);d="<nobr>"+d.replace("\u2022 ","").trim()+"</nobr>";b.push(d)}a=a[0];c=a.parentNode.parentNode;d=c.previousSibling;3==d.nodeType&&(d=d.previousSibling);d.id=this._Id+"__ewa_meger";d.cells[0].colSpan=3;d.cells[0].innerHTML=b.join("");d.cells[0].style.width="100%";d.cells[0].style.height="25px";
d.style.display="";c.style.display="";$X("tab_"+a.id).className="ewa_merge_tab1";null!=window._EWA_DialogWnd&&EWA.UI.Dialog._SetTitle(window._EWA_DialogWnd)}};this.DoValidEx=function(a,b,c,d,e,f){""!=a.value&&(this._ValidExOk=this.Resources[e],this._ValidExFail=this.Resources[f],this._ValidExObj=a,"action"==b.toLowerCase().trim()?this._DoValidExAction(a,d,this.Resources[e].GetInfo(),this.Resources[f].GetInfo()):eval(c)?(EWA_FrameShowAlert(a,this._ValidExOk.GetInfo()),a.setAttribute("EWA_VALID_EX",
"")):(EWA_FrameShowAlert(a,this._ValidExFail.GetInfo()),a.setAttribute("EWA_VALID_EX",this._ValidExFail.GetInfo())))};this._DoValidExAction=function(a,b,c,d){if(null!=a&&!$(a).is(":hidden"))if(null==b||""==b.trim())alert("action not value");else{var e=a.id+","+a.value;if(this.DoValidExAction_RETS&&null!=this.DoValidExAction_RETS[e])0==this.DoValidExAction_RETS[e]?(EWA_FrameRemoveAlert(a,c),a.setAttribute("EWA_VALID_EX","")):(EWA_FrameShowAlert(a,d),a.setAttribute("EWA_VALID_EX",d));else{var f=new EWA.C.Ajax;
f.LoadingType="image";f.AddParameter("EWA_AJAX","HAVE_DATA");f.AddParameter("EWA_ACTION",b);f.AddParameter("EWA_ID",this._Id);f.AddParameter("EWA_NO_CONTENT","1");f.AddParameter(a.id,a.value);this.DoValidExAction_RETS||(this.DoValidExAction_RETS={});var g=this;f.PostNew(this.Url,function(){if(4==f._Http.readyState){f.HiddenWaitting();if(200==f._Http.status){var b=f._Http.responseText;if(EWA.F.CheckCallBack(b))try{var k=parseInt(b.trim());g.DoValidExAction_RETS[e]=k;0==k?(EWA_FrameRemoveAlert(a,c),
a.setAttribute("EWA_VALID_EX","")):(EWA_FrameShowAlert(a,d),a.setAttribute("EWA_VALID_EX",d))}catch(l){alert(l+","+b)}}else alert("ERROR:\r\n"+f._Http.statusText);f=null}})}}};this.ValidCodeError=function(a){$(".ewa-valid-code-img").each(function(){this.click()});a||($Tip(_EWA_EVENT_MSG.ValidCodeError),$(".ewa-valid-code-img").parent().parent().find("input").focus().select())};this.Init=function(a){this.Xml=new EWA.C.Xml;this.Xml.LoadXml(a);this.ItemList.F=this;this.ItemList.Init(this.Xml);this.Resources=
new EWA_FrameResoures;this.Resources.Init(this.Xml);"enus"==EWA.LANG&&$(".ewa-ipt-droplist").attr("placeholder","Input character selection");this._InitTranslations();this._GetDropListValue();this._InitMustInputs();this._InitEncyptions()};this._InitMustInputs=function(){var a=$("#EWA_FRAME_"+this._Id),b;for(b in this.ItemList.Items){var c=this.ItemList.Items[b],d=this.ItemList.GetItemValue(c,"Name","Name");0<$(c).find('IsMustInput Set[IsMustInput="1"]').length&&(c="#"+d,a.find(".ewa-row-"+d).addClass("ewa-row-must"),
d=a.find(c),d.addClass("ewa-row-item-must"),0<d.length&&d.attr("type")&&"hidden"==d.attr("type").toLowerCase()&&d.prev().addClass("ewa-row-item-must"))}};this._InitEncyptions=function(){var a=$("#EWA_FRAME_"+this._Id),b;for(b in this.ItemList.Items){var c=this.ItemList.Items[b],d=this.ItemList.GetItemValue(c,"Name","Name");c=$(c).find("DispEnc Set");if(0!=c.length&&(d=a.find("#"+d),0!=d.length&&c.attr("EncType"))){if("INPUT"==d[0].tagName||"TEXTAREA"==d[0].tagName){if(!d.val())continue;d.prop("disabled",
!0);d.attr("ewa_encyrption","yes")}var e=$("<div class='ewa-enc-cover' style='position:absolute;left:0;top:0;width:100%;height:100%;'><div></div></div>");d.parent().append(e);d.parent().css("position","relative");if(c=c.attr("EncShowUrl")){e.find("div").html("\u70b9\u51fb\u67e5\u770b").css({position:"absolute",height:30,"line-height":"30px",top:"50%","margin-top":"-15px",right:10,"text-align":"right"});c=new EWA_UrlClass(c);e=new EWA_UrlClass(this.Url);for(var f in e._Paras)if(!c.GetParameter(f)){var g=
e._Paras[f];null!=g&&(g=g.unURL());c.AddParameter(f,g)}c.AddParameter("EWA_ENCY_FROM_ID",d.attr("id"));c=c.GetUrl();d.parent().attr("enc_url",c).attr("fid",d.attr("id"));d.parent().on("click",function(){if(!$(this).attr("enc_ok")){var a=$(this).attr("t")||100,b=(new Date).getTime();if(!(400>b-a)){$(this).attr("t",b);a=$(this).attr("enc_url");var c=$(this).find("#"+$(this).attr("fid"));$J(a,function(a){a.RST?(c.prop("disabled",!1),c.removeAttr("ewa_encyrption"),c.val(a.VALUE),$(c).parent().find(".ewa-enc-cover").remove(),
$(c).parent().attr("enc_ok","1")):(a.ERR||a.MSG)&&$Tip(a.ERR||a.MSG)})}}})}}}};this._InitTranslations=function(){var a="EWA.F.FOS[&quot;"+this._Id+"&quot;]._Trans(this)",b;for(b in this.ItemList.Items){var c=this.ItemList.Items[b],d=this.ItemList.GetItemValue(c,"Name","Name"),e=$(c).find("DataItem Set[Translation]");if(c=e.attr("Translation")){e=e.attr("TransTarget");var f="en2zh"==c?" \u82f1\u8bd1\u4e2d":" \u4e2d\u8bd1\u82f1";"enus"==EWA.LANG&&(f="en2zh"==c?" En-Zh":" Zh-En");c=$('<a class="ewa-but-trans" href="javascript:void(0)" onclick="'+
a+'" _transf="'+d+'" _transp="'+c+'" _transt="'+e+'">'+f+"</a>");e=$("#EWA_FRAME_"+this._Id+" .ewa-row-"+d+" .EWA_TD_L");0==e.length&&(e=$("#EWA_FRAME_"+this._Id+" .ewa-row-"+d+" .EWA_TD"));0==e.length&&(e=$("#EWA_FRAME_"+this._Id+" #"+d).parent().prev().find(".ewa_d1"));0==e.length&&(e=$("#EWA_FRAME_"+this._Id+" #"+d).parent(),e.css("position","relative"),c.addClass("ewa-but-trans-float"));e.append(c)}}};this._Trans=function(a){if(a){var b=$(a).attr("_transf"),c=$(a).attr("_transp");a=$(a).attr("_transt");
b=$("#EWA_FRAME_"+this._Id+" #"+b);a=$("#EWA_FRAME_"+this._Id+" #"+a);if(0==b.length||0==a.length)console.log("trans ex:",b,a);else{var d=b[0].tagName.toLowerCase();if(b="input"==d||"textarea"==d||"hidden"==d?b.val():b.text()){var e=new EWA_TransClass;"en2zh"==c?e.TransToCn(b,a[0]):e.TransToEn(b,a[0]);$Tip("enus"==EWA.LANG?"Translating...":"\u7ffb\u8bd1\u4e2d...",function(){return!e.IsRun})}}}};this._GetDropListValue=function(){var a=$X("EWA_FRAME_"+this._Id);if(null!=a){for(var b=a.getElementsByTagName("input"),
c=0;c<b.length;c++){var d=b[c];if("droplist"==d.getAttribute("ewa_class")){var e=d.nextSibling;"INPUT"==e.tagName.toUpperCase()&&"HIDDEN"==e.type.toUpperCase()&&this._GetDropListValue1(d,e)}}a=a.getElementsByTagName("select");for(c=0;c<a.length;c++)if(d=a[c],b=d.getAttribute("_ListFilterType"))e=d.getAttribute("_ListFilterField"),this.initSelectFilter(d.id,b,e);this._SelectFilters&&this._checkSelectOptionsChange()}};this._GetDropListValue1=function(a,b){if(""==b.value)b.setAttribute("setvalue",1);
else{var c=b.getAttribute("DlsShow");if(null==c||""==c)b.setAttribute("canopen",0),a.value=b.value,b.setAttribute("canopen",1);else{var d=new EWA_AjaxClass,e=b.getAttribute("xmlName"),f=b.getAttribute("itemName"),g=b.getAttribute("paraName"),h=b.getAttribute("DlsAction");d=new EWA.C.Ajax;var k=b.value;var l=this.EWA_CGI?this.EWA_CGI:window.EWA_CGI?window.EWA_CGI:EWA.CP+"/EWA_STYLE/cgi-bin/";var m=-1==l.indexOf("?")?"?":"&";l=(l+(m+"XMLNAME="+e+"&ITEMNAME="+f+"&EWA_AJAX=JSON")).replace("//","/");l=
l.replace("//","/");l=l.replace("//","/");d.AddParameter(g,k);null!=h&&0<h.trim().length&&(d.AddParameter("EWA_ACTION",h),d.AddParameter(b.id,b.value));d.PostNew(l,function(){if(d.IsRunEnd()){var e=d.GetRst(),f="__json"+Math.random();try{eval('window["'+f+'"]='+e)}catch(w){b.setAttribute("canopen",0);a.value=w;b.setAttribute("canopen",1);return}e=window[f];if(0!=e.length){f=e[0];var g=[];e={};for(var h in f)g.push(f[h]),e["@"+h.toUpperCase()]=f[h],f[h]&&b.setAttribute("para_"+h.toLowerCase(),f[h]);
if(null==c||""==c)e=g.join("/");else{h=c.match(/@[a-zA-Z0-9\-\._:]*\b/ig);for(f=0;f<h.length;f++){g=h[f];var k=e[g.toUpperCase()];c=c.replace(g,k)}e=c}b.setAttribute("canopen",0);a.value=e;b.id=null==b.id||""==b.id?Math.random():b.id;"yes"==b.getAttribute("isdlseventload")&&(EWA.F.FOS[b.id]=new EWA_FrameItemClass,EWA.F.FOS[b.id].DropList(a),EWA.F.FOS[b.id].CallAfterEvent());b.setAttribute("canopen",1);b.setAttribute("setvalue",1)}}})}}};this.DoPostEx=function(){EWA.F.F.CUR=this;if(this.CheckValidAll(document.forms[0])){this._Ajax=
new EWA.C.Ajax;this._Ajax.LoadingType="image";this._Ajax.AddParameter("EWA_AJAX","1");this._Ajax.AddParameter("EWA_POST","1");this._Ajax.AddParameter("EWA_NO_CONTENT","1");for(var a=document.getElementsByTagName("input"),b=0;b<a.length;b+=1){var c=a[b],d=""==c.name?c.id:c.name;null!=d&&""!=d&&this._Ajax.AddParameter(d,c.value)}a=document.getElementsByTagName("select");for(b=0;b<a.length;b+=1)c=a[b],d=""==c.name?c.id:c.name,null!=d&&""!=d&&this._Ajax.AddParameter(d,c.value);a=document.getElementsByTagName("textarea");
for(b=0;b<a.length;b+=1)c=a[b],d=""==c.name?c.id:c.name,null!=d&&""!=d&&this._Ajax.AddParameter(d,c.value);this._Ajax.PostNew(this.Url,EWA.F.F.CUR._CallBack)}};this.CreateAjax=function(a,b){EWA.F.F.CUR=this;null==a&&(a=$("#f_"+this._Id)[0]);if(!b&&!this.CheckValidAll(a))return null;b=new EWA.C.Ajax;for(var c in this.ItemList.Items){var d=this.ItemList.GetItemValue(this.ItemList.Items[c],"Name","Name"),e=this.GetObject(d,a);if(null!=e&&!$(e).attr("ewa_encyrption")){var f=this._GetObjectValue(e);null!=
f&&b.AddParameter(d,f);"DIV"==e.tagName.toUpperCase()&&"1"==e.getAttribute("EWA_DHTML")&&(f=$X("UP_IMG_"+d).value,b.AddParameter(d+"_imgs_split",f));d=e.getAttribute("ewa_tag");if("swffile"==d||"IMG_UPLOAD"==d)if(f=e.getAttribute("UP_PARAS"),null!=f&&0<f.length){f=f.split(",");for(var g=0;g<f.length;g++){var h=f[g];b.AddParameter(h,e.getAttribute(h))}}else b.AddParameter("UP_URL",e.value);"markdown"==d&&(e=e.parentNode.getElementsByTagName("textarea"),1<e.length&&b.AddParameter(e[1].id,e[1].value))}}if(this.PostAddData)for(h in this.PostAddData)b.AddParameter(h,
this.PostAddData[h]);return b};this.CreatePostData=function(){var a=$("#f_"+this._Id)[0],b={},c;for(c in this.ItemList.Items){var d=this.ItemList.GetItemValue(this.ItemList.Items[c],"Name","Name"),e=this.GetObject(d,a);if(null!=e){var f=this._GetObjectValue(e);null!=f&&(b[d]=f);"DIV"==e.tagName.toUpperCase()&&"1"==e.getAttribute("EWA_DHTML")&&(f=$X("UP_IMG_"+d).value,b[d+"_imgs_split"]=f);d=e.getAttribute("ewa_tag");if("swffile"==d||"IMG_UPLOAD"==d)if(f=e.getAttribute("UP_PARAS"),null!=f&&0<f.length){f=
f.split(",");for(var g=0;g<f.length;g++){var h=f[g];b[h]=e.getAttribute(h)}}else b.UP_URL=e.value;"markdown"==d&&(e=e.parentNode.getElementsByTagName("textarea"),1<e.length&&(b[e[1].id]=e[1].value))}}return b};this.DoPostBefore=function(){return!0};this.isDoPostBeforeTimer=function(){return null!=this._checkStatusFristResult};this.DoPost=function(a,b,c){if(!c){c=this.DoPostBefore();if(c instanceof Array){var d=this;this._checkStatusInc=0;this._checkStatusFristResult=c;this._checkStatusTimer=window.setInterval(function(){var c=
0==d._checkStatusInc?d._checkStatusFristResult:d.DoPostBefore();d._checkStatusInc++;null!=c[0]&&(window.clearInterval(d._checkStatusTimer),d._checkStatusTimer=null,d._checkStatusInc=null,d._checkStatusFristResult=null,0==c[0]?c[2]?$Confirm(c[1],c[1],function(){c[0]=c[1]=null;d.DoPost(a,b,!0)},function(){}):$Tip(c[1]):(c[0]=c[1]=null,d.DoPost(a,b,!0)))},232);return}if(!c)return}var e=$(a).find("input[ewa_tag=ht5upload]");if(!(0<e.length)||this.uploadProcess||this.CheckValidAll(a)){for(c=0;c<e.length>
0;c++){var f=e[c],g=f.id;f=!1;g=window["h5u_"+this._Id+"$"+g];if(g.haveFile()){if("ok"!=g.UPLOAD_STATUS){f||(d=this,setTimeout(function(){d.DoPost(a,b)},700),f=!0);$X(g.WAIT_ID)||(g.createWaitBox(),g.submitUploads(),this.uploadProcess=!0);return}g.removeWaitBox()}}e=$(a).find("input[ewa_tag=ht5takephoto]");if(!(0<e.length)||this.uploadProcess||this.CheckValidAll(a)){for(c=0;c<e.length>0;c++){f=e[c];g=f.id;f=!1;g=window["h5takephoto_"+this._Id+"$"+g];if("ok"!=g.UPLOAD_STATUS){if(!$X(g.H5_UPLOAD.WAIT_ID)){try{g.submitUpload()}catch(k){console.log("ht5takephotos - ht5.submitUpload: "+
k);$Tip("\u60a8\u6ca1\u6709\u83b7\u53d6\u7167\u7247");return}g.H5_UPLOAD.createWaitBox();this.uploadProcess=!0}f||(d=this,setTimeout(function(){d.DoPost(a,b)},700),f=!0);return}g.H5_UPLOAD.removeWaitBox()}c=this.CreateAjax(a);if(null!=c){null==b&&(b=this.Url);if(""==b||null==b)b=window.location.href;this._Ajax=c;this._Ajax.AddParameter("EWA_AJAX","1");this._Ajax.AddParameter("EWA_POST","1");this._Ajax.AddParameter("EWA_NO_CONTENT","1");this._Ajax.LoadingType="image";this.DoPostStart&&this.DoPostStart(this._Ajax);
c=new EWA_UrlClass(b);for(var h in this._Ajax._Parameters)c.RemoveParameter(h);b=c.GetUrl();this._Ajax.PostNew(b,EWA.F.F.CUR._CallBack);this.isShowPostWaitting||this._Ajax.HiddenWaitting();$("#EWA_FRAME_"+this._Id+" input[type=submit]").attr("disabled","disabled")}}}};this._CallBack=function(){var a=EWA.F.F.CUR._Ajax;if(a.IsRunEnd())if($("#EWA_FRAME_"+EWA.F.F.CUR._Id+" input[type=submit]").attr("disabled",null),EWA.F.F.CUR.DoPostEnd&&EWA.F.F.CUR.DoPostEnd(a,a._Http.status,a._Http.responseText,a._Http.statusText),
200==a._Http.status){if(a=a._Http.responseText,EWA.F.CheckCallBack(a)){EWA.F.F.CUR.ValidCodeError(!0);try{EWA.F.F.CUR.ReloadAfter&&EWA.F.F.CUR.ReloadAfter(a),eval(a)}catch(b){alert(a)}}}else alert("ERROR:\r\n"+a._Http.statusText)};this.Reload=function(){};this.Reload1=function(){console.log("Reload1 \u8fd9\u4e2a\u5e72\u561b\u7528\uff1f\u8c01\u5728\u8c03\u7528\uff1f")};this.ReloadFrame=function(a){var b=$("#EWA_FRAME_"+this._Id);if(0!=b.length){var c=b.parentsUntil("#EWA_FRAME_MAIN").last().parent();
if(0!=c.length){b=EWA_Utils.tempId("ewa_frame_relaod");c.attr("id",b);var d=new EWA_UrlClass(this.Url);d.AddParameter("ewa_ajax","install");d=d.GetUrl();$Install(d,b,function(){a&&a(c,this)})}}};this.CheckValidAll=function(a){var b=!0,c=null,d;for(d in this.ItemList.Items){var e=this.ItemList.GetItemValue(this.ItemList.Items[d],"Name","Name");e=this.GetObject(e,a);null!=e&&((b&=this.CheckValid(e))||null!=c||(c=e))}null!=c&&c.focus();return b};this.H5Type=function(){var a=$("#EWA_FRAME_"+this._Id),
b;for(b in this.ItemList.Items){var c=this.ItemList.Items[b],d=this.ItemList.GetItemValue(c,"Name","Name");d=a.find('[id="'+d+'"]');if(0!=d.length){var e=this.ItemList.GetItemValue(c,"Tag","Tag"),f=this.ItemList.GetItemValue(c,"DataItem","Valid");this.ItemList.GetItemValue(c,"DataItem","Format");c=this.ItemList.GetItemValue(c,"IsMustInput","IsMustInput");"Email"==f&&d.attr("type","email");"valid"==e&&d.attr("type","tel");1==c&&d.attr("required","required")}}};this.GetObject=function(a,b){b||(b=$("FORM#f_"+
this._Id));a=$(b).find('[id="'+a+'"]');return 0<a.length?a[0]:null};this.CheckValid=function(a,b){if("SPAN"==a.tagName||"IMG"==a.tagName)return!0;if(a&&b&&"DIV"==a.tagName&&"REPT"==a.getAttribute("tag")){b=b.target.tagName;if("LABEL"==b||"INPUT"==b){var c=this;setTimeout(function(){c._GetObjectValue(a);c.ItemList.CheckValid(a,d)},10)}return!0}var d=this._GetObjectValue(a);return this.ItemList.CheckValid(a,d)};this._GetObjectValue=function(a){return this.ItemList.GetObjectValue(a)};this.getUrlClass=
function(){var a=new EWA_UrlClass;a.SetUrl(this.Url);return a}}var __EWA_ALTER_MSG=null;
function EWA_FrameShowAlert(a,b){if(1!=a.getAttribute("show_alert")){a.setAttribute("show_alert",1);var c=a;do if(c=c.parentNode,"BODY"==c.tagName){c=null;break}while("TR"!=c.tagName||1!=c.getAttribute("SHOW_MSG"));if(c)if(1==c.cells.length||"1"==c.parentNode.parentNode.getAttribute("error_show_type")){a=$(c);var d=a.next();if(!d.attr("error")){d=c.parentNode.insertRow(c.rowIndex+1);d.setAttribute("error",1);var e=d.insertCell(-1);e.colSpan=c.cells.length;e.className="ewa-tip-error";d=$(d);e.innerHTML=
'<div class="ewa-tip-error-info"></div>'}a.find("td").addClass("ewa-tip-error");d.find(".ewa-tip-error-info").html(b)}else 3==c.cells.length?(c.style.backgroundColor="lightyellow",null==a.getAttribute("ori_msg")&&(a.setAttribute("ori_msg",c.cells[2].innerHTML),a.setAttribute("ori_st",c.cells[2].style.borderLeft)),c.cells[2].innerHTML=a.getAttribute("ORI_MSG")+"(<font color=red>"+b+"</font>)",c.cells[2].style.borderLeft="2px solid red"):($(c).find("td").css("background-color","lightyellow"),"SELECT"!=
a.tagName&&a.focus(),1==c.cells.length?(c=$(c).prev(),c.attr("id")&&0<c.attr("id").indexOf(a.id)?(null==a.getAttribute("ori_msg")&&a.setAttribute("ori_msg",c[0].cells[0].innerHTML),c[0].cells[0].innerHTML=a.getAttribute("ori_msg")+"(<font color=red>"+b+"</font>)"):(alert("\u8bf7\u8f93\u5165\uff1a"+b),a.focus())):(null==a.getAttribute("ori_msg")&&a.setAttribute("ori_msg",c.cells[0].innerHTML),c.cells[0].innerHTML=a.getAttribute("ori_msg")+"(<font color=red>"+b+"</font>)"));else b=$(a),b.attr("ori_bc",
b.css("background-color")),b.css("background-color","pink"),"SELECT"!=a.tagName&&a.focus()}}
function EWA_FrameRemoveAlert(a){__EWA_ALTER_MSG&&(__EWA_ALTER_MSG.style.display="none");if(1==a.getAttribute("show_alert")){a.setAttribute("show_alert",0);var b=a;do if(b=b.parentNode,"BODY"==b.tagName){b=null;break}while("TR"!=b.tagName||1!=b.getAttribute("SHOW_MSG"));b?(b.style.backgroundColor="",1==b.cells.length||"1"==b.parentNode.parentNode.getAttribute("error_show_type")?(a=$(b),a.find("td").removeClass("ewa-tip-error"),a=a.next(),a.attr("error")&&a.remove()):3==b.cells.length?(b.cells[2].innerHTML=
a.getAttribute("ori_msg"),b.cells[2].style.borderLeft=a.getAttribute("ori_st")):1==b.cells.length?(b=$(b).prev(),b.attr("id")&&0<b.attr("id").indexOf(a.id)&&(b[0].cells[0].innerHTML=a.getAttribute("ori_msg"))):($(b).find("td").css("background-color",""),b.cells[0].innerHTML=a.getAttribute("ori_msg"))):(a=$(a),a.css("background-color",a.attr("ori_bc")))}}
function EWA_FrameShowAlert1(a,b){var c=a;do if(c=c.parentNode,"BODY"==c.tagName){c=null;break}while("TD"!=c.tagName||1!=c.getAttribute("SHOW_MSG")&&"ewa_redraw_info"!=c.className);if(c){var d=c.parentNode.parentNode.parentNode,e=c.previousElementSibling?c.previousElementSibling:c.previousSibling;c.style.backgroundColor="lightblue";e&&1==e.nodeType?(e.style.backgroundColor="lightblue",null==a.getAttribute("ori_msg")&&(a.setAttribute("ori_msg",e.innerHTML),a.setAttribute("ori_st",e.style.borderLeft)),
"*"==b&&(b=$(e).find(".ewa_d1").html()+"\uff1a\u9700\u8981\u8f93\u5165"),e.style.borderLeft="2px solid red"):c.style.borderLeft="2px solid red";a="ERR_"+a.id;c=$(d).find('.ewa_msg_err span[id="'+a+'"]');0<c.length?c.html(b+"&nbsp;"):$(d).find(".ewa_msg_err").append('<span id="'+a+'">'+b+"&nbsp;</span>")}else"*"==b&&(b=a.parentNode.innerText+"\uff1a\u9700\u8981\u8f93\u5165"),$(".ewa_msg_err").html(b),a.focus()}
function EWA_FrameRemoveAlert1(a){if(null!=a.getAttribute("ori_msg")){var b=a;do if(b=b.parentNode,"BODY"==b.tagName)return;while("TD"!=b.tagName||1!=b.getAttribute("SHOW_MSG")&&"ewa_redraw_info"!=b.className);var c=b.parentNode.parentNode.parentNode,d=b.previousElementSibling?b.previousElementSibling:b.previousSibling;b.style.backgroundColor="";d&&1==d.nodeType?(d.style.backgroundColor="",d.style.borderLeft=a.getAttribute("ori_st")):b.style.borderLeft=a.getAttribute("ori_st");a="ERR_"+a.id;$(c).find('.ewa_msg_err span[id="'+
a+'"]').remove()}}EWA.F&&EWA.F.F?EWA.F.F.C=EWA_FrameClass:(EWA.F||(EWA.F={}),EWA.F.F={CUR:null,C:EWA_FrameClass});
function EWA_FrameItemClass(){this._Dialog=this._Object1=this._Object=this._Ajax=null;this._Items={};this._SelectedValue=this._LastMoveTr=null;this.DropList=function(a,b){var c=a.nextSibling;this._Object=a;this._Object1=c;if(""==a.value)c.value="";else if(0!=c.getAttribute("canopen"))if(b||null==this._SelectedValue||this._SelectedValue!=a.value){this._inputValue=a.value;var d=c.getAttribute("xmlName"),e=c.getAttribute("itemName");b=c.getAttribute("paraName");_EWA_FRAME_ITEM=this;var f=new EWA.C.Ajax;
f.LoadingType="none";var g="%"+a.value+"%";var h=window.EWA_CGI?window.EWA_CGI:EWA.CP+"/EWA_STYLE/cgi-bin/";h+="?XMLNAME="+d.toURL()+"&ITEMNAME="+e.toURL()+"&EWA_AJAX=NOJS&EWA_LF_NOHEADER=1";(d=$U())&&(h+="&"+d);$(a).attr("ewa_drop_list_para")?h+="&"+$(a).attr("ewa_drop_list_para"):$(c).attr("ewa_drop_list_para")&&(h+="&"+$(c).attr("ewa_drop_list_para"));a=new EWA_UrlClass(h);a.RemoveParameter(b);h=a.GetUrl();f.AddParameter(b,g);f.PostNew(h,function(){if(f.IsRunEnd()){var a=f.GetRst();_EWA_FRAME_ITEM.Show(!0);
_EWA_FRAME_ITEM.SetContent(a)}});this.SetContent(this._Items[c.value])}else this._SelectedValue=null};this.MouseOver=function(a){a=a?a:window.event;a=a.srcElement?a.srcElement:a.target;if("TD"==a.tagName){a=a.parentNode;if(null!=this._LastMoveTr)for(var b=0;b<this._LastMoveTr.cells.length;b+=1)this._LastMoveTr.cells[b].style.backgroundColor="";if("HEADER"==a.getAttribute("EWA_TAG"))this._LastMoveTr=null;else{for(b=0;b<a.cells.length;b+=1)a.cells[b].style.backgroundColor="#cccccc";this._LastMoveTr=
a}}};this.MouseDown=function(a){a=a?a:window.event;a=a.srcElement?a.srcElement:a.target;if("DIV"!=a.tagName){if("TR"==a.tagName)var b=a;else{var c=$(a).parentsUntil("tbody").last();if(0==c.length){console.log(a);return}b=c[0]}if(null==b)console.log(a);else if("TR"!=b.tagName)console.log(a);else if("HEADER"!=b.getAttribute("ewa_tag")){a=this._Object.nextSibling;a.setAttribute("canopen",0);c=[];for(var d={},e=0;e<b.cells.length;e+=1){var f=b.cells[e];f.style.backgroundColor="lightyellow";var g=GetInnerText(f).trim();
c[c.length]=g;f=f.childNodes[0].id;null!=f?(d["@"+f.toUpperCase()]=g,this._Object1.setAttribute("para_"+f.toLowerCase(),g)):d[e]=g}this._LastMoveTr=null;this._SelectedValue=c[0];this._Object1.value=c[0];b=this._Object1.getAttribute("DlsShow");if(null==b||""==b)this._Object.value=c[0];else{g=b.match(/@[a-zA-Z0-9\-\._:]*\b/ig);for(e=0;e<g.length;e++){f=g[e];var h=d[f.toUpperCase()];b=b.replace(f,h)}this._Object.value=b}this._Object.parentNode.setAttribute("title",c.join("\n"));this._Object1.getAttribute("afterEvent");
this.CallAfterEvent();this.Show(!1);a.setAttribute("canopen",1)}}};this.CallAfterEvent=function(){var a=this._Object1.getAttribute("afterEvent");if(null!=a&&0!=a.trim().length){var b=eval("window."+a);if("function"==typeof b)try{b(this._Object1.value,this._Object.value,this._Object1,this._Object)}catch(c){alert("\u5b9a\u4e49\u7684Js "+a+"\u6267\u884c\u9519\u8bef\uff1a"+c)}else alert("\u5b9a\u4e49\u7684Js "+a+"\u4e0d\u5b58\u5728, \u5bf9\u8c61\u4e3a"+typeof b)}};this.Show=function(a){if(null==this._Dialog){var b=
$(this._Object).width();b=400<b?b+"px":"500px";var c="180px";null!=this._Object1.getAttribute("set-dialog-width")&&(b=this._Object1.getAttribute("set-dialog-width"));null!=this._Object1.getAttribute("set-dialog-height")&&(c=this._Object1.getAttribute("set-dialog-height"));EWA.B.PAD&&(b=document.documentElement.clientWidth+"px",c=document.documentElement.clientHeight-300+"px");this._Dialog=new EWA_UI_DialogClass;this._Dialog.Width=b;this._Dialog.Height=c;this._Dialog.ShadowColor="";"undefined"==typeof _EWA_DialogWnd?
this._Dialog.CreateWindow=window:(this._Dialog.CreateWindow=_EWA_DialogWnd._ParentWindow,_EWA_DialogWnd.OpendDialogs[_EWA_DialogWnd.OpendDialogs.length]=this._Dialog);this._Dialog.Create();b="<div style='position:absolute;width:"+b+";height:"+c+";overflow-y:scroll;overflow-x:hidden;border:1px solid #ccc;cursor:pointer'";b=EWA.B.PAD?b+" onclick='_EWA_FRAME_ITEM.MouseDown(event)' ></div>":b+" onmouseover='_EWA_FRAME_ITEM.MouseOver(event)'  onmousedown='_EWA_FRAME_ITEM.MouseDown(event)' ></div>";this._Dialog.SetHtml(b);
$(this._Dialog.GetFrame()).addClass("ewa-ddl-list")}this._Dialog.ShowType=a;this._Dialog.MoveBottom(this._Object);this._Dialog.Show(a);this._Dialog.CreateWindow._EWA_FRAME_ITEM=this;_EWA_FRAME_ITEM=this};this.SetContent=function(a){if(null!=a)if(a=a.replace(/onmouseout/ig,"z1"),a=a.replace(/onmousedown/ig,"z2"),a=a.replace(/onmouseover/ig,"z3"),null==this._Items[this._Object.value]&&(this._Items[this._Object.value]=a),this._Dialog.GetFrameContent().childNodes[0].innerHTML=a,a=this._Dialog.GetFrameContent().childNodes[0].getElementsByTagName("table")[0],
a.style.position="absolute",1>=a.rows.length||0==this._Object.value.length)1>=a.rows.length&&this.Show(!1);else{try{for(var b=eval("/("+this._Object.value+")/ig"),c=1;c<a.rows.length;c+=1)for(var d=a.rows[c],e=0;e<d.cells.length;e++){var f=GetInnerText(d.cells[e].childNodes[0]);d.cells[e].childNodes[0].innerHTML=f.replace(b,"<font color=blue><b>$1</b></font>")}}catch(g){}this.Show(!0)}}}EWA.F.F?EWA.F.F.FI=EWA_FrameItemClass:EWA.F.F={CUR:null,FI:EWA_FrameItemClass};
function EWA_FrameMapToClass(){this.EWA=null;this.mapRef=function(a,b,c){this.POST_URL=c;this.EWA=b;var d=$("#EWA_FRAME_"+this.EWA._Id);this._Id=this.EWA._Id+"_MAPTO";EWA.F.FOS[this._Id]=this;var e=this;$(a).find("[ref]").each(function(){try{e.mapRefItem(this,d)}catch(f){console.log(f,this)}})};this.checkbox=function(a){a=$(a).parentsUntil('div[tag="REPT"]').last().parent();var b=[];a.find("input:checked").each(function(){b.push(this.value)});a={key:a.attr("id"),val:b.join(",")};$JP(this.POST_URL||
window.location.href,a,function(a){a.RST?$TipTL("\u4fdd\u5b58\u5b8c\u6bd5"):$Tip(a.ERR)})};this.showGpsMap=function(a,b){var c=a.attr("ref_map");if(c){var d=b.parent().parent().next().find(".ewa-map-small");if(0==d.length){var e=this;setTimeout(function(){e.showGpsMap(a,b)},100)}else 0==c.indexOf(".")||0==c.indexOf("#")?$(c).append(d.css("height","100%")):$("#"+c).append(d.css("height","100%"))}};this.mapRefItem=function(a,b){var c=$(a),d=c.attr("ref");d=b.find('[id="'+d+'"]');var e=!1,f=this,g="",
h="EWA.F.FOS['"+this._Id+"']";if("hidden"==d[0].type){if(!d.attr("setvalue")){setTimeout(function(){f.mapRefItem(a,b)},100);return}d=d.prev();g=d.val();c.attr("onclick",h+".modifyRef(this)").css("cursor","pointer")}else if("addressMap"==d.attr("ewa_tag"))g=d.val(),c.attr("onclick",h+".modifyRef(this)").css("cursor","pointer"),this.showGpsMap(c,d);else{if("REPT"==d.attr("tag")){c=$(a);c.offset();c.offset();c.outerWidth();c.append(d);d.find("input[type=checkbox]").attr("onclick",h+".checkbox(this)");
return}"1"==d.attr("ewa_dhtml")?(e=!0,g=d[0].textContent,c.attr("onclick",h+".modifyRefHtml(this)").css("cursor","pointer")):("SELECT"==d[0].tagName?g=d[0].options[d[0].selectedIndex].text:"TEXTAREA"==d[0].tagName?((g=d.val())&&(g="<div>"+g.replace(/</,"&lt;").replace(/>/,"&gt;").replace(/\n/ig,"</div><div>")+"</div>"),e=!0):g=d.val(),c.attr("onclick",h+".modifyRef(this)").css("cursor","pointer"))}g||(g="...................");e?c.html(g):c.text(g);c.append('<i style="margin-left:5px" class="fa fa-edit"></i>')};
this.createRefCaption=function(a,b,c,d){if($X(a+"_____tip"))e=$($X(a+"_____tip")),e.show();else{e=document.createElement("div");var e=$(e);e.css({position:"absolute",left:c,top:d-30,height:30,"line-height":"30px",background:"antiquewhite",padding:"0 10"}).text(b);e.attr("id",a+"_____tip");$("body").append(e)}return e};this.modifyRefHtml=function(a){var b=$(a),c=b.attr("ref"),d=$("#EWA_FRAME_"+this.EWA._Id).find('[id="'+c+'"]').prev(),e=b.offset().left,f=b.offset().top,g=b.outerWidth(),h=b.outerHeight();
g={position:"absolute",left:e,top:f,width:g,height:h,font:b.css("font"),border:"2px solid antiquewhite",outline:"none"};d.css(g);$(d.find("iframe")[0].contentWindow.document.body).css("width","auto").css("font",b.css("font"));oldv=window[d.attr("id").replace("box","")].GetHtml();d.attr("oldv",oldv);g=$($X("_ewa_tr$"+c).cells[0]).text();var k=this.createRefCaption(c,g,e,f);d.focus();var l=this;window.onmousedown=function(c){if(!l.checkInHtmlEditor(c.target)){c=d.attr("id").replace("box","");var e=
window[c].GetHtml();window.onmousedown=null;c=d.attr("oldv");e==c?($(d).attr("style",""),k.hide()):(c={key:$(a).attr("ref"),val:e},$JP(l.POST_URL||window.location.href,c,function(a){$(d).attr("style","");k.hide();a.RST?(""==e&&(e="............."),b.html(e),$TipTL("\u4fdd\u5b58\u5b8c\u6bd5"),b.append('<i style="margin-left:5px" class="fa fa-edit"></i>')):$Tip(a.ERR)}))}}};this.checkInHtmlEditor=function(a){a=$(event.target).parents();for(var b=0;b<a.length;b++){var c=$(a[b]);if(c.hasClass("ewa-editor")||
c.hasClass("ewa-editor-pop")||c.hasClass("ewa-dialog"))return!0}return!1};this.modifyRef=function(a){var b=$(a);a=b.attr("ref");var c=$("#EWA_FRAME_"+this.EWA._Id).find('[id="'+a+'"]');"hidden"==c[0].type&&(c=$(c).prev());var d=b.offset().left,e=b.offset().top,f=b.outerWidth(),g=b.outerHeight();"TEXTAREA"==c[0].tagName&&(g+=30);f={position:"absolute",left:d,top:e,width:f,height:g,font:b.css("font"),border:"2px solid antiquewhite",outline:"none"};c.css(f);f=c.val();c.attr("oldv",f);f=$($X("_ewa_tr$"+
a).cells[0]).text();var h=this.createRefCaption(a,f,d,e);c.focus();if(!c.attr("evtblur")){c.attr("evtblur","is_setted");var k=this;addEvent(c[0],"keydown",function(a){a=a.keyCode;13==a&&"TEXTAREA"!=c[0].tagName?this.blur():27==a&&(this.value=$(this).attr("oldv"),this.blur())});addEvent(c[0],"blur",function(){var a=$(this.parentNode.parentNode.cells[0]),c=a.css("background-color"),d=$(this).attr("onmousedown");if(d){var e=d.indexOf(".CheckValid");d=d.substring(0,e);if(eval(d).CheckValid(this))$(this).css("background",
"");else{this.focus();$(this).css("background","pink");return}}d=this.id;e=this.value;"droplist"==$(this).attr("ewa_class")&&(e=$(this).next().val(),d=$(this).next().attr("id"));d={key:d,val:e};if("rgb(255, 255, 224)"==c)$Tip(a.html()),h.hide(),this.focus();else if(this.value==$(this).attr("oldv"))$(this).attr("style",""),h.hide();else{var f=this;$JP(k.POST_URL||window.location.href,d,function(a){$(f).attr("style","");h.hide();a.RST?(a="SELECT"==f.tagName?f.options[f.selectedIndex].text:f.value,"TEXTAREA"==
f.tagName?""==a?b.html("............."):(a=a.replace(/</ig,"&lt;").replace(/>/ig,"&gt;"),a="<div>"+a.split("\n").join("</div><div>")+"</div>",b.html(a)):(""==a&&(a="............."),b.text(a)),b.append('<i style="margin-left:5px" class="fa fa-edit"></i>'),$TipTL("\u4fdd\u5b58\u5b8c\u6bd5")):$Tip(a.ERR)})}})}}}
function EWA_ListFrameClass(){this._Ajax=this.Xml=null;this.ItemList=new EWA_FrameCommonItems;this._SortName=this._Sort=this._RecordCountName=this._PageCountName=this._PageSizeName=this._PageCurrentName=this._RecordCount=this._PageCount=this._PageSize=this._PageCurrent=null;this._SearchExp="";this._SearchHtml=null;this._SearchFields=[];this._Id=null;this._IsCheckedAll=!0;this._SearchDialog=null;this._SearchJson={};this.Resources={};this.GotoParas=[];this._CurTr=null;this._TrSelectMulti=!0;this.IsTrSelect=
!1;this.CheckedAllAfter=this.ReloadAfter=null;this.IsNotMDownAutoChecked=!1;this.ShowRecycle=function(){var a=$X("EWA_LF_"+this._Id);if(null!=a&&(a=$(a).parentsUntil("table").last().find(".ewa_lf_func_caption"),0!=a.length)){var b="\u56de\u6536\u7ad9";window._EWA_INFO_MSG&&window._EWA_INFO_MSG.RECYCLE&&(b=window._EWA_INFO_MSG.RECYCLE);b="<div class='ewa_lf_func_dact ewa-lf-func-recycle' onclick='EWA.F.FOS[\""+this._Id+"\"].ShowRecycle1(this)' ><b class='fa fa-recycle'></b>"+b+"</div>";a.parent().append(b)}};
this.ShowRecycle1=function(a){var b=new EWA_UrlClass(this.Url);$(a).attr("recycle")?(b=b.RemoveParameter("ewa_recycle"),$(a).attr("recycle",null).removeClass("ewa-lf-func-recycle-yes")):(b=b.AddParameter("ewa_recycle","1"),$(a).attr("recycle",1).addClass("ewa-lf-func-recycle-yes"));this.Url=b;this.Goto(1)};this.BindButton=function(a,b){$("#EWA_LF_"+this._Id+' tr[ewa_key] [id="'+a+'"]').each(function(){$(this).attr("onclick","$(this).parent().parent().find('[id=\""+b+"\"]')[0].click()");$(this).addClass("ewa-map-button")})};
this.Merge=function(a,b,c,d){$("#EWA_LF_"+this._Id+" tr[ewa_key]").each(function(){var e=$(this).find('[id="'+a+'"]');e.parent().hide();var f=$(this).find('[id="'+b+'"]').parentsUntil("tr").last();c||(c="<br>");0<=c.indexOf("<")?f.append(c):f.append("<span class='ewa-mearge-str'>"+c+"</span>");f.append(e);d&&d(f,this)});$("#EWA_LF_"+this._Id+' tr[ewa_tag="HEADER"] [id="'+a+'"]').parent().hide()};this.Mearge=function(a,b,c){console.log("\u62fc\u5199\u9519\u8bef\uff0c\u8bf7\u7528 Merge");this.Merge(a,
b,c)};this.MergeExp=function(a,b,c,d){if(b){var e=b.match(/@@[a-zA-Z0-9\-\._:]*\b/ig),f=[],g=b,h={};for(b=0;b<e.length;b++){var k=e[b];f.push(k);var l=k.replace("@@","");g=g.replace(k,"<span class='ewa-lf-mearge ewa-lf-mearge-"+l+"' mid=\""+l+'"></span>');l!=a&&$("#EWA_LF_"+this._Id+' tr[ewa_tag="HEADER"] [id="'+l+'"]').parent().hide();h[l]=$("#EWA_LF_"+this._Id+' tr[ewa_tag="HEADER"] [id="'+l+'"]').html()}$("#EWA_LF_"+this._Id+" tr[ewa_key]").each(function(){var b=document.createElement("div");b.style.display=
"none";b.innerHTML=g;document.body.appendChild(b);if(0==$(this).find('[id="'+a+'"]').length)console.log("not find "+a);else{var e=$(this).find('[id="'+a+'"]').parent(),k;for(k in f){var l=f[k].replace("@@",""),n=$(this).find('[id="'+l+'"]');if(0!=n.length){l!=a&&n.parent().hide();var u=$(b).find('span[mid="'+l+'"]');c&&(u.append("<span class='ewa-lf-mearge-memo'></span>"),u.find(".ewa-lf-mearge-memo").html(h[l]));u.append(n)}}for(;0<b.childNodes.length;)e.append(b.childNodes[0]);$(b).remove();d&&
d(e,this)}})}else console.log("mergeExp \u6ca1\u6709\u8bbe\u7f6e")};this.MeargeExp=function(a,b,c,d){console.log("\u62fc\u5199\u9519\u8bef\uff0c\u8bf7\u7528 MereExp");this.MergeExp(a,b,c,d)};this.SubBottoms=function(a){this.SubBottomsArray=a.split(",");this._SubBottoms()};this._SubBottoms=function(){var a=this.AddRow([]);$(a).find("td").addClass("ewa-lf-sub-td");var b=0,c;for(c in this.SubBottomsArray){var d=this.SubBottomsArray[c],e=0;$("#EWA_LF_"+this._Id+" .ewa-col-"+d).each(function(){var a=GetInnerText(this).replace(/,/ig,
"");isNaN(a)||(e+=1*a,0<a.indexOf(".")&&(b=2))});$(a).find("td[id=ADD_ROW_"+d+"]").html("<nobr class='ewa-lf-sub'>"+e.fm(b)+"</nobr>")}};this.ChangeRowStyle=function(a,b,c){for(var d=$X("EWA_LF_"+this._Id),e=1;e<d.rows.length;e++){var f=d.rows[e];if(!(0==f.cells.length||f.cells.length<=a)){var g=f.cells[a].childNodes[0].getAttribute(b);if(null!=g&&c[g])for(var h=0;h<f.cells.length;h++)f.cells[h].style.cssText=f.cells[h].style.cssText+";"+c[g]}}if(null==this.ReloadAfter){var k=this;this.ReloadAfter=
function(){k.ChangeRowStyle(a,b,c)}}};this.MDownEvent=function(a,b){};this.LoadJson=function(a,b){null!=a&&$J(this.Url+"&EWA_ACTION="+a+"&EWA_AJAX=JSON",b)};this.Workflow=function(a,b,c,d,e,f){EWA.F.CID=this._Id;this._Ajax=this.CreateAjax();this._Ajax.AddParameter("EWA_AJAX","WORKFLOW");this._Ajax.AddParameter("EWA_ID",this._Id);this._Ajax.AddParameter("EWA_WF_NAME",b);null!=c?(a=this.GetRowKey(c),this._Ajax.AddParameter("EWA_ACTION_KEY",a),"true"==c.getAttribute("ewa_wf_control")?this._Ajax.AddParameter("EWA_WF_CTRL",
1):this._Ajax.AddParameter("EWA_WF_CTRL",0)):this._Ajax.AddParameter("EWA_WF_CTRL",1);null!=d&&this._Ajax.AddParameter("EWA_ACTION_KEY",d);e&&this._Ajax.AddParameter("EWA_WF_UOK",e);f&&this._Ajax.AddParameter("EWA_WF_UMSG",f);var g=this;this._Ajax.PostNew(this.Url,function(){g._CallBackJs()})};this.GetRowKey=function(a){a=this.GetRow(a);return null!=a?a.getAttribute("EWA_KEY"):null};this.GetRow=function(a){if(null==a||null==a.tagName||""==a.tagName)return null;var b=0;for(a=a.parentNode;"TR"!=a.tagName||
null==a.getAttribute("EWA_KEY");){a=a.parentNode;if("BODY"==a.tagName){a=null;break}b++;if(100<b){alert("\u5faa\u73af100\u6b21\uff0c\u672a\u53d1\u73b0TR");break}}return a};this.RecordModify=function(a,b,c){var d=this.SelectChecked();if(0==d.length)EWA.UI.Msg.Alter("\u8bf7\u5148\u9009\u62e9","\u4fee\u6539");else{var e="EWA_MTYPE=M";null!=c&&0<c.trim().length&&(e+="&"+c);EWA.UI.Dialog.OpenReloadClose(this._Id,a,b,!1,e+d)}};this.RecordNew=function(a,b,c){var d="EWA_MTYPE=N";null!=c&&0<c.trim().length&&
(d+="&"+c);EWA.UI.Dialog.OpenReloadClose(this._Id,a,b,!1,d)};this.SelectSingle=function(){this.IsTrSelect=!0;this._TrSelectMulti=!1};this.SelectMulti=function(){this._TrSelectMulti=this.IsTrSelect=!0};this.MOver=function(a,b){if(this.IsTrSelect&&this._CurTr!=a&&(null!=this._CurTr&&("1"!=this._CurTr.getAttribute("__ewa_lf_mdown")?this._MSetBg(this._CurTr,""):this._MSetBg(this._CurTr,"down")),"1"!=a.getAttribute("__ewa_lf_mdown")?this._MSetBg(a,"over"):this._MSetBg(a,"down"),this._CurTr=a,this.MOverEvent))try{this.MOverEvent(a,
b)}catch(c){console.log(c,this.MOverEvent)}};this.MOut=function(a){if(this.IsTrSelect&&null!=this._CurTr&&"1"!=this._CurTr.getAttribute("__ewa_lf_mdown")){this._MSetBg(this._CurTr,"out");if(this.MOutEvent)try{this.MOutEvent(this._CurTr,a)}catch(b){console.log(b,this.MOutEvent)}this._CurTr=null}};this.MDownEnableCheck=function(a,b){return!0};this.MDown=function(a,b){if(this.IsTrSelect&&(b=null==b?event:b,this.MDownEnableCheck(a))){if(b){var c=b.srcElement?b.srcElement:b.target;if(c&&("A"==c.tagName||
"INPUT"==c.tagName||"SELECT"==c.tagName||"BUTTON"==c.tagName||"TEXTAREA"==c.tagName||0<=c.className.indexOf("EWA_LF_EDIT")||0<=c.className.indexOf("ewa-lf-edit")||0<=c.className.indexOf("ewa-lf-search-text-click")||0<=c.parentNode.className.indexOf("ewa-lf-search-text-click")||0<=c.parentNode.parentNode.className.indexOf("ewa-lf-search-text-click")))return}var d=(new Date).getTime(),e=$(a).attr("mdown_time_last");if(!(null!=e&&500>d-e)){$(a).attr("mdown_time_last",d);d=null;if(!this.IsNotMDownAutoChecked){var f=
a.getElementsByTagName("input");if("INPUT"!=c.tagName&&0<f.length)for(c=0;c<f.length;c++){if("RADIO"==f[c].type.toUpperCase()){d=f[c];d.click();break}if("CHECKBOX"==f[c].type.toUpperCase()&&0>f[c].parentNode.className.indexOf("ewa-switch")){d=f[c];d.click();break}}}if("1"==a.getAttribute("__ewa_lf_mdown"))this._TrSelectMulti&&(d&&"CHECKBOX"==d.type.toUpperCase()&&(d.checked=!1),this._MSetBg(a,""),a.removeAttribute("__ewa_lf_mdown"),$(a).removeClass("ewa-lf-mdown"));else{d&&(d.checked=!0);this._MSetBg(a,
"down");a.setAttribute("__ewa_lf_mdown",1);$(a).addClass("ewa-lf-mdown");if(!this._TrSelectMulti)for(d=a.parentNode,c=0;c<d.rows.length;c++)e=d.rows[c],"1"==e.getAttribute("__ewa_lf_mdown")&&e!=a&&(e.removeAttribute("__ewa_lf_mdown"),$(e).removeClass("ewa-lf-mdown"),this._MSetBg(e,""));if(this.IsReShow)for(c=0;c<f.length;c++)"BUTTON"==f[c].type.toUpperCase()&&(d=f[c],"true"==d.getAttribute("disabled")||1==d.getAttribute("disabled")||"true"==d.parentNode.getAttribute("disabled")||1==d.parentNode.getAttribute("disabled")?
(this._ReshowButs[d.value].disabled=!0,this._ReshowButs[d.value].style.display="none"):(this._ReshowButs[d.value].disabled=!1,this._ReshowButs[d.value].style.display=""))}if(this._IsAddPreRow){if(f=a.getAttribute("ewa_key"),this.AddPreRowCheck(a,f,b)){d=a.parentNode.rows[a.rowIndex+1];if(null==d||1!=d.getAttribute("add_pre_row"))d=a.parentNode.parentNode,c=d.rows[0].cells.length,d=d.insertRow(a.rowIndex+1),d.setAttribute("add_pre_row",1),e=d.insertCell(-1),e.innerHTML="",e.colSpan=c,e.className="",
d.style.display="none",e.id=("EWA_LF_NR_"+this._Id+"_"+Math.random()).replace(".","G"),$(d).addClass("ewa-lf-add-pre-row");this.prevTr&&(this.AddPreRowCloseBeforeEvent&&this.AddPreRowCloseBeforeEvent(this._Id,a,f,this.prevTr,b),this.prevTr.style.display="none",this.prevTr.cells[0].innerHTML="",this.AddPreRowCloseEvent&&this.AddPreRowCloseEvent(this._Id,a,f,this.prevTr,b));this.prevTr==d?this.prevTr=null:(this.prevTr=d,this.prevTr.style.display="",this.MDownEvent(this._Id,a,f,this.prevTr,b))}}else this.MDownEvent(a,
b)}}};this.AddPreRow=function(a){this._IsAddPreRow||(this.MDownEvent=a);this._IsAddPreRow=!0};this.AddPreRowCheck=function(a,b,c){return!0};this.AddPreRowCloseBeforeEvent=function(a,b,c,d,e){};this.AddPreRowCloseEvent=function(a,b,c,d,e){};this._MSetBg=function(a,b){var c="EWA_TD_M";"down"==b?c="ewa_grid_down":"over"==b&&(c="ewa_grid_mover");for(b=0;b<a.cells.length;b++)$(a.cells[b]).removeClass("ewa_grid_mover ewa_grid_down EWA_TD_M").addClass(c)};this._ReShowSearchQuick=function(){var a=this,b=
EWA_ListFrameClass.prototype.RESOURCES.search_text_items,c,d,e;for(e in b){var f=b[e];"eq"==f.Id&&(c=f);"lk"==f.Id&&(d=f)}for(e in this._SearchJson){var g=this._SearchJson[e];g.isSearchQuick&&(b=$("#EWA_LF_"+this.Id+' .ewa-lf-data-row [id="'+e+'"]'),b.bind("click",function(b){b.stopPropagation();var e=$(this).attr("search_tag"),f=$(this).text(),g=f,h=$("table#EWA_SEARCH_ITEM_"+a.Id+' .ewa-lf-search-item-ctl [name="'+this.id.toUpperCase()+'"]');if("number"==e||"date"==e)h=h.parentsUntil(".ewa-lf-search-item").last().find("input");
var r=h.parentsUntil(".ewa-lf-search-item").last().find("a");console.log(b);if("date"==e)f=f.split(" ")[0],g=f+" 23:59:59";else if("fix"==e){var p=null;h.find("option").each(function(){this.text==f&&(p=this.value)});f=null===p?"":p}console.log(f,g);h.val()==f?("text"==e&&d&&0<r.length&&(r.attr("tag",d.Id),r.html("enus"==EWA.LANG?d.TxtEn:d.Txt)),h.val("")):("text"==e&&c&&0<r.length&&(r.attr("tag",c.Id),r.html("enus"==EWA.LANG?c.TxtEn:c.Txt)),h.val(f),"date"==e&&(h[1].value=g))}),b.each(function(){$(this).text()&&
$(this).addClass("ewa-lf-search-text-click").attr("search_tag",g.T)}))}};this.ReShowWithNoButtons=function(){var a=$X("EWA_LF_"+this._Id),b=[],c;for(c in this.ItemList.Items){var d=this.ItemList.Items[c],e=this._GetSubValue("Tag","Tag",d);if(null!=e&&"button"==e.trim().toLowerCase())for(e=0;e<a.rows[0].cells.length;e++)if(a.rows[0].cells[e].childNodes[0].id.toUpperCase()==c){b.push(e);d.setAttribute("but_show","1");break}}this.ShowHiddenColumns(b,!1)};this.ReShowButtonsInDailogTitle=function(){EWA.OW.Load();
if(EWA.OW.Dia){var a=$(EWA.OW.Dia._Dialog.GetFrameTitle()),b=$($X("EWA_RESHOW_"+this._Id)).find("td.ewa_lf_func:eq(0)"),c=this;b.find(".ewa_lf_func_dact").each(function(){this.id=EWA_Utils.tempId("gDx_"+c._Id+"_")});a.html(b.html());a.find(".ewa_lf_func_dact").each(function(){this.onclick=function(){b.find('div[id="'+this.id+'"]').click()}});b.parent().hide();$(EWA.OW.Dia._Dialog.GetFrame()).addClass("ewa-lf-btns-in-title")}};this.ReShow=function(a){this.IsReShow=!0;a=document.createElement("table");
a.id="EWA_RESHOW_"+this._Id;a.cellSpacing="0";a.cellPadding="0";var b=!(0<this.Url.toUpperCase().indexOf("EWA_AJAX=INSTALL")||0<this.Url.toUpperCase().indexOf("EWA_CALL_METHOD=INNER_CALL")||0<this.Url.toUpperCase().indexOf(".JSP"));b?EWA.UI.Utils.SetStyle(a,"width:100%;height:100%;"):EWA.UI.Utils.SetStyle(a,"width:100%");var c=a.insertRow(-1),d=c.insertCell(-1),e=a.insertRow(-1).insertCell(-1);e.className="ewa_lf_func";e.innerHTML='<div style="display:none"></div><div></div>';var f=a.insertRow(-1).insertCell(-1);
f.vAlign="top";EWA.UI.Utils.SetStyle(f,"width:100%;");css="";f.innerHTML='<div id="_G_'+this._Id+'" style="'+css+'"></div>';var g=$X("EWA_LF_"+this._Id),h=g.parentNode.parentNode.parentNode;f.childNodes[0].appendChild(g.parentNode);var k="_G_"+this._Id;this.NewDivId=k;b&&(window.setTimeout(function(){$X("__EWA_DEBUG")&&f.childNodes[0].appendChild($X("__EWA_DEBUG"));var a=$X(k);a.getElementsByTagName("table");var b=EWA.UI.Utils.GetDocSize(window),c=a.parentNode.parentNode.previousSibling.offsetHeight;
a.style.top=c+"px";a.style.height=b.H-c+"px"},100),addEvent(window,"resize",function(){var a=$X(k),b=EWA.UI.Utils.GetDocSize(window),c=a.parentNode.parentNode.previousSibling.offsetHeight;a.style.top=c+"px";a.style.height=b.H-c+"px"}));for(;0<h.childNodes.length;)e.childNodes[0].appendChild(h.childNodes[0]);var l=EWA.UI.Utils.CreateObject(window,"div","cursor:pointer",e.childNodes[1]);l.className="ewa_lf_func_caption";b=l;var m=[],q=!1,r=GetInnerText(e);r=r.trim();this._ReshowButs={};for(var p in this.ItemList.Items){l=
this.ItemList.Items[p];var n=this._GetSubValue("Tag","Tag",l);if(null!=n&&("button"==n.trim().toLowerCase()||"butflow"==n.trim().toLowerCase()))for(n=0;n<g.rows[0].cells.length;n++)if(g.rows[0].cells[n].childNodes[0].id.toUpperCase()==p){m.push(n);q=!0;n=this._GetSubValue("DescriptionSet","Info",l);var u=this._GetSubValue("DescriptionSet","Memo",l),w=this._GetSubValue("EventSet","EventName",l),v="";null!=w&&"ewa_click"==w.toLowerCase().trim()&&(v=this._GetSubValue("EventSet","EventValue",l));r=r.replace(n,
"");l=this._ReShowButton(n,u,null);this._ReshowButs[n]=l;l.setAttribute("f_id",this._Id);e.childNodes[1].appendChild(l);""==v?l.onclick=function(){var a=this.getAttribute("f_id");a=EWA.F.FOS[a].SelectCheckedRows();if(null==a||0==a.length)EWA.UI.Msg.Alert(_EWA_INFO_MSG["EWA.SYS.CHOOSE_ITEM"],_EWA_INFO_MSG["EWA.SYS.CHOOSE_ITEM_TITLE"]);else{a=a[0].getElementsByTagName("input");for(var b=0;b<a.length;b++){var c=a[b];if("button"==c.type&&c.value==this.childNodes[0].innerHTML){c.click();break}}}}:(l.setAttribute("ewa_click",
v),l.onclick=function(){eval(this.getAttribute("ewa_click"))});break}}q&&this._ReShowSplit(e.childNodes[1]);m=e.getElementsByTagName("input");g={};for(n=0;n<m.length;n++){var t=m[n];t.style.display="none";if(null==t.id||""==t.id)t.id=("_tmp_"+Math.random()).replace(".","_");if("button"==t.type){if(l=this._ReShowButton(t.value,t.title,t.id),q=t.nextSibling){var x="";3==q.nodeType&&(x=q.nodeValue.trimEx());"|"==x&&this._ReShowSplit(e.childNodes[1])}}else(q=t.nextSibling)&&(x=3==q.nodeType?q.nodeValue.replace("|",
""):q.innerHTML),l=this._ReShowButton(x.trimEx(),t.title,t.id),l.id=("_tmp_"+Math.random()).replace(".","_"),g[t.name]||(g[t.name]=[]),g[t.name].push(l.id);e.childNodes[1].appendChild(l)}r=r.replace(/ /ig,"").replace(/\|/ig,"").trimEx();""!=r?0<=r.indexOf("if")?c.style.display="none":d.innerHTML=r.replace(/ /,""):c.style.display="none";h.appendChild(a);for(p in g)for(x=g[p],n=0;n<x.length;n++)t=$X(x[n]),t.setAttribute("_r_ids",x.join(",")),t.onclick=function(){var a=this.getAttribute("_ewa_event_id");
$X(a).click();a=this.getAttribute("_r_ids").split(",");for(var b=0;b<a.length;b++)t.id!=a[b]&&($X(a[b]).style.fontWeight="",$X(a[b]).style.color="");this.style.fontWeight="bold";this.style.color="blue"};b.innerHTML='<b>[<i class="fa fa-star-o"></i>&nbsp;'+this.Description+"]</b>";if(0<this.Url.toUpperCase().indexOf("EWA_BTNS_IN_TITLE"))var y=this,z=0,A=setInterval(function(){z++;1E3<z&&window.clearInterval(A);EWA.OW.Load();EWA.OW.Dia&&(window.clearInterval(A),y.ReShowButtonsInDailogTitle())},10)};
this._ReShowSplit=function(a){EWA.UI.Utils.CreateObject(window,"div","",a).className="ewa_lf_func_split"};this._ReShowButton=function(a,b,c){var d=EWA.UI.Utils.CreateObject(window,"div","cursor:pointer",document.body);d.innerHTML="<nobr>"+a+"</nobr>";null!=c&&(d.setAttribute("_ewa_event_id",c),d.onclick=function(){var a=this.getAttribute("_ewa_event_id");$X(a).click()});EWA.B.IE&&(d.onselectstart=function(){return!1});d.className="ewa_lf_func_dact";d.title=b;return d};this.CheckValid=function(a){var b=
a.tagName.toLowerCase();if("span"==b||"img"==b||"div"==b)return!0;b=this.ItemList.GetObjectValue(a);return this.ItemList.CheckValid(a,b)};this.ShowEdit=function(a){a.parentNode.style.width=a.clientWidth+"px";a.style.display="none";__show_obj__=a.nextSibling;__show_obj__.style.display="";var b=__show_obj__.childNodes[0];3==b.nodeType&&(b=__show_obj__.childNodes[1]);b.setAttribute("old",b.value);"SELECT"!=b.tagName||b.getAttribute("func")||(b.setAttribute("func",1),b.onchange=function(){EWA.F.FOS[this.getAttribute("__ewa_fid__")].EditAfter(this)});
null==b.getAttribute("__ewa_fid__")&&(b.setAttribute("__ewa_fid__",this._Id),b.onblur=function(){EWA.F.FOS[this.getAttribute("__ewa_fid__")].EditAfter(this)},b.onkeydown=function(a){a=null==a?window.event:a;var b=a.target?a.target:a.srcElement;13==a.keyCode&&"INPUT"==b.tagName&&EWA.F.FOS[this.getAttribute("__ewa_fid__")].EditAfter(this);27==a.keyCode&&EWA.F.FOS[this.getAttribute("__ewa_fid__")].EditReset(this)});setTimeout(function(){b.focus()},10)};this.EditReset=function(a){a.parentNode.style.display=
"none";var b=a.parentNode.previousSibling;b.style.display="";b.innerHTML=a.getAttribute("old");"select"==a.tagName.toLowerCase()?b.innerHTML=a.options[a.selectedIndex].text:a.value=a.getAttribute("old").replace(/</ig,"&lt;").replace(/>/ig,"&gt;")};this.EditAfter=function(a){if(this.CheckValid(a))if(a.getAttribute("old")==a.value)this.EditReset(a);else{a.parentNode.style.display="none";var b=a.parentNode.previousSibling;b.style.display="";if("droplist"==a.getAttribute("ewa_class")){var c=a.parentNode.getElementsByTagName("input")[1].id;
var d=a.parentNode.getElementsByTagName("input")[1].value;b.innerHTML=a.parentNode.getElementsByTagName("input")[0].value}else"select"==a.tagName.toLowerCase()?(c=a.id,b.innerHTML=a.options[a.selectedIndex].text):(c=a.value.replace(/</ig,"&lt;").replace(/>/ig,"&gt;").replace(/\n/ig,"<br>"),b.innerHTML=c,c=a.id),d=a.value;b=a.getAttribute("action_name");if(""==b||null==b)b="OnListFrameUpdateCell";var e=a.getAttribute("action_confirm");e=null==e?"":e;var f=a.getAttribute("action_tip");null==f&&(f="");
var g=a.getAttribute("action_js"),h=[];h[0]={Name:"EWA_FIELD_ID",Value:c};h[1]={Name:"EWA_FIELD_VAL",Value:d};h[2]={Name:"EWA_ACTION_RELOAD",Value:"0"};h[3]={Name:a.id,Value:a.value};c=this.ItemList.GetValue(a.id,"DataItem","DataType");h[4]={Name:"EWA_DATA_TYPE",Value:c};h[5]={Name:"EWA_FIELD_VAL_OLD",Value:a.getAttribute("old")};this.EditEvent={FROM:a,OLD_VAL:a.getAttribute("old"),NEW_VAL:a.value};this.DoAction(a,b,e,f,h,g)}else a.focus()};this.RewriteInfo=function(a,b,c,d){$X("EWA_LF_"+this._Id);
null==this._INFO&&(this._INFO={},this._INFO.INFO=a,this._INFO.ID_NAME=b,this._INFO.INFO_NAME=c,this._INFO.INFO_MEMO=d);if(null!=this._INFO.INFO)for(a=0;a<this._INFO.INFO.length;a++)if(b=this._INFO.INFO[a],c=b[this._INFO.ID_NAME],$X(c))if(null==b[this._INFO.INFO_NAME]||""==b[this._INFO.INFO_NAME].trim())for(b="TD"==$X(c).parentNode.tagName?$X(c).parentNode:$X(c).parentNode.parentNode,c=0;c<b.parentNode.cells.length;c++)b.parentNode.cells[c]==b&&this.ShowHiddenColumn(c,!1);else $X(c).innerHTML=b[this._INFO.INFO_NAME]};
this.ShowHiddenColumn=function(a,b){var c=$X("EWA_LF_"+this._Id),d="";if(null==b||0==b||"none"==b)d="none";for(b=0;b<c.rows.length;b++)c.rows[b].cells.length==c.rows[0].cells.length&&(c.rows[b].cells[a].style.display=d)};this.ShowHiddenColumns=function(a,b){var c=$X("EWA_LF_"+this._Id),d="";if(null==b||0==b||"none"==b)d="none";b=c.rows[0].cells.length;for(var e=0;e<c.rows.length;e++){var f=c.rows[e];if(f.cells.length==b)for(var g=0;g<a.length;g++)f.cells[a[g]].style.display=d}};this.GroupShowHidden=
function(a){var b=$(a).attr("t"),c=(new Date).getTime();if(!(b&&333>c-b)){$(a).attr("t",c);b=a.parentNode.parentNode;c=b.getAttribute("ewa_group");""==c?(c="none",a.childNodes[0].innerHTML=" + "):(c="",a.childNodes[0].innerHTML=" - ");b.setAttribute("ewa_group",c);for(var d=b.parentNode.parentNode,e=0,f=b.rowIndex+1;f<d.rows.length;f++){b=d.rows[f];if("group"==b.getAttribute("ewa_tag"))break;b.style.display=c;e++}a.childNodes[a.childNodes.length-1].innerHTML=" ("+e+")"}};this.Sort=function(a){var b=
this._last_sort_timer||0,c=this._Sort||"",d=(new Date).getTime();c==a&&500>d-b||(this._last_sort_timer=d,this._Sort=a,this.Goto(1))};this.SearchClear=function(a){a=a.parentNode.parentNode.parentNode.parentNode;for(var b=0;b<a.rows.length;b+=1)for(var c=a.rows[b].getElementsByTagName("input"),d=0;d<c.length;d++){var e=c[d];if("text"==e.type)e.value="";else if("radio"==e.type||"checkbox"==e.type)e.checked=!1}};this.SearchGetExp=function(a){var b=[];$(a).find(".ewa-lf-search-item").each(function(){var a=
$(this).find("input");if(0==a.length&&(a=$(this).find("select"),0==a.length))return;var d=a[0],e=$(d).attr("t");if(1==a.length){var f=d.value;""!=d.value.trim()&&("text"==e&&(a=$(d.parentNode.parentNode).find("a").attr("tag"))&&(e=a),b.push("@!@"+d.name+"~!~"+e+"~!~"+f))}else if(("date"==e||"number"==e)&&2==a.length)f=d.value,a=a[1].value,""==a&&""==f||b.push("@!@"+d.name+"~!~"+e+"~!~"+f+"~!~"+a);else if("fix"==e&&"INPUT"==d.tagName){var g=[""];$(this).find("input").each(function(){this.checked&&
g.push(this.value)});1!=g.length&&b.push("@!@"+d.name+"~!~"+e+g.join("~!~"))}});return b.join("")};this.DoSearch=function(a){var b=!1;a.id=="EWA_SEARCH_ITEM_"+this.Id?a=$X("EWA_SEARCH_ITEM_"+this.Id).childNodes[0]:(a=a.parentNode.parentNode.parentNode.parentNode,b=!0);this._SearchExp=this.SearchGetExp(a);b&&(this._SearchHtml=a.parentNode.innerHTML,this._SearchDialog.Show(!1));this.Goto(1)};this.Search=function(a){null==this._SearchHtml?(this._SearchCreate(),this._SearchDialog=new EWA.UI.Dialog.OpenWindow("about:blank",
"aa",400,100,!0,null,null,!1),this._SearchDialog.SetCaption(_EWA_INFO_MSG["EWA.LF.SEARCH.BUT.TITLE"]),this._SearchDialog._Dialog.AutoSize=!0,this._SearchDialog._Dialog.SetHtml(this._SearchHtml),this._SearchDialog._Dialog.Show(!0),this._SearchDialog._Dialog.GetFrame().focus(),this._SearchDialog.MoveCenter()):(this._SearchDialog._Dialog.AutoSize=!1,this._SearchDialog.Show(!0))};this.ShowSearch=function(){$X("EWA_SEARCH_ITEM_"+this.Id)||this._SearchCreateItm();this._ReShowSearchQuick()};this.ChangeSearchTextType=
function(a){this._MENU_DATE_RANGE&&this._MENU_DATE_RANGE.HiddenMemu();this._MENU_TEXT_TYPE.ShowByObject(a,null,0)};this.ChangeSearchDateType=function(a){this._MENU_TEXT_TYPE&&this._MENU_TEXT_TYPE.HiddenMemu();this._MENU_DATE_RANGE.ShowByObject(a,null,0)};this.ChangeSearchTextTypeIt=function(a){var b=$(this._MENU_TEXT_TYPE.SHOW_BY_OBJECT).parentsUntil(".ewa-lf-search-item").last(),c=$J2MAP(this.RESOURCES.search_text_items,"Id")[a];c="enus"==EWA.LANG?c.TxtEn:c.Txt;b.find("a").attr("tag",a).html(c)};
this._GetInitSearchMap=function(){var a=new EWA_UrlClass(this.Url),b={},c=a.GetParameter("ewa_search");if(!c)return b;this.Url=a.RemoveParameter("ewa_search");c=c.unURL();a=c.split(",");for(var d in a){var e=a[d],f=e.indexOf("["),g=e.indexOf("]");0>f||g<f||(c=e.substring(0,f).trim(),0!=c.length&&(f=e.substring(f+1,g).trim().toLowerCase(),0!=f.length&&(e=e.substring(g+1).trim(),""!=e&&(b[c.toUpperCase()]||(b[c.toUpperCase()]={name:c,tag:f}),c=b[c.toUpperCase()],"lt"==f||"lte"==f?c.para2=e.unURL():
c.para1=e.unURL()))))}return b};this.SearchFilterDate=function(a){var b=$(this._MENU_DATE_RANGE.SHOW_BY_OBJECT).parentsUntil(".ewa-lf-search-item").last(),c=b.find("input")[0];b=b.find("input")[1];if("Clear"==a)$(c).val(""),$(b).val("");else{var d=EWA_Utils.Date(),e="",f="";"Today"==a?f=e=d.GetDateString():"Week"==a?(a=d.GetBenWeek(),e=a[0],f=a[1]):"Today-Weekend"==a?(a=d.GetBenWeek(),e=a[d.GetDateString()],f=a[1]):"Month"==a?(a=d.GetBenMonth(),e=a[0],f=a[1]):"Today-EOM"==a?(a=d.GetBenMonth(),e=a[d.GetDateString()],
f=a[1]):"Quarter"==a?(a=d.GetBenQ(),e=a[0],f=a[1]):"Today-EOQ"==a?(a=d.GetBenQ(),e=a[d.GetDateString()],f=a[1]):"Year"==a?(a=d.GetBenYear(),e=a[0],f=a[1]):"Today-EOY"==a&&(a=d.GetBenYear(),e=a[d.GetDateString()],f=a[1]);a=EWA_Utils.Date(e).FormatDate();d=EWA_Utils.Date(f).FormatDate();d+=" 23:59:59";$(c).val(a);$(b).val(d)}};this._SearchCreateDateRange=function(){var a="_MENU_DATE_RANGE"+this._Id;$("."+a).remove();var b="enus"==EWA.LANG.toLowerCase()?"TxtEn":"Txt",c=JSON.parse(JSON.stringify(this.RESOURCES.search_date_items)),
d="EWA.F.FOS[&quot;"+this._Id+"&quot;].SearchFilterDate",e;for(e in c){var f=c[e];f.Txt=f[b];f.Cmd=d+"(&quot;"+f.Id+"&quot;)"}b="EWA.F.FOS[&quot;"+this._Id+"&quot;]._MENU_DATE_RANGE";this._MENU_DATE_RANGE=new EWA_UI_MenuClass(b);this._MENU_DATE_RANGE.Create(c);$(this._MENU_DATE_RANGE.Dialog.GetFrame()).addClass("ewa-lf-search-menu "+a);return b};this._SearchCreateTextType=function(){var a="_MENU_TEXT_TYPE"+this._Id;$("."+a).remove();var b="enus"==EWA.LANG.toLowerCase()?"TxtEn":"Txt",c=JSON.parse(JSON.stringify(this.RESOURCES.search_text_items)),
d="EWA.F.FOS[&quot;"+this._Id+"&quot;].ChangeSearchTextTypeIt",e;for(e in c){var f=c[e];f.Txt=f[b];f.Cmd=d+"(&quot;"+f.Id+"&quot;)"}b="EWA.F.FOS[&quot;"+this._Id+"&quot;]._MENU_TEXT_TYPE";this._MENU_TEXT_TYPE=new EWA_UI_MenuClass(b);this._MENU_TEXT_TYPE.Create(c);$(this._MENU_TEXT_TYPE.Dialog.GetFrame()).addClass("ewa-lf-search-menu "+a);return b};this._SearchCreateItm=function(){var a="EWA_SEARCH_ITEM_"+this.Id,b=[],c=[],d=[],e={},f;for(f in this._SearchJson)this._SearchJson[f].ORI_NAME=f,e[f.toUpperCase()]=
this._SearchJson[f];this._SearchJson=e;var g="EWA.F.FOS[&quot;"+this._Id+"&quot;].ChangeSearchTextType(this)",h="EWA.F.FOS[&quot;"+this._Id+"&quot;].ChangeSearchDateType(this)",k=$J2MAP(this.RESOURCES.search_text_items,"Id");e=this._GetInitSearchMap();var l=!1,m=!1;for(f in this.ItemList.Items)if(null!=this._SearchJson[f]){var q=[],r=this._SearchJson[f],p=r.T,n=this._GetSubValue("DescriptionSet","Info",this.ItemList.Items[f]);q.push("<table class='ewa-lf-search-item ewa-ref-"+f+" ewa-lf-search-type-"+
p+" "+("fix"==p?"ewa-lf-search-fix-m"+(r.M||"0"):"")+"' cellspacing=0 cellpadding=0>");q.push("<tr><td class='ewa-lf-search-item-title' style='position:relative'><nobr><b>");q.push(n);var u=n="",w="lk";e[f.toUpperCase()]&&(u=e[f.toUpperCase()],w=u.tag,n=u.para1,u=u.para2);"text"==p?(m=k[w]||k.lk,m="enus"==EWA.LANG?m.TxtEn:m.Txt,q.push("<a class='ewa-lf-search-type' tag='"+w+"' href='javascript:void(0)' onclick='"+g+"'>"),q.push(m),q.push("</a>"),m=!0):"date"==p&&(q.push("<a  href='javascript:void(0)' class='fa fa-calendar-check-o'  onclick='"+
h+"'></a>"),l=!0);q.push(": </b></nobr></td><td class='ewa-lf-search-item-ctl'>");"text"==p?q.push(this._SearchSingle(f,n)):"date"==p?q.push(this._SearchDate(f,n,u)):"number"==p?q.push(this._SearchNumber(f,n,u)):"fix"==p&&(r="<div >"+this._SearchFix(f,r,"span",n)+"</div>",q.push(r));q.push("</td></tr></table>");"fix"==p?c.push(q.join("")):d.push(q.join(""))}if(0!=d.length+c.length){b.push('<table class="ewa-lf-search-main" id="'+a+'" cellspacing="0" cellpadding="0" style="width:100%">');b.push("<tr><td class='ewa-lf-search-des'></td><td>");
0<d.length&&b.push(" "+d.join("")+" ");if(0<c.length)for(d=0;d<c.length;d++)b.push(" "+c[d]+" ");b.push("</td></tr></table>");var v=document.createElement("div");this._SEARCH_BOX=v;v.className="ewa-lf-search";v.innerHTML=b.join("");b=$X("EWA_LF_"+this.Id).parentNode;b.parentNode.insertBefore(v,b);a="EWA_SEARCH_ITEM_"+this.Id;var t=this;l&&this._SearchCreateDateRange();m&&this._SearchCreateTextType();t._SEARCH_ITEM_EXP=this.SearchGetExp(v);"{}"!=JSON.stringify(e)&&(t._SearchExp=t._SEARCH_ITEM_EXP);
this._TIMER_SEARCH=window.setInterval(function(){try{if(!$X(a)){window.clearInterval(t._TIMER_SEARCH);return}}catch(y){window.clearInterval(t._TIMER_SEARCH);return}var b=t.SearchGetExp(v);b!=t._SEARCH_ITEM_EXP&&(t._SEARCH_ITEM_EXP=b,t.DoSearch($X(a)))},700)}};this._SearchSingle=function(a,b){var c=[];c.push('<input t="text" type="text" autocomplete="off" class="EWA_INPUT" maxlength="40" name="');c.push(a.toInputValue());c.push('"');null!=b&&(c.push(' value="'),a=b.toInputValue(),c.push(a),c.push('" '));
c.push(" />");return c.join("")};this._SearchDate=function(a,b,c){var d=[];d.push("<table border=0 cellpadding=0 cellspacing=0>");d.push('<td  ><input type="text" autocomplete="off" class="EWA_INPUT" t="date" readonly maxlength="8" onclick="EWA.UI.Calendar.Pop(this)" name="');d.push(a);d.push('"');b&&(b=b.toInputValue(),d.push(' value="'),d.push(b),d.push('"'));d.push(' /></td><td><span class="ewa-lf-search-split"> - </span></td>');d.push('<td  ><input type="text" autocomplete="off" class="EWA_INPUT" t="date" readonly maxlength="8" onclick="EWA.UI.Calendar.Pop(this)" name="');
d.push(a);d.push('1"');c&&(b=c.toInputValue(),d.push(' value="'),d.push(b),d.push('"'));d.push("/></td></tr></table>");return d.join("")};this._SearchNumber=function(a,b,c){var d=[];d.push('<input type="text" t="number" size="10" name="');d.push(a);d.push('"');b&&(b*=1,d.push(' value="'),d.push(b),d.push('"'));d.push(' /><span class="ewa-lf-search-split"> - </span>');d.push('<input type="text" t="number" size="10" name="');d.push(a);d.push('1"');c&&(b=1*c,d.push(' value="'),d.push(b),d.push('"'));
d.push("/>");return d.join("")};this._SearchFix=function(a,b,c,d){var e=[],f="radio";if("1"==b.M)f="checkbox";else if("2"==b.M)return this._SearchFix1(a,b,c,d);c="<"+c+"><nobr><input t='fix' [@CHK] id='@ID' value=\"@V\" type='"+f+"' name='"+a+"' /><label for='@ID'>@T</label></nobr></"+c+"> ";f={};if(d){d=d.split(";");for(var g in d)f[d[g].trim().toUpperCase()]=1}for(g=0;g<b.D.length;g++){var h=b.D[g];d=h[0];h=h[1];var k=this.Id+"_"+a+"_SearchFix_"+g,l=c.replace("@ID",k);l=l.replace("@ID",k);l=l.replace("@V",
d);l=f[d.toUpperCase().trim()]?l.replace("[@CHK]","checked"):l.replace("[@CHK]","");l=l.replace("@T",h);e.push(l)}return e.join("")};this._SearchFix1=function(a,b,c,d){c=[];c.push("<select t='fix' name='"+a+"'><option></option>");for(var e=0;e<b.D.length;e++){var f=b.D[e],g="<option @CKD t='fix' id='@ID' value=\"@V\">@T</option> ".replace("@ID",this.Id+"_"+a+"_SearchFix_"+e);g=g.replace("@V",f[0]);g=g.replace("@T",f[1]);g=d&&f[0]==d?g.replace("@CKD","selected"):g.replace("@CKD","");c.push(g)}c.push("</select>");
return c.join("")};this._SearchCreate=function(){var a=[];a.push("<div><table border=0 style='margin:0px;' class=EWA_TABLE cellspacing=1>");for(var b in this.ItemList.Items)if(null!=this._SearchJson[b]){var c=this._SearchJson[b],d=c.T,e=this._GetSubValue("DescriptionSet","Info",this.ItemList.Items[b]);a.push("<tr><td class=EWA_TD_L width=140><nobr>"+e+"<nobr></td><td width=350 class=EWA_TD_M>");"text"==d?a.push(this._SearchSingle(b)):"date"==d?a.push(this._SearchDate(b)):"number"==d?a.push(this._SearchNumber(b)):
"fix"==d&&a.push(this._SearchFix(b,c,"div"));a.push("</td></tr>")}a.push("<tr><td class=EWA_TD_B colspan=2 align=right><input onclick='EWA.F.FOS[\""+this._Id+"\"].SearchClear(this);' type=button value='"+_EWA_INFO_MSG["EWA.LF.SEARCH.BUT.CLEAR"]+"'> <input type=submit value='"+_EWA_INFO_MSG["EWA.LF.SEARCH.BUT.SEARCH"]+"' onclick='EWA.F.FOS[\""+this._Id+"\"].DoSearch(this);'> <input type=button value='"+_EWA_INFO_MSG["EWA.LF.SEARCH.BUT.CLOSE"]+"' onclick='EWA.F.FOS[\""+this.Id+"\"]._SearchDialog.Show(false);'></td></tr>");
a.push("</table></div>");this._SearchHtml=a.join("")};this.SearchMark=function(){for(var a=this._SearchExp.split("@!@"),b=$X("EWA_LF_"+this._Id),c=0;c<a.length;c+=1){var d=a[c].split("~!~");if(!(3>d.length))for(var e=2;e<d.length;e++){var f=d[e];if(""!=f){if("fix"==d[1]){var g=d[0],h=d[2];$("table#EWA_SEARCH_ITEM_"+this.Id+' [name="'+g+'"]').find("option").each(function(){this.value==h&&(f=this.text)})}g=[];for(var k=0;k<f.length;k++){var l=f[k];"a"<=l&&"z">=l||"A"<=l&&"Z">=l||"0"<=l&&"9">=l?g.push(l):
g.push("\\"+l)}f=g.join("");g=d[0];this._SearchJson[g]&&(g=this._SearchJson[g].ORI_NAME);try{f=eval("/("+f+")/ig"),$(b).find('.EWA_TD_M [id="'+g+'"]').each(function(){0==this.children.length&&(this.innerHTML=this.innerHTML.replace(f,"<font color=red><b>$1</b></font>"))})}catch(m){console.log(m)}}}}};this.DblClick=function(a){this._IsDblClick=a;for(var b=$X("EWA_LF_"+this._Id),c=1;c<b.rows.length;c++)b.rows[c].ondblclick=function(){var b=this.getElementsByTagName("input");b.length>a&&0==b[a].disabled&&
b[a].click()}};this.Init=function(a){this.Xml=new EWA.C.Xml;this.Xml.LoadXml(a);this.ItemList.Init(this.Xml);this.Resources=new EWA_FrameResoures;this.Resources.Init(this.Xml);if((a=$X("EWA_LF_"+this._Id))&&"table"==a.tagName&&!(1>=a.rows.length)){a=a.rows[1].getElementsByTagName("input");for(var b=0;b<a.length;b++)if("RADIO"==a[b].type.toUpperCase()){this._TrSelectMulti=!1;break}}};this.SetPageParameters=function(a,b,c,d,e){this._PageCurrent=a;this._PageSize=c;this._PageCount=b;this._RecordCount=
d;this._Sort=e};this.SetPageParametersName=function(a,b,c,d,e){this._PageCurrentName=a;this._PageSizeName=c;this._PageCountName=b;this._RecordCountName=d;this._SortName=e};this.CheckedAll=function(){var a=document.getElementById("EWA_LF_"+this._Id);if(!(1>=a.rows.length)){for(var b=0;b<a.rows.length;b+=1){var c=a.rows[b].getElementsByTagName("input");0!=c.length&&(c[0].checked=this._IsCheckedAll)}this._IsCheckedAll=this._IsCheckedAll?!1:!0;this.CheckedAllAfter&&this.CheckedAllAfter(a)}};this.SelectChecked=
function(){var a=$X("EWA_LF_"+this._Id);if(!a||1>a.rows.length)return"";var b=[],c=$F(a,"input","type","radio,checkbox");if(0<c.length)for(var d=0;d<c.length;d++)c[d].checked&&b.push(c[d].value);else for(d=0;d<a.rows.length;d++)c=a.rows[d],1==c.getAttribute("__ewa_lf_mdown")&&b.push(c.getAttribute("EWA_KEY"));return b.join(",")};this.SelectCheckedInputs=function(){var a=[],b=$X("EWA_LF_"+this._Id);if(1>b.rows.length)return a;b=b.getElementsByTagName("input");a=[];for(var c=0;c<b.length;c++)("CHECKBOX"==
b[c].type.toUpperCase()||"RADIO"==b[c].type.toUpperCase())&&b[c].checked&&a.push(b[c]);return a};this.SelectCheckedRows=function(){for(var a=[],b=$X("EWA_LF_"+this._Id),c=0;c<b.rows.length;c++){var d=b.rows[c],e=d.getElementsByTagName("input");0!=e.length&&e[0].checked&&a.push(d)}if(0==a.length)for(c=0;c<b.rows.length;c++)d=b.rows[c],1==d.getAttribute("__ewa_lf_mdown")&&a.push(d);return a};this.Reload=function(a){this.StopAjaxAfterReload?this.StopAjaxAfterReload=!1:this.Goto(this._PageCurrent,a)};
this.DoAction=function(a,b,c,d,e,f){EWA.F.CID=this._Id;if(b){if(a&&$(a).parent().hasClass("scroll-delete")){var g=$(a).attr("do-action-time")||0,h=(new Date).getTime();if(1E3>h-g)return;$(a).attr("do-action-time",h)}this._Ajax=new EWA.C.Ajax;this._Ajax.LoadingType="image";this._Ajax.AddParameter("EWA_AJAX","1");this._Ajax.AddParameter("EWA_ACTION",b);this._Ajax.AddParameter("EWA_ID",this._Id);this._Ajax.AddParameter("EWA_NO_CONTENT","1");this._Ajax.AddParameter("EWA_ACTION_TIP",d);null!=f&&0<f.trim().length?
(this._Ajax.AddParameter("EWA_AFTER_EVENT",f),this.StopAjaxAfterReload=!0,this._Ajax.AddParameter("EWA_ACTION_RELOAD","0")):this.StopAjaxAfterReload=!1;if(a&&a.getAttribute&&"yes"==a.getAttribute("box_menu_item")){if(this._Ajax.AddParameter("___CALL__FROM__","box"),a=a.parentNode)a=a.getAttribute("json_ref"),a=JSON.parse(a),a.EWA_KEY&&this._Ajax.AddParameter("EWA_ACTION_KEY",a.EWA_KEY)}else(a=this.GetRowKey(a))&&this._Ajax.AddParameter("EWA_ACTION_KEY",a);a=this.SelectChecked();this._Ajax.AddParameter("IDS_SPLIT",
a);if(null!=e&&0<e.length)for(a=0;a<e.length;a+=1)this._Ajax.AddParameter(e[a].Name,e[a].Value);e=new EWA.C.Url;e.SetUrl(this.Url);var k=e.RemoveParameter("EWA_ACTION"),l=this;c?((e=_EWA_INFO_MSG[c])||(e=c),$Confirm(e,"Confirm",function(){l._Ajax.PostNew(k,function(){l._CallBackJs()})})):this._Ajax.PostNew(k,function(){l._CallBackJs()})}};this.NewPageSize=function(a){this._PageSize!=a&&(this._PageSize=a,this.Goto(1))};this.Goto=function(a,b){EWA.F.CID=this._Id;this._PageCurrent=a;this._Ajax=this.CreateAjax();
a=new EWA_UrlClass;a.SetUrl(null==this.Url?document.location.href:this.Url);a.RemoveParameter("EWA_AJAX");var c=this;this._Ajax.PostNew(a.GetUrl(),function(){c._CallBack(b)})};this.CreateAjax=function(){var a=new EWA.C.Ajax;a.LoadingType="image";a.AddParameter(this._PageCurrentName,this._PageCurrent);this._PageSize&&a.AddParameter(this._PageSizeName,this._PageSize);null!=this._Sort&&a.AddParameter(this._SortName,this._Sort);null!=this._SearchExp&&""!=this._SearchExp&&a.AddParameter("EWA_LF_SEARCH",
this._SearchExp);a.AddParameter("EWA_AJAX","LF_RELOAD");if(null!=this.GotoParas&&0<this.GotoParas.length)for(var b=0;b<this.GotoParas.length;b+=1)a.AddParameter(this.GotoParas[b].Name,this.GotoParas[b].Value);return a};this.DownlodData=function(a,b){EWA.F.CID=this._Id;this._Ajax=new EWA.C.Ajax;this._Ajax.LoadingType="image";null!=this._Sort&&this._Ajax.AddParameter(this._SortName,this._Sort);null!=this._SearchExp&&""!=this._SearchExp&&this._Ajax.AddParameter("EWA_LF_SEARCH",this._SearchExp);this._Ajax.AddParameter("EWA_AJAX",
"DOWN_DATA");this._Ajax.AddParameter("EWA_AJAX_DOWN_TYPE",a);b&&this._Ajax.AddParameter("EWA_ACTION",b);if(null!=this.GotoParas&&0<this.GotoParas.length)for(a=0;a<this.GotoParas.length;a+=1)this._Ajax.AddParameter(this.GotoParas[a].Name,this.GotoParas[a].Value);this._AjaxType="DOWN_DATA";a=new EWA_UrlClass;a.SetUrl(null==this.Url?document.location.href:this.Url);var c=this;this._Ajax.PostNew(a.GetUrl(),function(){c._CallBack()})};this.Get=function(a){EWA.F.CID=this._Id;this._Ajax=new EWA.C.Ajax;this._Ajax.LoadingType=
"image";var b=this;this._Ajax.Get(a,function(){b._CallBack()})};this.Post=function(a,b){EWA.F.CID=this._Id;this._Ajax=new EWA.C.Ajax;this._Ajax.LoadingType="image";var c=this;this._Ajax.Post(a,b,function(){c._CallBackJs()})};this._CallBack=function(a){var b=this._Ajax;if(4==b._Http.readyState){b.HiddenWaitting();if(top.EWA&&top.EWA.MQE){var c=new EWA_MqeClass;c.Data=b.GetRst();c.FromId=EWA.F.CID;c.Type="POST";top.EWA.MQE.AddMqe(c)}200==b._Http.status?(b=b._Http.responseText,EWA.F.CheckCallBack(b)&&
("DOWN_DATA"==this._AjaxType?(this._AjaxType=null,"DENY"==b.trim()?alert(_EWA_INFO_MSG["EWA.LF.DOWN_DATA.DENY"]):window.location.href=b.trim()):(c=$X("EWA_LF_"+this._Id).parentNode,$(c).replaceWith(b),this.SearchMark(),this.IsReShow&&this.ReShowWithNoButtons(),this._ReShowSearchQuick(),null!=this._IsDblClick&&this.DblClick(this._IsDblClick),this._IsAddPreRow&&this.AddPreRow(),this.SubBottomsArray&&this._SubBottoms(),this.ReloadAfter&&this.ReloadAfter(a),this.ReloadAfterApp&&this.ReloadAfterApp(a)))):
alert("ERROR:\r\n"+b._Http.statusText);this.RewriteInfo()}};this._CallBackJs=function(){var a=this._Ajax;if(4==a._Http.readyState){if(top.EWA&&top.EWA.MQE){var b=new EWA_MqeClass;b.Data=a.GetRst();b.FromId=EWA.F.CID;b.Type="POST";top.EWA.MQE.AddMqe(b)}a.HiddenWaitting();200==a._Http.status?(a=a._Http.responseText,EWA.F.CheckCallBack(a)&&eval(a)):alert("ERROR:\r\n"+a._Http.statusText);this.EditAfterEvent&&this.EditAfterEvent()}};this.EditAfterEvent=function(){};this._GetItem=function(a){for(var b=
this.ItemList,c=0;c<b.length;c+=1){var d=b[c],e=this._GetSubItem("Name",d);if(this.Xml.GetElementAttribute(e,"Name")==a)return d}};this._GetSubItem=function(a,b){b=this.Xml.GetElements(a+"/Set",b);if(null==b||0==b.length)return null;if("DescriptionSet"==a)for(a=0;a<b.length;a+=1){var c=b[a].getAttribute("Lang");if(null!=c&&c.trim().toUpperCase()==EWA.LANG.trim().toUpperCase())return b[a]}return b[0]};this._GetSubValue=function(a,b,c){a=this._GetSubItem(a,c);return null==a?null:this.Xml.GetElementAttribute(a,
b)};this.AddColumns=function(a,b,c,d,e,f,g,h){var k=$X("EWA_LF_"+this._Id);null==h&&(h=k.rows[0].cells.length);for(var l=0;l<a.length;l++)for(var m=a[l],q=h+l,r=0;r<k.rows.length;r++){var p=k.rows[r].insertCell(q);if(0==r)p.className="EWA_TD_H",p.innerHTML='<nobr cellIdx="'+q+'" id="'+m[b]+'">'+m[c]+"</nobr>",p.title=m[d],p.width=100;else{var n=k.rows[r].getAttribute("EWA_KEY");p.className="EWA_TD_M";n=n+"_"+m[b];var u=this._GetAddControl(m[f]);null==u&&(u=e);var w=g.replace("[ID]",m[b]);u=0<=u.indexOf("<select")?
u.replace("!!",w.replace("onblur=","onchange=")):u.replace("!!",w);p.innerHTML=u;p.childNodes[0].id=n}}};this._GetAddControl=function(a){if(null==a)return null;a=a.toUpperCase().trim();return"SELECT"==a?"<select !!></select>":"DATE"==a?'<input type=text class=EWA_INPUT onclick="EWA.UI.Calendar.Pop(this,false);" readonly !!>':"TIME"==a?'<input type=text class=EWA_INPUT onclick="EWA.UI.Calendar.Pop(this,true);" readonly !!>':"STRING"==a||"NUMBER"==a?"<input type=text class=EWA_INPUT !!>":null};this.AddedValues=
function(a,b,c,d,e){for(var f=0;f<a.length;f++){var g=a[f],h=$X(g[b]+"_"+g[c]);if(!h)break;var k=h.tagName.toUpperCase();"INPUT"==k||"SELECT"==k||"TEXTAREA"==k?h.value=g[d]:h.innerHTML=g[d];e&&(this.GetRow(h).getElementsByTagName("input")[0].checked=!0)}};this.AddRow=function(a){for(var b=$X("EWA_LF_"+this._Id),c=b.insertRow(-1),d=0;d<b.rows[0].cells.length;d++){var e=c.insertCell(-1),f=b.rows[0].cells[d];e.className="EWA_TD_M";null!=a[d]&&(e.innerHTML=a[d]);e.style.display=f.style.display;e.id="ADD_ROW_"+
f.childNodes[0].id}return c};this.Calc=function(a,b,c,d){for(var e=$X("EWA_LF_"+this._Id),f={},g=0;g<a.length;g++)f[a[g]]=0;for(g=b;g<c;g++)for(a=e.rows[g],b=0;b<a.cells.length;b++)if(null!=f[b]){var h=a.cells[b],k=h.getElementsByTagName("input");0<k.length?f[b]+=1*k[0].value:(h=GetInnerText(h),""==h&&(h=0),f[b]+=1*h)}c=e.rows[d];for(g=0;g<c.cells.length;g++)null!=f[g]&&(h=Math.round(100*f[g])/100,d=GetInnerText(c.cells[g]),h!=1*d&&(this.IsCalcChanged=!0),c.cells[g].innerHTML=h.fm())};this.mergeHeaders=
function(a,b,c){var d=$($X("EWA_LF_"+this._Id)),e=d.find('tr[ewa_tag="HEADER"]');if(0!=e.length&&(a=e.find('nobr[id="'+a+'"]').parent(),0!=a.length)){var f=d.find("tr[ewa_mearge]");0==f.length&&(f=$(d[0].insertRow(1)),f.attr("ewa_mearge","gdx"));d=-1;for(var g=0;g<e[0].cells.length;g++){var h=e[0].cells[g];h==a[0]&&(d=g,h.colSpan=c);if(-1==d)"1"!=$(h).attr("ewa_tdmearged")&&(h.rowSpan=2);else if(d+c==g)d=-1,h.rowSpan=2;else{h.rowSpan=1;var k=f[0].insertCell(-1);k.innerHTML=h.innerHTML;k.className=
h.className;k.style.cssText=h.style.cssText;h.style.display="none";$(h).attr("ewa_tdmearged",1)}h==a[0]&&(h.innerHTML=b,h.style.display="",h.style.width="")}}};this.MeargeHeader=function(a,b,c){console.log("\u62fc\u5199\u9519\u8bef\uff0c\u8bf7\u7528 mergeHeaders");this.mergeHeaders(a,b,c)};this.getUrlClass=function(){var a=new EWA_UrlClass;a.SetUrl(this.Url);return a}}EWA.F.L={CUR:null,C:EWA_ListFrameClass};
EWA_ListFrameClass.prototype.RESOURCES={search_text_items:[{Id:"lk",Txt:"\u5305\u542b",TxtEn:"Like"},{Id:"llk",Txt:"\u5de6\u5305\u542b",TxtEn:"Left like"},{Id:"rlk",Txt:"\u53f3\u5305\u542b",TxtEn:"Right like"},{Id:"eq",Txt:"\u7b49\u4e8e",TxtEn:"Equals"}],search_date_items:[{Id:"Clear",Txt:"\u6e05\u7a7a",TxtEn:"Clear",Img:"fa fa-eraser"},{Id:"Today",Txt:"\u4eca\u5929",TxtEn:"Today"},{Id:"Week",Txt:"\u672c\u5468",TxtEn:"Week"},{Id:"Today-Weekend",Txt:"\u4eca\u5929\u81f3\u5468\u65e5",TxtEn:"Today-Weekend"},
{Id:"Month",Txt:"\u672c\u6708",TxtEn:"This Month"},{Id:"Today-EOM",Txt:"\u4eca\u5929\u81f3\u6708\u5e95",TxtEn:"Today-EOM"},{Id:"Quarter",Txt:"\u672c\u5b63\u5ea6",TxtEn:"This Quarter"},{Id:"Today-EOQ",Txt:"\u4eca\u5929\u81f3\u5b63\u672b",TxtEn:"Today-EOQ"},{Id:"Year",Txt:"\u672c\u5e74\u5ea6",TxtEn:"This Year"},{Id:"Today-EOY",Txt:"\u4eca\u5929\u81f3\u5e74\u5e95",TxtEn:"Today-EOY"}]};
function EWA_ListFrame_CellResizeClass(a){this._Name=a;this._Cover=this._Table=null;this._CellResize=[];this.Init=function(a){this._Table=a;this._Table.style.tableLayout="fixed";this._Table.style.width=this._Table.clientWidth+"px";this._Cover=this._CreateElement("div","width:100%; height:100%;background-color:blue; position:absolute; top:0px; left:0px; display:block; filter:alpha(opacity=0);opacity:0",document.body);for(a=0;a<this._Table.rows[0].cells.length-1;a++)this._CreateMarker(a);this._SetLocation()};
this._ShowCover=function(a){this._Cover.style.display=a?"block":"none"};this._EventX=function(a){return a.x?a.x:a.pageX};this._OnMouseDown=function(a,c){this._ShowCover(!0);a.childNodes[0].style.borderLeft="1px solid black";a.setAttribute("D",1);c=c?c:event;var b=this._EventX(c);a.setAttribute("X",b);a.setAttribute("SX",b);"undefined"!=typeof c.preventDefault&&c.preventDefault();"undefined"!=typeof c.stopPropagation?c.stopPropagation():c.cancelBubble=!0};this._OnMouseUp=function(a,c){a.childNodes[0].style.borderLeft=
"1px";a.setAttribute("D",0);c=c?c:event;var b=this._EventX(c)-1*a.getAttribute("SX");a=a.getAttribute("TDINDEX");a=this._Table.rows[0].cells[a];b=a.clientWidth+b;a.style.width=4>b?4:b+"px";this._SetLocation();"undefined"!=typeof c.preventDefault&&c.preventDefault();"undefined"!=typeof c.stopPropagation?c.stopPropagation():c.cancelBubble=!0};this._OnMouseOut=function(a,c){"1"==a.getAttribute("D")&&(a.style.left=a.getAttribute("SX")+"px",a.setAttribute("D",0),this._SetLocation(),a.childNodes[0].style.borderLeft=
"1px");this._ShowCover(!1)};this._OnMouseMove=function(a,c){this._ShowCover(!0);if("1"==a.getAttribute("D")){c=c?c:event;var b=this._EventX(c),e=1*a.getAttribute("X");e=b-e;a.style.left=1*a.style.left.replace("px","")+e+"px";a.setAttribute("X",b);"undefined"!=typeof c.preventDefault&&c.preventDefault();"undefined"!=typeof c.stopPropagation?c.stopPropagation():c.cancelBubble=!0}};this._CreateMarker=function(b){var c=this._CreateElement("div","width:40px; height:"+this._Table.clientHeight+"px; position:absolute;cursor:e-resize",
document.body);c.setAttribute("TDINDEX",b);c.setAttribute("instanceName",a);c.onmouseover=function(){var a=this.getAttribute("instanceName");eval("window."+a)._ShowCover(!0)};c.onmousedown=function(a){var b=this.getAttribute("instanceName");eval("window."+b)._OnMouseDown(this,a)};c.onmouseup=function(a){var b=this.getAttribute("instanceName");eval("window."+b)._OnMouseUp(this,a)};c.onmouseout=function(a){var b=this.getAttribute("instanceName");eval("window."+b)._OnMouseOut(this,a)};c.onmousemove=
function(a){var b=this.getAttribute("instanceName");eval("window."+b)._OnMouseMove(this,a)};this._CreateElement("div","width:1px;height:100%;position:absolute;top:0px;left:20px;border-Left:1px ;",c);this._CellResize[b]=c;c=null};this._SetLocation=function(){for(var a=0;a<this._Table.rows[0].cells.length-1;a++){var c=this._Table.rows[0].cells[a],d=this._Location(c);""!=c.style.width&&(c.style.width=c.clientWidth+"px");this._CellResize[a].style.left=d[0]+c.clientWidth-this._CellResize[a].clientWidth/
2+"px";this._CellResize[a].style.top=d[1]+"px"}};this._CreateElement=function(a,c,d){a=document.createElement(a);null!=c&&(a.style.cssText=c,a.setAttribute("style",c));null!=d&&d.appendChild(a);return a};this._Location=function(a){var b;var d=b=0;do d+=a.offsetLeft,b+=a.offsetTop,a=a.offsetParent;while("BODY"!=a.tagName);return[d,b]}}
function EWA_ListFrame_ShowHideColumns(a){this._name=a;this.storageId=this.frameUnid="";this.inited=!1;this.notHideColsArr=[];this.defHideCols="";this.readme="\u5408\u5e76\u5217\u548c\u8bbe\u7f6e\u5b8c\u521d\u59cb\u67e5\u8be2\u6761\u4ef6\u540e\uff0c\u518d\u6267\u884cinit\u3002 \u53c2\u6570\u8bf4\u660e\uff1aSYS_FRAME_UNID;\u4e0d\u9690\u85cf\u7684\u5217\uff08\u9017\u53f7\u5206\u9694\uff09\uff0c\u590d\u9009\u5217\u4e0d\u9690\u85cf defHideCols \u9ed8\u8ba4\u9690\u85cf\u7684\u5217";this.wrap="";this.setWrap=
function(a){this.wrap="#"+a};this.initPart=function(a,c,d){if(0<$(".grp-part").length){var b=$("#EWA_LF_"+a).parentsUntil(".grp-part").parent().attr("id");this.setWrap(b)}this.init(a,c,d);b&&$("#"+b+" .but-shc-gear b.fa-gear").css({"line-height":"100%","font-size":"14px"})};this.init=function(a,c,d){if(!this.inited){var b=this;this.frameUnid=a;this.wrap||(this.wrap="#"+a+"_RESHOW");this.defHideCols=d;this.storageId="LF_HIDE_COLS_"+this.frameUnid;c&&(this.notHideColsArr=c.split(","));d&&!window.localStorage.hasOwnProperty(this.storageId)&&
(window.localStorage[this.storageId]=d);c=$(this.wrap+" .ewa_lf_func_caption").parent();var f=!1;0===c.find(".but-shc-gear").length&&(f=!0,c.append('<div class="ewa_lf_func_dact ewa-lf-func-recycle but-shc-gear"><b class="fa fa-gear"  style="font-size: 16px;line-height: 30px;"></b></div>'),c.find(".but-shc-gear").on("click",function(){b.togglePanel()}));if(d=window.localStorage[this.storageId]){if(d=d.split(","),!f)for(f=0;f<d.length;f++)$("#EWA_LF_"+a+" .ewa-col-"+d[f]+".EWA_TD_H:hidden").show()}else d=
[];var g=[];$("#EWA_LF_"+a+" .EWA_TD_H:not(:hidden)").each(function(){if(0===$(this).find("a[href*='CheckedAll']").length){var a=$(this).find("nobr").attr("id"),b=$(this).text();g.push({id:a,name:b})}});if(0===g.length){this.hideCols();return}a=[];a.push("<div class='custom-cols-panel-box' data-fid=\""+this.frameUnid+'">');f="";f="enus"==EWA.LANG.toLowerCase()?"Show/Hide&nbsp;&nbsp;<a href='javascript:void(0)' class='but-default'>Default</a>":"\u663e\u793a/\u9690\u85cf\u5217&nbsp;&nbsp;<a href='javascript:void(0)' class='but-default'>\u9ed8\u8ba4</a>";
a.push("<div class='custom-cols-header'>"+(f+"<b class='fa fa-close but-close'></b></div>"));a.push("<div class='custom-cols-contain'>");a.push("<ul>");for(f=0;f<g.length;f++)a.push("<li><input type='checkbox' checked  value='"+g[f].id+"' id='custom_cols_id_"+g[f].id+"'><label for='custom_cols_id_"+g[f].id+"'>"+g[f].name.replace(/>/ig,"&gt")+"</label></li>");a.push("</ul>");a.push("</div>");a.push("</div>");c.append(a.join(""));c.find(".but-default").on("click",function(){b.setDefault()});c.find(".but-close").on("click",
function(){b.togglePanel()});c.find("li input[type=checkbox]").on("click",function(){b.setCol(this.value)});if(0<d.length)for(f=0;f<d.length;f++)0<$(this.wrap+" .custom-cols-panel-box input[value='"+d[f]+"']").length?$(this.wrap+" .custom-cols-panel-box input[value='"+d[f]+"']")[0].checked=!1:this.setCol(d[f]);if(0<this.notHideColsArr.length)for(f=0;f<this.notHideColsArr.length;f++)a=this.notHideColsArr[f],c=$(this.wrap+" .custom-cols-panel-box input[value='"+a+"']"),0<c.length&&(c.parent().addClass("not-hide-col"),
c[0].checked||(this.setCol(a),c[0].checked=!0),c[0].disabled=!0);this.inited=!0}this.hideCols()};this.adjustPanel=function(){var a=window.innerHeight-80;$(this.wrap+" .custom-cols-contain").height();$(this.wrap+" .but-shc-gear").offset();var c=window.innerWidth,d=$(this.wrap+" .custom-cols-panel-box").width();c=(c-d)/2;$(this.wrap+" .custom-cols-contain").css({"max-height":a});$(this.wrap+" .custom-cols-panel-box").css({right:c,top:"0"})};this.togglePanel=function(){this.inited||this.init(this.frameUnid);
$('.custom-cols-panel-box[data-fid!="'+this.frameUnid+'"]').hide();$(this.wrap+" .custom-cols-panel-box").toggle();$(this.wrap+" .custom-cols-panel-box").is("hide")||this.adjustPanel()};this.hideCols=function(){var a=window.localStorage[this.storageId];if(a){a=a.split(",");for(var c=0;c<a.length;c++)this.hide(a[c])}};this.show=function(a){$("#EWA_LF_"+this.frameUnid+" .ewa-col-"+a).show();$("#EWA_SEARCH_ITEM_"+this.frameUnid+" .ewa-lf-search-item [name='"+a+"']").parentsUntil(".ewa-lf-search-item").last().parent().show();
$("#EWA_LF_"+this.frameUnid+" #ADD_ROW_"+a).show();$("#EWA_LF_"+this.frameUnid+" #INS_ROW_"+a).show()};this.hide=function(a){var b=$("#EWA_SEARCH_ITEM_"+this.frameUnid+" .ewa-lf-search-item [name='"+a+"']").parentsUntil(".ewa-lf-search-item").last().parent();b.find("select").val("");b.find("input[type=text]").val("");b.find("input:checked").each(function(){this.checked=!1});$("#EWA_LF_"+this.frameUnid+" .ewa-col-"+a).hide();b.hide();$("#EWA_LF_"+this.frameUnid+" #ADD_ROW_"+a).hide();$("#EWA_LF_"+
this.frameUnid+" #INS_ROW_"+a).hide()};this.setCol=function(a){this.frameUnid||$Tip("not init");if(!(0<$("#EWA_LF_"+this.frameUnid+" .ewa-col-"+a+" a[href*='CheckedAll']").length)){var b=window.localStorage[this.storageId];if(b){b=b.split(",");for(var d=[],e=0;e<b.length;e++)a==b[e]?this.show(a):d.push(b[e]);b.length==d.length&&(d.push(a),this.hide(a));window.localStorage[this.storageId]=d.join(",")}else window.localStorage[this.storageId]=a,this.hide(a)}};this.setDefault=function(){this.togglePanel();
window.localStorage[this.storageId]=this.defHideCols;for(var a=$(this.wrap+" .custom-cols-panel-box input"),c=0;c<a.length;c++)a[c].checked=!0;if(this.defHideCols)for(a=this.defHideCols.split(","),c=0;c<a.length;c++)0<$(this.wrap+" .custom-cols-panel-box input[value='"+a[c]+"']").length?$(this.wrap+" .custom-cols-panel-box input[value='"+a[c]+"']")[0].checked=!1:this.setCol(a[c]);EWA.F.FOS[this.frameUnid].Reload()}}
function EWA_MultiGridClass(a,b){this.ClassName=a;this.Url=b;this._Id=this.TransParent=null;this.Resources={};this.Init=function(a){this.Xml=new EWA.C.Xml;this.Xml.LoadXml(a);this.Resources=new EWA_FrameResoures;this.Resources.Init(this.Xml)};this.CollapseCol=function(a,b){var c="",d=b.parentNode;null==d.getAttribute("expand")||1==d.getAttribute("expand")?(d.setAttribute("expand",0),b.innerHTML="+",c="none",d.setAttribute("col_span",d.colSpan),d.colSpan=1,d.style.fontStyle="italic",d.style.color=
"blue"):(d.setAttribute("expand",1),b.innerHTML="-",d.colSpan=d.getAttribute("col_span"),d.style.fontStyle="",d.style.color="#000");var g=document.getElementsByTagName(a);a=[];var h=[];for(b=0;b<g.length;b++){var k=g[b],l=k.parentNode.parentNode.rowIndex;null==a[l]&&(a[l]=[]);k=k.parentNode;a[l].push(k);"none"==c&&"none"==k.style.display&&h.push(k.id)}if("none"==c)d.setAttribute("ids","["+h.join("][")+"]");else{var m=d.getAttribute("ids");m=null==m?"":m}for(b=0;b<a.length;b++)if(null!=a[b]){for(g=
d=0;g<a[b].length;g++)h=a[b][g],d+=1*h.getAttribute("val"),l="["+h.id+"]",0<g&&(""==c?0>m.indexOf(l)&&(h.style.display=c):h.style.display=c);h=a[b][0];""==c?(l="["+h.id+"]",0>m.indexOf(l)&&(h.childNodes[0].innerHTML=h.getAttribute("val"),h.style.fontStyle="",h.style.color="#000")):(h.childNodes[0].innerHTML="EWA_GRID_H"==h.className?h.childNodes[0].innerHTML+"...":d,h.style.fontStyle="italic",h.style.color="blue")}};this.Trans=function(){var a=new EWA_UrlClass;a.SetUrl(this.Url);0<this.Url.indexOf("&EWA_GRID_TRANS=")?
a.RemoveParameter("EWA_GRID_TRANS"):a.AddParameter("EWA_GRID_TRANS","1");this.TransParent=$X("EWA_MG_"+this._Id).parentNode;this.Url=a.GetUrl();this._DoTrans(a.GetUrl())};this._DoTrans=function(a){EWA.F.CID=this._Id;this._Ajax=new EWA.C.Ajax;this._Ajax.LoadingType="image";this._Ajax.AddParameter("EWA_AJAX","1");this._Ajax.AddParameter("EWA_ID",this._Id);this._Ajax.PostNew(a,EWA.F.FOS[EWA.F.CID]._CallBackJs)};this.Reload=function(){var a=new EWA_UrlClass;a.SetUrl(this.Url);this.TransParent=$X("EWA_MG_"+
this._Id).parentNode;this.Url=a.GetUrl();this._DoTrans(a.GetUrl())};this.ReloadAfter=function(){};this.getUrlClass=function(){var a=new EWA_UrlClass;a.SetUrl(this.Url);return a};this._CallBackJs=function(){var a=EWA.F.FOS[EWA.F.CID]._Ajax;4==a._Http.readyState&&(a.HiddenWaitting(),200==a._Http.status?(a=a._Http.responseText,EWA.F.CheckCallBack(a)&&(EWA.F.FOS[EWA.F.CID].TransParent.innerHTML=a,EWA.F.FOS[EWA.F.CID].ReloadAfter&&EWA.F.FOS[EWA.F.CID].ReloadAfter())):alert("ERROR:\r\n"+a._Http.statusText))}}
EWA.UI.MultiGrid={COLOR_BG:"rgba(173, 216, 230, 0.25)",COLOR_FOCUS:"gold",MTbId:null,MTbs:{},MOut:function(a){a=a||event;var b=a.srcElement||a.target;if(null!=b){a.stopPropagation?a.stopPropagation():a.cancelBubble();a=0;try{for(;!(b&&b.tagName&&"TD"==b.tagName.toUpperCase()&&0<b.id.indexOf("$MGC_"));)if(b=b.parentNode,a++,5<a)return}catch(l){return}var c=b.id;if(c!=EWA.UI.MultiGrid.MTbId){EWA.UI.MultiGrid.MTbId=c;var d=c.split("_"),e=d[2];a=d[1];var f=b.parentNode.parentNode.parentNode;null==this.MTbs[f.id]&&
(this.MTbs[f.id]=[]);b=this.MTbs[f.id];for(var g=0;g<b.length;g++)this._restoreBg(b[g]);for(g=b.length=0;1E3>g;g++){var h=d[0]+"_"+g+"_"+d[2],k=$X(h);if(!k)break;h==c?this._setBg(k,this.COLOR_FOCUS):this._setBg(k,this.COLOR_BG);b.push(k)}for(g=0;1E3>g;g++){h=d[0]+"_"+d[1]+"_"+g;k=$X(h);if(!k)break;h!=c&&(b.push(k),this._setBg(k,this.COLOR_BG))}c=$(f).find("#MGA_"+e+"_0");0<c.length&&(k=c[0],this._setBg(k,this.COLOR_BG),b.push(k));a=$(f).find("#MGB_"+a+"_0");0<a.length&&(k=a[0],this._setBg(k,this.COLOR_BG),
b.push(k))}}},_setBg:function(a,b){a.setAttribute("oldbg",a.style.backgroundColor);a.style.backgroundColor=b},_restoreBg:function(a){var b=a.getAttribute("oldbg");a.style.backgroundColor=b}};EWA.F.M={CUR:null,C:EWA_MultiGridClass};
function EWA_TreeNodeClass(){this.Next=this.Prev=this.Parent=this.MenuGroup=this.Text=this.Key=null;this.AddParas=[];this.Children=[];this.Cmd=this.ChildLast=null;this.tagName="TREE_NODE";this.Object=null;this.IsMoreChildren=!1;this.Mark=function(a){var b=$(this.GetObject().rows[0]);a?$(b).addClass("ewa-tree-node-marked"):$(b).removeClass("ewa-tree-node-marked")};this.SetKey=function(a){var b=this.GetObject();this.Key=a;b.id=a};this.SetText=function(a){this.Text=a;this.GetObject().rows[0].cells[2].childNodes[0].innerHTML=
a};this.SetAddParameters=function(a){this.AddParas=a.split(",");a=this.GetObject();for(var b=0;b<this.AddParas.length;b+=1)a.rows[0].cells[2].childNodes[0].setAttribute("EWA_P"+b,this.AddParas[b].trim())};this.SetMenuGroup=function(a){this.GetObject().setAttribute("EWA_MG",a)};this.AddChild=function(a){a.Parent=this;this.ChildLast=this.Children[this.Children.length]=a;this.IsMoreChildren=!1};this.GetObject=function(){null==this.Object&&(this.Object=document.getElementById(this.Key));return this.Object};
this.AddBackground=function(a){this.GetObject().rows[1].cells[0].background=a};this.SetBookIcon=function(a){this.GetObject().rows[0].cells[1].className=a};this.IsNodeOpen=function(){var a=this.GetObject().rows[0].cells[0];tag=this._GetTag(a);return"B"==tag};this.NodeShow=function(a){if("EWA_TREE_ROOT"!=this.Key){var b=this.GetObject(),c=b.rows[0].cells[0];if(null==a){var d=this._GetTag(c);if("C"==d||"D"==d)return;d="A"==d?"B":"A"}else d=a?"B":"A";for(var e=c.className.split(" "),f=[this._GetClassNameNoTag(c)+
d],g=1;g<e.length;g++)f.push(e[g]);c.className=f.join(" ");2==b.rows.length&&0<b.rows[1].cells[1].childNodes.length&&(b.rows[1].style.display="B"==d?"table-row":"none");this.BookShow(a);this.IsMoreChildren&&(this.Object.setAttribute("EWA_TREE_MORE","0"),a=new EWA.F.Cmd,a.EWA_ACTION="OnTreeNodeMore",a.EWA_TREE_KEY=this.Key,EWA.CurUI._PostChange(a));if(this.ewa&&this.ewa.OnBookShowAfter)try{this.ewa.OnBookShowAfter("B"==d,this)}catch(h){console.log(h)}}};this.BookShow=function(a){if("EWA_TREE_ROOT"!=
this.Key){var b=this.GetObject().rows[0].cells[1];null==a?(tag=this._GetTag(b),tag="A"==tag?"B":"A"):tag=a?"B":"A";a=b.className.split(" ");for(var c=[this._GetClassNameNoTag(b)+tag],d=1;d<a.length;d++)c.push(a[d]);b.className=c.join(" ")}};this.NodeClose=function(){this.NodeShow(!1)};this.NodeOpen=function(){this.NodeShow(!0)};this.BookOpen=function(){this.BookShow(!0)};this.BookClose=function(){this.BookShow(!1)};this.NodeCross=function(a){var b=this.GetObject(),c=b.rows[0].cells[0];if("D"==this._GetTag(c)||
a)c.className=this._GetClassNameNoTag(c)+"C";1==b.rows.length&&(a=b.insertRow(-1),a.insertCell(-1),a.insertCell(-1),a.cells[1].colSpan=2,a.style.display="none");c=b.rows[1].cells[0];c.className="TD10B"};this.NodeCrossEnd=function(a){var b=this.GetObject(),c=b.rows[0].cells[0],d=this._GetTag(c);if(1==b.rows.length){var e=b.insertRow(-1);e.insertCell(-1);e.insertCell(-1);e.cells[1].colSpan=2}b.rows[1].style.display="none";if("C"==d||a)c.className=this._GetClassNameNoTag(c)+"D";c=b.rows[1].cells[0];
c.className="TD10A"};this._GetTag=function(a){a=a.className.split(" ")[0];return a.substring(a.length-1)};this._GetClassNameNoTag=function(a){a=a.className.split(" ")[0];return a.substring(0,a.length-1)}}
function EWA_TreeClass(a,b,c){this.ParentObject=a;this.ClassName=b;this.Url=this._Url=c;this.Resources={};this.Icons=this.Menu=this._Ajax=null;this._CurNewNode=0;this.Fields={};this._LastFocus=this._Id=null;this._TempNode=document.createElement("DIV");this._MoveNode=document.createElement("DIV");this._HtmlTemplate1="<div oncontextmenu='"+this.ClassName+".ShowMenu(event);return false;' onclick='"+this.ClassName+".Click(event)'><table border=0 cellspacing=0 [ID] cellpadding=0 width=100% style='table-layout:fiexed'>";
this._HtmlTemplate1+="<tr><TD></TD><td class=CAPTION>&nbsp;&nbsp;&nbsp;</td><td width=99%><SPAN style='padding-left:4px'>[B]</SPAN></td></tr>";this._HtmlTemplate1+="<tr><td></td><td colspan=2></td></tr></table></div>";this._HtmlTemplate1+="<div style='display:none'><input style='margin:0px' type=text onblur='"+this.ClassName+".RenameBlur(this)'></div>";this._HtmlTemplate="<table class='ewa-tree-node ewa-tree-lvl-[LVL]' border=0 EWA_MG=\"[EWA_MENU_GROUP]\" EWA_T=1 [EWA_MORE_CHILDREN] cellspacing=0 [ID] cellpadding=0 width=100%>";
this._HtmlTemplate+="<tr class='ewa-node-row-0'><td nowrap class='[A] ewa-node-open-close'><div>&nbsp;</div></td><td nowrap class='[B] ewa-node-icon'><div>&nbsp;</div></td><td class='ewa-node-caption'><SPAN EWA_CMD=1 [TMP_ADD_PARAS]>[C]</SPAN></td>[TEMP_NODE_ADD_FIELDS]";this._HtmlTemplate+="</tr><tr class='ewa-node-row-1' style='display:none'><td class='[A1]'></td><td colspan=13></td></tr></table>";this.OpenAll=function(){this._OpenOrClose(".TD00A")};this.CloseAll=function(){this._OpenOrClose(".TD00B")};
this._OpenOrClose=function(a){var b=this;$("#EWA_TREE_"+this._Id).find(a).each(function(){b.Click({srcElement:this})})};this.DoAction=function(a,b,c,g,h,k){EWA.F.CID=this._Id;if(null==b||""==b.trim())alert("action not value");else{if(null!=c&&0<c.trim().length)if(a=_EWA_INFO_MSG[c],null!=a&&""!=a){if(!window.confirm(a))return}else if(!window.confirm(c))return;this._Ajax=new EWA.C.Ajax;this._Ajax.LoadingType="image";this._Ajax.AddParameter("EWA_AJAX","1");this._Ajax.AddParameter("EWA_ACTION",b);this._Ajax.AddParameter("EWA_ID",
this._Id);this._Ajax.AddParameter("EWA_NO_CONTENT","1");this._Ajax.AddParameter("EWA_ACTION_TIP",g);null!=k&&0<k.trim().length?(this._Ajax.AddParameter("EWA_AFTER_EVENT",k),this.StopAjaxAfterReload=!0,this._Ajax.AddParameter("EWA_ACTION_RELOAD","0")):this.StopAjaxAfterReload=!1;if(null!=h&&0<h.length)for(b=0;b<h.length;b+=1)this._Ajax.AddParameter(h[b].Name,h[b].Value);h=new EWA.C.Url;h.SetUrl(this.Url);h=h.RemoveParameter("EWA_ACTION");this._Ajax.PostNew(h,EWA.F.FOS[EWA.F.CID]._PostChangeCallback)}};
this.OnMouseDown=function(a){};this.OnMouseUp=function(a){};this.OnMouseMove=function(a){};this.OnMouseOut=function(a){};this.MoveNode=function(a){};this.GetParentNode=function(a){if(null==a||"EWA_TREE_ROOT"==a.Key)return null;a=a.GetObject().parentNode;a=this.GetNode(a);return null==a?null:"EWA_TREE_ROOT"==a.Key?null:a};this.CreateByXml=function(a){for(var b=a.GetElements("FrameData/Row"),c={},d,h=0;h<b.length;h+=1){var k=this._CreateNodeFromXml(b[h],a);c[k.Key]=k;if(0==h)d=k;else{var l=c[""==k.ParentKey?
"EWA_TREE_ROOT":k.ParentKey];null!=l&&l.AddChild(k)}}treeFirstNode=d;this.Create(d)};this.OnSelect=function(a){return"INPUT"!=a.srcElement.tagName?!1:!0};this.InitMenu=function(a){null!=a&&(this.Menu=new EWA_UI_MenuClass(b+".Menu"),this.Menu.Create(a))};this._PostChange=function(a){this.PostChangeType=a.EWA_ACTION;this.PostChangeKey=a.EWA_TREE_KEY;EWA.CurUI=this;this._Ajax=new EWA.C.Ajax;"OnTreeNodeMore"==this.PostChangeType&&(a.EWA_AJAX="XML",a.EWA_TREE_MORE="1");for(var b in a)this._Ajax.AddParameter(b,
a[b]);this._Ajax.PostNew(this._Url,EWA.CurUI._PostChangeCallback);this.IsPostChange=!0};this._PostChangeCallback=function(){var a=EWA.CurUI._Ajax;4==a._Http.readyState&&(a.HiddenWaitting(),200==a._Http.status?(a=a._Http.responseText,EWA.F.CheckCallBack(a)&&("OnTreeNodeMore"==EWA.CurUI.PostChangeType?EWA.CurUI.LoadChildrenAfter(a):"OnTreeNodeStatus"==EWA.CurUI.PostChangeType?EWA.CurUI.LoadChildrenStatus(a):eval(a))):alert("ERROR:\r\n"+a._Http.statusText),EWA.CurUI.IsPostChange=!1,EWA.SHOW_ERROR=!0)};
this.LoadChildrenStatus=function(a){var b=new EWA.C.Xml;b.LoadXml(a);var c=b.GetElements("FrameData/Row");if(null!=c){a=[];for(var d={},h=0;h<c.length;h=1+h){var k=this._CreateNodeFromXml(c[h],b);""==k.Key||$[k.ParentKey]||(a.push(k),d[k.Key]=k)}if(0!=a.length&&(b=this.GetNodeById(a[0].ParentKey),null!=b)){d[b.Key]=b;for(h=0;h<a.length;h+=1)d[a[h].ParentKey].AddChild(a[h]);b.GetObject().setAttribute("EWA_TREE_MORE","0");b.IsMoreChildren=!1;for(h=0;h<b.Children.length;h+=1)this.Create(b.Children[h]);
b.NodeShow(!0);this.ShowNode(this.PostChangeKey)}}};this.LoadChildrenAfter=function(a){var b=new EWA.C.Xml;b.LoadXml(a);a=b.GetElements("FrameData/Row");if(null!=a&&0!=a.length){var c=this.GetNodeById(this.PostChangeKey),d={};d[c.Key]=c;for(var h=0;h<a.length;h=1+h){var k=this._CreateNodeFromXml(a[h],b);if("EWA_TREE_ROOT"!=k.Key){if(null==k.ParentKey||""==k.ParentKey)k.ParentKey=c.Key;d[k.Key]=k;var l=k.ParentKey;null!=d[l]&&d[l].AddChild(k)}}if(0<c.Children.length)for(h=0;h<c.Children.length;h=1+
h)this.Create(c.Children[h]);c.NodeShow(!0)}};this._CreateNodeFromXml=function(a,b){var c=new EWA_TreeNodeClass;c.ewa=this;c.Key=b.GetElementAttribute(a,"Key");c.ParentKey=b.GetElementAttribute(a,"ParentKey");c.Text=b.GetElementAttribute(a,"Text");c.IsMoreChildren="1"==b.GetElementAttribute(a,"IsMoreChildren")?!0:!1;c.MenuGroup=b.GetElementAttribute(a,"MenuGroup");for(var d=0;3>d;d+=1)c.AddParas[c.AddParas.length]=b.GetElementAttribute(a,"AddPara"+d);return c};this.Rename=function(a,b,c,g){null==
a&&(a=this._LastFocus);null!=a&&(this._RenameActionCmd=b,this._RenameRegex=c,this._RenameInfo=g,this._RenameNode="TREE_NODE"==a.tagName?a:this.GetNode(a),"EWA_TREE_ROOT"==this._RenameNode.Key?this._RenameNode=null:(a=this._RenameNode.GetObject(),a=a.rows[0].cells[a.rows[0].cells.length-1].childNodes[0],b=GetInnerText(a),a.style.display="none",c=this._GetInput(),a.parentNode.appendChild(c),c.value=b,c.setAttribute("EWA_OLD_VAL",b),c.style.width="300px",c.focus()))};this._GetInput=function(){for(var a=
this.ParentObject.getElementsByTagName("INPUT"),b=a.length-1;0<=b;b--){var c=a[b];if(c.getAttribute("onblur")&&0<c.getAttribute("onblur").indexOf("RenameBlur("))return this._InputDiv=c.parentNode,c}};this.RenameBlur=function(a){for(var b=a.getAttribute("EWA_OLD_VAL"),c=this._RenameNode,d=this.GetNode(c.GetObject().parentNode),h=0;h<d.Children.length;h+=1){var k=d.Children[h];if(k.Key!=c.Key&&k.Text.trim()==a.value.trim()){alert(_EWA_EVENT_MSG.OnTreeNodeNameRepeat);a.focus();return}}d=a.parentNode.childNodes[0];
this._InputDiv.appendChild(a);d.style.display="";if("NEW"==c.RenameType||b!=a.value){d.innerHTML=a.value;b=this._RenameActionCmd;null==b&&(b=new EWA.F.Cmd);if(null==b.EWA_ACTION||""==b.EWA_ACTION.trim())b.EWA_ACTION="NEW"==c.RenameType?"OnTreeNodeNew":"OnTreeNodeRename";"NEW"==c.RenameType&&(""==b.EWA_AFTER_EVENT&&(b.EWA_AFTER_EVENT='EWA.F.FOS["'+this._Id+'"].NewNodeAfter;'),d=this.GetNode(c.GetObject().parentNode),b.EWA_TREE_PARENT_KEY=d.Key);b.EWA_TREE_TEXT=a.value;b.EWA_TREE_KEY=c.Key;this._PostChange(b);
this._RenameActionCmd=null}};this.RenameKeyDown=function(a,b){a=a.keyCode?a.keyCode:a.which;13==a&&this.RenameBlur(b);27==a&&(a=b.getAttribute("EWA_OLD_VAL"),b.value=a,this.RenameBlur(b))};this.Delete=function(a,b){var c=this.GetNode(this._LastFocus);null!=c&&"EWA_TREE_ROOT"!=c.Key&&window.confirm(_EWA_EVENT_MSG.OnTreeNodeDelete)&&(!a&&(0<c.Children.length||c.IsMoreChildren)?(c.NodeShow(!0),alert(_EWA_EVENT_MSG.OnTreeNodeDeleteHaveChildren)):(a=b,null==a&&(a=new EWA.F.Cmd,a.EWA_ACTION="OnTreeNodeDelete"),
""==a.EWA_AFTER_EVENT&&(a.EWA_AFTER_EVENT='EWA.F.FOS["'+this._Id+'"].DeleteAfter();'),a.EWA_TREE_KEY=c.Key,this._PostChange(a)))};this.DeleteAfter=function(){var a=this.GetNode(this._LastFocus).GetObject(),b=a.parentNode;b.removeChild(a);a=this.GetNode(b);0==a.Children.length?this.GetNode(a.GetObject().parentNode).ChildLast.Key==a.Key?a.NodeCrossEnd(!0):a.NodeCross(!0):a.ChildLast.NodeCrossEnd();this._LastFocus=null};this.NewNode=function(a,b,c,g){null!=this._LastFocus&&(this._NewNodeTemp={TEXT:a,
CMD:b,REGEX:c,INFO:g},this.GetNode(this._LastFocus).NodeShow(!0),this.IsPostChange?this._NewNodeTimer=window.setInterval(function(){EWA.CurUI.IsPostChange||(window.clearInterval(EWA.CurUI._NewNodeTimer),EWA.CurUI._NewNode())},100):this._NewNode())};this._NewNode=function(){var a=this._NewNodeTemp.TEXT,b=this._NewNodeTemp.CMD,c=this._NewNodeTemp.REGEX,g=this._NewNodeTemp.INFO;this._NewNodeTemp=null;var h=new EWA_TreeNodeClass;h.ewa=this;this._CurNewNode+=1;h.Key="NEW_NODE_"+this._Id+"__"+this._CurNewNode;
h.RenameType="NEW";var k=_EWA_EVENT_MSG.OnTreeNodeNew+this._CurNewNode;null!=a&&0<a.trim().length&&(k=a.trim());h.Text=k;a=this.GetNode(this._LastFocus);0<a.Children.length&&a.Children[a.Children.length-1].NodeCross();a.AddChild(h);this.Create(h);a.NodeShow(!0);this.Rename(h,b,c,g)};this.NewNodeAfter=function(a,b,c){var d=this.GetNodeById("NEW_NODE_"+this._Id+"__"+this._CurNewNode);d.SetKey(a);d.SetAddParameters(null==b?"":b);d.SetMenuGroup(null==c?"":c);a=this.TestIcon(d);d.SetBookIcon(a)};this.GetNodeById=
function(a){a=$("#EWA_TREE_"+this._Id+' .ewa-tree-node[id="'+a+'"]');return 0==a.length?null:this.GetNode(a[0])};this.GetFocusNode=function(){return this.GetNode(this._LastFocus)};this.GetNode=function(a){if(null==a||null==a.tagName)return null;var b=a;for(a=0;("TABLE"!=b.tagName||"1"!=b.getAttribute("EWA_T"))&&"EWA_TREE_ROOT"!=b.id;)if(b=b.parentNode,a++,33<a||"BODY"==b.tagName)return null;a=new EWA_TreeNodeClass;a.ewa=this;a.Key=b.id;a.MenuGroup=b.getAttribute("EWA_MG");a.Object=b;var c=b.rows[0].cells[2];
a.Text=GetInnerText(c);for(var d=0;3>d;d+=1)a.AddParas[d]=c.childNodes[0].getAttribute("EWA_P"+d);d=b.getAttribute("EWA_TREE_MORE");a.IsMoreChildren="1"==d?!0:!1;if(1<b.rows.length){b=b.rows[1].cells[b.rows[1].cells.length-1];for(d=0;d<b.childNodes.length;d=1+d)c=b.childNodes[d],3!=c.nodeType&&"TABLE"==c.tagName&&"1"==c.getAttribute("EWA_T")&&a.Children.push(this.GetNode(c));0<a.Children.length&&(a.ChildLast=a.Children[a.Children.length-1])}return a};this.Click=function(a,b){if(!this.IsPostChange&&
(EWA.CurUI=this,a=a.srcElement?a.srcElement:a.target,"INPUT"!=a.tagName))if("DIV"==a.tagName&&(a=a.parentNode),"TD"==a.tagName&&0==a.className.indexOf("TD00")){var c=this.GetNode(a);c.NodeShow()}else{for(;("SPAN"!=a.tagName||null==a.getAttribute("EWA_CMD"))&&"1"!=a.getAttribute("EWA_TREE_TOP");)if(a=a.parentNode,"BODY"==a.tagName)return;c=this.GetNode(a);if("SPAN"==a.tagName&&(null!=a.getAttribute("EWA_CMD")||"1"==a.getAttribute("EWA_TREE_TOP"))){null!=this._LastFocus&&(this.GetNode(this._LastFocus).Mark(!1),
this._LastFocus=null);"1"!=a.getAttribute("EWA_TREE_TOP")&&c.Mark(!0);this._LastFocus=a;if(b)return a;0>this.Url.toUpperCase().indexOf("EWA_TREE_SKIP_GET_STATUS")&&EWA.F.ST.SaveStatus(c.Key,"TREE");this._RunCmd(c);this.MoveNode(c.GetObject())}}};this._RunCmd=function(a){var b=this.GetNode(a.GetObject().parentNode);if(this.link)this.link(a.Key,a);else{console.warn('\u5efa\u8bae\u91c7\u7528\u5b9a\u4e49 EWA.F.FOS["xx"].link = function(nodeKey, node){}');b='link("'+a.Key+'","'+b.Key+'","'+a.Text.replace(/\n/mig,
"\\n").replace(/\r/mig,"\\r").replace(/"/mig,"&quot;")+'"';for(var c=0;c<a.AddParas.length;c+=1)b=null==a.AddParas[c]?b+",null":b+(',"'+a.AddParas[c]+'"');EWA.C.Utils.RunCmd(b+");")}};this.ShowMenu=function(a){EWA.CurUI=this;var b=this.Click(a,!0);null!=this.Menu&&null!=b&&(b=this.GetNode(b),this.Menu.ShowByMouse(a,b.MenuGroup))};this.TestIcon=function(a){if(null==this.Icons)return"TD01A";for(var b in this.Icons){var c=this.Icons[b],d=null;switch(c.TEST.toUpperCase()){case "KEY":d=a.Key;break;case "PARENTKEY":d=
a.Parent.Key;break;case "TEXT":d=a.Text;break;case "P0":d=a.AddParas[0];break;case "P1":d=a.AddParas[1];break;case "P2":d=a.AddParas[2];break;case "MG":d=a.MenuGroup}if(null!=d&&eval("/"+c.FILTER+"/ig").test(d))return c.NAME+"A"}return"TD01A"};this.Create=function(a,b){if(null!=a)if(null==a.Parent)this._CreateFirst(a);else{var c=this._HtmlTemplate.replace("[ID]",'id="'+a.Key+'"');c=c.replace("[TEMP_NODE_ADD_FIELDS]",this.AddCols||"");for(var d="",e=0;e<a.AddParas.length;e+=1)null!=a.AddParas[e]&&
void 0!=a.AddParas[e]&&(d+="EWA_P"+e+'="'+a.AddParas[e]+'" ');c=c.replace("[TMP_ADD_PARAS]",d);c=c.replace("[EWA_MENU_GROUP]",a.MenuGroup);d=this.TestIcon(a);c=c.replace("[B]",d);c=c.replace("[C]",a.Text);c=a.IsMoreChildren?c.replace("[EWA_MORE_CHILDREN]","EWA_TREE_MORE='1'"):c.replace("[EWA_MORE_CHILDREN]","");0<a.Children.length||a.IsMoreChildren?(c=c.replace("[A]","TD00A"),c=a!=a.Parent.ChildLast?c.replace("[A1]","TD10B"):c.replace("[A1]","TD10A")):c=a==a.Parent.ChildLast?c.replace("[A]","TD00D"):
c.replace("[A]","TD00C");d=a.Parent.GetObject();1==d.rows.length&&(e=d.insertRow(-1),e.insertCell(-1),e.insertCell(-1),e.cells[1].colSpan=2);e=this.GetNodeLvl(a.Parent);c=c.replace("[LVL]",e+1);this._TempNode.innerHTML=c;c=this._TempNode.childNodes[0];d.rows[1].cells[d.rows[1].cells.length-1].appendChild(c);d.parentNode.childNodes[d.parentNode.childNodes.length-1]!=d&&(d.rows[1].cells[0].className="TD10B");a.Parent.NodeShow(!0);b&&b(c,this);for(e=0;e<a.Children.length;e+=1)this.Create(a.Children[e],
b)}};this.GetNodeLvl=function(a){var b=a;if(a.Object.getAttribute("tree_lvl"))return 1*a.Object.getAttribute("tree_lvl");for(var c=0;100>c;c++)if(b=this.GetParentNode(b),null==b)return a.Object.setAttribute("tree_lvl",c+1),c+1};this._CreateFirst=function(a,b){var c=this._HtmlTemplate1.replace("[ID]","id='"+a.Key+"'");c=c.replace("[B]",a.Text);this.ParentObject.innerHTML=c;for(c=0;c<a.Children.length;c+=1)this.Create(a.Children[c],b)};this.Init=function(a){var b=new EWA.C.Xml;b.LoadXml(a);this.Resources=
new EWA_FrameResoures;this.Resources.Init(b);-1!=this.Url.toUpperCase().indexOf("EWA_TREE_INIT_KEY")||0<this.Url.toUpperCase().indexOf("EWA_TREE_SKIP_GET_STATUS")||EWA.F.ST.GetStatus("TREE",this)};this.LoadStatus=function(){EWA.SHOW_ERROR=!1;this.ShowNode(_EWA_STATUS_VALUE)};this.ShowNode=function(a){if(null!=a&&""!=a&&"EWA_TREE_ROOT"!=a){var b=this.GetNodeById(a);null==b?(b=new EWA.F.Cmd,b.EWA_ACTION="OnTreeNodeStatus",b.EWA_AJAX="XML",b.EWA_TREE_KEY=a,b.EWA_TREE_STATUS="1",this._PostChange(b)):
(this._StatusNode=b,this.ShowNodeA())}};this.ShowNodeA=function(){var a=this._StatusNode;this._StatusNode=null;for(var b=a.GetObject().parentNode,c=this.GetNode(b);"EWA_TREE_ROOT"!=c.Key;)c.NodeShow(!0),c=this.GetNode(c.GetObject().parentNode);a.Mark(!0);this._LastFocus=a.GetObject();this._RunCmd(a);window.setTimeout(function(){b.focus()},0)};this.getUrlClass=function(){var a=new EWA_UrlClass;a.SetUrl(this.Url);return a};this.Reload=function(){}}
function EWA_Treelink(a,b,c,d,e,f){alert("key="+a+"\r\nparentKey="+b+"\r\ntext="+c+"\r\naddPara1="+d+"\r\naddPara2="+e+"\r\naddPara3="+f+"\r\n\r\n\u60a8\u9700\u8981\u8986\u76d6\u8fd9\u4e2a\u65b9\u6cd5\r\nlink(key, parentKey, text, addPara1, addPara2, addPara3)")}"undefined"==typeof link&&(link=EWA_Treelink);EWA.F.T={CUR:null,C:EWA_TreeClass,Node:EWA_TreeNodeClass};
function EWA_Html5UploadClass(){this.uploadIframes=[];this.files=[];this.UPLOAD_STATUS=this.POST_REF=this.POST_NAME=this.POST_ITEMNAME=this.POST_XMLNAME="";this.WAIT_ID=EWA_Utils.tempId("ht5upload_wait_");this.haveFile=function(){for(var a=0;a<this.files.length;a++)if(""!=this.files[a].value)return!0;return!1};this.getValue=function(){if(0==this.uploadIframes.length&&0==this.files.length)return"";for(var a=[],b=0;b<this.uploadIframes.length;b++){var c=eval("(function(){var __json="+this.uploadIframes[b]+
"; return __json;})()"),d;for(d in c)a.push(c[d])}return JSON.stringify(a)};this.fileIco=function(a,b){a=EWA.UI.Ext.FileExt(a.name);$X(b).onerror=function(){};$X(b).src=EWA.UI.Ext.FileIco(a)};this.showPreview=function(a){var b=a.parentNode,c=b.outerHTML;b.style.display="none";a.setAttribute("ok",1);gFileReaders={};for(var d=0;d<a.files.length;d++){var e=a.files[d];this.showPreview1(b,e);this.files.push(e)}"yes"==this.UpMulti&&$(b).before(c)};this.addOther=function(a){for(var b=$X(this.POST_NAME).parentNode.getElementsByTagName("input")[1].parentNode,
c=0;c<a.length;c++)this.showPreview1(b,a[c]);this.uploadIframes.push(JSON.stringify(a))};this.showPreviewExists=function(){var a=$("#EWA_FRAME_"+this.SYS_FRAME_UNID+" input#"+this.POST_NAME).val();if(""!=a){try{EWA.F.FOS[this.SYS_FRAME_UNID].setUnMust(this.POST_NAME)}catch(f){}var b=$("#EWA_FRAME_"+this.SYS_FRAME_UNID+" input#"+this.POST_NAME).parent().find(".ewa_app_upload_form")[0],c="_upload_"+Math.random();c=c.replace(".","G");var d=document.createElement("img");d.id=c;c=document.createElement("table");
c.cellPadding=0;c.cellSpacing=0;c.className="ewa_app_upload_form1";b.parentNode.appendChild(c);b=c.insertRow(-1).insertCell(-1);b.align="center";b.appendChild(d);b.className="img";b.vAlign="middle";b=c.insertRow(-1).insertCell(-1);c=a.split("/");c=c[c.length-1];b.innerHTML="<div title='"+c+"'>"+c+"</div>";b.className="name";d.src=a;var e=this;d.onerror=function(){e.fileIco({name:this.src},this.id)}}};this.showPreview1=function(a,b){var c="_upload_"+Math.random();c=c.replace(".","G");b.ref=c;var d=
document.createElement("img");d.id=c;var e=document.createElement("table");e.cellPadding=0;e.cellSpacing=0;e.className="ewa_app_upload_form1";a.parentNode.appendChild(e);a=e.insertRow(-1).insertCell(-1);a.align="center";a.appendChild(d);a.className="img";a.vAlign="middle";a=e.insertRow(-1).insertCell(-1);a.innerHTML="<div>"+b.name+"</div><div id='"+c+"_process1' class='ewa-app-upload-process1'></div><div id='"+c+"_process' class='ewa-app-upload-process'>0%</div>";a.className="name";if(b.type&&0==
b.type.indexOf("image/")){d.src=EWA.RV_STATIC_PATH+"/EWA_STYLE/images/loading2.gif";d=new FileReader;gFileReaders[c]=d;var f=this;d.onloadend=function(a){for(var b in gFileReaders)gFileReaders[b]==a.target&&($X(b).src=a.target.result,f.showPreviewAfter&&f.showPreviewAfter($X(b),a))};d.readAsDataURL(b)}else this.fileIco(b,c),this.showPreviewAfter&&this.showPreviewAfter($X(c),b)};this.submitUploads=function(a){if(window.FormData){this.uploadIframes=[];var b=this;this.UPLOAD_STATUS="start";this.action=
EWA.CP+"/EWA_STYLE/cgi-bin/_up_/?xmlname="+this.POST_XMLNAME+"&ITEMNAME="+this.POST_ITEMNAME+"&NAME="+this.POST_NAME+"&EWA_UP_TYPE=SWFUPLOAD&EWA_UP_REF="+this.POST_REF;try{$("input[type=file][ok=1]").each(function(a){a=this.id.split("_1_2_3_4_5_")[1];if(b.POST_NAME==a)for(a=0;a<this.files.length;a++)b.uploadIframes.push({file:this.files[a]})})}catch(c){alert(c)}0<this.uploadIframes.length?(a=$X("f_"+this.SYS_FRAME_UNID),$(a).find(".ewa-app-upload-process,.ewa-app-upload-process1").show(),b.UPLOAD_STATUS=
"checking",this.asyncUpload()):this.UPLOAD_STATUS="nofile"}else this.submitUploads_old(a)};this.asyncUpload=function(){var a=this,b=null,c;for(c in this.uploadIframes){var d=this.uploadIframes[c];if("string"!=typeof d){b=d;break}}null!=b?(b.submitting||(b.submitting=!0,this.submitUpload(b)),setTimeout(function(){a.asyncUpload()},111)):this.uploadsCompleted&&this.uploadsCompleted(this.uploadIframes)};this.createFormData=function(){var a=new FormData,b=new EWA_UrlClass;b.SetUrl(EWA.F.FOS[this.SYS_FRAME_UNID].Url);
for(var c in b._Paras)0!=c.toUpperCase().indexOf("EWA")&&a.append(c,b._Paras[c]);if(b=$X("f_"+this.SYS_FRAME_UNID))for(c=0;c<b.length;c++){var d=b[c],e=d.name||d.id;"file"!=d.type&&"button"!=d.type&&"submit"!=d.type&&("radio"!=d.type&&"checkbox"!=d.type||d.checked)&&"ht5upload"!=$(d).attr("ewa_tag")&&a.append(e,d.value)}return a};this.submitUpload=function(a){var b=a.file,c=this.createFormData();c.append(this.POST_NAME,b,b.name);var d=$('img[id="'+b.ref+'"]');this.createNewSizes(d[0],c);var e=this,
f=$('div[id="'+b.ref+'_process"]');f.show().html("0%");var g=$('div[id="'+b.ref+'_process1"]');g.css("width",0).show();b=new XMLHttpRequest;b.upload.addEventListener("progress",function(a){a.lengthComputable?(a=Math.round(100*a.loaded/a.total-10),0>a&&(a=0),f.html(a.toString()+"%"),g.css("width",a.toString()+"%")):f.html("unable to compute")},!1);b.addEventListener("load",function(a){f.html("100%");g.css("width","100%");for(var b in e.uploadIframes)if(e.uploadIframes[b].xhr==a.target){e.uploadIframes[b]=
a.target.responseText;break}e.chkAllXhrComplete()},!1);b.addEventListener("error",function(a){console.log(a);f.html(a);e.UPLOAD_STATUS="error"},!1);b.addEventListener("abort",function(a){f.html("The upload has been canceled by the user or the browser dropped the connection.");console.log(a);e.UPLOAD_STATUS="abort"},!1);b.open("POST",this.action,!0);b.send(c);a.xhr=b;delete a.file};this.createNewSizes=function(a,b){if(this.UpNewSizes&&"server"!=this.NewSizesIn){if(!this.siezs){var c=this.UpNewSizes.split(",");
this.siezs=[];for(var d in c){var e=c[d],f=e.split("x");2==f.length&&(e=f[0],f=f[1],isNaN(e)||isNaN(f)||this.siezs.push({w:1*e,h:1*f}))}}if(0!=this.siezs.length)for(d in this.siezs)e=this.siezs[d],c=EWA_ImageCalss.resizeAsBlob(a,e.w,e.h),b.append(this.POST_NAME,c,"resized$"+e.w+"x"+e.h+".jpg")}};this.chkAllXhrComplete=function(){for(var a=0,b=0;b<this.uploadIframes.length;b++)"string"==typeof this.uploadIframes[b]&&a++;a==this.uploadIframes.length&&(this.UPLOAD_STATUS="ok")};this.submitUploads_old=
function(a){this.uploadIframes=[];var b=this;this.UPLOAD_STATUS="start";try{$("input[type=file][ok=1]").each(function(a){var c=this.id.split("$")[1];b.POST_NAME==c&&b.submitUpload_old(a,this)})}catch(c){alert(c)}0<this.uploadIframes.length?window.setTimeout(function(){b.UPLOAD_STATUS="checking";b.chkframeSubmt()},400):this.UPLOAD_STATUS="nofile"};this.submitUpload_old=function(a,b){a="GDX"+a;var c=document.createElement("iframe");c.id=a;c.name=a;document.body.appendChild(c);c=$(c);c.hide();var d=
document.createElement("form");document.body.appendChild(d);d.method="post";d.enctype="multipart/form-data";d.innerHTML="<input type=submit>";var e=$(d);e.hide();d=EWA.CP+"/EWA_STYLE/cgi-bin/_up_/?xmlname="+this.POST_XMLNAME+"&ITEMNAME="+this.POST_ITEMNAME+"&NAME="+this.POST_NAME+"&EWA_UP_TYPE=SWFUPLOAD&EWA_UP_REF="+this.POST_REF;var f=b.id.split("_")[1].split("$")[0],g=EWA.F.FOS[f].Url,h=new EWA_UrlClass;h.SetUrl(g);for(var k in h._Paras)0!=k.toUpperCase().indexOf("EWA")&&(d+="&"+k+"="+h._Paras[k]);
if(k=$X("f_"+f))for(f=0;f<k.length;f++)g=k[f],"file"!=g.type&&"button"!=g.type&&"submit"!=g.type&&("radio"!=g.type&&"checkbox"!=g.type||g.checked)&&(d+="&"+(g.name||g.id)+"="+g.value.toURL());e.attr("action",d);e.append(b);e.attr("target",a);this.uploadIframes.push(c[0]);setTimeout(function(){e.submit()},400)};this.chkframeSubmt=function(){for(var a=0,b=0;b<this.uploadIframes.length;b++){var c=this.uploadIframes[b];if("string"==typeof c)a++;else if(c.contentDocument&&c.contentDocument.body){var d=
GetInnerText(c.contentDocument.body);if(0<=d.indexOf("]")&&0<=d.indexOf("["))$("form[target="+c.id+"]").remove(),$(c).remove(),this.uploadIframes[b]=d;else if(""!=d.trim()){alert("\u7cfb\u7edf\u6267\u884c\u9519\u8bef\uff1a"+d);return}}}if(a==this.uploadIframes.length)this.UPLOAD_STATUS="ok";else{var e=this;window.setTimeout(function(){e.chkframeSubmt()},100)}};this.createWaitBox=function(){if(!$X(this.WAIT_ID)){var a=document.createElement("div");a.id=this.WAIT_ID;var b=$("body");$(a).css({width:300,
height:100,"line-height":"100px","font-size":"16px",position:"fixed",top:.5*b.height()-35,left:.5*b.width()-150,"z-index":12838,"background-color":"f0f0f0",color:"#08c","border-radius":"10px",opacity:.9}).addClass("ewa-upload-wait-box");a.innerHTML="<table height=100% align=center><tr><td><img src='"+EWA.RV_STATIC_PATH+"/EWA_STYLE/images/loading2.gif'></td><td>"+("enus"==EWA.LANG?"Please waitting ...":"\u8bf7\u7b49\u5f85\u6587\u4ef6\u4e0a\u4f20\u5b8c\u6bd5...")+"</td></table>";b.append(a);this.noWaitBox&&
$(a).hide()}};this.removeWaitBox=function(){$("#"+this.WAIT_ID).remove()}}
function EWA_Html5TakePhotoClass(){this._wait_end=!0;this.UPLOAD_STATUS="NO";this.H5_UPLOAD=new EWA_Html5UploadClass;this.res={zhcn:{TAKE_PHOTO:"\u70b9\u51fb\u83b7\u53d6\u7167\u7247",RE_TAKE:"\u91cd\u65b0\u83b7\u53d6"},enus:{TAKE_PHOTO:"Take photo",RE_TAKE:"Re take"}};this.getRes=function(){return"enus"==EWA.LANG?this.res.enus:this.res.zhcn};this.getValue=function(){return this.responseText?this.responseText:""};this.init=function(a){this.objName=a;var b="#h5TakePhoto_"+a,c="h5TakePhotoVod_"+a;a=
$X("h5TakePhotoCan_"+a);a.height=$(b).height();a.width=$(b).width();this.context=a.getContext("2d");this.video=$X(c);$(this.video).show();c={video:!0};var d=this;navigator.getUserMedia?navigator.getUserMedia(c,function(a){d.video.src=a;d.video.play()},d.errBack):navigator.webkitGetUserMedia?navigator.webkitGetUserMedia(c,function(a){d.video.src=(window.URL||window.webkitURL).createObjectURL(a);d.video.play()},d.errBack):navigator.mozGetUserMedia&&navigator.mozGetUserMedia(c,function(a){d.video.src=
window.URL.createObjectURL(a);d.video.play()},d.errBack);$(b).find("button").html(this.getRes().TAKE_PHOTO)};this.errBack=function(a){EWA.UI.Msg.ShowError("\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u5728\u7ebf\u62cd\u6444<br>"+a.message,"\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u5728\u7ebf\u62cd\u6444");console.log(a)};this.takePhoto=function(a){if(this._wait_end){var b="#h5TakePhotoVod_"+this.objName,c=$(b).width();b=$(b).height();this.context.drawImage(this.video,0,0,c,b);this.createPic();this.setPhotoStatus("img");
if(a){var d=this;a.innerHTML=this.getRes().RE_TAKE;a.onclick=function(){d.showVideo(this)};$(a).show();$(a).parent().show()}}else $Tip("\u8fd0\u884c\u4e2d...")};this.showVideo=function(a){if(this._wait_end){if(this.setPhotoStatus("video"),a){var b=this;a.innerHTML=this.getRes().TAKE_PHOTO;a.onclick=function(){b.takePhoto(this)};$(a).show();$(a).parent().show()}}else $Tip("\u8fd0\u884c\u4e2d...")};this.setPhotoStatus=function(a){var b="#h5TakePhoto_"+this.objName,c="#h5TakePhotoCan_"+this.objName,
d="#h5TakePhotoVod_"+this.objName,e="#h5TakePhotoImg_"+this.objName;$(b).find("*").hide();"img"==a?(this._photo_status="img",$(b).css({border:"1px solid green"}),$(e).show()):"video"==a?(this._photo_status="video",$(b).css({border:"1px solid red"}),$(d).show()):"canvas"==a&&(this._photo_status="canvas",$(b).css({border:"1px solid blue"}),$(c).show())};this.createPic=function(){var a="#h5TakePhotoImg_"+this.objName,b=$X("h5TakePhotoCan_"+this.objName).toDataURL("image/jpeg",.7);$(a).attr("src",b);
this.setPhotoStatus("img");return $(a)[0]};this.submitUpload=function(){var a="#h5TakePhotoImg_"+this.objName,b=this.H5_UPLOAD.createFormData();a=$(a)[0];a=EWA_ImageCalss.resizeAsBlob(a,a.width,a.height);b.append(this.objName,a,this.objName+".jpg");a="#h5TakePhoto_"+this.objName;var c=this,d=$(a).find(".ewa-h5-take-photo-process");d.show();d.find("span").show().html("0%");var e=$(a).find(".ewa-h5-take-photo-process1");e.css("width",0).show();var f=new XMLHttpRequest;c=this;f.upload.addEventListener("progress",
function(a){a.lengthComputable?(a=Math.round(100*a.loaded/a.total-10),0>a&&(a=0),d.find("span").html(a.toString()+"%"),e.css("width",a.toString()+"%")):d.html("unable to compute")},!1);f.addEventListener("load",function(a){d.find("span").html("100%");e.css("width","100%");$("#EWA_FRAME_"+c.H5_UPLOAD.SYS_FRAME_UNID+" #"+c.objName).val(a.target.responseText);c.responseText=a.target.responseText;c.UPLOAD_STATUS="ok"},!1);f.addEventListener("error",function(a){console.log(a);d.html(a);c.UPLOAD_STATUS=
"error"},!1);f.addEventListener("abort",function(a){d.html("The upload has been canceled by the user or the browser dropped the connection.");console.log(a);c.UPLOAD_STATUS="abort"},!1);var g=EWA.CP+"/EWA_STYLE/cgi-bin/_up_/?xmlname="+this.H5_UPLOAD.POST_XMLNAME+"&ITEMNAME="+this.H5_UPLOAD.POST_ITEMNAME+"&NAME="+this.H5_UPLOAD.POST_NAME+"&EWA_UP_TYPE=SWFUPLOAD&EWA_UP_REF="+this.H5_UPLOAD.POST_REF;$(a).find("button").hide();f.open("POST",g,!0);f.send(b);this.xhr=f}}
function EWA_UI_BoxClass(){this._ClassName=("_eWAbOX"+Math.random()).replace(".","$");window[this._ClassName]=this;this._Cfg=this._JSON_URL=this._REF_DATA=null;this.Create=function(a){this._Cfg=a;if(EWA.F&&EWA.F.FOS)for(var b in EWA.F.FOS)a=EWA.F.FOS[b],a.BOX_CLASS==this&&(this.FOS=a);this.FOS&&(a=new EWA_UrlClass(this.FOS.Url),a.GetParameter("EWA_BOX_PARENT_ID")&&(a=a.GetParameter("EWA_BOX_PARENT_ID"),$X(a)&&(this._Cfg.parent_id=a)));if(this._Cfg.parent_id){a=this._Cfg.parent_id.split(",");for(var c=
0;c<a.length;c++){var d=a[c].trim();if($X(d)){$($X(d)).html("waiting...");this._Cfg.parent_id_init=this._Cfg.parent_id;this._Cfg.parent_id=d;break}}if(this._Cfg.parent_id_init){this.initBoxSize();a=new EWA_UrlClass;a.SetUrl(this.FOS.Url);c=a.GetParameter("EWA_PAGESIZE");d=a.GetParameter("EWA_PAGECUR");c&&!isNaN(c)?this._Cfg.EWA_PAGESIZE=c:this._Cfg.EWA_PAGESIZE=this._Cfg.EWA_PAGESIZE||10;d&&!isNaN(d)?this._Cfg.EWA_PAGECUR=d:this._Cfg.EWA_PAGECUR=this._Cfg.EWA_PAGECUR||1;c={};for(b in a._Paras)c["@"+
b.toUpperCase()]=a._Paras[b];this._REF_DATA=c;this.load_box_data()}else alert("parent_id["+this._Cfg.parent_id+"]\u627e\u4e0d\u5230\u5b9a\u4e49\u7684\u5bf9\u8c61")}else alert("parent_id\u672a\u5b9a\u4e49")};this.initBoxSize=function(){if(this._Cfg.page_width){if(isNaN(this._Cfg.page_width)){var a=this._ClassName+"_check_size";var b="<div id='"+a+"' style='height:1px;width:"+this._Cfg.page_width+"'></div>";$("body").append(b);b=$($X(a));a=b.width();b.remove()}else a=1*this._Cfg.page_width;if(!(50>=
a)){b={};b.width=a;var c=a-10-20-5;b.box_title=c;b.box_title_img=c-30-5;a-=10;b.box_txt=a;b.box_des1=a-2-58;this._Cfg._Fix=b}}};this.load_box_data=function(){var a;if(null==this.FOS){var b=[EWA.CP+"/EWA_STYLE/cgi-bin/?EWA_AJAX=JSON_EXT1&ewa_frameset_no=1"];for(a in this._Cfg){var c=a.toUpperCase();if("XMLNAME"==c||"ITEMNAME"==c||0==c.indexOf("EWA_")){var d=this._Cfg[a];d&&b.push(c+"="+d)}}b.push($U());this._JSON_URL=a=b.join("&")}else{b=new EWA_UrlClass;b.SetUrl(this.FOS.Url);b.AddParameter("EWA_AJAX",
"JSON_EXT1");b.AddParameter("ewa_frameset_no","1");for(a in this._Cfg)c=a.toUpperCase(),0==c.indexOf("EWA_")&&(d=this._Cfg[a])&&b.AddParameter(c,d);this._JSON_URL=a=b.GetUrl()}$J(a,this.load_box_data1,this)};this.load_box_data1=function(a,b){var c=b[b.length-1];b=c._Cfg;var d=c._Cfg.parent_id;EWA.F.FOS[a.FRAME_UNID]||(EWA_Utils.JsRegister(a.JSFRAME),EWA_Utils.JsRegister(a.JS));EWA.F.FOS[a.FRAME_UNID].Reload=function(){c.Create(c._Cfg)};EWA.F.FOS[a.FRAME_UNID].Goto=function(a){var b=new EWA_UrlClass;
b.SetUrl(c._JSON_URL);b.RemoveParameter("ewa_pagecur");b.AddParameter("ewa_pagecur",a);a=b.GetUrl();console.log(a);$J(a,c.load_box_data1,c._REF_DATA,a,c);this._JSON_URL=a};var e="___NeW_____"+b.parent_id;$X(e)||(b.new_parent_id=e,c.createToolbar(a));c.setPageInfo(a);c.enq_op_main_sub_boxs(a);1==b.autofocus&&(a=$X(d),a=$(a).offset().top,$("body").animate({scrollTop:a-30},300));if(b.callback)try{"function"==typeof b.callback?b.callback(c):eval(b.callback)}catch(g){console.log("EWA_UI_BoxClass->tmp.callback"+
g),console.log(b.callback)}if(EWA&&EWA.F&&EWA.F.FOS)for(var f in EWA.F.FOS)if(b=EWA.F.FOS[f],b.BOX_CLASS==c&&b.ReloadAfter)try{b.ReloadAfter(c)}catch(g){console.log("EWA_UI_BoxClass->EWA->ReloadAfter"+g),console.log(b.ReloadAfter)}};this.createToolbar=function(a){var b=this._Cfg,c=$($X(b.parent_id)),d=[];d.push('<div onselectstart="return false;" class="box-tool-bar">');for(var e=" onclick='"+this._ClassName+".toolBarClick(this)' ",f=["fa-table","fa-list aa","fa-sort aa","fa-search aa"],g=0;g<f.length;g++)d.push("<i class='fa "+
f[g]+"' "+e+"></i>");d.push("&nbsp;&nbsp;");f=["fa-fast-backward aa","fa-backward aa","fa-forward aa","fa-fast-forward aa"];for(g=0;g<f.length;g++)d.push("<i class='fa "+f[g]+"' "+e+"></i>"),1==g&&(d.push("<span class='aa' id='"+this._ClassName+"_records'></span>"),d.push("<select class='aa' id='"+this._ClassName+"_page' onchange='"+this._ClassName+".do_page(this)'><option value=5>5</option><option value=10>10</option><option value=20>20</option><option value=50>50</option><option value=100>100</option><option value=150>150</option><option value=200>200</option><option value=300>300</option><option value=500>500</option></select>"));
g=this.create_filter(a);e=g[0];g=g[1];d.push("<div class='sort_items' id='"+this._ClassName+"_search'>");d.push(e.join(""));d.push(g.join(""));d.push("</div>");a=this.create_sort(a);d.push("<div class='sort_items' id='"+this._ClassName+"_sort'>");d.push(a);d.push("</div>");d.push('</div><div id="'+b.new_parent_id+'"></div>');c.html(d.join(""));$X(this._ClassName+"_page").value=this._Cfg.EWA_PAGESIZE};this.setPageInfo=function(a){var b=1*a.RECORDS/this._Cfg.EWA_PAGESIZE,c=Math.round(b);c<b&&c++;this._Cfg._TOTALPAGE=
c;a=" ["+this._Cfg.EWA_PAGECUR+"/ <b >"+c+"</b> ("+a.RECORDS+")] ";if(b=$X(this._ClassName+"_records"))b.innerHTML=a};this.create_sort=function(a){var b=$J2MAP(a.CFG,"NAME"),c=[];for(d in EWA.F.FOS[a.FRAME_UNID].ItemList.Items)"1"==$(EWA.F.FOS[a.FRAME_UNID].ItemList.Items[d]).find("OrderSearch Set").attr("IsOrder")&&c.push(d);var d=[];d.push('<p class="sort-item" onclick="'+this._ClassName+'.do_sort(null,this)">\u6e05\u9664\u6392\u5e8f<b class="fa fa-times"></b></p>');for(var e=0;e<c.length;e++){var f=
c[e];b[f]&&(a=b[f].DES,d.push('<div  class="sort-item" onclick="'+this._ClassName+".do_sort(&quot;"+f+'&quot;,this)"><nobr><i class="fa fa-circle-o"></i>&nbsp;'+a+'&nbsp;<b class="fa"></b></nobr></div>'))}return d.join("")};this.do_sort=function(a,b){var c=$(".sort_items")[1];$(c).find(".sort-item i").attr("class","fa fa-circle-o");$(c).find(".sort-item b").attr("class","fa");if(a){var d=$(b).attr("desc");null==d||""==d?(a+=" DESC",$(b).attr("desc","desc"),d="fa fa-caret-down"):($(b).attr("desc",
""),d="fa fa-caret-up");$(b).find("i").attr("class","fa fa-dot-circle-o");$(b).find("b").attr("class",d)}this._Cfg.EWA_LF_ORDER=a;this._Cfg.EWA_PAGECUR=1;this.load_box_data();c.style.display="none";c.setAttribute("show","")};this.create_filter=function(a){var b=EWA.F.FOS[a.FRAME_UNID]._SearchJson,c=[],d=$J2MAP(a.CFG,"NAME"),e=[],f;for(f in b){var g=b[f];try{if("fix"==g.T){c.push("<select onchange='"+this._ClassName+".do_filter(this)' search_type='"+g.T+"' search_tag='"+f+"'>");c.push("<option value=''>--"+
d[f].DES+"--</option>");for(var h=0;h<g.D.length;h++)a=g.D[h],c.push('<option value="'+a[0]+'">'+a[1]+"</option>");c.push("</select>")}else if("text"==g.T)e.push("<div class='search_input'><input search_type='"+g.T+"' old='' onblur='"+this._ClassName+".checkTextChange(this)' search_tag='"+f+"' type=text placeholder=\""+d[f].DES+'"/></div>');else if("date"==g.T){var k=("D"+Math.random()).replace(".","A");e.push("<div class='search_input'><input style='width:43%' id='"+k+"' onclick=\"EWA.UI.Calendar.Pop(this)\" search_tag='"+
f+"' search_type='"+g.T+"' old='' onblur='"+this._ClassName+".checkTextChange(this)' type=text placeholder=\""+d[f].DES+"\"/> <input style='width:43%' id='"+k+"_1' old='' onblur='"+this._ClassName+'.checkTextChange(this)\' onclick="EWA.UI.Calendar.Pop(this)" type=text placeholder="'+d[f].DES+'"/></div>')}}catch(l){console.log(l),console.log(f),console.log(g)}}return[c,e]};this.toolBarClick=function(a){var b=a.className;if(0<b.indexOf("fa-table"))this.last_but!=a&&(this.last_but=a,$(a).parent().find(".aa").show(),
this.load_box_data());else if(0<b.indexOf("fa-list"))this.last_but!=a&&(this.last_but=a,$(a).parent().find(".aa").hide(),a=new EWA_UrlClass,a.SetUrl(this._JSON_URL),a.RemoveParameter("ewa_ajax"),a.AddParameter("ewa_ajax","install"),a.RemoveParameter("ewa_box"),a.RemoveParameter("xmlname"),a.AddParameter("xmlname","|"+this._Cfg.xmlname),(new EWA.C.Ajax).Install(a.GetUrl(),"",this._Cfg.new_parent_id,function(){}));else if(0<b.indexOf("fa-search")){b=this._ClassName+"_search";b=$($X(b));var c=$(a).offset(),
d=c.left;a=c+$(a).height+20;b.css({top:a,left:d,"z-index":1E4}).show()}else 0<b.indexOf("fa-sort")?(b=this._ClassName+"_sort",b=$($X(b)),c=$(a).offset(),d=c.left,a=c+$(a).height+20,b.css({top:a,left:d,"z-index":1E4}).show()):0<b.indexOf("fa-fast-forward")?(this._Cfg.EWA_PAGECUR=this._Cfg._TOTALPAGE,this.load_box_data()):0<b.indexOf("fa-forward")?(a=1*this._Cfg.EWA_PAGECUR+1,a>this._Cfg._TOTALPAGE?$Tip("\u5df2\u7ecf\u5230\u9875\u5c3e\u4e86"):(this._Cfg.EWA_PAGECUR=a,this.load_box_data())):0<b.indexOf("fa-backward")?
(a=1*this._Cfg.EWA_PAGECUR-1,0==a?$Tip("\u5df2\u7ecf\u5230\u9875\u5934\u4e86"):(this._Cfg.EWA_PAGECUR=a,this.load_box_data())):0<b.indexOf("fa-fast-backward")&&(this._Cfg.EWA_PAGECUR=1,this.load_box_data())};this.checkTextChange=function(a){var b=a.getAttribute("old"),c=a.value.trim();b!=c&&(a.setAttribute("old",c),this.do_filter(a.parentNode))};this.do_page=function(a){a=a.value;this._Cfg.EWA_PAGESIZE=a;this.FOS&&(this.FOS._PageSize=a);this._Cfg.EWA_PAGECUR=1;this.load_box_data()};this.do_filter=
function(a){a=$(".sort_items")[0];for(var b=$(a).find("[search_tag]"),c={},d=0;d<b.length;d++){var e=b[d],f=e.getAttribute("search_type");if(""!=e.value||"date"==f)if("date"==f){var g=e.value,h=$X(e.id+"_1").value;if(""!=g||""!=h)f="@!@"+e.getAttribute("search_tag")+"~!~"+f,c[f]||(c[f]=""),c[f]+="~!~"+g+"~!~"+h}else f="@!@"+e.getAttribute("search_tag")+"~!~"+f,c[f]||(c[f]=""),c[f]+="~!~"+e.value}b=[];for(var k in c)b.push(k),b.push(c[k]);this._Cfg.EWA_LF_SEARCH=b.join("");console.log(this.filterExp);
a.style.display="none";a.setAttribute("show","");this._Cfg.EWA_PAGECUR=1;this.load_box_data()};this.enq_op_main_sub_boxs=function(a){var b=$J2MAP(a.CFG,"NAME"),c=a.DATA,d=a.WF,e=this._Cfg,f=this._REF_DATA,g=$X(e.new_parent_id);if(g){g.innerHTML="";if(e.first){var h=this.enq_op_main_sub_tb();g.appendChild(h);var k=$(h.rows[0].cells[0]);k.attr({valign:"",align:"center"});k.append(e.first);$(h).addClass("ewa-box-first")}else this.enq_op_main_sub_box_but(g);g.setAttribute("sys_frame_unid",a.FRAME_UNID);
for(k=0;k<c.length;k++){h=this.enq_op_main_sub_tb();h.id=a.FRAME_UNID+"$"+c[k].EWA_KEY;g.appendChild(h);h=$(h.rows[0].cells[0]);if(e.chk&&e.chk_icons){var l=this.enq_op_main_sub_box_chk(b,c[k],e,f,d,a.FRAME_UNID);h.append(l)}l=this.enq_op_main_sub_title(b,c[k],e,f);h.append(l);l=this.enq_op_main_sub_box(b,c[k],e,f);h.append(l[0]);h.attr("json",JSON.stringify(l[1]));h.attr("json_ref",JSON.stringify(c[k]))}$(g).find(".box_des1").each(function(){this.title=GetInnerText(this)});$(g).append('<div style="clear:both"></div>')}};
this.enq_op_main_sub_box_but=function(a){var b=$(a).parentsUntil("table[id=Test1]").find(".ewa_lf_func_dact"),c=this.enq_op_main_sub_tb();a.appendChild(c);var d=$(c.rows[0].cells[0]),e=d.width()/3-10;d.attr("valign","middle");b.each(function(){var a=document.createElement("div");a.innerHTML=this.innerHTML;a.className="box_but";this.id=this.id||("sdo"+Math.random()).replace(".","P");a.id="K"+this.id;$(a).attr("fid",this.id);$(a).attr("onclick","$X(this.getAttribute('fid')).click()");$(a).css("width",
e);d.append(a)});return c};this.enq_op_main_sub_box_chk=function(a,b,c,d,e,f){var g=document.createElement("div");g.className="status";if(c.chk&&c.chk instanceof Function)try{var h=c.chk(b);var k=c.chk_icons[h];"function"==typeof k&&(k=k())}catch(l){k=l}if(null==k||""==k)k=c.icon;if(null==k||""==k)k="fa fa-gear";c=c.icon_color;"object"==typeof k&&(c=k.color,k=k.icon);0==k.trim().indexOf("fa")?g.innerHTML="<li class='"+k+"' "+(c?" style='color:"+c+"'":"")+"></li>":g.innerHTML=k;a=this.enq_op_main_sub_menu(a,
b,d,e,f);0<a.childNodes.length&&(g.setAttribute("onclick",this._ClassName+".enq_op_main_sub_menu_show(this)"),g.appendChild(a));return g};this.enq_op_main_sub_menu_show=function(a){var b=$(a).find(".box_menus")[0];if(!this.enq_op_main_sub_last_menu){var c=document.createElement("div");c.className="box_menus";c.setAttribute("onselectstart","return false");document.body.appendChild(c);this.enq_op_main_sub_last_menu=$(c);this.enq_op_main_sub_last_menu.css("z-index",1E6)}this.enq_op_main_sub_last_menu.html(b.innerHTML);
this.enq_op_main_sub_last_menu.attr("json_ref",a.parentNode.getAttribute("json_ref"));a=$(a).offset();this.enq_op_main_sub_last_menu.show();b=this.enq_op_main_sub_last_menu.height();c=$("body").height();this.enq_op_main_sub_last_menu.css({left:a.left-110,top:a.top+b>c?a.top-b-10:a.top,width:110})};this.enq_op_main_sub_menu=function(a,b,c,d,e){var f=document.createElement("div");f.className="box_menus";$(f).hide();var g=null;for(m in a){var h=a[m],k=h._ONCLICK||h.EWA_ONCLICK||h.EWA_CLICK;if(null!=
k&&""!=k)if("BUTDELETE"==h.NAME.toUpperCase())g=h;else{var l="BUTMODIFY"==h.NAME.toUpperCase()?"<b class='fa fa-edit'></b>"+h.DES:"BUTADD"==h.NAME.toUpperCase()?"<b class='fa fa-plus'></b>"+h.DES:"<b class='fa'></b>"+h.DES;k=this.replace_parameter(b,k,c);l=this.enq_op_main_sub_menu_item(l,k);l.setAttribute("refid",h.NAME);f.appendChild(l)}}if(g){var m=document.createElement("hr");f.appendChild(m);l="<b class='fa fa-trash-o'></b>&nbsp;"+g.DES;k=this.replace_parameter(b,g._ONCLICK,c);l=this.enq_op_main_sub_menu_item(l,
k);f.appendChild(l)}d&&(k=this.enq_op_main_wf_js(a,b,c,d,e)[0],l=enq_op_main_sub_menu_item("\u6d41\u7a0b\u63a7\u5236/\u5ba1\u6279",k),l.setAttribute("flow",1),l.setAttribute("onclick",this._ClassName+".enq_op_main_close_menu(event,this);eval('window.___wf_json_para='+this.parentNode.parentNode.parentNode.getAttribute('json'))"),f.appendChild(l));a="<b onclick='"+this._ClassName+".enq_op_main_close_menu(event,this)' class='fa fa-power-off close'></b>";f.setAttribute("onselectstart","return false;");
$(f).append(a);return f};this.enq_op_main_wf_js=function(a,b,c,d,e){for(var f=d.P,g=[],h=0;h<d.RID.length;h++)g.push("@"+d.RID[h]);f=f.replace(/\[RID\]/ig,g.join(","));d="EWA.UI.Dialog.OpenReloadClose('"+e+"','"+d.X+"','"+d.I+"',false,'"+(f+"&fjson=___wf_json_para')");d=this.replace_parameter(b,d,c);c=[];for(h=a.length-1;0<=h;h--)e=a[h],f=e.NAME,(f=b[f+"_HTML"]||b[f])&&c.push({DES:e.DES,VAL:f});return[d,c]};this.enq_op_main_sub_menu_item=function(a,b){var c=document.createElement("a");c.innerHTML=
a;c.href="javascript:void(0)";c.setAttribute("onclick",b+";"+this._ClassName+".enq_op_main_close_menu(event,this);");c.setAttribute("box_menu_item","yes");return c};this.enq_op_main_close_menu=function(a,b){a=a||window.event;a.stopPropagation();a.cancelBubble=!0;b.parentNode.style.display="none"};this.enq_op_main_sub_box=function(a,b,c,d){d=["<table  onselectstart='return true' class='box_txt' "+(this._Cfg._Fix?"style='width:"+this._Cfg._Fix.box_txt+"px'":"")+" cellspacing=0 cellpadding=0>"];for(var e=
this._Cfg._Fix?"style='width:"+this._Cfg._Fix.box_des1+"px'":"",f=[],g=0;g<c.txt.length;g++){var h=c.txt[g],k=h.t;h=h.n;if(0==h.indexOf("<hr"))d.push("<tr><td class='box_subject' colspan=2>"),d.push(h),d.push("</td></tr>");else{if((k=this.replace_parameter(b,k))&&0<=k.indexOf("(")&&0<k.indexOf(")"))try{k=eval(k)}catch(m){}var l=a[h]?a[h].DES:h;d.push("<tr class='ewa-box-"+h+"'><td class='box_subject'><div class='box_subject1'><nobr>");d.push(l);d.push("</nobr><i class='fa fa-caret-right' style='color:#ccc'></i></div></td>");
d.push("<td class='box_des'><div class='box_des1' "+e+">");d.push(k+"</div></td></tr>");f.push({DES:l,VAL:k})}}return[d.join(""),f]};this.enq_op_main_sub_tb=function(){var a=document.createElement("table");a.className="box";a.cellSpacing=0;a.cellPadding=0;a.insertRow(-1).insertCell(-1).vAlign="top";a.setAttribute("onselectstart","return false;");this._Cfg._Fix&&$(a).css("width",this._Cfg._Fix.width);this._Cfg.page_color&&$(a).css("background",this._Cfg.page_color);this._Cfg.page_radius&&$(a).css("border-radius",
this._Cfg.page_radius);this._Cfg.page_height&&$(a).css("height",this._Cfg.page_height);return a};this.replace_parameter=function(a,b,c){var d=b,e=[];for(f in a)e["@"+f.toUpperCase()]=a[f];if(c)for(f in c)e[f]||(e[f]=c[f]);if(a=b.match(/@[a-zA-Z0-9\-\._:]*\b/ig))for(b=0;b<a.length;b++){c=a[b];var f=c.toUpperCase();d=d.replace(c,e[f+"_HTML"]||e[f]||"")}return d};this.enq_op_main_sub_title=function(a,b,c,d){if(!c.title)return"";a=[];if(c.img){a.push("<div class='box_img'>");var e="function"==typeof c.img?
c.img(b):b[c.img];var f="",g="_blank",h="";e&&""!=e?f=e.replace("_SMAILL",""):e=EWA.RV_STATIC_PATH+"/EWA_STYLE/images/pic_no.jpg";c.img_click&&(h=this.replace_parameter(b,c.img_click.toString(),d),g="");a.push("<a class='imgtb' style='background-image:url("+e+")' ");h?a.push(" href='javascript:void(0)' onclick=\""+h+'" '):""!=f&&a.push(" target='"+g+"' href=\""+f+'" ');a.push("></a>");a.push("</div>")}c.title&&(d="box_title",e="",c.img&&(d="box_title_img"),this._Cfg._Fix&&(e="width:"+this._Cfg._Fix[d]+
"px; "),c.title_color&&(e+="color:"+c.title_color),a.push("<div class='"+d+"' style='"+e+"'>"),b=this.replace_parameter(b,c.title),a.push(b),a.push("</div>"));return a.join("")};this.add_box_style=function(){}}
var EWA_UI_BoxExt={getFileLen:function(a){return null==a||isNaN(a)?a||"":1073741824<a?Math.round(a/1073741824*100)/100+"G":1048576<a?Math.round(a/1048576*100)/100+"M":1024<a?Math.round(a/1024*100)/100+"K":a+"B"},openInBox:function(a,b,c){if(!$X("EWA_UI_BoxExt_OpenInBox")){var d=[];d.push("#EWA_UI_BoxExt_OpenInBox {left: 10px;right: 10px;bottom: 10px;top: 10px;position: fixed; background-color: rgba(127, 127, 127, 0.7);display: none;padding: 5px;z-index: 1010;}");d.push("#EWA_UI_BoxExt_OpenInBox .title {height: 30px;background-color: #cdcdcd;font-size: 14px;padding: 4px;}");
d.push("#open_box .title b {color: #08c;cursor: pointer;}");var e=document.createElement("style");e.textContent=d.join("\n");document.getElementsByTagName("head")[0].appendChild(e);d=[];d.push("<div id='EWA_UI_BoxExt_OpenInBox'>");d.push("<table width=100% height=100% cellpadding=0 cellspacing=0>");d.push("<tr>");d.push('<td class="title"><b class="fa fa-power-off fa-border"');d.push(" onclick=\"$('#EWA_UI_BoxExt_OpenInBox').hide();isStopMouseWheel = false;\"></b>&nbsp;<span></span></td>");d.push("</tr>");
d.push("<tr>");d.push("<td class=\"cnt\" valign=top><div id='open_box_cnt'");d.push(" style='overflow: auto; width: 100%; height: 100%'></div></td>");d.push("</tr>");d.push("</table>");d.push("</div>");$("body").append(d.join(""))}$("#EWA_UI_BoxExt_OpenInBox").show();$("#EWA_UI_BoxExt_OpenInBox .title span").html(b);a="<iframe width=100% height=100% src='"+a+"' frameborder=0></iframe>";$("#EWA_UI_BoxExt_OpenInBox .cnt").html(a);c&&c()}};
EWA_UI_BoxExt={getFileLen:function(a){return EWA.UI.Ext.FileLen(a)},openInBox:function(a,b,c){if(!$X("EWA_UI_BoxExt_OpenInBox")){var d=[];d.push("#EWA_UI_BoxExt_OpenInBox {left: 10px;right: 10px;bottom: 10px;top: 10px;position: fixed; background-color: rgba(127, 127, 127, 0.7);display: none;padding: 5px;z-index: 1010;}");d.push("#EWA_UI_BoxExt_OpenInBox .title {height: 30px;background-color: #cdcdcd;font-size: 14px;padding: 4px;}");d.push("#open_box .title b {color: #08c;cursor: pointer;}");var e=
document.createElement("style");e.textContent=d.join("\n");document.getElementsByTagName("head")[0].appendChild(e);d=[];d.push("<div id='EWA_UI_BoxExt_OpenInBox'>");d.push("<table width=100% height=100% cellpadding=0 cellspacing=0>");d.push("<tr>");d.push('<td class="title"><b class="fa fa-power-off fa-border"');d.push(" onclick=\"$('#EWA_UI_BoxExt_OpenInBox').hide();isStopMouseWheel = false;\"></b>&nbsp;<span></span></td>");d.push("</tr>");d.push("<tr>");d.push("<td class=\"cnt\" valign=top><div id='open_box_cnt'");
d.push(" style='overflow: auto; width: 100%; height: 100%'></div></td>");d.push("</tr>");d.push("</table>");d.push("</div>");$("body").append(d.join(""))}$("#EWA_UI_BoxExt_OpenInBox").show();$("#EWA_UI_BoxExt_OpenInBox .title span").html(b);a="<iframe width=100% height=100% src='"+a+"' frameborder=0></iframe>";$("#EWA_UI_BoxExt_OpenInBox .cnt").html(a);c&&c()}};
function EWA_UI_LeftClass(){this.searchExp=this.sortExp=this.instanceName=this.objContent=this.objRecords=this.objSearchGrp=this.objSearch=this.parentId=this.lastmd=this.map=this.crm_cfg=null;this.Create=function(a){this.parentId=("EWA_UI_LeftClass"+Math.random()).replace(".","m");EWA.F.FOS[this.parentId]=this;this._Id=this.parentId;this.map=a;this.map.des=this.map.des.split(",");this.map.order=this.map.order.split(",");window!=parent&&$("body").css("background-color","transparent");a=['<link rel="stylesheet" rev="stylesheet" type="text/css" href=\''+
EWA.RV_STATIC_PATH+"/EWA_STYLE/skins/complex.css' />"];a.push("<table cellpadding=0 cellspacing=0 width=100% height=100%>");a.push("<tr>");a.push("<td width=230><div id='div_"+this.parentId+'\' class="items"></div></td>');var b="";this.map["default"]&&(b=' src="'+this.map["default"]+'" ');a.push("<td id=\"cnt\"><iframe frameborder=0 id='a2a2' "+b+' name="a2a2"');a.push("height=100% width=100%></iframe></td>");a.push("</tr>");a.push("</table>");$("body").html(a.join(""));this.instanceName="EWA.F.FOS."+
this.parentId;this.objContent=$X("div_"+this.parentId);a='<div class="search_box" onselectstart="return false">'+this.create_grp()+'<div class=" fa fa-search" style="width:100%"><input class="search" onkeyup="'+this.instanceName+".do_search()\" placeholder=\"search\"  onselectstart=\"return true\"></div></div><div class='search_records'><b class='fa fa-quote-left'></b>&nbsp;\u8bb0\u5f55\u6570\uff1a<i></i><b class='fa fa-chevron-up records-gotop'></b></div>";$("body").append(a);this.objSearch=$(".search")[0];
this.map.grp&&0<this.map.grp.length?this.objSearchGrp=$(".search-grp")[0]:(this.objContent.style.top="31px",$(".search_box").css("height",30));this.objRecords=$(".search_records i")[0];$(".search_records .records-gotop").click(function(){$(".items").first().scrollTop(0)});this.page_size=50;this.page_size=this.map.page_size?this.map.page_size:50;this.load_data();this.current_page=1};this.scroll_check=function(a){a.scrollHeight-a.scrollTop>1.2*a.clientHeight||this.current_page*this.page_size>=this.total_records||
this.is_load_data||this.load_more()};this.load_more=function(){this.current_page?this.current_page++:this.current_page=2;this._load_datas()};this.create_grp=function(){if(!this.map.grp||0==this.map.grp.length)return"";for(var a=["<div ><i class='fa fa-filter'></i><select onchange='"+this.instanceName+".do_grp(this)' class='search-grp'>"],b=0;b<this.map.grp.length;b++){var c=this.map.grp[b];a.push("<option value='"+c[1]+"'>"+c[0]+"</option>")}a.push("</select></div>");return a.join("")};this.create_sort=
function(){if(null!=this.map.order&&0!=this.map.order.length){var a=$J2MAP(this.crm_cfg,"NAME"),b=["<div openbox=1 class='sort' onclick='"+this.instanceName+".show_sort(this.childNodes[0],event)'><i openbox=1 style='line-height:16px' class='fa fa-gear'></i><table cellpadding=1 cellspacing=1 class='sort_items'><tr><td valign=top>"];b.push('<p onclick="'+this.instanceName+'.do_sort(null,this)">\u6e05\u9664\u6392\u5e8f<b class="fa fa-times"></b></p>');for(var c=0;c<this.map.order.length;c++){var d=this.map.order[c];
a[d]&&b.push('<div  class="sort_item" onclick="'+this.instanceName+".do_sort(&quot;"+d+'&quot;,this)"><nobr><i class="fa fa-circle-o"></i>&nbsp;'+a[d].DES+'&nbsp;<b class="fa"></b></nobr></div>')}b.push("</td><td valign=top></td><td valign=top></td></tr></table></div><div onclick='"+this.instanceName+".hide(this)' class='hide_but'><b style='line-height:16px' class='fa fa-caret-left'></b></div>");return b.join("")}};this.hide=function(a){this.objContent.style.display="none";this.objContent.parentNode.style.backgroundColor=
"#f1f1f1";this.objSearch.parentNode.parentNode.style.display="none";this.objRecords.parentNode.style.display="none";var b=this;this.objContent.parentNode.onclick=function(){b.show()};this.objContent.parentNode.appendChild(a);this.hideButton=a;$(this.objContent.parentNode).animate({width:"30px"},300)};this.show=function(){this.objSearch.parentNode.appendChild(this.hideButton);var a=this;$(this.objContent.parentNode).animate({width:"230px"},300,function(){a.objContent.parentNode.style.backgroundColor=
"";a.objContent.style.display="";a.objRecords.parentNode.style.display="";a.objSearch.parentNode.parentNode.style.display=""})};this.do_sort=function(a,b){var c=$(".sort_items")[0];$(c).find(".sort_item i").attr("class","fa fa-circle-o");$(c).find(".sort_item b").attr("class","fa");if(a){var d=$(b).attr("desc");null==d||""==d?(a+=" DESC",$(b).attr("desc","desc"),d="fa fa-caret-down"):($(b).attr("desc",""),d="fa fa-caret-up");$(b).find("i").attr("class","fa fa-dot-circle-o");$(b).find("b").attr("class",
d)}this.sortExp=a;this.current_page=1;this._load_datas();c.style.display="none";c.setAttribute("show","")};this.do_grp=function(a){this.current_page=1;this._load_datas()};this.do_filter=function(a){a=$(".sort_items")[0];for(var b=$(a).find("[search_tag]"),c={},d=0;d<b.length;d++){var e=b[d],f=e.getAttribute("search_type");if(""!=e.value||"date"==f)if("date"==f){var g=e.value,h=$X(e.id+"_1").value;if(""!=g||""!=h)f="@!@"+e.getAttribute("search_tag")+"~!~"+f,c[f]||(c[f]=""),c[f]+="~!~"+g+"~!~"+h}else f=
"@!@"+e.getAttribute("search_tag")+"~!~"+f,c[f]||(c[f]=""),c[f]+="~!~"+e.value}b=[];for(var k in c)b.push(k),b.push(c[k]);this.filterExp=b.join("");a.style.display="none";a.setAttribute("show","");this.current_page=1;this._load_datas()};this.do_search=function(){var a=$(this.objSearch),b=a.val(),c=a.attr("old_val");b!=c&&(a.attr("old_val",b),this.searchExp="@!@"+this.map.search+"~!~text~!~"+b,this.current_page=1,this._load_datas())};this._load_datas=function(){this.is_load_data=!0;var a=$U2(this.map.XMLNAME,
this.map.ITEMNAME,this.map._URL_PARAS,!0);this.sortExp&&""!=this.sortExp&&(a+="&EWA_LF_ORDER="+this.sortExp.toURL());var b="";this.searchExp&&""!=this.searchExp&&(b=this.searchExp);this.filterExp&&""!=this.filterExp&&(b+=this.filterExp);""!=b&&(a+="&EWA_LF_SEARCH="+b.toURL());this.objSearchGrp&&(a+="&"+this.objSearchGrp.value);this.current_page&&(a+="&EWA_PAGECUR="+this.current_page);a+="&EWA_PAGESIZE="+this.page_size;var c=this,d=(new Date).getTime();this._load_datas_post_time=d;$J(a,function(a){d==
c._load_datas_post_time&&(c.total_records=a.RECORDS,c.show_pages(),c.show_data(a.DATA,[!0]),c.is_load_data=!1)})};this.show_sort=function(a,b){b=b||event;1==(b.srcElement||b.target).getAttribute("openbox")&&(a=$(a).next(),null==a.attr("show")||""==a.attr("show")?(a.show(),a.css({top:20,right:4}),a.attr("show",1)):(a.hide(),a.attr("show","")))};this.load_data=function(){if(EWA&&EWA.F&&EWA.F.FOS)for(var a in EWA.F.FOS){var b=EWA.F.FOS[a];if(b.LEFT_CLASS==this){var c=b;break}}b={};if(c){c=c.Url;var d=
new EWA_UrlClass;d.SetUrl(c);for(a in d._Paras)"XMLNAME"!=a&&"ITEMNAME"!=a&&"EWA_LEFT"!=a&&(b[a]=d._Paras[a])}d=new EWA_UrlClass;d.SetUrl(window.location.href);for(a in d._Paras)"XMLNAME"!=a&&"ITEMNAME"!=a&&"EWA_LEFT"!=a&&(b[a]=d._Paras[a]);b.EWA_FRAMESET_NO=1;b.EWA_AJAX="json_ext1";c=[];for(a in b)c.push(a+"="+((b[a]||"")+"").toURL());this.map._URL_PARAS=c.join("&");a=$U2(this.map.XMLNAME,this.map.ITEMNAME,this.map._URL_PARAS,!0);this.objSearchGrp&&(a+="&"+this.objSearchGrp.value);a+="&EWA_PAGESIZE="+
this.page_size;$J(a,this.load_data1,this)};this.create_filter=function(a){var b=[],c=$J2MAP(this.crm_cfg,"NAME"),d=[],e;for(e in a){var f=a[e];if("fix"==f.T){b.push("<select onchange='"+this.instanceName+".do_filter(this)' search_type='"+f.T+"' search_tag='"+e+"'>");b.push("<option value=''>--"+c[e].DES+"--</option>");for(var g=0;g<f.D.length;g++){var h=f.D[g];b.push('<option value="'+h[0]+'">'+h[1]+"</option>")}b.push("</select>")}else"text"==f.T?d.push("<div class='search_input'><input search_type='"+
f.T+"' old='' onblur='"+this.instanceName+".checkTextChange(this)' search_tag='"+e+"' type=text placeholder=\""+c[e].DES+'"/></div>'):"date"==f.T&&(g=("D"+Math.random()).replace(".","A"),d.push("<div class='search_input'><input style='width:43%' id='"+g+"' onclick=\"EWA.UI.Calendar.Pop(this)\" search_tag='"+e+"' search_type='"+f.T+"' old='' onblur='"+this.instanceName+".checkTextChange(this)' type=text placeholder=\""+c[e].DES+"\"/> <input style='width:43%' id='"+g+"_1' old='' onblur='"+this.instanceName+
'.checkTextChange(this)\' onclick="EWA.UI.Calendar.Pop(this)" type=text placeholder="'+c[e].DES+'"/></div>'))}return[b,d]};this.checkTextChange=function(a){var b=a.getAttribute("old"),c=a.value.trim();b!=c&&(a.setAttribute("old",c),this.do_filter(a.parentNode))};this.load_data1=function(a,b){b=b[0];0==a.DATA.length&&b.noDataFunc&&b.noDataFunc();b.crm_cfg=a.CFG;var c=$J2MAP(b.crm_cfg,"NAME");b.CFG_MAP=c;b.WF=a.WF;b.FRAME_UNID=a.FRAME_UNID;b.show_data(a.DATA);b.total_records=a.RECORDS;b.show_pages();
c=b.create_sort();$(b.objSearch).parent().append(c);c=a.FRAME_UNID;EWA_Utils.JsRegister(a.JSFRAME);a=b.create_filter(EWA.F.FOS[c]._SearchJson);c=1;var d=$(b.objSearch).parent().find(".sort_items");if(0<a[0].length){var e='<p on1click="'+this.instanceName+'.do_sort(null,this)">\u7b5b\u9009</p>';d.find("td:eq(1)").css("width",140).append(e+a[0].join(""));c++}else d.find("td:eq(1)").hide();0<a[1].length?(e='<p on1click="'+this.instanceName+'.do_sort(null,this)">\u68c0\u7d22</p>',d.find("td:eq(2)").css("width",
140).html(e+a[1].join("")),c++):d.find("td:eq(2)").hide();d.css("width",144*c);b.init_scroll||(b.init_scroll=!0,b.objContent.setAttribute("onscroll",b.instanceName+".scroll_check(this)"))};this.show_pages=function(){this.objRecords.innerHTML=this.total_records+", "+this.current_page+"/ "+Math.ceil(this.total_records/this.page_size)};this.load_after=function(){};this.show_data=function(a,b){var c=$(this.objContent);1==this.current_page&&null!=b&&0<b.length&&1==b[0]&&c.find(".item").remove();for(b=
0;b<a.length;b++){var d=this.show_data1(a[b],b);c.append(d)}this.load_after&&this.load_after()};this.show_data1=function(a,b){var c=document.createElement("div");c.setAttribute("fid",("ITEM_"+Math.random()).replace(".","k"));c.className="item";var d=document.createElement("h1"),e=this.replace_parameter(a,this.map.title),f=$(this.objSearch).val();f&&""!=f&&(e=e.replace(f,"<span style='color:red'>"+f+"</span>"));f=this.total_records?this.total_records:this.page_size;f=8*((10>f?10:f)+"").split("").length+
2;d.innerHTML="<span class=idx style='width:"+f+"px'>"+(b+1+(this.current_page-1)*this.page_size)+"</span>"+e;d.title=e;$(d).css({"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"});c.appendChild(d);b=document.createElement("ol");for(var g in this.map.des)if(d=this.map.des[g],this.CFG_MAP[d]){e=document.createElement("li");f=this.CFG_MAP[d].NAME;var h=a[f+"_HTML"];if(null==h||""==h)h=a[f];null!=h&&""!=h&&(e.innerHTML=this.CFG_MAP[d].DES+":&nbsp; "+h,b.appendChild(e))}c.appendChild(b);
$(b).css({"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis",margin:4,padding:"4px 18px"});g=this.replace_parameter(a,this.map.key);c.id=g;c.setAttribute("onmousedown",this.instanceName+".md(this)");this.WF&&(a=this.create_item_wf(a),c.appendChild(a));return c};this.create_item_wf=function(a){for(var b=this.WF,c=b.P,d=[],e=0;e<b.RID.length;e++)d.push("@"+b.RID[e]);c=c.replace(/\[RID\]/ig,d.join(","));c="EWA.UI.Dialog.OpenReloadClose('"+this.FRAME_UNID+"','"+b.X+"','"+b.I+"',false,'"+
(c+"&fjson=___wf_json_para')");c=this.replace_parameter(a,c);b=document.createElement("a");b.innerHTML="\u6d41\u7a0b\u63a7\u5236/\u5ba1\u6279";b.setAttribute("flow",1);b.setAttribute("onclick","eval('window.___wf_json_para='+this.getAttribute('json'));"+c);c=[];for(var f in this.crm_cfg)d=this.crm_cfg[f],"span"==d.TAG&&(d={DES:d.DES,VAL:a[d.NAME+"_HTML"]||a[d.NAME]},d.VAL&&c.push(d));b.setAttribute("json",JSON.stringify(c));b.style.display="none";return b};this.md=function(a){this.lastmd&&(this.lastmd.className=
this.lastmd.className.replace(" md",""));a.className+=" md";this.lastmd=a;var b=this.map.u;if(b){0<this.map.u.indexOf("()")&&(b=eval(this.map.u));b=b+(0<b.indexOf("?")?"&":"?")+a.id+"&_fid_="+a.getAttribute("fid");if(this.objSearchGrp){var c=this.objSearchGrp.value;""!=c&&(b+="&"+c)}(c=$U())&&(b+="&"+c);this.AddTab?(a=GetInnerText($(a).find("h1")[0]),this.AddTab(b,a)):window.frames.a2a2.location.href=b}else window.frames[0].document.body.innerHTML='<h1 style="color:Red">json.u\u6ca1\u5b9a\u4e49,\u4e0d\u77e5\u9053\u8981\u5bfc\u822a\u5230\u54ea\u91cc</h1>'};
this.replace_parameter=function(a,b,c){var d=b,e=[];if(!a.____S2){for(var f in a)e["@"+f.toUpperCase()]=a[f];if(c)for(f in c)e[f]||(e[f]=c[f]);a.____S2=e}e=a.____S2;a=b.match(/@[a-zA-Z0-9\-\._:]*\b/ig);for(b=0;b<a.length;b++)c=a[b],f=(f=e[c.toUpperCase()])||"-",d=d.replace(c,f);return d}}
function EWA_ComplexClass(){this.Resources={};this.edit=function(a,b){var c=$X(a);$(c).offset();if(1!=c.getAttribute("is_open"))this.changeEdit(a,!1),b.innerHTML='<i class="fa fa-save"></i>',c.setAttribute("is_open",1),b.setAttribute("_title","enus"==EWA.LANG?"Save":"\u4fdd\u5b58");else{var d=$("#"+a).find("form")[0].id.replace("f_","");if(!EWA.F.FOS[d].DoPostBefore()||!EWA.F.FOS[d].CheckValidAll($("#f_"+d)[0]))return;$(c).find("input[id=butOk]").click();this.changeEdit(a,!0);b.innerHTML='<i class="fa fa-edit"></i>';
c.setAttribute("is_open",0);b.setAttribute("_title","enus"==EWA.LANG?"Edit":"\u7f16\u8f91")}this.focusObject(c)};this.focusObject=function(a,b){var c=$(a).offset();b?$("body").animate({scrollTop:c.top-40},300,b):$("body").animate({scrollTop:c.top-40},300);$(".pop_title").hide();a=$(a).prev().find(".fa-expand");0<a.length&&a.click()};this.goItem=function(a,b){var c=$X(a);if(null==c)alert("EWA_ComplexClass.goItem "+a+" not found");else{var d=$(c).offset();$("body").animate({scrollTop:d.top+30},300);
b?b():window["__timer_"+a]=setInterval(function(){b&&(window.clearInterval(window["__timer_"+a]),b())},111);this.focusObject($(c))}};this.changeEdit=function(a,b){a=$X(a);b&&$(a).hasClass("disabled-true")||($(a).find(".EWA_TD_B").hide(),$(a).find("select").attr("disabled",b),$(a).find("input").attr("disabled",b),$(a).find("textarea").each(function(){var a=$(this).parent();a.hasClass("ewa_redraw_info")&&0==a.find(".textarea-tip").length&&(a.css("position","relative").append("<span class='textarea-tip'>"+
$(this).attr("placeholder")+"</span>"),a.hover(function(){a.find(".textarea-tip").show()},function(){a.find(".textarea-tip").hide()}));if(0==a.find(".hide-textarea-content").length){var b="<div class='hide-textarea-content' style='display:none;overflow:auto;height:"+$(this).height()+"'>"+$(this).val()+"</div>";$(this).after(b)}a.find(".hide-textarea-content").hover(function(){$(this).parent().find(".textarea-tip").show()},function(){$(this).parent().find(".textarea-tip").hide()})}),$(a).find(".EWA_DHTML").each(function(){var a=
$(this).parent();if(a.hasClass("ewa_redraw_info")&&0==a.find(".textarea-tip").length){var b=$("#cpx_tab1 .EWA_TABLE").prop("id").replace("EWA_FRAME_",""),e=EWA.LANG?EWA.LANG.toLowerCase():"zhcn";b=$(EWA.F.FOS[b].ItemList.Items[this.id]).find("DescriptionSet Set[Lang='"+e+"']").attr("Info");a.css("position","relative").append("<span class='textarea-tip'>"+b+"</span>");a.hover(function(){a.find(".textarea-tip").show()},function(){a.find(".textarea-tip").hide()})}0==a.find(".hide-textarea-content").length&&
(b="<div class='hide-textarea-content' style='display:none;overflow:auto;height:"+$(this).height()+"'>"+$(this).find("input").val()+"</div>",$(this).after(b));a.find(".hide-textarea-content").hover(function(){$(this).parent().find(".textarea-tip").show()},function(){$(this).parent().find(".textarea-tip").hide()})}),b?($(a).addClass("disabled-true"),$(a).find("input").css("background-color","#eee"),$(a).find("textarea").hide(),$(a).find(".EWA_DHTML").hide(),$(a).find(".hide-textarea-content").show()):
($(a).removeClass("disabled-true"),$(a).find("input").css("background-color",""),$(a).find('input[ewa_class="droplist"]').css("background-color","lightyellow"),$(a).find("textarea").show(),$(a).find(".EWA_DHTML").show(),$(a).find(".hide-textarea-content").remove()))};this.textareaTip=function(a){var b=$(a).parent();0<b.find(".textarea-tip").length||(b.css("position","relative").append("<span class='textarea-tip' style=''>"+$(a).attr("placeholder")+"</span>"),b.hover(function(){b.find(".textarea-tip").show()},
function(){b.find(".textarea-tip").hide()}))};this._init=function(){this.Xml=new EWA.C.Xml;this.Xml.LoadXml(window["EWA_ITEMS_XML_"+this._Id]);this.Resources=new EWA_FrameResoures;this.Resources.Init(this.Xml);var a=window["_EWA_MENU_"+this._Id];$(".caption-info").attr("onselectstart","return false");this.add_doc_buts(a);this.init_lazy_frames_top();var b=this;addEvent(window,"scroll",function(){b.lazy_load()});this.mark_loc();this.lazy_load();document.body.style.overflow="hidden";EWA.B.MOZILLA?addEvent(window,
"DOMMouseScroll",this.my_mousewheel):addEvent(window,"mousewheel",this.my_mousewheel);a=this.getlocalStorage();for(var c in a)if("id"!=c&&a[c]&&$X(c)){var d=$($X(c)).prev().find(".fa-compress");0<d.length&&this.hide_frame(d[0])}window.open_in_box||(window.open_in_box=this.open_in_box);parent!=window&&(document.body.style.backgroundColor="transparent")};this.add_doc_buts=function(a){parent==window&&$("body").css("background-color","#ccc");if(a&&0!=a.length){for(var b=[],c=0;c<a.length;c++)b[c]=a[c];
b.push({Id:this._Id+"_comress_all",Txt:"enus"==EWA.LANG?"Hide All":"\u9690\u542b\u5168\u90e8",Cmd:"EWA.F.FOS['"+this._Id+"'].compress_all(this)",Img:"fa-compress"});for(c=b.length-1;0<=c;c--)if(a=b[c],null!=a){var d=$X("controls").rows[0].insertCell(1);d.innerHTML="<div id='"+a.Id+"' tag='"+a.Id+"' idx='"+c+"' onmouseover='EWA.F.FOS[\""+this._Id+"\"].show_title(this)' onmouseout=\"$('.pop_title').hide()\" class='but' _title=\""+a.Txt+'" '+(a.paras||"")+"><i class='fa "+a.Img+"'></i></div>";0<=a.Cmd.indexOf("function(")?
(d.childNodes[0].setAttribute("cmd",a.Cmd),d.childNodes[0].onclick=function(){var a=this.getAttribute("cmd");eval("("+a+")")(this)}):d.childNodes[0].setAttribute("onclick",a.Cmd);d.className="tdbut"}b=$("#controls").width();$("#dock").css("width",b).css("left","50%").css("margin-left",-1*b/2)}else $("#dock").hide()};this.init_lazy_frames_top=function(){this.lazy_frames=this.lazy_frames||{};var a=this;$("div[x]").each(function(){var b=$(this).offset().top;a.lazy_frames[this.id]?a.lazy_frames[this.id].top=
b:a.lazy_frames[this.id]={top:b}})};this._getBodyHeight=function(){return"CSS1Compat"==document.compatMode?document.documentElement.clientHeight:document.body.clientHeight};this.lazy_load=function(){var a=("CSS1Compat"==document.compatMode?document.documentElement.scrollTop:document.body.scrollTop)+this._getBodyHeight(),b;for(b in this.lazy_frames)this.lazy_frames[b].top<=a-10&&this.lazy_load_do(b);this.mark_loc()};this._getParas=function(){var a=new EWA_UrlClass(this.Url);a.RemoveEwa();return a.GetParas()};
this.lazy_load_do=function(a){if(!this.lazy_frames[a].ok){this.lazy_frames[a].ok=!0;var b=$("#"+a),c=b.attr("x"),d=this._getParas();d&&(d="&"+d);if(null!=c&&0<c.length){var e=b.attr("i"),f=b.attr("p"),g=b.attr("js");null==g||""==g.trim()?EWA.F.Install(a,c,e,f+d):EWA.F.Install(a,c,e,f+d,function(){eval(g)})}else{b=b.attr("u")+d+"&NO_NAV=1";var h=("iframe_lazy_"+Math.random()).replace(".","A");c="<iframe id='"+h+"' name='"+h+"' width=100% height=100% frameborder=0 src='"+b+"'></iframe>";$X(a).innerHTML=
c;var k=-1,l=0<b.indexOf("combine.jsp")?!0:!1;setInterval(function(){var a=window.frames[h];if(a&&a.document&&"complete"==a.document.readyState&&a.$){var b=l?$("[id=crm_main_box]:visible").height():a.document.body.offsetHeight;100>Math.abs(k-b)||(k=b,$("#"+h).css("height",b+10),a.document.body.style.overflow="hidden")}},777)}}};this.mark_loc=function(){for(var a=$(".fcaption"),b=$("#nav_left .top"),c=$("#nav_left .bottom"),d=$("#nav_left"),e=this._getBodyHeight(),f=0;f<a.length;f++){var g=a[f],h=
this.mark_loc_ref(g,f);g=$(g);g=g.offset().top-("CSS1Compat"==document.compatMode?document.documentElement.scrollTop:document.body.scrollTop);g>e-c.height()?c.append(h):g<b.height()?b.append(h):(h.css({bottom:"",top:g}),d.append(h))}};this.mark_loc_ref=function(a,b){if(null==a.id||""==a.id)a.id=Math.random();var c=a.id;a=$(a);var d=$X("zzz"+c),e='EWA.F.FOS["'+this._Id+'"].';if(!d){d="c"+b%5;a.attr("class",a.attr("class")+" "+d);a.html("<b onclick='"+e+"max_frame(this)' class='fa fa-thumb-tack '>&nbsp;</b>"+
a.html());var f=a.css("background-color");a.parent().css("border-bottom-color",f);d=document.createElement("div");d.style.backgroundColor=f;d.id="zzz"+c;$("#nav_left").append(d);d.onclick=function(){var a=this.id.replace("zzz","");a=$($X(a)).offset().top;"CSS1Compat"==document.compatMode?$(document.documentElement).animate({scrollTop:a},300):$("body").animate({scrollTop:a},300)};d.title=a.text();d.innerHTML=b+1;d.onmouseover=function(){$(".pop_title_left div").html(this.title);var a=$(this).offset();
$(".pop_title_left").show().css("top",a.top-10).css("right",45)};d.onmouseout=function(){$(".pop_title_left").hide()};a.append('&nbsp;<i class="fa fa-compress" onclick='+e+"hide_frame(this)></i>");a.append('&nbsp;<i class="fa fa-refresh" onclick='+e+"reload_frame(this)></i>")}return $(d)};window.isStopMouseWheel=!1;this.my_mousewheel=function(a){if(!isStopMouseWheel){a=a.wheelDelta||a.detail;var b="CSS1Compat"==document.compatMode?document.documentElement:document.body;b.scrollTop=EWA.B.MOZILLA?b.scrollTop+
3*a:b.scrollTop-a}};this.show_title=function(a){if(""==a.getAttribute("_title")||null==a.getAttribute("_title")){var b=a.title;if(""==b||null==b)return;a.setAttribute("_title",b);a.title=""}$(".pop_title div").html(a.getAttribute("_title"));b=$(a).offset();a=$(a).width();var c=$(".pop_title").height(),d=$(".pop_title").width();$(".pop_title").css("top",b.top-c-8);$(".pop_title").show();$(".pop_title").css("left",b.left-(d-a)/2)};this.compress_all=function(a){a=$(a);if(null==a.attr("compress")||""==
a.attr("compress")){a.attr("compress",1);a.find("i").attr("class","fa fa-expand");var b="fa-compress";a.attr("_title","enus"==EWA.LANG?"Show All":"\u663e\u793a\u5168\u90e8")}else a.attr("compress",""),a.find("i").attr("class","fa fa-compress"),b="fa-expand",a.attr("_title","enus"==EWA.LANG?"Hide All":"\u9690\u542b\u5168\u90e8");var c=this;$(".fcaption ."+b).each(function(){c.hide_frame(this)})};this.getlocalStorage=function(){var a="ROBERT_"+location.pathname;if(0<a.indexOf("/cgi-bin/")){var b=new EWA_UrlClass;
b.SetUrl(window.location.href);var c=b.GetParameter("xmlname");b=b.GetParameter("itemname");c&&b&&(a="EWA_"+c+"GdX"+b)}c={};if(window.localStorage[a])try{c=eval("__json="+window.localStorage[a]+"; __json;")}catch(d){c={}}c.id=a;return c};this.hide_frame=function(a){var b=$(a.parentNode.parentNode);b=b.next();var c=$(a);a=!1;null==c.attr("compress")||""==c.attr("compress")?(c.attr("compress",1),c.attr("class","fa fa-expand"),b.hide(),this.init_lazy_frames_top(),this.lazy_load(),a=!0):(c.attr("compress",
""),c.attr("class","fa fa-compress"),this.init_lazy_frames_top(),b.show());c=this.getlocalStorage();c[b.attr("id")]=a;window.localStorage[c.id]=JSON.stringify(c)};this.max_frame=function(a){a=$(a.parentNode.parentNode);$('<p id="_MAX_FRAME___"></p>').insertBefore(a);var b=a.next();isStopMouseWheel=!0;if(!$X("MAX_FRAME___")){var c=document.createElement("div");c.id="MAX_FRAME___";$(c).css({position:"fixed",left:10,right:10,top:10,bottom:10,"background-color":"rgba(255,255,255,0.9)","z-index":1E7,"padding-top":5,
overflow:"auto","border-radius":5});c.innerHTML='<div style="position:fixed;left:15px;top:15px;font-size:16px;color:#fff;cursor:pointer;width:20px;height:20px;border-radius:10px;text-align:center;background-color:#111;"  onclick=EWA.F.FOS["'+this._Id+'"].remove_max()><b style="line-height:20px" class="fa fa-times"></b></div>';document.body.appendChild(c)}c=$("#MAX_FRAME___");c.append(a);a.find(".fa").hide();c.append(b);b.show();c.show()};this.remove_max=function(){for(var a=$X("MAX_FRAME___"),b=$("#_MAX_FRAME___"),
c=0;1<a.childNodes.length;){var d=a.childNodes[1];$(d).insertBefore(b);$(d).find(".fa").show();c++;if(5<c)break}b.remove();$(a).hide();isStopMouseWheel=!1};this.reload_frame=function(a){a=a.parentNode.parentNode;a=a.nextElementSibling?a.nextElementSibling:a.nextSibling;var b=a.getAttribute("r");null!=b&&""!=b?eval(b):(b=$(a).find(".EWA_TABLE"),0<b.length?(b=b[0].id.replace("EWA_LF_","").replace("EWA_FRAME_",""),EWA.F.FOS[b]instanceof EWA_FrameClass?(b=EWA.F.FOS[b].Url,(new EWA_AjaxClass).Install(b,
"EWA_AJAX=INSTALL",a.id,function(){change_edit("disabled")})):EWA.F.FOS[b].Reload()):"grp_fin_all"==a.id?load_grp_fin_total():(a=a.getElementsByTagName("iframe"),0<a.length&&(a[0].src=a[0].src)))};this.open_in_box=function(a,b){$("#open_box").show();$("#open_box .title span").html(b);a=a.replace(/\|/ig,"%7c");a="<iframe width=100% height=100% src='"+a+"' frameborder=0></iframe>";$("#open_box .cnt").html(a);isStopMouseWheel=!0}}
function focus_object(a,b){var c=$(a).offset();b?$("body").animate({scrollTop:c.top-40},300,b):$("body").animate({scrollTop:c.top-40},300);$(".pop_title").hide();a=$(a).prev().find(".fa-expand");0<a.length&&a.click()}
function EWA_UI_ADListClass(){this._TimeOut=3E3;this._Width=515;this._Height=223;this._List=[];this._Object=null;this._CurIndex=0;this._GotoIndex=-1;this.ClassName=null;this.Timer=-1;this._CssSize="";this.IsAutoPaly=!0;this.SetSize=function(a,b){this._Width=a;this._Height=b;this._CssSize="width:"+this._Width+(isNaN(this._Width)?"":"px")+";height:"+this._Height+(isNaN(this._Height)?"":"px")};this.AddAd=function(a,b,c,d){var e={};e.ImgUrl=a;e.AdUrl=b;e.AdText=c;e.Target=d;this._List.push(e)};this.Change=
function(){window.clearTimeout(this.Timer);var a=this._Object.getElementsByTagName("a"),b=this._Object.getElementsByTagName("table")[0].rows[0];b.cells[1].childNodes[this._CurIndex].style.backgroundColor="#000";b.cells[1].childNodes[this._CurIndex].style.color="#fff";var c=a[this._CurIndex];-1==this._GotoIndex?(this._CurIndex++,this._CurIndex==this._List.length&&(this._CurIndex=0)):(this._CurIndex=this._GotoIndex,this._GotoIndex=-1);a=a[this._CurIndex];b.cells[1].childNodes[this._CurIndex].style.backgroundColor=
"white";b.cells[1].childNodes[this._CurIndex].style.color="#000";EWA.UI.Utils.FadeIn(a,c,10,80,this)};this.ChangeAfter=function(){var a=this._Object.getElementsByTagName("table")[0].rows[0].cells[0].childNodes[0];a.innerHTML=this._List[this._CurIndex].AdText;a.href=this._List[this._CurIndex].AdUrl;a.target=this._List[this._CurIndex].Target;this.IsAutoPaly&&(window.clearTimeout(this.Timer),this.Timer=window.setTimeout(this.ClassName+".Change()",this._TimeOut))};this.CreateByUrl=function(a,b){this._ParentId=
b;EWA.UI.Utils.FADE_AJAX=new EWA.C.Ajax;EWA.UI.Utils.FADE_AJAX.Get(a,eval(this.ClassName+".AjaxCallBack"));EWA.UI.Utils.FADE=this};this.AjaxCallBack=function(){var a=EWA.UI.Utils.FADE_AJAX;4==a._Http.readyState&&(a.HiddenWaitting(),200==a._Http.status?(EWA.UI.Utils.FADE._List=eval(a._Http.responseText),EWA.UI.Utils.FADE.Create()):alert("ERROR:\r\n"+a._Http.statusText),EWA.SHOW_ERROR=!0)};this.Create=function(a){null==a&&(a=this._ParentId);var b=$X(a);if(null==b)alert("ID("+a+") Not Exists!");else{a=
document.createElement("DIV");a.style.width=this._Width+(isNaN(this._Width)?"":"px");a.style.height=this._Height+(isNaN(this._Height)?"":"px");a.style.overflow="hidden";var c=[];c.push('<div style="position: relative;'+this._CssSize+'"><div style="z-index:0;position: absolute;'+this._CssSize+'"></div>');c.push('<div style="position: absolute; height: 20px; width: '+this._Width+"px; left: 0px; top:"+(this._Height-22)+'px; border: 1px black solid; background-color: #000; filter: Alpha(Opacity=20); opacity: 0.2;z-index:1"></div>');
c.push('<table style="z-index:2;position:absolute;height:20px; width:'+this._Width+(isNaN(this._Width)?"":"px")+"; left: 0px;top:"+(this._Height-22)+'px; font-size: 12px;color: white" cellpadding="0" cellspacing="0"><tr><td align="center"><a style="color:white"></a></td><td style="width:'+24*this._List.length+'px;"></td></tr></table>');c.push("</div>");a.innerHTML=c.join("");b.innerHTML="";b.appendChild(a);this._Object=a;this._CreateList();this.ChangeAfter()}};this._CreateList=function(){for(var a=
this._Object.getElementsByTagName("table")[0].rows[0].cells[1],b=0;b<this._List.length;b++){var c=this._List[b],d=document.createElement("div");d.style.cssText="filter:Alpha(Opacity=70);width: 18px; height: 18px; float: left; text-align: center; color: #fff; margin-right: 2px; font-family: arial; cursor: pointer; opacity: 0.7; border-radius: 9px;line-height: 18px; background-color: #000;";d.innerHTML=b+1;a.appendChild(d);d.setAttribute("instancename",this.ClassName);d.onclick=function(){var a=eval("window."+
this.getAttribute("instancename"));window.clearTimeout(a.Timer);a._GotoIndex=1*this.innerHTML-1;a.Change()};d=document.createElement("div");d.style.cssText="background-image:url('"+c.ImgUrl+"');  "+this._CssSize+";background-repeat: no-repeat; background-size: cover;-moz-background-size: cover;-webkit-background-size: cover;background-position: center center;";d.title=c.AdText;var e=document.createElement("a");e.style.cssText=this._CssSize;e.style.position="absolute";e.style.top="0em";e.style.left=
"0em";0<b&&(e.style.display="none");e.style.zIndex=b;e.href=c.AdUrl;e.target=null==c.Target?"_blank":c.Target;e.appendChild(d);this._Object.childNodes[0].childNodes[0].appendChild(e)}}}
function EWA_UI_ADFlagClass(){this._ClassName=null;this._List=[];this._Ads=[];this.AddAd=function(a,b,c,d,e,f,g){var h={};h.IMG_SRC=a;h.URL=b;h.TOP=c;h.LEFT=d;h.IMG_WIDTH=e;h.IMG_HEIGHT=f;h.IS_FROM_CENTER=g;this._List.push(h)};this.Create=function(a){for(var b=0;b<this._List.length;b++)this._CreateObj(this._List[b]);if(a){var c=this;document.onscroll=function(){if("undefined"!=typeof window.pageYOffset)var a=window.pageYOffset;else"undefined"!=typeof document.compatMode&&"BackCompat"!=document.compatMode?
a=document.documentElement.scrollTop:"undefined"!=typeof document.body&&(a=document.body.scrollTop);for(var b=0;b<c._Ads.length;b++)c._Ads[b].style.top=1*c._List[b].TOP+a+"px"}}};this._CreateObj=function(a){var b=1*a.LEFT;a.IS_FROM_CENTER&&(b=window.document.body.offsetWidth/2+b);var c=document.createElement("div");c.style.position="absolute";c.style.left=b+"px";c.style.top=a.TOP+"px";c.style.width=a.IMG_WIDTH+"px";c.style.height=a.IMG_HEIGHT+"px";c.innerHTML="<a href='"+a.URL+"' target='_blank'><img src='"+
a.IMG_SRC+"' border='0' width='"+a.IMG_WIDTH+"px' height='"+a.IMG_HEIGHT+"px' /></a><div style='cursor:pointer;font-size:12px;text-align:right;padding-top:2px' onclick='this.parentNode.style.display=\"none\"'>\u5173\u95ed</div>";document.body.appendChild(c);this._Ads.push(c)}}
function EWA_CombineClass(){this.EWA_COMBINES_HTML=[];this.EWA_COMBINES=[];this.ewa_lf_func_index=this.curCombineIndex=0;this.MEAGER_ITEMS=[];this._init=function(){for(var a=0;a<this.EWA_COMBINES_HTML.length;a++)this.installCfgMoveButton1(this.EWA_COMBINES_HTML[a]);if(0==this.EWA_COMBINES.length){for(a=0;a<this.MEAGER_ITEMS.length;a++)this.meargeItems(this.MEAGER_ITEMS[a]);window.lastDo&&lastDo()}else this.installCfg()};this.installCfgMoveButton1=function(a){var b=$("#"+a).find(".ewa_lf_func");if(0!=
b.length&&(b=b[0],$X(a).getElementsByTagName("table")[0].style.height="",b.style.display="none",b=b.childNodes[1],0<b.getElementsByTagName("div").length))for(b.getElementsByTagName("div")[0].style.display="none";0<b.childNodes.length;)$X("DES_"+a).appendChild(b.childNodes[0])};this.installCfg=function(){if(this.curCombineIndex<this.EWA_COMBINES.length){if(0<this.curCombineIndex){if(!$X("EWA_FRAME_MAIN")){setTimeout(installCfg,51);return}$X("EWA_FRAME_MAIN").id="a"}var a=this.EWA_COMBINES[this.curCombineIndex],
b=this;EWA.F.Install(a.id,a.x,a.i,a.p,function(a,d,e,f){b.installOk(a,d,e,f)});this.curCombineIndex++}else{for(a=0;a<this.MEAGER_ITEMS.length;a++)this.meargeItems(this.MEAGER_ITEMS[a]);window.lastDo&&lastDo()}};this.installOk=function(a,b,c,d){this.installCfgMoveButton1(c);this.installCfg()};this.showFull=function(a){var b=$("#"+a).parent("div"),c=b.find(".left"),d=$("#"+a).find(".show"),e=b.attr("full");if(null!=e&&"1"==e)b.attr("full","0"),$(document.body).css("overflow","auto"),eval("ori="+b.attr("ori")),
b.animate(p,"fast","swing",function(){b[0].style.cssText="";var e=1*b.attr("st");document.body.scrollTop=e;1==$("#crm_left_box").attr("show")&&$("#crm_left_box").show();b.css("display",b.attr("dsp"));0<d.length&&"DES_plugin"!=a?d[0].click():(e=$X(a.replace("DES_","")),e.style.width=e.parentNode.clientWidth-10+"px",e.style.height=p.height-30+"px",c.find('div[id="EWA_FRAME_MAIN"]').css("height",p.height-150))});else{b.attr("full","1");b.attr("st",document.body.scrollTop);b.attr("dsp",b.css("display"));
var f=document.documentElement.clientHeight;e=document.documentElement.clientWidth-10;var g=f-20,h=document.documentElement.clientWidth-30,k=f-20-20-15;f=b.offset();var l=b.position(),m=f.left-l.left,q=b.width(),r=b.height();var p={width:q,height:r,"margin-left":m,left:l.left,top:l.top};b.attr("ori",JSON.stringify(p));b.css({"margin-left":"0px",top:f.top,left:f.left,position:"absolute",display:"",overflow:"auto"});b.animate({width:e,height:g,left:10,top:0},"fast","swing",function(){c.css("width",
h);c.css("height",k);b.find("iframe").css("height",k);b.find('div[id="EWA_FRAME_MAIN"]').css("height",k-30);0<d.length&&"DES_plugin"!=a&&d[0].click()});document.body.scrollTop=0;"none"!=$("#crm_left_box").css("display")&&($("#crm_left_box").hide(),$("#crm_left_box").attr("show",1));$(document.body).css("overflow","hidden")}};this.meargeItems=function(a){a=a.split(",");for(var b,c,d,e=0;e<a.length;e++){var f=a[e].trim();if($X(f)){var g=$X(f.replace("DES_",""));$("#"+f);var h=[];if(0==e){b=$X(f);d=
document.createElement("div");d.id="KK_"+f;d.style.cssText="clear:both;height:25px;border-top:1px solid #cdcdcd";d.setAttribute("but","1");c=g;for(var k=1;k<$X(f).childNodes.length;k++)if(g=$X(f).childNodes[k],1<k)g.id="M"+Math.random(),h.push(g.id);else{var l=g;l.className="ewa_lf_func_caption show";if(null==l.id||""==l.id)l.id="MAx"+Math.random();l.parentNode.setAttribute("lid",l.id)}for(;2<$X(f).childNodes.length;)g=$X(f).childNodes[2],d.appendChild(g)}else for(g.parentNode.style.display="none",
c.parentNode.appendChild(g),g.style.display="none",k=0;1<$X(f).childNodes.length;)g=$X(f).childNodes[1],0<k?(g.style.display="none",g.id="M"+Math.random(),h.push(g.id),d.appendChild(g)):(l=g,b.appendChild(g)),k++;l.setAttribute("ids",h.join(","));l.setAttribute("lst",f);l.setAttribute("menu_id",d.id);var m=this;addEvent(l,"click",function(){m.meargeItems_ck(this)})}else if(0==e)return}0<d.childNodes.length&&(b.appendChild(d),b.style.height="50px")};this.meargeItems_ck=function(a){var b=a.getAttribute("menu_id"),
c=a.parentNode.getAttribute("lid");null!=c&&0<c.length&&($X(c).className="ewa_lf_func_caption hide");a.className="ewa_lf_func_caption show";if(null==a.id||""==a.id)a.id="MAx"+Math.random();a.parentNode.setAttribute("lid",a.id);$("#"+b).children("div").each(function(){$(this).hide()});$(a).parent("div").parent("div").children(".ewa_cb_left").each(function(){$(this).hide()});b=a.getAttribute("ids");if(""!=b)for(b=b.split(","),c=0;c<b.length;c++)"ewa_lf_func_caption"!=$X(b[c]).className&&($X(b[c]).style.display=
"");a=a.getAttribute("lst");a=$X(a.replace("DES_",""));a.style.display="";a.style.width=a.parentNode.clientWidth-20+"px"};this.actIframe=function(a){var b=$("#"+a).find("iframe");if(0==b.length)alert(a+" not iframe");else{var c=b[0].contentWindow,d=c.document.body.scrollHeight,e=c.document.body.scrollWidth;if(c.$){var f=0;0<c.document.body.innerHTML.indexOf("EWA.F.F.C")?(f=c.$("#Test1").height(),e=c.$("#Test1").width()):(c.$(".ewa_table").parent().parent().children().each(function(){f+=$(this).height()}),
e=c.$(".ewa_table").width());d=f}e>$("#"+a).width()&&(d+=40);300>d&&(d=330);$("#"+a).css("height",d);var g=this;"0"!=b.attr("_src")?(b.attr("src",b.attr("_src")),b.attr("_src","0"),setTimeout(function(){g.chkFrameLazyLoaded(a)},199)):(g.setFrameCss(a,c),g.afterFrameLazyLoaded(a))}};this.setFrameCss=function(a,b){if(1!=$("#"+a).attr("lnk")){var c=b.document.createElement("link");c.type="text/css";c.rel="stylesheet";c.rev="stylesheet";c.href="../../css/main.css";b.document.getElementsByTagName("head")[0].appendChild(c);
b.document.body.style.backgroundColor="#fff";$("#"+a).attr("lnk",1)}};this.afterFrameLazyLoaded=function(a){};this.chkFrameLazyLoaded=function(a){var b=$("#"+a).find("iframe")[0].contentWindow;if(b&&b.document&&b.document.body&&b.$&&"complete"==b.document.readyState){var c=[],d=$("#"+a).parent().find("div[but=1]");0<d.length&&(b.$(".ewa_lf_func_dact").each(function(b){var e=document.createElement("div");e.className="ewa_lf_func_dact";e.style.cursor="pointer";e.innerHTML=this.innerHTML;""==this.id&&
(this.id=a+"|"+Math.random());e.id=this.id;d[0].appendChild(e);e.onclick=function(){this.id.split("|");$("#"+a).find("iframe")[0].contentWindow.$X(this.id).click()};c.push(e.id);0==b&&(this.parentNode.parentNode.style.display="none")}),d.parent().find(".show").attr("ids",c.join(",")));this.actIframe(a)}else{var e=this;setTimeout(function(){e.chkFrameLazyLoaded(a)},101)}};this.showInPlugin=function(a,b){if(0<a.indexOf(".jsp"))a='<iframe width=100% height=100% frameborder=0 src="'+a+'"></iframe>',$("#plugin").html(a),
this.showFull("DES_plugin"),document.body.scrollTop=0,$X("subject_plugin").innerHTML=b;else{var c=this;(new EWA.C.Ajax).Install(a+"&EWA_AJAX=install&EWA_FRAMESET_NO=1","_r=1","plugin",function(){c.showFull("DES_plugin");document.body.scrollTop=0;$X("subject_plugin").innerHTML=b})}}}
installCfgMoveButton1=function(a){var b=$("#"+a).find(".ewa_lf_func");if(0!=b.length&&(b=b[0],$X(a).getElementsByTagName("table")[0].style.height="",b.style.display="none",b=b.childNodes[1],0<b.getElementsByTagName("div").length))for(b.getElementsByTagName("div")[0].style.display="none";0<b.childNodes.length;)$X("DES_"+a).appendChild(b.childNodes[0])};

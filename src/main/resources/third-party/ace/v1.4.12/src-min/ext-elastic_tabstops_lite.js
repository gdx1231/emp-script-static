define("ace/ext/elastic_tabstops_lite",["require","exports","module","ace/editor","ace/config"],function(t,e,i){"use strict";var s=function(t){this.$editor=t;var e=this;var i=[];var s=false;this.onAfterExec=function(){s=false;e.processRows(i);i=[]};this.onExec=function(){s=true};this.onChange=function(t){if(s){if(i.indexOf(t.start.row)==-1)i.push(t.start.row);if(t.end.row!=t.start.row)i.push(t.end.row)}}};(function(){this.processRows=function(t){this.$inChange=true;var e=[];for(var i=0,s=t.length;i<s;i++){var r=t[i];if(e.indexOf(r)>-1)continue;var o=this.$findCellWidthsForBlock(r);var n=this.$setBlockCellWidthsToMax(o.cellWidths);var a=o.firstRow;for(var h=0,l=n.length;h<l;h++){var c=n[h];e.push(a);this.$adjustRow(a,c);a++}}this.$inChange=false};this.$findCellWidthsForBlock=function(t){var e=[],i;var s=t;while(s>=0){i=this.$cellWidthsForRow(s);if(i.length==0)break;e.unshift(i);s--}var r=s+1;s=t;var o=this.$editor.session.getLength();while(s<o-1){s++;i=this.$cellWidthsForRow(s);if(i.length==0)break;e.push(i)}return{cellWidths:e,firstRow:r}};this.$cellWidthsForRow=function(t){var e=this.$selectionColumnsForRow(t);var i=[-1].concat(this.$tabsForRow(t));var s=i.map(function(t){return 0}).slice(1);var r=this.$editor.session.getLine(t);for(var o=0,n=i.length-1;o<n;o++){var a=i[o]+1;var h=i[o+1];var l=this.$rightmostSelectionInCell(e,h);var c=r.substring(a,h);s[o]=Math.max(c.replace(/\s+$/g,"").length,l-a)}return s};this.$selectionColumnsForRow=function(t){var e=[],i=this.$editor.getCursorPosition();if(this.$editor.session.getSelection().isEmpty()){if(t==i.row)e.push(i.column)}return e};this.$setBlockCellWidthsToMax=function(t){var e=true,i,s,r;var o=this.$izip_longest(t);for(var n=0,a=o.length;n<a;n++){var h=o[n];if(!h.push){console.error(h);continue}h.push(NaN);for(var l=0,c=h.length;l<c;l++){var f=h[l];if(e){i=l;r=0;e=false}if(isNaN(f)){s=l;for(var u=i;u<s;u++){t[u][n]=r}e=true}r=Math.max(r,f)}}return t};this.$rightmostSelectionInCell=function(t,e){var i=0;if(t.length){var s=[];for(var r=0,o=t.length;r<o;r++){if(t[r]<=e)s.push(r);else s.push(0)}i=Math.max.apply(Math,s)}return i};this.$tabsForRow=function(t){var e=[],i=this.$editor.session.getLine(t),s=/\t/g,r;while((r=s.exec(i))!=null){e.push(r.index)}return e};this.$adjustRow=function(t,e){var i=this.$tabsForRow(t);if(i.length==0)return;var s=0,r=-1;var o=this.$izip(e,i);for(var n=0,a=o.length;n<a;n++){var h=o[n][0],l=o[n][1];r+=1+h;l+=s;var c=r-l;if(c==0)continue;var f=this.$editor.session.getLine(t).substr(0,l);var u=f.replace(/\s*$/g,"");var v=f.length-u.length;if(c>0){this.$editor.session.getDocument().insertInLine({row:t,column:l+1},Array(c+1).join(" ")+"\t");this.$editor.session.getDocument().removeInLine(t,l,l+1);s+=c}if(c<0&&v>=-c){this.$editor.session.getDocument().removeInLine(t,l+c,l);s+=c}}};this.$izip_longest=function(t){if(!t[0])return[];var e=t[0].length;var i=t.length;for(var s=1;s<i;s++){var r=t[s].length;if(r>e)e=r}var o=[];for(var n=0;n<e;n++){var a=[];for(var s=0;s<i;s++){if(t[s][n]==="")a.push(NaN);else a.push(t[s][n])}o.push(a)}return o};this.$izip=function(t,e){var i=t.length>=e.length?e.length:t.length;var s=[];for(var r=0;r<i;r++){var o=[t[r],e[r]];s.push(o)}return s}}).call(s.prototype);e.ElasticTabstopsLite=s;var r=t("../editor").Editor;t("../config").defineOptions(r.prototype,"editor",{useElasticTabstops:{set:function(t){if(t){if(!this.elasticTabstops)this.elasticTabstops=new s(this);this.commands.on("afterExec",this.elasticTabstops.onAfterExec);this.commands.on("exec",this.elasticTabstops.onExec);this.on("change",this.elasticTabstops.onChange)}else if(this.elasticTabstops){this.commands.removeListener("afterExec",this.elasticTabstops.onAfterExec);this.commands.removeListener("exec",this.elasticTabstops.onExec);this.removeListener("change",this.elasticTabstops.onChange)}}}})});(function(){window.require(["ace/ext/elastic_tabstops_lite"],function(t){if(typeof module=="object"&&typeof exports=="object"&&module){module.exports=t}})})();
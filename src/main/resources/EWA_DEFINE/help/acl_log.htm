<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="acl_log.files/filelist.xml">
<title>一、</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>guolei</o:Author>
  <o:LastAuthor>guolei</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>214</o:TotalTime>
  <o:Created>2010-04-16T03:53:00Z</o:Created>
  <o:LastSaved>2010-04-16T03:53:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>907</o:Words>
  <o:Characters>5176</o:Characters>
  <o:Lines>43</o:Lines>
  <o:Paragraphs>12</o:Paragraphs>
  <o:CharactersWithSpaces>6071</o:CharactersWithSpaces>
  <o:Version>11.9999</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:PunctuationKerning/>
  <w:DrawingGridVerticalSpacing>7.8 磅</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:SpaceForUL/>
   <w:BalanceSingleByteDoubleByteWidth/>
   <w:DoNotLeaveBackslashAlone/>
   <w:ULTrailSpace/>
   <w:DoNotExpandShiftReturn/>
   <w:AdjustLineHeightInTable/>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:黑体;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimHei;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:1 135135232 16 0 262144 0;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:"\@黑体";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:1 135135232 16 0 262144 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	mso-font-kerning:1.0pt;}
h1
	{mso-style-next:正文;
	margin-top:17.0pt;
	margin-right:0cm;
	margin-bottom:16.5pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:240%;
	mso-pagination:lines-together;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:22.0pt;
	font-family:"Times New Roman";
	mso-font-kerning:22.0pt;}
h2
	{mso-style-next:正文;
	margin-top:13.0pt;
	margin-right:0cm;
	margin-bottom:13.0pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:173%;
	mso-pagination:lines-together;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:16.0pt;
	font-family:Arial;
	mso-fareast-font-family:黑体;
	mso-bidi-font-family:"Times New Roman";
	mso-font-kerning:1.0pt;}
p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
	{mso-style-noshow:yes;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	background:navy;
	font-size:10.5pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:宋体;
	mso-font-kerning:1.0pt;}
 /* Page Definitions */
 @page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-paper-source:0;
	layout-grid:15.6pt;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:569997831;
	mso-list-type:hybrid;
	mso-list-template-ids:1014426250 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l0:level1
	{mso-level-tab-stop:21.0pt;
	mso-level-number-position:left;
	margin-left:21.0pt;
	text-indent:-21.0pt;}
@list l1
	{mso-list-id:847060282;
	mso-list-type:hybrid;
	mso-list-template-ids:-654659212 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l1:level1
	{mso-level-tab-stop:21.0pt;
	mso-level-number-position:left;
	margin-left:21.0pt;
	text-indent:-21.0pt;}
@list l2
	{mso-list-id:851840674;
	mso-list-type:hybrid;
	mso-list-template-ids:1025155590 -379452172 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l2:level1
	{mso-level-number-format:japanese-counting;
	mso-level-text:%1、;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	margin-left:21.0pt;
	text-indent:-21.0pt;}
@list l3
	{mso-list-id:1632635824;
	mso-list-type:hybrid;
	mso-list-template-ids:388253690 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l3:level1
	{mso-level-tab-stop:21.0pt;
	mso-level-number-position:left;
	margin-left:21.0pt;
	text-indent:-21.0pt;}
@list l4
	{mso-list-id:1848666272;
	mso-list-type:hybrid;
	mso-list-template-ids:171240862 -1276769408 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l4:level1
	{mso-level-text:%1、;
	mso-level-tab-stop:18.0pt;
	mso-level-number-position:left;
	margin-left:18.0pt;
	text-indent:-18.0pt;}
@list l5
	{mso-list-id:2101682054;
	mso-list-type:hybrid;
	mso-list-template-ids:-1164298114 -379452172 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l5:level1
	{mso-level-number-format:japanese-counting;
	mso-level-text:%1、;
	mso-level-tab-stop:21.0pt;
	mso-level-number-position:left;
	margin-left:21.0pt;
	text-indent:-21.0pt;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:普通表格;
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
table.MsoTableGrid
	{mso-style-name:网格型;
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	border:solid windowtext 1.0pt;
	mso-border-alt:solid windowtext .5pt;
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-border-insideh:.5pt solid windowtext;
	mso-border-insidev:.5pt solid windowtext;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=ZH-CN style='tab-interval:21.0pt;text-justify-trim:punctuation'>

<div class=Section1 style='layout-grid:15.6pt'>

<h1 style='margin-left:21.0pt;text-indent:-21.0pt;mso-list:l2 level1 lfo4'><![if !supportLists]><span
lang=EN-US style='mso-bidi-font-family:宋体'><span style='mso-list:Ignore'>一、<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>涉及对象</span></h1>

<h2 style='margin-left:21.0pt;text-indent:-21.0pt;mso-list:l1 level1 lfo3;
tab-stops:list 21.0pt'><![if !supportLists]><span lang=EN-US style='mso-fareast-font-family:
Arial;mso-bidi-font-family:Arial'><span style='mso-list:Ignore'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
lang=EN-US>RequestValue</span><span style='font-size:10.5pt;line-height:173%;
font-family:黑体;mso-ascii-font-family:Arial;font-weight:normal;mso-bidi-font-weight:
bold'>（</span><span lang=EN-US style='font-size:10.5pt;line-height:173%;
font-weight:normal;mso-bidi-font-weight:bold'>com.gdxsoft.easyweb.script.RequestValue</span><span
style='font-size:10.5pt;line-height:173%;font-family:黑体;mso-ascii-font-family:
Arial;font-weight:normal;mso-bidi-font-weight:bold'>）</span></h2>

<p class=MsoNormal style='text-indent:18.0pt'><span lang=EN-US>RequestValue</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>是系统中获取参数使用的对象，它将</span><span lang=EN-US>From</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，</span><span lang=EN-US>Cookie</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，</span><span lang=EN-US>Session</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，</span><span lang=EN-US>Query</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，数据集（</span><span
lang=EN-US>DTTable</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>）等对象传递的参数作为一个对象统一处理。从而简便编程环境。</span></p>

<p class=MsoNormal style='text-indent:18.0pt'><span lang=EN-US>RequestValue</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>基本使用是</span><span lang=EN-US>getString(</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>参数名</span><span lang=EN-US>)</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>，例如</span><span
lang=EN-US>getString(‘xmlname’)</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>是获取配置文件名称。</span><span
lang=EN-US>getRequest()</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>是获取页面的</span><span
lang=EN-US>request</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>对象。</span></p>

<h2 style='margin-left:21.0pt;text-indent:-21.0pt;mso-list:l1 level1 lfo3;
tab-stops:list 21.0pt'><![if !supportLists]><span lang=EN-US style='mso-fareast-font-family:
Arial;mso-bidi-font-family:Arial'><span style='mso-list:Ignore'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
lang=EN-US>DataConnection</span><span style='font-size:10.5pt;line-height:173%;
font-family:黑体;mso-ascii-font-family:Arial;font-weight:normal;mso-bidi-font-weight:
bold'>（</span><span lang=EN-US style='font-size:10.5pt;line-height:173%;
font-weight:normal;mso-bidi-font-weight:bold'>com.gdxsoft.easyweb.datasource.DataConnection</span><span
style='font-size:10.5pt;line-height:173%;font-family:黑体;mso-ascii-font-family:
Arial;font-weight:normal;mso-bidi-font-weight:bold'>）</span></h2>

<p class=MsoNormal style='text-indent:18.0pt'><span lang=EN-US>DataConnection</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>是数据库连接，用于系统和数据库的操作，调用</span><span lang=EN-US>WEB</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>容器的数据库连接池。使用方法：</span></p>

<p class=MsoNormal style='text-indent:18.0pt'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>生成对象</span></p>

<p class=MsoNormal style='text-indent:18.0pt'><span lang=EN-US>DataConnection
conn=new DataConnection();</span></p>

<p class=MsoNormal style='text-indent:18.0pt'><span lang=EN-US>conn.setConfigName(‘test’);
//</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>在</span><span lang=EN-US>EwaConnection.xml</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>中定义的名称</span></p>

<p class=MsoNormal style='text-indent:18.0pt'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>获取结果集</span></p>

<p class=MsoNormal style='text-indent:18.0pt'><span lang=EN-US>//</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>设置参数集合对象</span></p>

<p class=MsoNormal style='text-indent:18.0pt'><span lang=EN-US>conn.setRequestValue(requestValue);
</span></p>

<p class=MsoNormal style='text-indent:18.0pt'><span lang=EN-US>//</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>执行带参数查询命令</span></p>

<p class=MsoNormal style='text-indent:18.0pt'><span lang=EN-US>conn.executeQuery(</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>‘</span><span lang=EN-US>select * from users where uid=@uid</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>’</span><span lang=EN-US>)</span><span style='font-family:
宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>；</span>
</p>

<p class=MsoNormal style='text-indent:18.0pt'><span lang=EN-US>ResultSet
rs=null; //</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>结果集</span></p>

<p class=MsoNormal style='text-indent:18.0pt'><span lang=EN-US>if(conn.getErrorMsg()==null
|| conn.getErrorMsg().length==0){</span></p>

<p class=MsoNormal style='text-indent:18.0pt'><span lang=EN-US><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>rs=conn.getLastResult().getResultSet();
//</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>获取结果集</span></p>

<p class=MsoNormal style='text-indent:18.0pt'><span lang=EN-US><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>….</span></p>

<p class=MsoNormal style='text-indent:18.0pt'><span lang=EN-US>}</span></p>

<p class=MsoNormal style='text-indent:18.0pt'><span lang=EN-US>conn.close(); //</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>关闭连接</span></p>

<h2 style='margin-left:21.0pt;text-indent:-21.0pt;mso-list:l1 level1 lfo3;
tab-stops:list 21.0pt'><![if !supportLists]><span lang=EN-US style='mso-fareast-font-family:
Arial;mso-bidi-font-family:Arial'><span style='mso-list:Ignore'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
lang=EN-US>Log</span><span style='font-size:10.5pt;line-height:173%;font-family:
黑体;mso-ascii-font-family:Arial;font-weight:normal;mso-bidi-font-weight:bold'>（</span><span
lang=EN-US style='font-size:10.5pt;line-height:173%;font-weight:normal;
mso-bidi-font-weight:bold'>com.gdxsoft.easyweb.log.Log</span><span
style='font-size:10.5pt;line-height:173%;font-family:黑体;mso-ascii-font-family:
Arial;font-weight:normal;mso-bidi-font-weight:bold'>）</span></h2>

<p class=MsoNormal style='text-indent:18.0pt'><span lang=EN-US>Log</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>是记录日志的信息类，包括执行的配置文件（</span><span lang=EN-US>xmlname</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>），配置项（</span><span lang=EN-US>itemname</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>），调用的活动（</span><span lang=EN-US>Action</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>），日期，</span><span lang=EN-US>IP</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>，执行时间，日志描述信息等，在编写自定义类中调用。</span></p>

<h1 style='margin-left:21.0pt;text-indent:-21.0pt;mso-list:l2 level1 lfo4'><![if !supportLists]><span
lang=EN-US style='mso-bidi-font-family:宋体'><span style='mso-list:Ignore'>二、<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>权限说明</span></h1>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>页面权限可根据需要自行编写权限控制类，控制类需要根据</span><span
lang=EN-US>IAcl</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>接口派生（</span><span lang=EN-US>com.gdxsoft.easyweb.acl.IAcl</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）。</span></p>

<h2 style='margin-left:21.0pt;text-indent:-21.0pt;mso-list:l0 level1 lfo5;
tab-stops:list 21.0pt'><![if !supportLists]><span lang=EN-US style='mso-fareast-font-family:
Arial;mso-bidi-font-family:Arial'><span style='mso-list:Ignore'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
style='font-family:黑体;mso-ascii-font-family:Arial'>接口说明：</span></h2>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='margin-left:21.0pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=110 valign=top style='width:82.2pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><b
  style='mso-bidi-font-weight:normal'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>函数</span><span
  lang=EN-US><o:p></o:p></span></b></p>
  </td>
  <td width=122 valign=top style='width:91.2pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><b
  style='mso-bidi-font-weight:normal'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>说明</span><span
  lang=EN-US><o:p></o:p></span></b></p>
  </td>
  <td width=72 valign=top style='width:54.0pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><b
  style='mso-bidi-font-weight:normal'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>参数</span><span
  lang=EN-US><o:p></o:p></span></b></p>
  </td>
  <td width=96 valign=top style='width:72.0pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><b
  style='mso-bidi-font-weight:normal'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>返回值</span><span
  lang=EN-US><o:p></o:p></span></b></p>
  </td>
  <td width=141 valign=top style='width:105.7pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><b
  style='mso-bidi-font-weight:normal'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>备注</span><span
  lang=EN-US><o:p></o:p></span></b></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=110 valign=top style='width:82.2pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>canRun</span></p>
  </td>
  <td width=122 valign=top style='width:91.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>是否可继续执行</span></p>
  </td>
  <td width=72 valign=top style='width:54.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  </td>
  <td width=96 valign=top style='width:72.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>true/false</span></p>
  </td>
  <td width=141 valign=top style='width:105.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>如果</span><span lang=EN-US>true</span><span
  style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
  "Times New Roman"'>则继续执行，否则跳转到指定的页面</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=110 valign=top style='width:82.2pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>getGotoUrl</span></p>
  </td>
  <td width=122 valign=top style='width:91.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>获取跳转页面</span></p>
  </td>
  <td width=72 valign=top style='width:54.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  </td>
  <td width=96 valign=top style='width:72.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>String</span></p>
  </td>
  <td width=141 valign=top style='width:105.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>canRun</span><span style='font-family:
  宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>为</span><span
  lang=EN-US>false</span><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>时调用</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=110 valign=top style='width:82.2pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>setGotoUrl</span></p>
  </td>
  <td width=122 valign=top style='width:91.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>赋值跳转页面</span></p>
  </td>
  <td width=72 valign=top style='width:54.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  </td>
  <td width=96 valign=top style='width:72.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  </td>
  <td width=141 valign=top style='width:105.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>好像用处不大。</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4;mso-yfti-lastrow:yes'>
  <td width=110 valign=top style='width:82.2pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>getRequestValue</span></p>
  </td>
  <td width=122 valign=top style='width:91.2pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>获取参数值对象</span></p>
  </td>
  <td width=72 valign=top style='width:54.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  </td>
  <td width=96 valign=top style='width:72.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>RequestValue</span></p>
  </td>
  <td width=141 valign=top style='width:105.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>用于内部调用判断用</span></p>
  </td>
 </tr>
</table>

<h2 style='margin-left:21.0pt;text-indent:-21.0pt;mso-list:l0 level1 lfo5;
tab-stops:list 21.0pt'><![if !supportLists]><span lang=EN-US style='mso-fareast-font-family:
Arial;mso-bidi-font-family:Arial'><span style='mso-list:Ignore'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
style='font-family:黑体;mso-ascii-font-family:Arial'>编程说明</span></h2>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>用户在编写自定义</span><span
lang=EN-US>Acl</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>时，主要编写</span><span lang=EN-US>canRun</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>方法。基本思路是根据传递的参数来判别该模块是否当前用户可执行。如果不可执行，设置</span><span
lang=EN-US>getGotoUrl</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>获取的地址供系统调用。</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>使用方式是在配置项的</span><span
lang=EN-US>Page</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>参数表中设置</span><span lang=EN-US>Acl</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>参数，填写你自定义的类的全称，例如：“</span><span lang=EN-US style='font-size:
9.0pt;font-family:"Courier New"'>your.pakagename.MyAcl</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>”，系统会自动调用并执行。</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>举例说明，要点是注意两点，首先是判断是否允许执行，可从数据库，</span><span
lang=EN-US>session</span><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>或其他资源获取相应数据，其次根据参数设定不同的跳转地址。</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'>package your.pakagename;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'>import
com.gdxsoft.easyweb.script.RequestValue;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'>import com.gdxsoft.easyweb.acl.IAcl;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'>import com.gdxsoft.easyweb.datasource.DataConnection;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'>import com.gdxsoft.easyweb.datasource.Data.DTTable;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'>public class MyAcl implements
IAcl {<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>private String _XmlName;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>private String _ItemName;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>private RequestValue _RequestValue;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>private String _GoToUrl; //</span><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New"'>验证失败跳转页面</span><span
lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt'><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:9.0pt;
font-family:"Courier New";color:blue'>public boolean canRun() {<o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New";color:blue'><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:blue'>在</span><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'>session</span><span style='font-size:9.0pt;font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
mso-bidi-font-family:"Courier New";color:blue'>中保存了管理员编号</span><span
lang=EN-US style='font-size:9.0pt;font-family:"Courier New";color:blue'> ADM_ID<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New";color:blue'><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:blue'>在表</span><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'>USER_ACL</span><span style='font-size:9.0pt;font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
mso-bidi-font-family:"Courier New";color:blue'>保存了权限数据，字段</span><span
lang=EN-US style='font-size:9.0pt;font-family:"Courier New";color:blue'>ALLOW</span><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:blue'>表示是否可执行</span><span lang=EN-US style='font-size:9.0pt;font-family:
"Courier New";color:blue'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New";color:blue'><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>String
sql = ”SELECT ALLOW FROM USER_ACL WHERE ”<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New";color:blue'><span
style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>+
” USER_ID=@ADM_ID AND ITEM_NAME=@ITEMNAME ”<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New";color:blue'><span
style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>+
” AND XML_NAME=@XMLNAME”;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New";color:blue'><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:21.0pt'><span
lang=EN-US style='font-size:9.0pt;font-family:"Courier New";color:blue'>DataConnection
conn=new DataConnection();<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New";color:blue'><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cnn.setConfigName(‘test’);<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New";color:blue'><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:blue'>设置参数集合对象</span><span lang=EN-US style='font-size:9.0pt;font-family:
"Courier New";color:blue'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:21.0pt'><span
lang=EN-US style='font-size:9.0pt;font-family:"Courier New";color:blue'>conn.setRequestValue(this._RequestValue);
<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:21.0pt'><span
lang=EN-US style='font-size:9.0pt;font-family:"Courier New";color:blue'>//</span><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:blue'>执行带参数查询命令</span><span lang=EN-US style='font-size:9.0pt;font-family:
"Courier New";color:blue'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:21.0pt'><span
lang=EN-US style='font-size:9.0pt;font-family:"Courier New";color:blue'>conn.executeQuery(sql)</span><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:blue'>；</span><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'> <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:21.0pt'><span
lang=EN-US style='font-size:9.0pt;font-family:"Courier New";color:blue'>ResultSet
rs=null; //</span><span style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:blue'>结果集</span><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
text-indent:21.0pt'><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'>boolean isCanRun=false; //</span><span style='font-size:9.0pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
mso-bidi-font-family:"Courier New";color:blue'>返回值</span><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New";color:blue'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
text-indent:21.0pt'><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'>if(conn.getErrorMsg()==null || conn.getErrorMsg().length==0){<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
text-indent:21.0pt'><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>rs = conn.getLastResult().getResultSet();
//</span><span style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:blue'>获取结果集</span><span lang=EN-US style='font-size:9.0pt;font-family:
"Courier New";color:blue'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
text-indent:21.0pt'><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:blue'>使用</span><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'>DTTable</span><span style='font-size:9.0pt;font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
mso-bidi-font-family:"Courier New";color:blue'>获取</span><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New";color:blue'>rs</span><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:blue'>数据集</span><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:63.0pt;mso-para-margin-left:6.0gd;
text-indent:21.0pt'><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'>DTTable table = new DTTable();<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
text-indent:21.0pt'><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>table.initData(table);
<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
text-indent:21.0pt'><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>if(table.isOk()
&amp;&amp; table.getCount()&gt;0){<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
text-indent:21.0pt'><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:blue'>获取指定字段的值</span><span lang=EN-US style='font-size:9.0pt;font-family:
"Courier New";color:blue'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
text-indent:21.0pt'><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Object
o = table.getRow(0).getCell(“ALLOW”).getValue();<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
text-indent:21.0pt'><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(o!=null
&amp;&amp; o.toString().equals(“YES”)){<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
text-indent:21.0pt'><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>isCanRun=true;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:84.0pt;mso-para-margin-left:8.0gd;
text-indent:21.0pt'><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:63.0pt;mso-para-margin-left:6.0gd;
text-indent:21.0pt'><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;mso-para-margin-left:4.0gd;
text-indent:21.0pt'><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:21.0pt'><span
lang=EN-US style='font-size:9.0pt;font-family:"Courier New";color:blue'>conn.close();
//</span><span style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:
"Courier New";mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:blue'>关闭连接</span><span lang=EN-US style='font-size:9.0pt;font-family:
"Courier New";color:blue'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New";color:blue'><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(!isCanRun){<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New";color:blue'><span
style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:blue'>指向相应地址</span><span lang=EN-US style='font-size:9.0pt;font-family:
"Courier New";color:blue'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New";color:blue'><span
style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>String
xn=._RequestValue.getString(‘XMLNAME’).toLower();<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New";color:blue'><span
style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:blue'>根据</span><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'>XmlName</span><span style='font-size:9.0pt;font-family:宋体;
mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Courier New";
mso-bidi-font-family:"Courier New";color:blue'>判断，设置跳转地址</span><span
lang=EN-US style='font-size:9.0pt;font-family:"Courier New";color:blue'><o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New";color:blue'><span
style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(xn.indexOf(“|admin.xml”)&gt;){<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:21.0pt'><span
lang=EN-US style='font-size:9.0pt;font-family:"Courier New";color:blue'><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>this._ GoToUrl=”/messages/errors/deny.html”;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:21.0pt'><span
lang=EN-US style='font-size:9.0pt;font-family:"Courier New";color:blue'><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>}else{<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:21.0pt'><span
lang=EN-US style='font-size:9.0pt;font-family:"Courier New";color:blue'><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>this._
GoToUrl=”/messages/errors/user_deny.html”;<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:21.0pt'><span
lang=EN-US style='font-size:9.0pt;font-family:"Courier New";color:blue'><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:21.0pt'><span
lang=EN-US style='font-size:9.0pt;font-family:"Courier New";color:blue'>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:21.0pt'><span
lang=EN-US style='font-size:9.0pt;font-family:"Courier New";color:blue'>return isCanRun;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New";color:blue'><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New";color:blue'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt'><span
lang=EN-US style='font-size:9.0pt;font-family:"Courier New";color:blue'>//</span><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:blue'>赋值参数对象，类里要有对象接收</span><span lang=EN-US style='font-size:9.0pt;
font-family:"Courier New";color:blue'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt'><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:9.0pt;
font-family:"Courier New";color:blue'>public void setRequestValue(RequestValue
requestValue) {<o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>this._RequestValue
= requestValue;<o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New";color:blue'><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:blue'>获取跳转地址，注意要赋值</span><span style='font-size:9.0pt;font-family:"Courier New";
color:blue'> <span lang=EN-US>_GoToUrl<b style='mso-bidi-font-weight:normal'><o:p></o:p></b></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span><span style='color:blue'>public
String getGoToUrl() {<o:p></o:p></span></span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return
_GoToUrl;<o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:21.0pt'><b style='mso-bidi-font-weight:
normal'><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span></span></b><span
lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'>public
RequestValue getRequestValue() {<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return _RequestValue;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>public MyAcl() {<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>public MyAcl(String xmlName, String itemName) {<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>this._ItemName = itemName;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>this._XmlName = xmlName;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>public String getXmlName() {<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return _XmlName;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>public void setXmlName(String xmlName) {<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_XmlName = xmlName;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>public String getItemName() {<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return _ItemName;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>public void setItemName(String itemName) {<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_ItemName = itemName;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span><span style='color:blue'><o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>public void setGoToUrl(String goToUrl) {<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_GoToUrl = goToUrl;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'>}<o:p></o:p></span></p>

<h1 style='margin-left:21.0pt;text-indent:-21.0pt;mso-list:l2 level1 lfo4'><![if !supportLists]><span
lang=EN-US style='mso-bidi-font-family:宋体'><span style='mso-list:Ignore'>三、<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]><span style='font-family:宋体;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman"'>日志说明</span></h1>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>日志可根据需要自行编写日志记录类，控制类需要根据</span><span
lang=EN-US>ILog</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>接口派生（</span><span lang=EN-US>com.gdxsoft.easyweb.log.ILog</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>）。</span></p>

<h2 style='margin-left:21.0pt;text-indent:-21.0pt;mso-list:l3 level1 lfo6;
tab-stops:list 21.0pt'><![if !supportLists]><span lang=EN-US style='mso-fareast-font-family:
Arial;mso-bidi-font-family:Arial'><span style='mso-list:Ignore'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
style='font-family:黑体;mso-ascii-font-family:Arial'>接口说明：</span></h2>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='margin-left:21.0pt;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-yfti-tbllook:480;mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
 mso-border-insideh:.5pt solid windowtext;mso-border-insidev:.5pt solid windowtext'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=110 valign=top style='width:82.2pt;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><b
  style='mso-bidi-font-weight:normal'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>函数</span><span
  lang=EN-US><o:p></o:p></span></b></p>
  </td>
  <td width=98 valign=top style='width:73.2pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><b
  style='mso-bidi-font-weight:normal'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>说明</span><span
  lang=EN-US><o:p></o:p></span></b></p>
  </td>
  <td width=96 valign=top style='width:72.0pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><b
  style='mso-bidi-font-weight:normal'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>参数</span><span
  lang=EN-US><o:p></o:p></span></b></p>
  </td>
  <td width=72 valign=top style='width:54.0pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><b
  style='mso-bidi-font-weight:normal'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>返回值</span><span
  lang=EN-US><o:p></o:p></span></b></p>
  </td>
  <td width=165 valign=top style='width:123.7pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><b
  style='mso-bidi-font-weight:normal'><span style='font-family:宋体;mso-ascii-font-family:
  "Times New Roman";mso-hansi-font-family:"Times New Roman"'>备注</span><span
  lang=EN-US><o:p></o:p></span></b></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=110 valign=top style='width:82.2pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>write</span></p>
  </td>
  <td width=98 valign=top style='width:73.2pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>写日志</span></p>
  </td>
  <td width=96 valign=top style='width:72.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  </td>
  <td width=72 valign=top style='width:54.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  </td>
  <td width=165 valign=top style='width:123.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>主要编写部分</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=110 valign=top style='width:82.2pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>setLog</span></p>
  </td>
  <td width=98 valign=top style='width:73.2pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>赋值日志</span></p>
  </td>
  <td width=96 valign=top style='width:72.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>log </span><span style='font-family:宋体;
  mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>日志信息</span></p>
  </td>
  <td width=72 valign=top style='width:54.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  </td>
  <td width=165 valign=top style='width:123.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3;mso-yfti-lastrow:yes'>
  <td width=110 valign=top style='width:82.2pt;border:solid windowtext 1.0pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;mso-border-alt:solid windowtext .5pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>getLog</span></p>
  </td>
  <td width=98 valign=top style='width:73.2pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman"'>获取日志</span></p>
  </td>
  <td width=96 valign=top style='width:72.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  </td>
  <td width=72 valign=top style='width:54.0pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US>String</span></p>
  </td>
  <td width=165 valign=top style='width:123.7pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  mso-border-alt:solid windowtext .5pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>
  </td>
 </tr>
</table>

<h2 style='margin-left:21.0pt;text-indent:-21.0pt;mso-list:l3 level1 lfo6;
tab-stops:list 21.0pt'><![if !supportLists]><span lang=EN-US style='mso-fareast-font-family:
Arial;mso-bidi-font-family:Arial'><span style='mso-list:Ignore'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><![endif]><span
style='font-family:黑体;mso-ascii-font-family:Arial'>编程说明</span></h2>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>用户在编写自定义</span><span
lang=EN-US>Log</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>时，主要编写</span><span lang=EN-US>write</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>方法，作用是记录日志信息，无论是填写到数据库还是到文件用户需要自行编写。</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>使用方式是在配置项的</span><span
lang=EN-US>Page</span><span style='font-family:宋体;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman"'>参数表中设置</span><span lang=EN-US>Log</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>参数，填写你自定义的类的全称，例如：“</span><span lang=EN-US style='font-size:
9.0pt;font-family:"Courier New"'>your.pakagename.MyLog</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>”，同时，要在</span><span lang=EN-US>Action</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>参数表中的</span><span lang=EN-US>CallSet</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>部分填写记录日志的信息，例如“用户</span><span lang=EN-US>@username</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>调用</span><span lang=EN-US>@xmlname</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>的</span><span lang=EN-US>@ItemName</span><span
style='font-family:宋体;mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:
"Times New Roman"'>”，系统会自动调用并执行。</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span style='font-family:宋体;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman"'>举例说明。</span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'>package
your.pakagename;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'>import
com.gdxsoft.easyweb.datasource.DataConnection;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'>import
com.gdxsoft.easyweb.script.RequestValue;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'>public
class MyLog <span style='mso-spacerun:yes'>&nbsp;</span>implements ILog {<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'>private Log _Log;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>public void
Write() {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if
(super.getLog().getMsg() == null) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt'><span
lang=EN-US style='font-size:9.0pt;font-family:"Courier New";color:blue'>/*<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt'><span
lang=EN-US style='font-size:9.0pt;font-family:"Courier New";color:blue'>System.out.println(super.getLog().getXmlName()
+ &quot;, &quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>+
super.getLog().getItemName() + &quot;, &quot; + super.getLog().getMsg()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>+
&quot;, &quot; + super.getLog().getRunTime() + &quot;, &quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>+
super.getLog().getDate());<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt'><span
lang=EN-US style='font-size:9.0pt;font-family:"Courier New";color:blue'>*/<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>this.WriteToLog();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>/**<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;</span>* </span><span style='font-size:9.0pt;
font-family:宋体;mso-ascii-font-family:"Courier New";mso-hansi-font-family:"Times New Roman";
mso-bidi-font-family:"Courier New"'>参考定义自己的写入日志的方法</span><span lang=EN-US
style='font-size:9.0pt;font-family:"Courier New"'>, </span><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Courier New"'>下面的例子是个参考，是用于写入数据库的日志</span><span
lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;</span>* <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;</span>* CREATE TABLE LOG_MAIN( LOG_ID INT
IDENTITY, USER_ID INT, LOG_MSG<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;</span>* NVARCHAR(1000), LOG_TIME DATETIME,
LOG_IP VARCHAR(19), LOG_XMLNAME<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;</span>* VARCHAR(200), LOG_ITEMNAME
VARCHAR(244), LOG_RUNTIME INT, LOG_ACTION<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;</span>* VARCHAR(233), LOG_URL varchar(1500),
LOG_REFERER varchar(1500), LOG_DES<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;</span>* nvarchar(200) )<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;</span>*/<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>private
void WriteToLog() {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span><span style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Courier New";
color:blue'>根据自己的日志表结构生成写入日志的方法</span><span lang=EN-US style='font-size:9.0pt;
font-family:"Courier New";color:blue'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Log
log = super.getLog();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>String
sql = &quot;INSERT INTO LOG_MAIN(LOG_DES, LOG_MSG, LOG_TIME,&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>+
&quot; LOG_IP, LOG_XMLNAME, LOG_ITEMNAME, LOG_RUNTIME&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>+
&quot;, LOG_ACTION, LOG_URL, LOG_REFERER)&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>+
&quot; VALUES (@LOG_DES, @LOG_MSG, @LOG_TIME,&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>+
&quot; @LOG_IP, @LOG_XMLNAME, @LOG_ITEMNAME, @LOG_RUNTIME, &quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>+
&quot;@LOG_ACTION,<span style='mso-spacerun:yes'>&nbsp; </span>@LOG_URL,
@LOG_REFERER)&quot;;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>RequestValue
rv = new RequestValue();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>rv.addValue(&quot;LOG_DES&quot;,
log.getDescription());<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>rv.addValue(&quot;LOG_MSG&quot;,
log.getMsg());<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>rv.addValue(&quot;LOG_TIME&quot;,
log.getDate(), &quot;Date&quot;, 100);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>rv.addValue(&quot;LOG_IP&quot;,
log.getIp());<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>rv.addValue(&quot;LOG_XMLNAME&quot;,
log.getXmlName());<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>rv.addValue(&quot;LOG_ITEMNAME&quot;,
log.getItemName());<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>rv.addValue(&quot;LOG_RUNTIME&quot;,
log.getRunTime());<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>rv.addValue(&quot;LOG_ACTION&quot;,
log.getActionName());<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>rv.addValue(&quot;LOG_URL&quot;,
log.getUrl());<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>rv.addValue(&quot;LOG_REFERER&quot;,
log.getRefererUrl());<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DataConnection
cnn = new DataConnection();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cnn.setConfigName(‘test’)</span><span
style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Courier New";mso-bidi-font-family:"Courier New";
color:blue'>；</span><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>try
{<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span><span style='font-size:9.0pt;font-family:宋体;mso-ascii-font-family:"Courier New";
mso-hansi-font-family:"Times New Roman";mso-bidi-font-family:"Courier New";
color:blue'>设在日志的</span><span lang=EN-US style='font-size:9.0pt;font-family:
"Courier New";color:blue'> RequestValue<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cnn.setRequestValue(rv);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cnn.executeUpdate(sql);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}
catch (Exception e) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>System.err.println(e);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}
finally {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cnn.close();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New";
color:blue'><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>public Log getLog() {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return
_Log;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>public void setLog(Log log) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_Log
= log;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;font-family:"Courier New"'>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

</div>

</body>

</html>

/*
 Easy Web Application js lib
 guolei 
 https://gdxsoft.com/
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.checkStringArgs=function(a,b,d){if(null==a)throw new TypeError("The 'this' value for String.prototype."+d+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");return a+""};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,d){if(a==Array.prototype||a==Object.prototype)return a;a[b]=d.value;return a};
$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var d=a[b];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};
$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,b){var d=$jscomp.propertyToPolyfillSymbol[b];if(null==d)return a[b];d=a[d];return void 0!==d?d:a[b]};$jscomp.polyfill=function(a,b,d,e){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,d,e):$jscomp.polyfillUnisolated(a,b,d,e))};
$jscomp.polyfillUnisolated=function(a,b,d,e){d=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var g=a[e];if(!(g in d))return;d=d[g]}a=a[a.length-1];e=d[a];b=b(e);b!=e&&null!=b&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:b})};
$jscomp.polyfillIsolated=function(a,b,d,e){var g=a.split(".");a=1===g.length;e=g[0];e=!a&&e in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var h=0;h<g.length-1;h++){var k=g[h];if(!(k in e))return;e=e[k]}g=g[g.length-1];d=$jscomp.IS_SYMBOL_NATIVE&&"es6"===d?e[g]:null;b=b(d);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,g,{configurable:!0,writable:!0,value:b}):b!==d&&(void 0===$jscomp.propertyToPolyfillSymbol[g]&&(d=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[g]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(g):$jscomp.POLYFILL_PREFIX+d+"$"+g),$jscomp.defineProperty(e,$jscomp.propertyToPolyfillSymbol[g],{configurable:!0,writable:!0,value:b})))};$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(b,d){var e=$jscomp.checkStringArgs(this,b,"startsWith");b+="";var g=e.length,h=b.length;d=Math.max(0,Math.min(d|0,e.length));for(var k=0;k<h&&d<g;)if(e[d++]!=b[k++])return!1;return k>=h}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(a){return a?a:function(b,d){var e=$jscomp.checkStringArgs(this,b,"endsWith");b+="";void 0===d&&(d=e.length);d=Math.max(0,Math.min(d|0,e.length));for(var g=b.length;0<g&&0<d;)if(e[--d]!=b[--g])return!1;return 0>=g}},"es6","es3");$jscomp.findInternal=function(a,b,d){a instanceof String&&(a=String(a));for(var e=a.length,g=0;g<e;g++){var h=a[g];if(b.call(d,h,g,a))return{i:g,v:h}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(b,d){return $jscomp.findInternal(this,b,d).v}},"es6","es3");window.EWA=window.EWA||{VERSION:2.6,LANG:"zhcn",SHOW_ERROR:!0};if(!EWA.CP){EWA.__p=window.location.pathname;for(EWA.__inc=0;0==EWA.__p.indexOf("//")&&!(EWA.__p=EWA.__p.replace("//","/"),EWA.__inc++,100<EWA.__inc););EWA.CP="/"+EWA.__p.split("/")[1]+"/"}var userAgent=window.navigator.userAgent.toLowerCase();
EWA.B={VERSION:(userAgent.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],SAFAIR:/webkit/.test(userAgent),OPERA:/opera/.test(userAgent),IE:(/msie/.test(userAgent)||/traaaaaident/.test(userAgent))&&!/opera/.test(userAgent),MOZILLA:/mozilla/.test(userAgent)&&!/(compatible|webkit)/.test(userAgent),GOOGLE:/chrome/.test(userAgent),PAD:/ipad|iphone|android|mobile/.test(userAgent),IS_ANDROID:/android/.test(userAgent)};var EWA_Utils={};EWA.C={Utils:EWA_Utils,Ajax:EWA_AjaxClass,Xml:EWA_XmlClass,Url:EWA_UrlClass};
EWA_Utils.ShowPic=function(a){a=a.src;if(!(0<a.indexOf("pic_no.jpg"))){if(0<a.indexOf("$resized/")){var b=a.indexOf("$resized/");a=a.substring(0,b)}else a=a.replace("_SMAILL.","."),a=a.replace("small","a");window.open(a)}};
EWA_Utils.ShowBgPic=function(a){if(a=$(a).css("background-image")){a=a.slice(4,a.length-1);if(a.startsWith('"')||a.startsWith("'"))a=a.slice(1,a.length-1);0<a.indexOf("pic_no.jpg")||0<a.indexOf("transparent.png")||(a=a.replace("_SMAILL.",".").split("$resized")[0],a=a.replace("small","a"),window.open(a))}};EWA_Utils.RunCmd=function(a,b){"string"==typeof a?(b=a,EWA.LastMenuMsg=""):(b=a.getAttribute("EWA_CMD"),EWA.LastMenuMsg=GetInnerText(a).trimEx());null!=b&&0<b.trim().length&&eval(b)};
EWA_Utils.ReloadValidCodeImage=function(){for(var a=document.getElementsByTagName("IMG"),b=0;b<a.length;b+=1){var d=a[b];0<d.src.indexOf("/cgi-bin/_co_/")&&(d.src=d.src)}alert(_EWA_EVENT_MSG.ValidCodeError)};
EWA_Utils.JsRegisters=function(a){var b=/addEvent\([^\)]+\){1}/ig;a=a.match(/<[\s]*?script[^>]*?>[\s\S]*?<[\s]*?\/[\s]*?script[\s]*?>/ig);if(null!=a){for(var d=[],e=0;e<a.length;e++){var g=a[e];g=g.replace(/<[\s]*?script[^>]*?>/ig,"");g=g.replace(/<[\s]*?\/[\s]*?script[\s]*?>/ig,"");g=g.trim();if(0<g.length){try{EWA.C.Utils.JsRegister(g)}catch(n){alert(n)}try{var h=g.match(b);if(h)for(var k=0;k<h.length;k++){var l=h[k].split(",");if(3==l.length){var m=l[2].replace(")","");d.push(m)}}}catch(n){console.log(g)}}else g=
document.createElement("div"),g.innerHTML=a[e],g=g.getElementsByTagName("script")[0].src,EWA_Utils.JsRegisterSrc(g,!1)}for(e=0;e<d.length;e++)if(!(0<=d[e].indexOf("function")))try{eval(d[e]+"()")}catch(n){console.log(n)}}};EWA_Utils.JsRegisterSrc=function(a,b){var d="ewa_js_register_"+a.hashCode();if(!b||!$X(d)){b=document.getElementsByTagName("head")[0];var e=document.createElement("script");e.type="text/javascript";e.language="javascript";e.id=d;try{e.src=a,b.appendChild(e)}catch(g){alert(g)}}};
EWA_Utils.JsRegister=function(a){var b=document.getElementsByTagName("head")[0],d=document.createElement("script");d.type="text/javascript";d.language="javascript";try{d.text=a,b.appendChild(d)}catch(e){alert(e)}};
EWA_Utils.LazyBackgroundLoad=function(a,b){var d=b||("CSS1Compat"==document.compatMode?document.documentElement.clientHeight+document.documentElement.scrollTop:document.body.clientHeight+document.body.scrollTop)+50;(a||$(".EWA_GRID_BG_IMG[is_lazy_load=true]")).each(function(){var e=$(this);if(e.offset().top<d){e.removeAttr("is_lazy_load");var g=e.attr("ori_src");e.css("background-image",'url("'+g+'")')}})};
EWA_Utils.ImageAdjust=function(a,b,d){if(null!=b&&null!=d&&(b=parseInt(b.replace("px","")),d=parseInt(d.replace("px","")),!(null==a||0>=b||0>=d||isNaN(b)&&isNaN(d))))if(isNaN(b))a.height=d;else if(isNaN(d))a.width=b;else{var e=a.width,g=a.height;0!=e&&0!=g&&(b/=e,d/=g,b>d?(e*=d,g*=d):(e*=b,g*=b),0<e&&0<g&&(a.width=e,a.height=g))}};
EWA_Utils.tempId=function(a){this.__TMPIDS||(this.__TMPIDS={});for(var b=a||"__ewatmpid__",d=0;1E3>d;d++)if(a=b+Math.random(),a=a.replace(".","GdX"),!this.__TMPIDS[a])return this.__TMPIDS[a]=1,a;a=b+"\u6267\u884c1000\u6b21\u91cd\u590d\u7684\u7f16\u53f7";console.log("\u6267\u884c1000\u6b21\u91cd\u590d\u7684\u7f16\u53f7");return a};
function $F(a,b,d,e){a=a.getElementsByTagName(b);b=[];e=e.toUpperCase().trim().split(",");for(var g=0;g<a.length;g++){var h=a[g],k=h.getAttribute(d);if(null!=k&&""!=k){k=k.toUpperCase();for(var l=0;l<e.length;l++)k==e[l]&&b.push(h)}}return b}function $J2MAP(a,b,d){b=b.split(",");var e={};d=null==d?",":d;for(var g=0;g<a.length;g++){var h=a[g];if(h){for(var k=[],l=0;l<b.length;l++)k.push(h[b[l]]);e[k.join(d)]=h}}return e}
function $J2MAP1(a,b,d){b=b.split(",");var e={};d=null==d?",":d;for(var g=0;g<a.length;g++){var h=a[g];if(h){for(var k=[],l=0;l<b.length;l++){var m=b[l];k.push(h[m])}m=k.join(d);e[m]||(e[m]=[]);e[m].push(h)}}return e}
function GetOuterHTML(a){if(a.outerHTML)return a.outerHTML;var b=a.attributes,d=[];d.push("<"+a.tagName.toLowerCase());for(var e=0;e<b.length;e++){var g=b[e];if(g.specified){var h=g.value.replace(/"/ig,"&quot;");d.push(" "+g.name+'="'+h+'"')}}g=a.innerHTML;null==g&&(g="");d.push(">"+g+"</"+a.tagName.toLowerCase()+">");return d.join("")}function GetInnerText(a){return a.innerText||a.textContent||""}function SetInnerText(a,b){EWA.B.IE?a.innerText=b:a.textContent=b}
"undefined"==typeof document.readyState&&(EWA.B._T=window.setInterval(function(){EWA.CP&&(window.clearInterval(EWA.B._T),document.readyState="complete")},10));function UrlParas(){var a=GetUrlParas(),b=[],d;for(d in a){var e=d.toUpperCase();"XMLNAME"==e||"ITEMNAME"==e||0<=e.indexOf("EWA")||b.push(d+"="+a[d])}return b.join("&")}var $U=UrlParas;
function $U2(a,b,d,e){if(!a||!b)return alert("xmlname and itemname not blank"),"xmlname and itemname not blank";a=EWA.CP+"/EWA_STYLE/cgi-bin/?xmlname="+a+"&itemname="+b;d&&(a=0==d.indexOf("&")?a+d:a+("&"+d));e&&(a+="&"+$U());return a}function GetUrlParas(a){var b={},d=window.location.href.split("?");if(1==d.length)return b;d=d[1].split("&");for(var e=0;e<d.length;e++){var g=d[e].split("=");if(1!=g.length){var h=g[0];a&&(h=h.toUpperCase());b[h]=g[1]}}return b}
function GetTopWin(){for(var a=window,b=0;a!=a.parent;){a=a.parent;if(20<b)return null;b++}return a}function addEvent(a,b,d){a.attachEvent?a.attachEvent("on"+b,d):a.addEventListener(b,d,!1)}function AddEvent(a,b,d){addEvent(a,b,d)}String.prototype.lTrim=function(){return this.replace(/(^\s*)/g,"")};String.prototype.rTrim=function(){return this.replace(/(\s*$)/g,"")};String.prototype.trimEx=function(){return this.trim().replace(/(^\u3000*)|(\u3000*$)/g,"")};
String.prototype.startsWith||(String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")},String.prototype.startsWith=function(a){return null==a||this.length<a.length?!1:this==a||this.substring(0,a.length)==a?!0:!1},String.prototype.endsWith=function(a){return null==a||this.length<a.length?!1:this==a||this.substring(this.length-a.length)==a?!0:!1});String.prototype.toURL=function(){return encodeURIComponent(this)};
String.prototype.toInputValue=function(){return null==this||""==this?this:this.replace(/</ig,"&lt;").replace(/>/ig,"&gt;").replace(/"/ig,"&quot;")};String.prototype.unURL=function(){return decodeURIComponent(this)};
String.prototype.toMoney=function(){if(null==this||""==this)return this;var a=1*this;if(isNaN(a))return a;var b=(this+"").split(".");a=b[0];if(999>=1*a)return this;b=2==b.length?"."+b[1]:"";for(var d=a.length/3,e=0;e<d;e++){var g=a.substring(a.length-3);0<e&&(b=","+b);b=g+b;a=a.substring(0,a.length-3)}0<a.length&&(b=a+","+b);return b};String.prototype.hashCode=function(){for(var a=0,b=this.length,d=0;d<b;d++)a=31*a+this.charCodeAt(d),2147483647<a&&(a%=2147483648);return a};
Number.prototype.fm=function(a,b,d,e){a=isNaN(a=Math.abs(a))?2:a;b=void 0!==b?b:"";d=d||",";e=e||".";var g=this,h=0>g?"-":"",k=parseInt(g=Math.abs(+g||0).toFixed(a),10)+"",l=3<(l=k.length)?l%3:0;return b+h+(l?k.substr(0,l)+d:"")+k.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+d)+(a?e+Math.abs(g-k).toFixed(a).slice(2):"")};function $X(a){return document.getElementById(a)}
function $XUC(a,b){if(b){d=$('input[ucid="'+a+'"][ucuid="'+b+'"]');if(0<d.length)return d[0];d=$('select[ucid="'+a+'"][ucuid="'+b+'"]')}else{var d=$('input[ucid="'+a+'"]');if(0<d.length)return d[0];d=$('select[ucid="'+a+'"]')}return 0<d.length?d[0]:document.getElementById(a)}function $N(a){return document.getElementsByName(a)}function $T(a,b){null==b&&(b=document);return b.getElementsByTagName(a)}function T$(a,b){return $T(a,b)}
function $GMap(a){null!=a&&a instanceof Function?window.google?a():(EWA._____set_google_map||(setTimeout(function(){var b=document.createElement("script");b.src=EWA.RV_STATIC_PATH?EWA.RV_STATIC_PATH+"/EWA_STYLE/js/js_jquery/EWA_GOOGLE_MAP.js":"/EmpScriptV2/EWA_STYLE/js/js_jquery/EWA_GOOGLE_MAP.js";document.body.appendChild(b)},123),EWA._____set_google_map=!0),setTimeout(function(){$GMap(a)},100)):alert("\u9700\u8981\u4f20\u7edf\u52a0\u8f7d\u5b8c\u6210\u8c03\u7528\u65b9\u6cd5")}
function $JS_RUN_CHANGE(a){if(a&&a.onchange){var b=a.onchange.toString(),d=b.indexOf("{"),e=b.lastIndexOf("}");b=b.substring(d+1,e);d="OBJ_"+Math.random();d=d.replace(".","GdX");window[d]=a;b=b.replace(/this/ig,d);try{eval(b)}catch(g){console.log(b),document.title=g}window[d]=null;delete window[d]}}
function EWA_AjaxClass(a){this.ResutValue=this._Http=null;this._WaittingId="EWA_AJAX_WAITING";this.LoadingType="text";this._Parameters={};this._ParentId=null;this.IsShowWaitting=!0;this._RunEndTime=null;this._IsAsync=(this._IsAsync=a)?!0:!1;this._ShowWaitting=function(){if(this.IsShowWaitting){var b=document.getElementById(this._WaittingId);null==b?("text"==this.LoadingType.trim().toLowerCase()&&this._CreateWaittingText(),"image"==this.LoadingType.trim().toLowerCase()&&this._CreateWaittingImg()):
b.style.display=""}};this._CreateWaittingText=function(){var b=document.createElement("DIV");b.id=this._WaittingId;b.innerHTML="Waiting...";document.body.appendChild(b);b.className="ewa-wait-txt"};this._CreateWaittingImg=function(){var b=document.createElement("TABLE");b.id=this._WaittingId;var d=b.insertRow(-1).insertCell(-1);d.align="center";d.innerHTML="<img src='"+this._getLoaddingImg()+"'>";document.body.appendChild(b);b.className="ewa-wait-img"};this.HiddenWaitting=function(){var b=document.getElementById(this._WaittingId);
null!=b&&(b.style.display="none")};this._InitHttp=function(){this._Http=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");if(null==window._EWA_AJAX_LIST||200<window._EWA_AJAX_LIST.length)window._EWA_AJAX_LIST=[];window._EWA_AJAX_LIST.push(this)};this.Get=function(b,d){null==b?console.log("ajax url not null"):(b.GetUrl?b=b.GetUrl():b.getUrl?b=b.getUrl():b.href&&(b=b.href),0<=b.indexOf("|")&&(b=b.replace(/\|/ig,"%7c")),this._Http.onreadystatechange=d,b.endsWith(".txt")||
b.endsWith(".TXT")||(b=0<b.indexOf("?")?b+"&___R="+Math.random():b+"?___R="+Math.random()),b=b.replace("&&","&"),b=b.replace("?&","?"),0==EWA.B.IE?(this._Http.open("GET",b,!this._IsAsync),this._Http.send(null)):(this._Http.open("GET",b,!this._IsAsync),this._Http.send()),this._IsAsync||this._ShowWaitting())};this.Post=function(b,d,e){null==b?console.log("ajax url not null"):(b.href&&(b=b.href),0<=b.indexOf("|")&&(b=b.replace(/\|/ig,"%7c")),this._ShowWaitting(),null!=e&&(this._Http.onreadystatechange=
e),b=b.replace("&&","&"),b=b.replace("?&","?"),this._Http.open("POST",b,!this._IsAsync),this._Http.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this._Http.send(d),this._IsAsync||this._ShowWaitting())};this.PostNew=function(b,d){var e=[],g;for(g in this._Parameters){var h=this._Parameters[g];null!=h&&e.push(g+"="+h)}this.Post(b,e.join("&"),d)};this.GetReturnValue=function(){return this._Http.responseText};this.AddParameter=function(b,d,e){this._Parameters[b]=e?d:encodeURIComponent(d)};
this._InitHttp();this._getLoaddingImg=function(){return(EWA.RV_STATIC_PATH||"/EmpScriptV2")+"/EWA_STYLE/images/loading4.gif"};this.Install=function(b,d,e,g,h){var k=this,l="string"==typeof e?$X(e):e;if(null==l)alert("Object ["+e+"] not found");else{var m=$(l),n=null;h||(n=m.css("position"),"static"==n&&m.css("position","relative"),m.append("<div class='ewa-ajax-install-waitting'></div>"));this.Post(b,d,function(){if(k.IsRunEnd()){"static"==n&&m.css("position",n);var p=k.GetRst();if(k.IsError())$(l)[0].innerHTML=
p;else{$(l)[0].innerHTML=p;try{EWA.C.Utils.JsRegisters(p)}catch(q){console.log(q)}}null!=g&&g(b,d,e,p)}});this.HiddenWaitting()}};this.IsRunEnd=function(){if(4!=this._Http.readyState)return!1;this.HiddenWaitting();this._RunEndTime||(this._RunEndTime=(new Date).getTime());window.setTimeout(function(){for(var b=window._EWA_AJAX_LIST.length-1;0<=b;b--){var d=window._EWA_AJAX_LIST[b];if(null!=d&&1231<d.GetEndPastTime()){try{d.Dispose()}catch(e){}window._EWA_AJAX_LIST[b]=null}}},1);return!0};this.Dispose=
function(){this._Http=null};this.GetEndPastTime=function(){return this._RunEndTime?(new Date).getTime()-this._RunEndTime:-1};this.IsError=function(){return 200==this._Http.status?!1:!0};this.GetRst=function(){return this.IsRunEnd()?this.IsError()?this._Http.statusText:this._Http.responseText:null}}function $JA(a,b){for(var d=new EWA_AjaxClass(!0),e=[],g=2;g<arguments.length;g++)e.push(arguments[g]);d.Get(a,function(){_$J_HandleRst(d,b,e,!0)});return d}
function $J2A(a,b){for(var d=new EWA_AjaxClass(!0),e=[],g=2;g<arguments.length;g++)e.push(arguments[g]);d.Get(a,function(){_$J_HandleRst(d,b,e,!1)});return d}function $JPA(a,b,d){for(var e=new EWA_AjaxClass(!0),g=[],h=3;h<arguments.length;h++)g.push(arguments[h]);if(b)for(var k in b)e.AddParameter(k,b[k]);e.PostNew(a,function(){_$J_HandleRst(e,d,g,!0)});return e}function $J(a,b){for(var d=[],e=2;e<arguments.length;e++)d.push(arguments[e]);return __$J(!1,a,b,d,!0)}
function $J1(a,b){for(var d=[],e=2;e<arguments.length;e++)d.push(arguments[e]);return __$J(!1,a,b,d,!0,!0)}function $J2(a,b){new EWA_AjaxClass;for(var d=[],e=2;e<arguments.length;e++)d.push(arguments[e]);return __$J(!1,a,b,d,!1,!1)}function $J3(a,b){new EWA_AjaxClass;for(var d=[],e=2;e<arguments.length;e++)d.push(arguments[e]);return __$J(!1,a,b,d,!1,!0)}function $JP1(a,b,d,e,g,h,k,l,m){$JP(a,b,d,e,g,h,k,l,m).HiddenWaitting()}
function $JP(a,b,d){for(var e=new EWA_AjaxClass,g=[],h=3;h<arguments.length;h++)g.push(arguments[h]);if(b)for(var k in b)e.AddParameter(k,b[k]);e.PostNew(a,function(){_$J_HandleRst(e,d,g,!0)});return e}function $JP2(a,b,d){for(var e=new EWA_AjaxClass,g=[],h=2;h<arguments.length;h++)g.push(arguments[h]);if(b)for(var k in b)e.AddParameter(k,b[k]);e.PostNew(a,function(){_$J_HandleRst(e,d,g,!1)});return e}
function __$J(a,b,d,e,g,h){var k=new EWA_AjaxClass(a);k.Get(b,function(){_$J_HandleRst(k,d,e,g)});h&&k.HiddenWaitting();return k}
function _$J_HandleRst(a,b,d,e){if(a.IsRunEnd())if(a.IsError())window.EWA_AjaxErr&&window.EWA_AjaxErr(a.GetRst());else{a=a.GetRst();if(e)try{a=eval("var _zz="+a+"; _zz")}catch(m){console.log("_$J_HandleRst-JSON"+m);return}if(null==b)alert("\u5bf9\u8c61\u6ca1\u6709\u53d1\u73b0");else if(b instanceof Function||"function"==typeof b)b(a,d);else if("string"==typeof b)$X(b);else if("SELECT"==b.tagName)if(e)if(2>d.length)alert("\u53c2\u6570\u4e0d\u8db3\uff0c\u9700\u8981textName,valueName\u7684\u5b9a\u4e49");
else{e=d[0];var g=d[1],h=!0;2<d.length&&(h=d[2]);var k="";3<d.length&&(k=d[3]);var l=null;4<d.length&&(l=d[4]);_$J_SELECT(a,b,e,g,h,k,l)}else alert("SELECT\u9700\u8981\u6620\u5c04\u4e3aJSON");else console.log("not define callback")}}
function _$J_SELECT(a,b,d,e,g,h,k,l){function m(v,y){if(!y)return"not defined textName";if(y instanceof Function)return y[v];if(-1==y.indexOf("@@"))return v[y];for(var x=y.match(/@@[a-zA-Z0-9\-\._:]*\b/ig),z=0;z<x.length;z++){var A=x[z],B=A.replace("@@","");y=y.replace(A,v[B]||"")}return y}function n(v,y){var x=m(v,d),z=b.options[b.options.length]=new Option(x,v[e]);if(y){for(var A=[],B=0;B<y;B++)A.push("");A.push(x);A.join("\u3000")}for(var D in v)v[D]&&z.setAttribute("para_"+D.toLowerCase(),v[D]);
z.setAttribute("json",JSON.stringify(v));return z}b.options.length=0;g&&(b.options[0]=new Option("",""),g instanceof Array&&(b.options[0].text=g[0],b.options[0].value=g[1]));if(l){var p=function(v,y){if((v=q[v])&&v._children&&0!=v._children.length)for(var x,z=0;z<v._children.length;z++)x=v._children[z],n(x,y),p(x[e],y+1)},q={___ROOT___:[]};g={___ROOT___:{}};for(var t,u,r,w=0;w<a.length;w++){r=a[w];t=r[l];u=r[e];if(null===t||""===t||"0"===t)t="___ROOT___";q[t]||(q[t]=[]);q[t].push(r);g[u]=r;g[t]&&
(g[t]._children||(g[t]._children=[]),g[t]._children.push(r))}p("___ROOT___",0)}else for(w=0;w<a.length;w++)r=a[w],n(r);h&&(b.value=h);$(b).trigger("change");k&&k(b)}$Install=function(a,b,d,e){var g=new EWA_UrlClass;g.SetUrl(a);g.GetParameter("EWA_AJAX")||(a=g.AddParameter("EWA_AJAX","INSTALL"));(new EWA_AjaxClass).Install(a,"",b,d,e)};
function EWA_JSONXmlClass(){this._JSon=new EWA_JSONClass;this.toJSON=function(a){return this.createNode(a)};this.createNode=function(a){var b=[];b.push(this._JSon.ToJSONString(a.tagName));b.push(": {");for(var d=0;d<a.attributes.length;d++){var e=this.createAttribute(a.attributes[d]);0<d&&b.push(",");b.push(e)}for(d=0;d<a.childNodes.length;d++)(0<d||0<a.attributes.length)&&b.push(",\r\n"),b.push(this.createNode(a.childNodes[d]));b.push("}");return b.join(" ")};this.createAttribute=function(a){var b=
[];b.push(this._JSon.ToJSONString(a.name));b.push(":");b.push(this._JSon.ToJSONString(a.value));return b.join(" ")}}
function EWA_JSONClass(){this._Escapeable=/["\\\x00-\x1f\x7f-\x9f]/g;this._Meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};this.ToJSONDate=function(a){return null==a?"null":a.getUTCFullYear()+"-"+f(a.getUTCMonth()+1)+"-"+f(a.getUTCDate())+"T"+f(a.getUTCHours())+":"+f(a.getUTCMinutes())+":"+f(a.getUTCSeconds())+"Z"};this.ToJSONString=function(a){return'"'+(this._Escapeable.test(a)?a.replace(escapeable,function(b){var d=meta[b];if("string"===typeof d)return d;d=b.charCodeAt();
return"\\u00"+Math.floor(d/16).toString(16)+(d%16).toString(16)}):a)+'"'};this.ToJSONArray=function(a){for(var b=a.length,d=[],e=0;e<b;e+=1)d[e]=this.ToJSON(a[e]);return 0===d.length?"[]":"["+d.join(", ")+"]"};this.ToJSONObject=function(a){var b,d=[];for(b in a){var e=a[b];if(!("parent"==b||"_"==b.substring(0,1)||null==e||e instanceof Function)){var g=this.ToJSONString(b)+": ",h=typeof e;"string"===h||"number"===h||"boolean"===h||e instanceof Date?d.push(g+this.ToJSON(e)):"object"===h&&d.push(g+this.ToJSON(e))}}return 0===
d.length?"{}":"{"+d.join(", ")+"}"};this.ToJSON=function(a){var b=typeof a;if(a instanceof Date)return this.ToJSONDate(a);if("string"===b)return this.ToJSONString(a);if("number"===b)return isFinite(a)?String(a):"null";if("boolean"===b||"null"===b)return String(a);if("object"===b)return"number"!==typeof a.length||a.propertyIsEnumerable("length")?this.ToJSONObject(a):this.ToJSONArray(a)};this.Parse=function(a){return eval("("+a+")")}}
JSON=window.JSON||function(){function a(m){return 10>m?"0"+m:m}function b(m){return e.test(m)?'"'+m.replace(e,function(n){var p=k[n];if("string"===typeof p)return p;p=n.charCodeAt();return"\\u00"+Math.floor(p/16).toString(16)+(p%16).toString(16)})+'"':'"'+m+'"'}function d(m,n){var p=g;(n=n[m])&&"object"===typeof n&&"function"===typeof n.toJSON&&(n=n.toJSON(m));switch(typeof n){case "string":return b(n);case "number":return isFinite(n)?String(n):"null";case "boolean":case "null":return String(n);case "object":if(!n)return"null";
g+=h;var q=[];if("number"===typeof n.length&&!n.propertyIsEnumerable("length")){var t=n.length;for(m=0;m<t;m+=1)q[m]=d(m,n)||"null";var u=0===q.length?"[]":g?"[\n"+g+q.join(",\n"+g)+"\n"+p+"]":"["+q.join(",")+"]";g=p;return u}if("object"===typeof l)for(t=l.length,m=0;m<t;m+=1){var r=l[m];"string"===typeof r&&(u=d(r,n,l))&&q.push(b(r)+(g?": ":":")+u)}else for(r in n)(u=d(r,n,l))&&q.push(b(r)+(g?": ":":")+u);u=0===q.length?"{}":g?"{\n"+g+q.join(",\n"+g)+"\n"+p+"}":"{"+q.join(",")+"}";g=p;return u}}
Date.prototype.toJSON=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z"};var e=/["\\\x00-\x1f\x7f-\x9f]/g,g,h,k={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;return{stringify:function(m,n,p){var q;h=g="";if(p)if("number"===typeof p)for(q=0;q<p;q+=1)h+=" ";else"string"===typeof p&&(h=p);if(n)if("function"===typeof n||"object"===typeof n&&
"number"===typeof n.length)l=n;else throw Error("JSON.stringify");else l=function(t,u){if(Object.hasOwnProperty.call(this,t))return u};return d("",{"":m})},parse:function(m,n){function p(q,t){var u,r=q[t];if(r&&"object"===typeof r)for(u in r)if(Object.hasOwnProperty.call(r,u)){var w=p(r,u);void 0!==w?r[u]=w:delete r[u]}return n.call(q,t,r)}if(/^[\],:{}\s]*$/.test(m.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,
"")))return m=eval("("+m+")"),"function"===typeof n?p({"":m},""):m;throw new SyntaxError("JSON.parse");},quote:b}}();EWA.JSON=JSON;
function EWA_DateClass(a){this._Date=a?a instanceof Date?a:EWA_Utils.Date(a)._Date:new Date;this._Days=[31,28,31,30,31,30,31,31,30,31,30,31];this.PastMilliseconds=function(b){return b._Date-this._Date};this.PastSeconds=function(b){return this.PastMilliseconds(b)/1E3};this.GetYear=function(){return this._Date.getFullYear()};this.GetMonth=function(){return this._Date.getMonth()+1};this.GetDay=function(){return this._Date.getDate()};this.GetBenYear=function(){var b=this.GetYear();return[b+"-01-01",b+
"-12-31"]};this.GetBenMonth=function(){var b=this.GetYear(),d=this.GetMonth(),e=this._Days[d-1];2==d&&(0==(b-1992)%4&&0!=(b-1900)%100||0==(b-2E3)%400)&&(e=29);10>d&&(d="0"+d);10>e&&(e="0"+e);return[b+"-"+d+"-01",b+"-"+d+"-"+e]};this.GetBenWeek=function(b){var d=this._Date.getDay(),e=this.GetDay();b?(b=d,d=6-d):(b=d-1,d=7-d);var g=this.Clone();g.setDate(e-b);b=this.Clone();b.setDate(e+d);return[this.GetDateString(g),this.GetDateString(b)]};this.GetBenQ=function(){var b=this.GetMonth();if(3>=b){var d=
1;b=3}else 6>=b?(d=4,b=6):9>=b?(d=7,b=9):(d=10,b=12);var e=this.GetYear();d=this.CreateDate(e,d,1);b=this.CreateDate(e,b,this._Days[b-1]);return[this.GetDateString(d),this.GetDateString(b)]};this.GetDateString=function(b){return this.FormatDateTime(null,b)};this.GetDateTimeString=function(b){return this.FormatDate(null,b)};this.Clone=function(){return this.CreateDate(this.GetYear(),this.GetMonth(),this.GetDay())};this.AddDays=function(b){var d=this._Date.getDate();this._Date.setDate(d+1*b);return this.GetDateString()};
this.AddDaysFt=function(b,d){var e=this._Date.getDate();this._Date.setDate(e+1*b);return this.FormatDate(d)};this.CreateDate=function(b,d,e,g,h,k){var l=new Date;null==g&&(g=0);null==h&&(h=0);null==k&&(k=0);l.setDate(1);l.setFullYear(b);l.setMonth(d-1);l.setDate(e);l.setHours(g);l.setMinutes(h);l.setSeconds(k);l.setMilliseconds(0);return l};this.SetDate=function(b,d,e,g,h,k){this._Date=null==d?EWA_Utils.Date(b)._Date:this.CreateDate(b,d,e,g,h,k)};this.GetWeekName=function(){return _EWA_G_SETTINGS.WEEKS.split(",")[this._Date.getDay()]};
this.FormatDate=function(b,d){!b&&_EWA_G_SETTINGS&&_EWA_G_SETTINGS.DATE&&(b=_EWA_G_SETTINGS.DATE);b||(b="yyyy-MM-dd");var e=d||this._Date,g=d=e.getMonth()+1,h=e.getDate();10>g&&(g="0"+d);10>h&&(h="0"+h);e=e.getFullYear();var k,l="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");"MM/dd/yyyy"==b?k=g+"/"+h+"/"+e:"dd/MM/yyyy"==b?k=h+"/"+g+"/"+e:"yyyy-MM-dd"==b?k=e+"-"+g+"-"+h:"MM/dd"==b?k=g+"/"+h+"/"+e:"dd/MM"==b?k=h+"/"+g+"/"+e:"MM-dd"==b?k=g+"-"+h:"MMM dd"==b?k=l[d-1]+" "+h:"dd-MMM"==b?k=
h+"-"+l[d-1]:"ddMMM"==b?k=h+l[d-1]:"MMMdd"==b?k=l[d-1]+h:"MM\u6708dd\u65e5"==b?k=d+h+"\u65e5":"yyyyMMdd"==b&&(k=e+""+g+h);return k};this.FormatDateTime=function(b,d){return this.FormatDate(b,d)+" "+this.GetTimeStr(d)};this.GetTimeStr=function(b){var d=b||this._Date;b=d.getHours();var e=d.getMinutes();d=d.getSeconds();return(10>b?"0":"")+b+":"+(10>e?"0":"")+e+":"+(10>d?"0":"")+d};this.GetDateDiff=function(b){var d=this._Date;b=b?b instanceof Date?b:b instanceof EWA_DateClass?b._Date:EWA_Utils.Date(b)._Date:
new Date;d=d.getTime();b=b.getTime();return((d-b)/864E5).toFixed(0)}}
EWA_Utils.Date=function(a){if(!a)return new EWA_DateClass;var b=a,d="";if(0<a.indexOf(" ")){var e=a.split(" ");b=e[0];d=e[1]}if(8==a.length)b=a.substring(0,4),e=a.substring(4,6),a=a.substring(6,8);else{if(0<b.indexOf("/")){var g=b.split("/");b=g[2];_EWA_G_SETTINGS&&"MM/dd/yyyy"==_EWA_G_SETTINGS.DATE?(e=g[0],a=g[1]):(e=g[1],a=g[0])}else g=b.split("-"),b=g[0],e=g[1],a=g[2];var h=g=0,k=0;0<d.length&&(d=d.split(":"),h=d[0],g=d[1],2<d.length&&(k=d[2]))}d=new EWA_DateClass;d.SetDate(b,e,a,h,g,k);return d};
function EWA_XmlClass(){this.XmlDoc=null;this.LoadXmlFile=function(a){this._InitXmlDoc();this.XmlDoc.load(a)};this.LoadXml=function(a){EWA.B.IE&&!EWA.B.MOZILLA?(this._InitXmlDoc(),this.XmlDoc?this.XmlDoc.loadXML(a):alert("xml is null")):(this.XmlDoc=null,this.XmlDoc=(new DOMParser).parseFromString(a,"text/xml"))};this.GetXml=function(a){null==a&&(a=this.XmlDoc);return EWA.B.IE?a.xml:(new XMLSerializer).serializeToString(a)};this.GetAttributeValue=function(a,b,d){return this.GetElement(a,d).getAttribute(b)};
this.GetElementText=function(a){if(null!=a&&0<a.childNodes.length){for(var b="",d=0;d<a.childNodes.length;d++)b+=a.childNodes[d].nodeValue;return b}return null};this.GetElementAttribute=function(a,b){return a.getAttribute(b)};this.GetText=function(a,b){a=this.GetElement(a,b);return this.GetElementText(a)};this.GetElements=function(a,b){a=a.split("/");var d=null==b?this.XmlDoc:b;for(b=0;b<a.length-1;b+=1){d=d.getElementsByTagName(a[b]);if(null==d||0==d.length)return null;d=d[0]}return null==d||0==
d.length?null:d.getElementsByTagName(a[a.length-1])};this.GetElement=function(a,b){a=this.GetElements(a,b);return null==a?null:a[0]};this.SetAttribute=function(a,b,d){null==b?d.setAttribute(a,""):d.setAttribute(a,b)};this.GetOrCreateElement=function(a,b){a=a.split("/");b=null==b?this.XmlDoc:b;for(var d=0;d<a.length;d+=1){var e=b.getElementsByTagName(a[d]);b=null==e||0==e.length?this.NewChild(a[d],b):e[0]}return b};this.NewChild=function(a,b){a=this.XmlDoc.createElement(a);b.appendChild(a);return a};
this.NewChilds=function(a,b){a=a.split("/");for(var d=0;d<a.length;d++)b=this.NewChild(a[d].trim(),b);return b};this.SetText=function(a,b){b.text=a};this.AppendText=function(a,b){a=this.XmlDoc.createTextNode(a);b.appendChild(a)};this.SetCData=function(a,b){null!=a&&(a=this.XmlDoc.createCDATASection(a),b.appendChild(a))};this._InitXmlDoc=function(){if(!this.XmlDoc){if(EWA.B.IE)for(var a=["MSXML4.DOMDocument","MSXML3.DOMDocument","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XmlDom"],b=0;b<a.length;b++){try{this.XmlDoc=
new ActiveXObject(a[b])}catch(d){this.XmlDoc=null}if(null!=this.XmlDoc)break}if(!this.XmlDoc)try{this.XmlDoc=document.implementation.createDocument("","doc",null)}catch(d){}if(this.XmlDoc)try{this.XmlDoc.async=!1}catch(d){}else alert("XML init failed")}};this._InitXmlDoc()}
function EWA_UrlClass(a){this._URL="";this._Paras={};this._Root="";this.SetUrl=function(b){this._URL=b=null==b?window.location.href:b.href?b.href:b.toString();this._Paras={};this._Root=b.split("?")[0];if(!(0>b.indexOf("?"))){b=b.split("?")[1].split("&");for(var d=0;d<b.length;d++){var e=b[d].split("=");2==e.length?this._Paras[e[0].toUpperCase()]=e[1]:this._Paras[e[0].toUpperCase()]=""}}};this.RemoveEwa=function(){for(var b in this._Paras){var d=b.toLowerCase();if("xmlname"==d||"itemname"==d||0==d.indexOf("ewa_"))this._Paras[b]=
null}return this.GetUrl()};this.GetParameter=function(b){return this._Paras[b.toUpperCase().trim()]};this.GetParas=function(b){var d=[],e;for(e in this._Paras){var g=this._Paras[e];b&&(e=e.toLowerCase());e&&null!=g&&d.push(e+"="+g)}return d.join("&")};this.SetRoot=function(b){this._Root=b};this.GetUrl=function(b){b=this.GetParas(b);var d="";0<b.length&&(d=0<=this._Root.indexOf("?")?"&":"?");return this._Root+d+b};this.AddParameter=function(b,d,e){b=b.toUpperCase().trim();this._Paras[b]=e?d:encodeURIComponent(d);
return this.GetUrl()};this.RemoveParameter=function(b){b=b.toUpperCase().trim();this._Paras[b]=null;return this.GetUrl()};this.SetUrl(a||window.location.href)}
function EWA_TanslatorCalss(){this.SKIP_EXISTS=!0;this.transAll=function(a,b,d,e){this.idx_ok=this.idx=0;null==a?alert("\u5bf9\u8c61objs_ch\u4e0d\u80fd\u4e3a\u7a7a"):(this._objs_ch=a,this._objs_en=b,this._transCompleteCallback=e,this._transCompleteItemCallBack=d,this.start_trans("en"))};this.transAllToCn=function(a,b,d,e){this.idx_ok=this.idx=0;null==a?alert("\u5bf9\u8c61objs_ch\u4e0d\u80fd\u4e3a\u7a7a"):(this._objs_ch=a,this._objs_en=b,this._transCompleteCallback=e,this._transCompleteItemCallBack=
d,this.start_trans("cn"))};this.start_trans=function(a){if(this.idx<=this._objs_ch.length-1){var b=this._objs_ch[this.idx],d=null;if(this._objs_en&&(d=this._objs_en[this.idx],this.SKIP_EXISTS&&this.get_text(d))){this.idx++;this.start_trans(a);return}this.idx++;this.trans_item(b,d,a);var e=this;setTimeout(function(){e.start_trans(a)},123)}};this.trans_item=function(a,b,d){var e=this;null==this.trans&&(this.trans=new EWA_TransClass,this.trans.transAfter=function(g,h){e.idx_ok++;e.call_item_callback(h,
g);e.check_complete()});"cn"==d?this.trans.TransToCn(this.get_text(a),b):this.trans.TransToEn(this.get_text(a),b)};this.get_text=function(a){if("string"==typeof a)var b=a;else{var d=a.tagName;null==d&&(d="");d=d.toUpperCase();"SELECT"==d||"INPUT"==d||"TEXTAREA"==d?b=a.value:""!=d?b=a.innerHTML:(console.log("trans_err"),console.log(a))}return b||""};this.call_item_callback=function(a,b){this._transCompleteItemCallBack&&this._transCompleteItemCallBack(a,b)};this.check_complete=function(){return this._objs_ch.length==
this.idx_ok?($Tip("\u7ffb\u8bd1\u5b8c\u6210"),this._transCompleteCallback&&this._transCompleteCallback(),!0):!1}}
function EWA_TransClass(){this._Id=("EWA_UT_TRANS"+Math.random()).replace(".","_");window[this._Id]=this;this._IDX=0;this.IsRun=!1;this.TransToEn=function(a,b){this.transToEn(a,b)};this.transToEn=function(a,b){null==a||""==a.trim()?b instanceof Function&&b(null):(this.IsRun=!0,"azure"==this.transProvider?this._trans_azure(a,b,!0):"bing"==this.transProvider?this._trans_bing(a,b,!0):"youdao"==this.transProvider?this._trans_youdao(a,b):console.log("\u6ca1\u6709\u6307\u5b9a\u7ffb\u8bd1\u5f15\u64ce"))};
this.TransToCn=function(a,b){this.transToCn(a,b)};this.transToCn=function(a,b){null==a||""==a.trim()?b instanceof Function&&b(null):(this.IsRun=!0,"azure"==this.transProvider?this._trans_azure(a,b,!1):"bing"==this.transProvider?this._trans_bing(a,b,!1):"youdao"==this.transProvider?this._trans_youdao(a,b):console.log("\u6ca1\u6709\u6307\u5b9a\u7ffb\u8bd1\u5f15\u64ce"))};this._trans_azure=function(a,b,d){var e=this;a={url:this.azureTansCfg.url+(d?"&from=zh-Hans&to=en":"&from=en&to=zh-Hans"),headers:{"Content-Type":"application/json;charset=utf8",
"Ocp-Apim-Subscription-Key":this.azureTansCfg.key,"Ocp-Apim-Subscription-Region":this.azureTansCfg.location},data:JSON.stringify([{text:a}]),type:"POST",success:function(g){0==g.length?$Tip("No result"):(e.transBackCallCommon(g[0].translations[0].text,b),delete window[this._Id])},error:function(g){e.IsRun=!1;$Tip(g.responseText)}};$.ajax(a)};this._trans_youdao=function(a,b){var d=this._get_func_name(),e=d+"AAAAA",g=this.transback_youdao_tmp.toString().replace("transback_youdao_tmp",""),h=this._get_user_func_str(d,
e);g=g.replace("{","{"+h);eval("window."+d+"="+g);window[e]=b;b=document.createElement("script");a=a.replace(/\n/ig,"[GDX]").replace(/\r/ig,"");a=this.youdaoTrans+"&callback="+d+"&q="+a.toURL();b.src=a;document.getElementsByTagName("head")[0].appendChild(b)};this._trans_bing=function(a,b,d){var e=this._get_func_name(),g=e+"AAAAA",h=this.transback_bing_tmp.toString().replace("trans_en_back_bing_tmp",""),k=this._get_user_func_str(e,g);h=h.replace("{","{"+k);eval("window."+e+"="+h);window[g]=b;b=document.createElement("script");
e=this.bingTrans+"&oncomplete="+e;e=d?e+("&from=zh-CHS&to=en&text="+a.toURL()):e+("&from=en&to=zh-CHS&text="+a.toURL());b.src=e;document.getElementsByTagName("head")[0].appendChild(b)};this._get_user_func_str=function(a,b){return"var fromClass=window['"+this._Id+"'];\n var func=window['"+b+"']; \n var _fname='"+a+"'; \n var _fname1='"+b+"'; \n "};this._get_func_name=function(){this._IDX++;return"___GDX_T_"+this._IDX};this.transback_bing_tmp=function(a){try{fromClass.transBackCallCommon(a,func)}catch(b){console.log(b)}delete window[_fname1];
delete window[_fname]};this.transback_youdao_tmp=function(a){try{if(a&&a.errorCode){console.log(a);func instanceof Function&&func("\u7ffb\u8bd1\u5f15\u64ce\u9519\u8bef");return}if(a&&a.translation&&0<a.translation.length)a=a.translation[0];else{func instanceof Function&&func(a);console.log(a);return}fromClass.transBackCallCommon(a,func)}catch(b){console.log(b)}delete window[_fname1];delete window[_fname]};this.transBackCallCommon=function(a,b){this.IsRun=!1;if(null==b)console.log(a);else if(b instanceof
Function)b(a);else{"string"==typeof b&&(b=document.getElementById(b));var d=b.tagName;null==d&&(d="");d=d.toUpperCase();if("SELECT"==d||"INPUT"==d||"TEXTAREA"==d){b.value=a;b.setAttribute("ewa_trans_end","ok");if(null!=b.onblur)b.onblur();"TEXTAREA"==d&&window.autosize&&autosize.update&&autosize.update(b)}else"DIV"==d||"SPAN"==d?"DIV"==d&&$(b).attr("EWA_DHTML")?($(b).find("iframe")[0].contentWindow.frames[0].document.body.innerHTML=a,$(b).find("input[type=hidden]")[0].value=a):(b.setAttribute("ewa_trans_end",
"ok"),b.innerHTML=a):console.log(a)}this.transAfter&&this.transAfter(a,b,this)}}window.EWA_UT_TRANS=EWA_TransClass;EWA_TransClass.prototype.transProvider="azure";EWA_TransClass.prototype.azureTansCfg={url:"https://api.cognitive.microsofttranslator.com/translate?api-version=3.0",key:"f436c44286474b5eaa928d8b3f251972",location:"EastAsia"};EWA_TransClass.prototype.bingTrans="//api.microsofttranslator.com/V2/Ajax.svc/Translate?appid=50F7C8D4BC00A6E047C046D012F334DEC61FA003";
EWA_TransClass.prototype.youdaoTrans="//fanyi.youdao.com/openapi.do?keyfrom=wwwoneworldcc&key=1597375709&type=data&doctype=jsonp&version=1.1";
EWA_ImageCalss={defaultRatio:.7,resize:function(a,b,d,e,g){b=a.naturalWidth/b;d=a.naturalHeight/d;d=b>d?b:d;b=a.naturalWidth/d;d=a.naturalHeight/d;e=e?e:"image/jpeg";g=g||this.defaultRatio;if(isNaN(g)||1<g)g=this.defaultRatio;var h=document.createElement("canvas");h.width=b;h.height=d;ctx1=h.getContext("2d");ctx1.drawImage(a,0,0,a.naturalWidth,a.naturalHeight,0,0,h.width,h.height);return h.toDataURL(e,g)},dataURItoBlob:function(a){var b=a.split(",");a=b[0].match(/:(.*?);/)[1];b=window.atob(b[1]);
for(var d=new Uint8Array(b.length),e=0;e<b.length;e++)d[e]=b.charCodeAt(e);return new Blob([d],{type:a})},resizeAsBlob:function(a,b,d,e,g){a=this.resize(a,b,d,e,g);return this.dataURItoBlob(a)}};
function EWA_WebSocketClass(a){this.connected=this.inited=!1;this.socket=null;this.cbs={};this.cbs_length=0;this.handleBroadMsgs={};this.handleOnReconnected={};this.handleOnOffline={};this.url=a;this.init=function(b,d){this.inited=!0;this.open(b);this.debug=d};this.registerHandleBroadMsg=function(b,d){this.handleBroadMsgs[b]=d};this.unRegisterHandleBroadMsg=function(b){this.handleBroadMsgs[b]=null};this.registerOnReconnected=function(b,d){this.handleOnReconnected[b]=d};this.unRegisterOnReconnected=
function(b){this.handleOnReconnected[b]=null};this.registerOnOffline=function(b,d){this.handleOnOffline[b]=d};this.unRegisterOnOffline=function(b){this.handleOnOffline[b]=null};this.send=function(b,d){if(!this.connected)return console.log("\u672a\u8fde\u63a5"),!1;this.debug&&console.debug(b,d);this.socket.send(JSON.stringify(b));d&&(this.cbs[b.ID]=d,this.cbs_length++);return!0};this.closeWebSocket=function(){this.socket.close()};this.tryClearCbs=function(){if(200<this.cbs_length)this.cbs={},this.cbs_length=
0,this.debug&&console.debug("tryClearCbs\uff1a\u8d85\u8fc7200\uff0c\u5f3a\u5236\u6e05\u7a7a");else{for(var b in this.cbs)if(null!=this.cbs[b])return;this.debug&&console.debug("tryClearCbs\uff1a\u6e05\u7a7a"+this.cbs_length);this.cbs={};this.cbs_length=0}};this.onMessage=function(b){try{var d=JSON.parse(b.data);if(d.ID&&this.cbs[d.ID]){var e=this.cbs[d.ID];if(e){this.debug&&(console.debug("\u6267\u884c\u56de\u8c03\u65b9\u6cd5"),console.debug(d.ID,e));try{e(d,b)}catch(g){console.log(b),console.log(e),
console.log(g)}this.cbs[d.ID]=null;10<this.cbs_length&&this.tryClearCbs()}}else if(d.BROADCAST_ID&&this.handleBroadMsgs[d.BROADCAST_ID]&&(e=this.handleBroadMsgs[d.BROADCAST_ID])){this.debug&&(console.debug("\u6267\u884c\u5e7f\u64ad\u6d88\u606f\u56de\u8c03\u7684\u65b9\u6cd5"),console.debug(e));try{e(d,b)}catch(g){console.log(b),console.log(e),console.log(g)}}}catch(g){console.log(b),console.log(g)}};this.onOpen=function(b,d){var e=this;e.connected=!0;if(d)d();else for(var g in e.handleOnReconnected){b=
e.handleOnReconnected[g];e.debug&&console.debug(g,b);try{b&&b(this,event)}catch(h){console.error(g),console.error(b),console.error(h)}}window.onbeforeunload=function(){e.CLOSED_ON_QUIT=!0;e.socket.close()};e._Attempts=0;e._maxTimeout=0};this.onError=function(b){};this.onClose=function(b){var d=this;if(d.connected)for(var e in d.handleOnOffline){var g=d.handleOnOffline[e];try{g&&g(this,b)}catch(h){console.error(e),console.error(g),console.error(h)}}d.connected=!1;d.CLOSED_ON_QUIT?console.log("closed"):
(d._Attempts?d._Attempts++:d._Attempts=0,0==d._maxTimeout?(b=555*Math.pow(1.1,d._Attempts),3E3<b&&(b=3210,d._maxTimeout=b)):b=d._maxTimeout,setTimeout(function(){d.open()},b))};this.open=function(b){var d=new WebSocket(this.url),e=this;d.onerror=function(g){e.debug&&console.debug(g);e.onError(g)};d.onopen=function(g){e.debug&&console.debug(g);e.onOpen(g,b)};d.onmessage=function(g){e.debug&&console.debug(g);e.onMessage(g)};d.onclose=function(g){e.debug&&console.debug(g);e.onClose(g)};this.socket=d}}
function EWA_AddEvent(a,b){if(!top.EWA||!top.EWA.MQE){var d=new EWA_MqeListenerClass;d.CheckId=a;d.FuncName=b;top.EWA.MQE.AddListener(d)}}function EWA_MqeClass(){this.Data=this.Type=this.FromId=null;this.Paras=GetUrlParas(!0);this.IsServer=!1}function EWA_MqeListenerClass(){this.Win=window;this.FuncName=this.CheckId=null;this.Paras=GetUrlParas(!0);this.LastMsg=null;this.LastResult=!1}
function EWA_MqeManagerClass(){this._Listeners=[];this.UrlServer=null;this.LastTimer=-1;this.Stop=!1;this.AddListener=function(a){this._Listeners.push(a)};this.AddMqe=function(a){window.status=a.FromId+","+a.Type;for(var b=0;b<this._Listeners.length;b++){var d=this._Listeners[b];if(null!=d)for(var e=d.CheckId.split(","),g=0;g<e.length;g++)if(a.FromId==e[g]){var h=this._DoEvent(d,a);!0===h?this._Listeners[b].LastResult=!0:null===h?this._Listeners[b]=null:(this._Listeners[b].LastMsg=h,this._Listeners[b].LastResult=
!1)}}};this._DoEvent=function(a,b){try{var d=eval("w."+a.FuncName);d(b.Type,b.Paras,b.IsServer);return!0}catch(e){return e}};this.CreateServer=function(a,b){var d=new EWA_UrlClass;d.SetUrl(a);d.AddParameter("UNID",b);this.UrlServer=d.GetUrl()};this._GetEvents=function(){var a=new EWA_AjaxClass,b=EWA.MQE,d=b.UrlServer+"&T="+b.LastTimer;a.IsShowWaitting=!1;a.Get(d,function(){if(a.IsRunEnd()){var e=a.GetRst();a.IsError()?window.EWA_AjaxErr&&window.EWA_AjaxErr(e):(e=e.trim(),b.ParseMsg(e),b.Mon())}})};
this.Mon=function(){if(!(0<userAgent.indexOf("ipad")||0<userAgent.indexOf("iphone"))){var a=EWA.MQE;void 0!=a.RunStopParaName&&(a.Stop=!eval("window."+a.RunStopParaName));a.Stop?window.setTimeout(a.Mon,1250):window.setTimeout(a._GetEvents,1250)}};this.ParseMsg=function(a){try{eval("evts="+a)}catch(e){this.Stop=!0;return}if(!(void 0).E)this.Stop=!0;else if(!((void 0).T<this.LastTimer)&&(this.LastTimer=(void 0).T,0!=(void 0).V.length)){var b={};for(a=(void 0).V.length-1;0<=a;a--){var d=(void 0).V[a];
d=d.ID+"--GDX--"+d.TP+"---GDX---"+d.V;b[d]||(b[d]=!0)}for(a=0;a<(void 0).V.length;a++)d=(void 0).V[a],null!=d&&(eval("m1="+d.V),b=new EWA_MqeClass,b.FromId=d.ID,b.Type=d.TP,b.Paras=void 0,b.IsServer=!0,this.AddMqe(b))}}}function EWA_MqeCreate(a,b,d){null==b||0==b.trim().length?alert("unid is blank"):(EWA.MQE=new EWA_MqeManagerClass,EWA.MQE.CreateServer(a,b),void 0!=d&&(EWA.MQE.RunStopParaName=d),EWA.MQE.Mon())}"undefined"==typeof EWA&&(EWA={});EWA.UI=EWA.UI||{};
EWA.UI.Postion=function(a){if(null==a)return null;var b=a,d;var e=d=0;do e+=1*b.offsetLeft,d+=1*b.offsetTop,"DIV"==b.tagName&&(e-=b.scrollLeft,d-=b.scrollTop),b=b.offsetParent;while(null!=b&&"BODY"!=b.tagName&&"HTML"!=b.tagName);b=d+1*a.offsetHeight;return{X:e,Y:b,Left:e,Top:d,Width:a.offsetWidth,Height:a.offsetHeight,Right:e+a.offsetWidth,Bottom:b}};
var EWA$UI$COMMON$Move={OnMouseDown:function(a,b,d,e,g){a.setAttribute("D",1);b=EWA$UI$COMMON.Move._Event(a,b);d=EWA$UI$COMMON.Move._EventXY(b);if(null==e||e)a.setAttribute("X",d.X),a.setAttribute("SX",d.X);if(null==g||g)a.setAttribute("Y",d.Y),a.setAttribute("SY",d.Y);"undefined"!=typeof b.preventDefault&&b.preventDefault();"undefined"!=typeof b.stopPropagation?b.stopPropagation():b.cancelBubble=!0},OnMouseUp:function(a){a.setAttribute("D",0)},OnMouseOut:function(a){"1"==a.getAttribute("D")&&a.setAttribute("D",
0)},OnMouseMove:function(a,b){if("1"==a.getAttribute("D")){b=EWA$UI$COMMON.Move._Event(a,b);var d=EWA$UI$COMMON.Move._EventXY(b);if(null!=a.getAttribute("X")){var e=1*a.getAttribute("X");e=d.X-e;a.style.left=1*a.style.left.replace("px","")+e+"px";a.setAttribute("X",d.X)}null!=a.getAttribute("Y")&&(e=1*a.getAttribute("Y"),e=d.Y-e,a.style.top=1*a.style.top.replace("px","")+e+"px",a.setAttribute("Y",d.Y));"undefined"!=typeof b.preventDefault&&b.preventDefault();"undefined"!=typeof b.stopPropagation?
b.stopPropagation():b.cancelBubble=!0}},_Event:function(a,b){return b?b:a.ownerDocument.parentWindow.event},_EventXY:function(a){return EWA.B.IE?{X:a.x,Y:a.y}:{X:a.pageX,Y:a.pageY}}},EWA$UI$COMMON={Move:EWA$UI$COMMON$Move,GetMousePosition:function(a){null==a&&(a=event);return EWA.B.IE?{X:a.x,Y:a.y}:{X:a.pageX,Y:a.pageY}},CreateObject:function(a,b,d,e){a=a.document.createElement(b);null!=d&&0<d.trim().length&&(EWA.B.IE?a.style.cssText=d:a.setAttribute("style",d));null!=e&&e.appendChild(a);return a},
SetStyle:function(a,b){EWA.B.IE?a.style.cssText=b:a.setAttribute("style",b)},GetPosition:function(a){var b=a,d;var e=d=0;do e+=1*b.offsetLeft,d+=1*b.offsetTop,"DIV"==b.tagName&&(e-=b.scrollLeft,d-=b.scrollTop),b=b.offsetParent;while(null!=b&&"BODY"!=b.tagName&&"HTML"!=b.tagName);d+=1*a.offsetHeight;return{X:e,Y:d}},Dispose:function(a){if(EWA.B.IE){if(null!=a.attributes)for(var b=0;b<a.attributes.length;b+=1)null!=a.attributes[b]&&"function"==typeof a.attributes[b]&&(a.attributes[b]=null);for(b=0;b<
a.childNodes.length;b+=1)EWA$UI$COMMON.Dispose(a.childNodes[b])}},Drop:function(a){EWA$UI$COMMON.Dispose(a);a.parentNode.removeChild(a)},AniExpand:function(a,b,d,e,g){if(null==e||0>=e)e=10;var h=0,k=b/(1*e),l=d/(1*e),m=a.clientWidth+b,n=a.clientHeight+d,p=window.setInterval(function(){var q=EWA$UI$COMMON.GetObjSize(a);if(h<e-1){var t=q.H+l,u=q.W+k;t>n&&(t=n);u>m&&(u=m);EWA$UI$COMMON.SetSize(a,u,t)}else EWA$UI$COMMON.SetSize(a,m,n);u=EWA$UI$COMMON.GetObjSize(a);t=u.W-q.W;u=u.H-q.H;q=EWA$UI$COMMON.GetPosition(a);
q.Y=q.Y-a.clientHeight-1*a.style.borderTopWidth.replace("px","")-1*a.style.borderBottomWidth.replace("px","");"LEFT_TOP"!=g&&("LEFT_BOTTOM"==g?(u=q.Y-u,t=q.X,EWA$UI$COMMON.MoveTo(a,t,u)):"RIGHT_TOP"==g?(u=q.Y,t=q.X-t,EWA$UI$COMMON.MoveTo(a,t,u)):"RIGHT_BOTTOM"==g?(u=q.Y-u,t=q.X-t,EWA$UI$COMMON.MoveTo(a,t,u)):(u=1*q.Y-u/2,t=1*q.X-t/2,EWA$UI$COMMON.MoveTo(a,t,u),EWA._TmpAniObj=a));h++;h>=e&&(window.clearInterval(p),EWA.UI.Utils.AniExpandCompleateFunction&&(EWA.UI.Utils.AniExpandCompleateFunction(),
EWA.UI.Utils.AniExpandCompleateFunction=null))},12)},AniExpandTo:function(a,b,d,e,g){if(null==e||0>=e)e=10;var h=EWA$UI$COMMON.GetObjSize(a);this.AniExpand(a,b-h.W,d-h.H,e,g)},SetSize:function(a,b,d){a.style.width=b+"px";a.style.height=d+"px"},MoveTo:function(a,b,d){a.style.left=b+"px";a.style.top=d+"px"},MoveCenter:function(a){var b=this._GetOwnerWindow(a),d=this.GetObjSize(a);b=this.GetDocSize(b);this.MoveTo(a,(b.W-d.W)/2,(b.H-d.H)/2)},GetObjSize:function(a){return{H:a.clientHeight,W:a.clientWidth}},
GetDocSize:function(a){null==a&&(a=window);var b=a.document;return{W:b.body.clientWidth,H:"CSS1Compat"==b.compatMode?b.documentElement.clientHeight:b.body.clientHeight,SH:a.document.body.scrollTop,SW:a.document.body.scrollLeft}},_GetOwnerWindow:function(a){return EWA.B.IE?a.ownerDocument.parentWindow:a.ownerDocument.defaultView}};EWA.UI.Utils=EWA$UI$COMMON;EWA.UI.ImgResize=function(a,b,d){};
function EWA_ChkIframeOk(a,b){var d=a.contentWindow;d.location&&"about:blank"!=d.location.href&&d.document&&"complete"==d.document.readyState?b&&b(d,a):setTimeout(function(){EWA_ChkIframeOk(a,b)},111)}
EWA.UI.Utils.FadeIn=function(a,b,d,e,g){a!=b&&(b.setAttribute("alpha",100),a.style.display="",a.style.zIndex=-1E3,a.style.filter="Alpha(Opacity=100)",a.style.opacity=1,b.style.zIndex=1E3,b.style.display="",b.style.filter="Alpha(Opacity=100)",b.style.opacity=1,EWA.UI.Utils.FADE_IN_OBJ=a,EWA.UI.Utils.FADE_OUT_OBJ=b,EWA.UI.Utils.FADE_STEP=d,EWA.UI.Utils.FADE_TIME_SPAN=e,EWA.UI.Utils.FADE_AFTER=g,window.setTimeout(EWA.UI.Utils.FadeInTimer,EWA.UI.Utils.FADE_TIME_SPAN))};
EWA.UI.Utils.FadeInTimer=function(){try{var a=1*EWA.UI.Utils.FADE_OUT_OBJ.getAttribute("alpha")-EWA.UI.Utils.FADE_STEP;EWA.UI.Utils.FADE_OUT_OBJ.setAttribute("alpha",a);if(0>=a){EWA.UI.Utils.FADE_OUT_OBJ.style.display="none";EWA.UI.Utils.FADE_OUT_OBJ.setAttribute("alpha",0);EWA.UI.Utils.FADE_OUT_OBJ.style.filter="Alpha(Opacity=100)";EWA.UI.Utils.FADE_OUT_OBJ.style.opacity=1;EWA.UI.Utils.FADE_AFTER.ChangeAfter();EWA.UI.Utils.FADE_IN_OBJ=null;EWA.UI.Utils.FADE_OUT_OBJ=null;EWA.UI.Utils.FADE_STEP=null;
EWA.UI.Utils.FADE_TIME_SPAN=null;EWA.UI.Utils.FADE_AFTER=null;return}EWA.UI.Utils.FADE_OUT_OBJ.style.filter="Alpha(Opacity="+a+")";EWA.UI.Utils.FADE_OUT_OBJ.style.opacity=1*a/100}catch(b){}window.setTimeout(EWA.UI.Utils.FadeInTimer,EWA.UI.Utils.FADE_TIME_SPAN)};
function EWA_UI_ExcelClass(){this._Tb=null;this._HeaderRowSize=1;this._ClassName="";this._LeftColSize=1;this._ScrollParent=this._LeftHeader=this._DivLeft=this._DivTop=this._Height=this._Left=this._Top=null;this.Init=function(a,b,d,e,g){this._Tb=a;var h=$(a).offset();this._Top=h.top;this._Left=h.left;this._Height=$(a).parent()[0].clientHeight;this._HeaderRowSize=b;this._LeftColSize=d;this._ClassName=e;this._ScrollParent=g||document.body;this._Create()};this._Create=function(){var a=this._Tb,b=a.cloneNode(!0);
b.removeAttribute("onmouseout");b.removeAttribute("onmousedown");b.removeAttribute("onmouseover");$(b).css("width",$(a).width());for(var d=b.rows.length-1;d>=this._HeaderRowSize;d--)b.deleteRow(d);for(var e=0;e<this._HeaderRowSize;e++){var g=b.rows[e],h=a.rows[e];for(d=0;d<g.cells.length;d++){var k=h.cells[d];$(g.cells[d]).css("width",$(k).width())}}this._DivTop=document.createElement("div");this._DivTop.id="tb_header_con"+this._ClassName;d={position:"fixed",display:"none",top:0,left:this._Left+0,
overflow:"hidden"};$(this._DivTop).css(d);$(this._DivTop).append(b);$(this._Tb).parent().append(this._DivTop);this._LeftHeader=this._Left+0;b=a.cloneNode(!0);b.removeAttribute("onmouseout");b.removeAttribute("onmousedown");b.removeAttribute("onmouseover");$(b).find("td").attr("id",null);a=a.rows[0].cells[0].offsetWidth+2;this._DivLeft=document.createElement("div");this._DivLeft.id="tb_sidebar_con"+this._ClassName;this._DivLeft.appendChild(b);this._DivLeft.style.position="fixed";this._DivLeft.style.top=
this._Top+"px";this._DivLeft.style.left=this._Left+"px";this._DivLeft.style.overflow="hidden";this._DivLeft.style.width=a+"px";this._DivLeft.style.height=this._Height+"px";$(this._Tb).parent().append(this._DivLeft);var l=this;try{this._ScrollParent.onscroll=function(){try{l.OnScroll()}catch(m){console.log(m)}}}catch(m){console.log(m)}console.log(this._ScrollParent.onscroll)};this.OnScroll=function(){this._ScrollParent.scrollTop>this._Top&&(this._ScrollParent.scrollTop<this._Top+this._Height||this._ScrollParent!=
document.body)?(this._DivTop.style.display="",$(this._DivTop).css({left:this._LeftHeader-this._ScrollParent.scrollLeft})):this._DivTop.style.display="none";$(this._DivLeft).css({top:this._Top-this._ScrollParent.scrollTop,height:this._Height+this._ScrollParent.scrollTop})}}
EWA.UI.Move=function(){this._BackgroundObjectList=[];this._MoveObjectList=[];this._MaxIndex=199999;this.IsMoveY=this.IsMoveX=!0;this.MoveStep=1;this.Init=function(a){addEvent(document.body,"mousedown",function(b){a.OnMouseDown(b)});addEvent(document.body,"mousemove",function(b){a.OnMouseMove(b)});addEvent(document.body,"mouseup",function(b){a.OnMouseUp(b)});EWA_COMMON_MV_OBJECT=null};this.AddBackgroundObjs=function(a){for(var b=0;b<a.length;b++)this.AddBackgroundObj(a[b])};this.ReCalcBackgroundObjs=
function(){for(var a=0;a<this._BackgroundObjectList.length;a++){var b=this._BackgroundObjectList[a],d=EWA.UI.Utils.GetPosition(b.obj),e=EWA.UI.Utils.GetObjSize(b.obj);b.x0=d.X;b.x1=d.X+e.W;b.y0=d.Y-e.H;b.y1=d.Y}};this.AddBackgroundObj=function(a){var b=EWA.UI.Utils.GetPosition(a),d=EWA.UI.Utils.GetObjSize(a);this._BackgroundObjectList.push({x0:b.X,x1:b.X+d.W,y0:b.Y-d.H,y1:b.Y,obj:a})};this.CheckBackgroundObj=function(a,b){for(var d in this._BackgroundObjectList){var e=this._BackgroundObjectList[d];
if(e.x0<=a&&e.x1>=a&&e.y0<=b&&e.y1>=b)return e}};this.ClearLastBackgroundObj=function(){this.LastCheckedBackground&&(this.LastCheckedBackground.obj.style.backgroundColor=this.LastCheckedBackground.obj.getAttribute("_mv_last_bc"),this.LastCheckedBackground=null)};this.ClearAll=function(){for(var a=0;a<this._MoveObjectList.length;a++){var b=this._MoveObjectList[a];b.B.parentNode&&b.B.parentNode.removeChild(b.B)}this._MoveObjectList=[]};this.AddMoveObject=function(a,b,d,e,g,h){a.setAttribute("ewa_move",
1);a.setAttribute("ewa_move_type","MOVE");e=null==e?null:EWA.UI.Postion(e);this._MoveObjectList.push({A:a,B:b,JS:d,T:"MOVE",MOVE_X:!0,MOVE_Y:!0,L:e,JSM:g,JS_MOUSE_DOWN:h})};this.AddMoveObjectX=function(a,b,d,e,g,h){a.setAttribute("ewa_move",1);a.setAttribute("ewa_move_type","MOVE");e=null==e?null:EWA.UI.Postion(e);this._MoveObjectList.push({A:a,B:b,JS:d,T:"MOVE",MOVE_X:!0,MOVE_Y:!1,L:e,JSM:g,JS_MOUSE_DOWN:h})};this.AddMoveObjectY=function(a,b,d,e,g,h){a.setAttribute("ewa_move",1);a.setAttribute("ewa_move_type",
"MOVE");e=null==e?null:EWA.UI.Postion(e);this._MoveObjectList.push({A:a,B:b,JS:d,T:"MOVE",MOVE_X:!1,MOVE_Y:!0,L:e,JSM:g,JS_MOUSE_DOWN:h})};this.AddSizeObject=function(a,b,d,e,g,h,k){a.setAttribute("ewa_move",1);a.setAttribute("ewa_move_type","SIZE");b.style.width=b.clientWidth+"px";e=null==e?null:EWA.UI.Postion(e);g=g?EWA.UI.Postion(b):null;this._MoveObjectList.push({A:a,B:b,JS:d,T:"SIZE",L:e,M:g,JSM:h,JS_MOUSE_DOWN:k})};this.OnMouseDown=function(a){var b=this._GetEventTarget(a);null!=b&&(b=this._GetObject(b),
null!=b&&"1"==b.A.getAttribute("ewa_move")&&(a=this._GetEventXY(a),this._MaxIndex++,b.B.style.zIndex=this._MaxIndex,b.B.setAttribute("_EWA_MOUSE_DOWN",1),b.B.setAttribute("_EWA_MOUSE_X",a.X),b.B.setAttribute("_EWA_MOUSE_Y",a.Y),"absolute"!=$(b.B).css("position")&&(a=$(b.B).position(),b.B.style.position="absolute",b.B.style.left=a.left+"px",b.B.style.top=a.top+"px"),EWA_COMMON_MV_OBJECT=b,this.ReCalcBackgroundObjs(),b.JS_MOUSE_DOWN&&b.JS_MOUSE_DOWN(b)))};this.OnMouseMove=function(a){if(null!=EWA_COMMON_MV_OBJECT){var b=
EWA_COMMON_MV_OBJECT,d=b.B;if("1"==d.getAttribute("_EWA_MOUSE_DOWN")){a=this._GetEventXY(a);var e=1*d.getAttribute("_EWA_MOUSE_X"),g=1*d.getAttribute("_EWA_MOUSE_Y"),h=a.X-e,k=a.Y-g;if(!(Math.abs(h)<this.MoveStep&&Math.abs(k)<this.MoveStep)){g=b.L;e=1*$(d).css("left").replace("px","")+h;var l=1*$(d).css("top").replace("px","")+k;if("MOVE"==b.T)null==g?(0>e&&(e=0),0>l&&(l=0)):(h=d.offsetWidth,k=d.offsetHeight,e<g.Left?e=g.Left:e+h>g.Right&&(e=g.Right-h),h=g.Right-(e+h),l<g.Top?l=g.Top:l+k>g.Bottom&&
(l=g.Bottom-k),g=g.Bottom-(l+k),d.setAttribute("ewa_mv_left",e.fm(0)),d.setAttribute("ewa_mv_top",l.fm(0)),d.setAttribute("ewa_mv_bottom",g.fm(0)),d.setAttribute("ewa_mv_right",h.fm(0))),this.IsMoveX&&b.MOVE_X&&(d.style.left=e+"px"),this.IsMoveY&&b.MOVE_Y&&(d.style.top=l+"px");else{var m=1*d.style.width.replace("px","")+h,n=1*d.style.height.replace("px","")+k;10>m&&(m=10);10>n&&(n=10);if(null!=g)if(null!=b.M){var p=1*b.M.Width/b.M.Height;if(1==p){d.style.width.replace("px","");a=Math.sqrt(h*h+k*k);
if(0<k||0>h)a*=-1;a={left:$(d).position().left-a/4,top:$(d).position().top-a/4,width:$(d).width()+a/2,height:$(d).height()+a/2};if(a.height+a.top>g.Bottom||a.top<g.Top||a.left+a.width>g.Right||a.left<g.Left||50>a.width)return;$(d).css(a);b.JSM&&b.JSM(b.B,b.A);return}h=m/n;h>p?n=m/p:h<p&&(m=n*p);e+m>g.Right&&(m=g.Right-e,n=m/p);l+n>g.Bottom&&(n=g.Bottom-l,m=n*p)}else e+m>g.Right&&(m=g.Right-e),l+n>g.Bottom&&(n=g.Bottom-l);this.IsMoveX&&(d.style.width=m+"px");this.IsMoveY&&(d.style.height=n+"px")}d.setAttribute("_EWA_MOUSE_X",
a.X);d.setAttribute("_EWA_MOUSE_Y",a.Y);b.JSM&&b.JSM(b.B,b.A);(b=this.CheckBackgroundObj(a.X,a.Y))?b!=this.LastCheckedBackground&&(this.LastCheckedBackground&&(this.LastCheckedBackground.obj.style.backgroundColor=this.LastCheckedBackground.obj.getAttribute("_mv_last_bc")),this.LastCheckedBackground=b,b.obj.setAttribute("_mv_last_bc",b.obj.style.backgroundColor),b.obj.style.backgroundColor="lightyellow"):this.LastCheckedBackground&&(this.LastCheckedBackground.obj.style.backgroundColor=this.LastCheckedBackground.obj.getAttribute("_mv_last_bc"))}}}};
this.OnMouseUp=function(a){a=EWA_COMMON_MV_OBJECT;if(null!=a){for(var b=0;b<this._MoveObjectList.length;b++)this._MoveObjectList[b].B.setAttribute("_EWA_MOUSE_DOWN",0);null!=a.JS&&a.JS(a.B,a.A);EWA_COMMON_MV_OBJECT=null}};this._GetObject=function(a){for(var b=0;b<this._MoveObjectList.length;b++){var d=this._MoveObjectList[b].A;if(d==a)return this._MoveObjectList[b]}for(b=0;b<this._MoveObjectList.length;b++){d=this._MoveObjectList[b].A;d=d.getElementsByTagName(a.tagName);for(var e=0;e<d.length;e++){var g=
this._MoveObjectList[b];if(d[e]==a)return g}}return null};this._GetEventTarget=function(a){return EWA.B.IE?event.srcElement:a.target};this._GetEventXY=function(a){return EWA.B.IE?{X:a.x,Y:a.y}:{X:a.pageX,Y:a.pageY}}};function EWA_UI_MenuItemClass(){this.Group=this.Cmd=this.Txt=this.Img=null}
function EWA_UI_MenuClass(a){this.ClassName=a;this.MenuShowType="";this.Dialog=null;this.Dialogs=[];this.clickedItem=this._ItemsDiv=this._LastObj=null;this.Click=function(b,d){this.clickBeforeEvent&&this.clickBeforeEvent(b,d);"LEFT"!=this.MenuShowType&&(null!=this._LastObj&&(this._LastObj.className=this._LastObj.className.replace("_mv1","")),this._LastObj=null,"undefined"!=typeof b.stopPropagation?b.stopPropagation():b.cancelBubble=!0,this._HiddenDialogs());EWA.C.Utils.RunCmd(d);this.clickAfterEvent&&
this.clickAfterEvent(b,d)};this.OnClick=function(b,d){this.clickedItem=d;if("LEFT"==this.MenuShowType){var e=d.parentNode.parentNode,g=d.parentNode,h=d.parentNode.parentNode.childNodes[1];if(null==h)return;0==h.childNodes.length?(this._LastCkObj&&(this._LastCkObj.style.backgroundColor=""),g.style.backgroundColor="#ccc",this._LastCkObj=g):("none"==h.style.display?(h.style.display="",$(e).addClass("ewa-lmenu-show")):($(e).removeClass("ewa-lmenu-show"),h.style.display="none"),window.event?b.cancelBubble=
!0:b.stopPropagation())}else if(""==d.getAttribute("EWA_MF_PID")&&(this._HiddenDialogs(),0>=this.Dialogs.length&&this.Dialogs.push(this._CreateDialog()),0<this._ShowPullDownMenu(d,this.Dialogs[0]))){this.ShowByObject(d,this.Dialogs[0],0);return}this.Click(b,d)};this._CalcLevel=function(b){for(var d=0;""!=b.getAttribute("EWA_MF_PID");)if(d+=1,b=document.getElementById(b.getAttribute("EWA_MF_PID")),null==b)return null;return d};this._ShowPullDownMenu=function(b,d){for(var e=$X(d.FrameContent).childNodes[0].rows[0].cells[0];0<
e.childNodes.length;)this._ItemsDiv.appendChild(e.childNodes[0]);for(var g=[],h=0;h<this._ItemsDiv.childNodes.length;h++){var k=this._ItemsDiv.childNodes[h];0<k.innerHTML.toUpperCase().indexOf("<HR")||(k.style.paddingRight="10px");k.getAttribute("EWA_MF_PID")==b.id&&g.push(k)}b=g.length;for(h=0;h<g.length;h++){e.appendChild(g[h]);if(this._CheckChildren(g[h].id)){k=g[h].childNodes[0].rows[0].cells[2];if(null==k.getAttribute("gdx")||""==k.getAttribute("gdx"))k.innerHTML+=" +",k.setAttribute("gdx","gdx");
g[h].setAttribute("EWA_MF_CHILD","1")}else g[h].setAttribute("EWA_MF_CHILD","0");g[h]=null}g.length=0;$X(d.FrameContent).childNodes[0].style.height="auto";return b};this._CheckChildren=function(b){for(var d=0;d<this._ItemsDiv.childNodes.length;d++)if(this._ItemsDiv.childNodes[d].getAttribute("EWA_MF_PID")==b)return!0;return!1};this.InstallMenus=function(b,d,e){if("METRO"==e){var g=[],h={};$(".ewa_menu_m").each(function(){var n=$(this),p={};p.id=n.attr("id");p.pid=n.attr("EWA_MF_PID");p.url=n.attr("EWA_CMD");
p.icon=n.find(".ewa_menu_m0").attr("class");p.title=n.text().trim();p.icon&&(p.icon=p.icon.replace("ewa_menu_m0","").trim());""==p.pid?(p.pid="0",p.subs=[],h[p.id]=p,g.push(p)):h[p.pid].subs.push(p)});EWA_UI_Metro.menus=g;EWA_UI_Metro.add_menus(g,"EWA_FRAME_MAIN","item",null,null,!0)}else{this.MenuShowType=e;e=$X(b);var k=$X(d);if(null==k)alert("MenuShow defined error ("+d+")");else{this._ItemsDiv=e;d=[];k.innerHTML="<table onselectstart='return false' style='cursor:pointer;-moz-user-select:none;' border=0 cellspacing=0 cellpadding=0></table>";
k=k.childNodes[0];for(var l=0;l<e.childNodes.length;l++){var m=e.childNodes[l];"DIV"==m.tagName&&""==m.getAttribute("EWA_MF_PID")&&d.push(m)}if(""==this.MenuShowType||"TOP"==this.MenuShowType)for(k.insertRow(-1),l=0;l<d.length;l++)k.rows[0].insertCell(-1).appendChild(d[l]);else k.style.width="100%",this._InstallMenusLeft(k,e,d,b);d.length=0;d=null}}};this._InstallMenusLeft=function(b,d,e,g){$(b).addClass("ewa-lmenu");for(var h=0;h<e.length;h++){var k=b.insertRow(-1).insertCell(-1);g=document.createElement("div");
g.innerHTML='<div class="ewa_lmenu_bar" des="rq1"></div><div  des="rq2"></div>';g.childNodes[1].style.paddingLeft="5px";k.appendChild(g);e[h].style.height="100%";g.childNodes[0].appendChild(e[h]);0==h?$(g).addClass("ewa-lmenu-show"):g.childNodes[1].style.display="none"}for(b=d.childNodes;0<d.childNodes.length;)e=b[0],h=e.getAttribute("EWA_MF_PID"),g=document.createElement("div"),g.innerHTML='<div class="ewa_lmenu_bar1"></div><div style="padding-left:4px;display:none"></div>',$X(h)?(h=$X(h).parentNode.parentNode,
$(h).addClass("ewa-lmenu-children"),h.childNodes[1].appendChild(g),g.childNodes[0].appendChild(e)):(console.warn("not found pid",h,e),$(e).remove())};this._CreateDialog=function(){var b=new EWA_UI_DialogClass;b.Create();b.SetHtml("<table class='ewa_menu_down' border=0 width=100 cellspacing=0 cellpadding=0 onmousemove='window."+this.ClassName+".IsOut=false;' onmouseout='window."+this.ClassName+".IsOut=true; window.setTimeout(function(){var a=window."+this.ClassName+";a.AutoHidden();},1410);' onselectstart='return false' style='cursor:pointer;-moz-user-select:none;' ><tr><td></td></tr></table>");
return b};this.AutoHidden=function(){this.IsOut&&this._HiddenDialogs()};this.Create=function(b){if(null!=b&&0!=b.length){this.Dialog=new EWA_UI_DialogClass;this.Dialog.Create();var d=[];d.push("<div class='ewa_menu_box' onmousemove='window."+this.ClassName+".IsOut=false;' onmouseout='window."+this.ClassName+".IsOut=true; var t1=new Date().getTime(); if(t1-$(this).attr(&quot;open_time&quot;)>1000){ window.setTimeout(function(){var a=window."+this.ClassName+";a.AutoHidden(this);},1410);}'  onselectstart='return false' style='width:120px;cursor:pointer;-moz-user-select:none;'>");
for(var e=0;e<b.length;e+=1){var g=b[e];d.push("<div class='ewa_menu_m' EWA_MG=\""+g.Group+"\" style='cursor:pointer' EWA_CMD=\""+g.Cmd+"\" onclick='"+this.ClassName+".Click(event,this);' onmouseover='"+this.ClassName+".MouseOver(this);'><table boder=0 width=100% cellpadding=0 cellspacing=0>");0<=g.Txt.toUpperCase().indexOf("<HR")?d.push("<tr><td colspan=2 style='white-space:nowrap'>"+g.Txt+"</td></tr></table></div>"):(d.push("<tr><td class='ewa_menu_m0'>"),g=b[e].Img,null!=g&&0>g.indexOf("index=0,size=0")&&
0<g.trim().length&&(0<=g.indexOf("fa")?d.push('<i class="'+g+'"></i>'):d.push('<img src="'+b[e].Img+'">')),d.push("</td><td class='ewa_menu_m1' style='white-space:nowrap'>"+b[e].Txt+"</td></tr></table></div>"))}d.push("</div>");this.Dialog.SetHtml(d.join(""))}};this.HiddenMemu=function(){this.Dialog.Show(!1);EWA.UI.CurMenu=null};this.ShowByObject=function(b,d,e){var g=EWA.UI.Utils.GetPosition(b);this.SHOW_BY_OBJECT=b;d=d||this.Dialog;null==e||0==e?d.Move(g.X,g.Y):d.Move(g.X+b.offsetWidth-5,g.Y-b.offsetHeight+
4);d.Show(!0);$(d.GetFrame()).find(".ewa_menu_box").attr("open_time",(new Date).getTime());d.ResizeByContent()};this.ShowByMouse=function(b,d){if(this.Dialog){var e=0,g=$X(this.Dialog.FrameContent).childNodes[0];if(null==d)e=g.childNodes.length;else for(var h=0;h<g.childNodes.length;h++)g.childNodes[h].getAttribute("EWA_MG")==d||null==d||""==d?(g.childNodes[h].style.display="",e++):g.childNodes[h].style.display="none";0<e?(d=b.x?b.x:b.pageX,b=b.y?b.y:b.pageY,b+=document.documentElement.scrollTop||
document.body.scrollTop,d+=document.documentElement.scrollLeft||document.body.scrollLeft,this.Dialog.Move(d,b),this.Dialog.Show(!0),this.Dialog.ResizeByContent()):this.Dialog.Show(!1)}};this.MouseOver=function(b){null!=this._LastObj&&("LEFT"==this.MenuShowType?this._LastObj.parentNode.className=this._LastObj.parentNode.className.replace("_mv",""):this._LastObj.className=this._LastObj.className.replace("_mv1",""));if("LEFT"==this.MenuShowType)this._LastObj=b,this._LastObj.parentNode.className+="_mv";
else{this._LastObj=b;this.IsOut=!1;this._LastObj.className+="_mv1";null==EWA.UI.CurMenu&&(EWA.UI.CurMenu=this);var d=this._CalcLevel(b);"1"==b.getAttribute("EWA_MF_CHILD")&&(this.Dialogs.length<=d&&this.Dialogs.push(this._CreateDialog()),this._ShowPullDownMenu(b,this.Dialogs[d]),this.ShowByObject(b,this.Dialogs[d],d))}};this._HiddenDialogs=function(){null!=this.Dialog&&this.Dialog.Show(!1);for(var b=0;b<this.Dialogs.length;b++){this.Dialogs[b].Show(!1);for(var d=$X(this.Dialogs[b].FrameContent).childNodes[0].rows[0].cells[0];0<
d.childNodes.length;)this._ItemsDiv.appendChild(d.childNodes[0])}};this._InitEvent=function(){"LEFT"!=this.MenuShowType&&(EWA.B.IE?document.body.attachEvent("onclick",function(){"undefined"!=typeof EWA.UI.CurMenu&&EWA.UI.CurMenu._HiddenDialogs()}):document.body.addEventListener("click",function(){"undefined"!=typeof EWA.UI.CurMenu&&EWA.UI.CurMenu._HiddenDialogs()}))}}
var EWA_UI_Metro={show_title:function(a){if(""==a.getAttribute("_title")||null==a.getAttribute("_title")){var b=a.title;if(""==b||null==b)return;a.setAttribute("_title",b);a.title=""}$(".pop_title div").html(a.getAttribute("_title"));b=$(a).offset();a=$(a).width();var d=$(".pop_title").height(),e=$(".pop_title").width();$(".pop_title").css("top",b.top-d-8);$(".pop_title").show();$(".pop_title").css("left",b.left-(e-a)/2)},item_click:function(a){var b=$(a);a=b.attr("u");b=b.attr("_title");a&&(a.startsWith("js:")?
(a=a.replace("js:",""),eval(a)):(0<a.indexOf("/")||(a=0<=a.indexOf("?")?EWA.CP+"/EWA_STYLE/cgi-bin/"+a:EWA.CP+"/EWA_STYLE/cgi-bin/?"+a),top.AddTab(a,b)))},add_menus:function(a,b,d,e,g,h){this.g_menu_cols=window.g_menu_cols||6;this.g_menu_rows=window.g_menu_rows||3;this.menuLoadInRight=window.menuLoadInRight||!1;e=e||this.g_menu_cols;g=g||this.g_menu_rows;for(var k=0;k<a.length;k++){var l=a[k];if(l&&l.icon&&0<l.icon.indexOf("gear")){a[k]=null;a[e*g-1]=l;break}}var m=document.createElement("table");
$X(b).innerHTML="";$X(b).className="ewa-metro-menu";$X(b).appendChild(m);$($X(b)).append('<div class="pop_title" style="display: none;"><div>-</div><p></p></div>');$($X(b)).css("background","transparent").css("border",0);m.align="center";var n=0,p=[];for(k=0;k<g;k++){var q=b+"_htr_"+k;l=m.insertRow(-1);l.id=q;var t=l.insertCell(-1);t.colSpan=e;l.style.display="none";t.id=q+"a";t=m.insertRow(-1);for(var u=0;u<e;u++){l=a[n];n++;var r=this.add_menu_item(t,l,h,n,d,q);l&&(r.id="M_"+l.id);r&&l&&(null==
l.all||1==l.all)&&p.push(r.innerHTML)}}!this._is_load_main_menu&&this.menuLoadInRight&&(parent.$("#RIGHT").html(p.join("")),parent.$("#RIGHT .item").each(function(){$(this).append($(this).attr("_title"));$(this).attr("onmouseout",null);$(this).attr("onmouseover",null);$(this).attr("onclick","EWA_UI_Metro.right_show_menu_sub(this,event)")}));this._is_load_main_menu=!0},add_menu_item:function(a,b,d,e,g,h){if(d||b){var k=a.insertCell(-1);k.innerHTML="<div class='"+g+"'><i id='memu_item_"+e+"'></i></div>"}if(b)return a=
$(k).find("i"),d=a.parent(),b.icon&&0<b.icon.trim().length?0==b.icon.indexOf("fa")?a.attr("class",b.icon):(d.append("<table width=100% height=100%><tr><td align=center><img style='max-width:90%;max-height:90%' src='"+b.icon+"' /></td></tr></table>"),a.hide()):b.img&&(d.append("<table width=100% height=100%><tr><td align=center><img  src='"+b.img+"' /></td></tr></table>"),a.hide()),d.attr("_title",b.title),d.attr("onmouseover","EWA_UI_Metro.show_title(this)"),d.attr("onmouseout","$('.pop_title').hide()"),
d.attr("hid",h),b.url?(d.attr("u",b.url),d.attr("onclick","EWA_UI_Metro.item_click(this,event)")):b.subs&&(d.attr("subs",JSON.stringify(b.subs)),d.attr("onclick","EWA_UI_Metro.show_menu_sub(this,event)")),k.id="M_"+b.id,k},show_menu_sub:function(a){var b=$(a),d=b.attr("class"),e=b.attr("hid");window.last_open&&window.last_open!=a&&window.last_open.click();if(1==b.attr("is_open"))b.attr("is_open","0"),$X(e).style.display="none",window.last_open=null,b.attr("class",d.split(" ")[0]);else{b.attr("is_open",
"1");var g=JSON.parse(a.getAttribute("subs"));$X(e).style.display="";$X(e).style.opacity=0;EWA_UI_Metro.add_menus(g,e+"a","item_sub",9,Math.round(g.length/9+.4),!1);b.attr("class",d+" open");$($X(e)).animate({opacity:1},300);window.last_open=a;EWA_UI_Metro.load_msg_sub()}this.show_menu_sub_after&&this.show_menu_sub_after(a)},css:function(){if(!this._css_setted){var a=[];a.push(".nav_box {");a.push("margin: auto;");a.push("margin-top: 50px;");a.push("}");a.push(".nav_box .item {");a.push("margin: 5px;");
a.push("background-color: #08c;");a.push("width: 140px;");a.push("height: 140px;");a.push("text-align: center;");a.push("color: #fff;");a.push("transition-duration: 0.3s;");a.push("-webkit-transition-duration: 0.3s;");a.push("cursor: pointer;");a.push("position: relative;");a.push("}");a.push(".nav_box .item .msg {");a.push("position: absolute;");a.push("top: -8px;");a.push("right: -8px;");a.push("height: 18px;");a.push("border-radius: 10px;");a.push("background-color: red;");a.push("color: #fff;");
a.push("line-height: 18px;");a.push("text-align: center;");a.push("min-width: 18px;");a.push("padding: 2px;");a.push("box-shadow: 1px 1px 13px rgba(0, 0, 245, 0.7);");a.push("}");a.push(".nav_box .open {");a.push("-webkit-transform: rotate(45deg) scale(0.7);");a.push("-webkit-transition-duration: 0.7s;");a.push("transform: rotate(45deg) scale(0.7);");a.push("transition-duration: 0.7s;");a.push("}");a.push(".nav_box .open i {");a.push("transform: rotate(-45deg);");a.push("-webkit-transform: rotate(-45deg);");
a.push("}");a.push(".nav_box .item:hover {");a.push("background-color: #fff;");a.push("color: #08c;");a.push("-webkit-transition-duration: 0.3s;");a.push("transition-duration: 0.3s;");a.push("}");a.push(".nav_box .item i {");a.push("line-height: 140px;");a.push("font-size: 60px;");a.push("}");a.push(".nav_box .item img {");a.push("max-height: 100px;");a.push("max-width: 100px;");a.push("}");a.push(".nav_box .item_sub {");a.push("margin: 12px;");a.push("background-color: darkorange;");a.push("width: 70px;");
a.push("height: 70px;");a.push("text-align: center;");a.push("color: #fff;");a.push("-webkit-transition-duration: 0.3s;");a.push("transition-duration: 0.3s;");a.push("cursor: pointer;");a.push("position: relative;");a.push("}");a.push(".nav_box .item_sub .msg {");a.push("position: absolute;");a.push("top: -8px;");a.push("right: -8px;");a.push("height: 18px;");a.push("border-radius: 10px;");a.push("background-color: #fff;");a.push("color: red;");a.push("line-height: 18px;");a.push("text-align: center;");
a.push("min-width: 18px;");a.push("padding: 2px;");a.push("box-shadow: 1px 1px 13px rgba(255, 0, 0, 0.7);");a.push("}");a.push(".nav_box .item_sub i {");a.push("line-height: 70px;");a.push("font-size: 30px;");a.push("}");a.push(".nav_box .item_sub:hover {");a.push("background-color: #fff;");a.push("color: darkorange;");a.push("-webkit-transition-duration: 0.3s;");a.push("transition-duration: 0.3s;");a.push("}");a.push(".pop_title{ position: absolute;min-width: 50px;display: none;z-index: 212;white-space: nowrap;}");
a.push(".pop_title div {position: relative;width: 100%;z-index: 2;height: 30px;line-height: 30px;text-align: center;background-color: #8D8804;padding: 0 4px;border-radius: 5px;color: #fff;}");a.push(".pop_title p {");a.push("position: relative;");a.push("padding: 0px;");a.push("height: 12px;");a.push("width: 12px;");a.push("transform: rotate(45deg);");a.push("-webkit-transform: rotate(45deg);");a.push("margin: auto;");a.push("margin-top: -6px;");a.push("z-index: 1;");a.push("background-color: #8D8804;");
a.push("}");var b=document.createElement("style");b.textContent=a.join("\n");document.getElementsByTagName("head")[0].appendChild(b);this._css_setted=!0}},right_show_menu_sub:function(a,b){b=b||event;if("item"==(b.target||b.srcElement).className){b=$(a);var d=this.right_add_menu_subs(a);window.last_open&&window.last_open!=a&&window.last_open.click();1==b.attr("is_open")?(b.attr("is_open","0"),d&&(d.style.display="none"),window.last_open=null):(b.attr("is_open","1"),d&&(d.style.display=""),window.last_open=
a)}},right_add_menu_subs:function(a){var b=("M_"+Math.random()).replace(".","");a.id=a.id||b;var d=a.id+"_s";if($X(d))return $X(d);var e;(b=a.getAttribute("subs"))&&(e=JSON.parse(b));if(e&&0!=e.length){b=document.createElement("div");b.id=d;a.appendChild(b);for(a=0;a<e.length;a++){d=e[a];var g=document.createElement("p");$(g).attr({onclick:"EWA_UI_Metro.right_item_click(this)",_title:d.title,u:d.url});g.innerHTML="<b class='"+d.icon+"'></b><span>"+d.title+"</span>";b.appendChild(g)}return b}this.right_item_click(a)},
right_item_click:function(a){var b=$(a);a=b.attr("u");b=b.attr("_title");a&&(0<a.indexOf("/")||(a=0<=a.indexOf("?")?EWA.CP+"/EWA_STYLE/cgi-bin/"+a:EWA.CP+"/EWA_STYLE/cgi-bin/?"+a),AddTab(a,b))},load_msg_sub:function(){}},__Menu={C:EWA_UI_MenuClass,OnMouseOver:function(a){null!=__Menu._LastObj&&(__Menu._LastObj.style.backgroundColor="");__Menu._LastObj=a;a.style.backgroundColor="#DDD"},OnClick:function(a,b){null!=__Menu._LastObj&&(__Menu._LastObj.style.backgroundColor="");__Menu._LastObj=null;"undefined"!=
typeof a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;if(0<b.id.indexOf("_EWA_MF_")&&0<b.id.indexOf("*")){a=b.id.split("*")[0];a=document.getElementById(a);for(var d=0;d<a.childNodes.length;d++){var e=a.childNodes[d];e.getAttribute("EWA_MF_PID")==a.id&&alert(e.innerHTML)}}EWA.C.Utils.RunCmd(b)}};EWA.UI.Menu=__Menu;var __EMP_TIP_TIMER_SHOW,__EMP_TIP_CLASS;function EMP_TIP_HIDE(){window.clearInterval(__EMP_TIP_TIMER_SHOW);__EMP_TIP_CLASS._Hidden();__EMP_TIP_TIMER_SHOW=null}
function EWA_UI_TipClass(a){this.ParentWindow=window;this.TipFrame=null;this.Alpha=0;this.IsShow=!0;this._Id="__EWA_TIP_"+a;this._BakFrame=this._BakTable=this._ForTable=this._ShowDocument=null;this._InitTipFrame=function(){var b=this._InitDiv(),d=this._InitTable();this._ForTable=d;this._InitTableImgForground(d);b.appendChild(d);this._BakTable=d=this._InitTable();this._InitTableImgBackground(d);b.appendChild(d);this.TipFrame=b;this.ParentWindow.document.body.appendChild(b);__EMP_TIP_CLASS=this};this._InitDiv=
function(){var b=this.ParentWindow.document.createElement("div");b.id=this._Id;b.style.zIndex="1998";b.style.display="none";b.className="ewa-tip";b.innerHTML=EWA.B.IE?"<iframe src='javascript:false' style=\"position:absolute; visibility:inherit; top:0px; left:0px; width:1px; height:1px; z-index:-1; filter='progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)';\"></iframe>":'<div style="position:absolute; visibility:inherit; top:0px; left:0px; width:1px; height:1px; z-index:-1;"></div>';this._BakFrame=
b.childNodes[0];return b};this._CreateImgHtml=function(b,d,e){return"<img src='"+((null==EWA.RV_STATIC_PATH?EWA.CP:EWA.RV_STATIC_PATH)+"/EWA_STYLE/images/tip/"+b)+"' width="+d+" height="+e+">"};this._SetBackgound=function(b,d){b.style.backgroundImage="url('"+((null==EWA.RV_STATIC_PATH?EWA.CP:EWA.RV_STATIC_PATH)+"/EWA_STYLE/images/tip/"+d)+"')";b.style.backgroundRepeat="repeat-x"};this._InitTableImgForground=function(b){b.className="ewa-tip-for";b.rows[2].cells[1].onmouseover=function(){window.clearInterval(__EMP_TIP_TIMER_SHOW);
__EMP_TIP_TIMER_SHOW=null;this.bgColor="#FFCC66"};b.onmouseout=function(){window.clearInterval(__EMP_TIP_TIMER_SHOW);__EMP_TIP_TIMER_SHOW=null;__EMP_TIP_CLASS.HiddenTip();this.rows[2].cells[1].bgColor="white"};b.rows[0].cells[0].className="ewa-tip-arrow";b.rows[1].cells[0].className="ewa-tip-tl";b.rows[1].cells[1].className="ewa-tip-tm";b.rows[1].cells[2].className="ewa-tip-tr";b.rows[2].cells[0].className="ewa-tip-l";b.rows[2].cells[1].className="ewa-tip-m";b.rows[2].cells[2].className="ewa-tip-r";
b.rows[3].cells[0].className="ewa-tip-bl";b.rows[3].cells[1].className="ewa-tip-bm";b.rows[3].cells[2].className="ewa-tip-br"};this._InitTableImgBackground=function(b){};this._InitTable=function(){var b=this.ParentWindow.document.createElement("table"),d=b.insertRow(-1);d.insertCell(-1);for(var e=0;3>e;e++){d=b.insertRow(-1);for(var g=0;3>g;g++)d.insertCell(-1).style.fontSize=1==e&&1==g?"12px":"1px"}d=b.insertRow(-1);d.insertCell(-1);b.border=0;b.cellSpacing=0;b.cellPadding=0;b.style.fontSize="1px";
b.rows[0].cells[0].colSpan=3;b.rows[4].cells[0].colSpan=3;return b};this.ShowTip=function(b,d,e){window.clearInterval(__EMP_TIP_TIMER_SHOW);__EMP_TIP_TIMER_SHOW=null;this.TipFrame.style.display="";this._ForTable.rows[2].cells[1].innerHTML=b;b=this._ForTable.offsetWidth;this._ForTable.style.width=this._ForTable.rows[2].cells[1].offsetWidth+12+"px";var g=d-b/4+14;0>g?g=12:null!=this._ShowDocument&&b+g>this._ShowDocument.body.offsetWidth&&(g=this._ShowDocument.body.offsetWidth-b-2);this.TipFrame.style.left=
g+"px";this.TipFrame.style.top=e+3+"px";g=d-g;d=g+3;var h="/EWA_STYLE/images/tip/image048.gif";e="/EWA_STYLE/images/tip/image013.png";g<b/2&&0<g-32&&(h="/EWA_STYLE/images/tip/image050.gif",e="/EWA_STYLE/images/tip/image015.png",g-=32,0>g&&(g=4),d=g-3);b=document.all?6:9;var k=null==EWA.RV_STATIC_PATH?EWA.CP:EWA.RV_STATIC_PATH;this._ForTable.rows[0].cells[0].innerHTML="<img src='"+k+h+"' width=32 height=21 style='position: relative; left: "+g+"px; top: "+b+"px'>";g="<img src='"+k+e+"' width=37 height=21 style='position: relative; left: "+
d+"px; top: "+b+"px'>";document.all&&(g="<div style=\"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+(k+e)+"', sizingMethod='scale'); position: relative; left: "+d+"px; top: "+b+'px; width:37px; height:21px"></DIv>');this._BakTable.rows[0].cells[0].innerHTML=g;this.TipFrame.style.display=""};this.HiddenTip=function(){__EMP_TIP_CLASS=this;null!=__EMP_TIP_TIMER_SHOW&&window.clearInterval(__EMP_TIP_TIMER_SHOW);__EMP_TIP_TIMER_SHOW=window.setInterval(EMP_TIP_HIDE,500)};this.GetObjectLocation=
function(b,d){b=EWA.UI.Utils.GetPosition(b);return[b.X,b.Y]};this._Hidden=function(){this.TipFrame.style.display="none"};this._InitTipFrame()}
function EWA_UI_LinkClass(a,b){this.LinkObj1=a;this.LinkObj2=b;this.LinkObj=null;this._Style="2px solid blue";this.getSize=function(d){var e=EWA$UI$COMMON.GetPosition(d);return{X:e.X,Y:e.Y,W:d.offsetWidth,H:d.offsetHeight}};this._CreateLinkObj=function(){var d=document.createElement("table");EWA.B.IE?d.style.cssText="position: absolute; width: 100px; height: 100px; z-index: -11; left: 693px; top: 174px;font-size:1px;":d.setAttribute("style","position: absolute; width: 100px; height: 100px; z-index: -11; left: 693px; top: 174px;font-size:1px;");
d.cellSpacing=0;for(var e=d.cellPadding=0;2>e;e++)for(var g=d.insertRow(-1),h=0;2>h;h++)g.insertCell(-1).innerHTML="&nbsp;";document.body.appendChild(d);this.LinkObj=d};this.Link=function(){null==this.LinkObj&&this._CreateLinkObj();this.LinkObj.rows[0].cells[0].style.border="";this.LinkObj.rows[0].cells[1].style.border="";this.LinkObj.rows[1].cells[0].style.border="";this.LinkObj.rows[1].cells[1].style.border="";var d=this.getSize(this.LinkObj1),e=this.getSize(this.LinkObj2);if(d.X+d.W<e.X){var g=
d.X+d.W;var h=e.X-d.X-d.W;this.LinkObj.rows[0].cells[0].style.width=h/2+"px"}else d.X<e.X?(g=d.X-20,h=e.X-d.X+20,this.LinkObj.rows[0].cells[0].style.width="20px"):d.X>=e.X&&d.X<e.X+e.W?(g=e.X-20,h=d.X-e.X+20,this.LinkObj.rows[0].cells[0].style.width="20px"):(g=e.X+e.W,h=d.X-e.X-e.W,this.LinkObj.rows[0].cells[0].style.width=h/2+"px");if(d.Y<e.Y){var k=e.Y-e.H/2-d.Y+d.H/2;var l=d.Y-d.H/2}else k=d.Y-d.H/2-e.Y+e.H/2,l=e.Y-e.H/2;this.LinkObj.style.width=h+"px";this.LinkObj.style.height=k+"px";this.LinkObj.style.left=
g+"px";this.LinkObj.style.top=l+"px";l=this.LinkObj.rows[0].cells[0];g=this.LinkObj.rows[0].cells[1];k=this.LinkObj.rows[1].cells[0];h=this.LinkObj.rows[1].cells[1];d.Y<e.Y?d.X+d.W<e.X?(l.style.borderTop=this._Style,l.style.borderRight=this._Style,k.style.borderRight=this._Style,h.style.borderBottom=this._Style):(d.X<e.X?(l.style.borderTop=this._Style,l.style.borderLeft=this._Style,k.style.borderLeft=this._Style,h.style.borderBottom=this._Style):d.X>=e.X&&d.X<e.X+e.W?(l.style.borderTop=this._Style,
l.style.borderLeft=this._Style,k.style.borderLeft=this._Style,g.style.borderTop=this._Style):(g.style.borderTop=this._Style,l.style.borderRight=this._Style,k.style.borderRight=this._Style),k.style.borderBottom=this._Style):d.X+d.W<e.X?(g.style.borderTop=this._Style,l.style.borderRight=this._Style,k.style.borderRight=this._Style,k.style.borderBottom=this._Style):d.X<e.X?(l.style.borderTop=this._Style,g.style.borderTop=this._Style,l.style.borderLeft=this._Style,k.style.borderLeft=this._Style,k.style.borderBottom=
this._Style):d.X>=e.X&&d.X<e.X+e.W?(l.style.borderTop=this._Style,l.style.borderLeft=this._Style,k.style.borderLeft=this._Style,h.style.borderBottom=this._Style,k.style.borderBottom=this._Style):(l.style.borderTop=this._Style,l.style.borderRight=this._Style,k.style.borderRight=this._Style,h.style.borderBottom=this._Style)}}
function EWA_UI_TabsClass(a){this._ClassName=a;this._Index=0;this._ContentsParent=this._TabsParent=null;this._IdTabTag="__EWA_TAB_HEAD_";this._IdFrameTag="__EWA_TAB_FRAME_";this.CurrentWindow=null;this._CurId="";this.CreateTab=function(b,d){var e=this._CheckExist(b);if(null==e){e=this._Index;var g=this._CreateTabHead(b,d||"...");b=this._CreateIframe(b);this._Index++;d||EWA_ChkIframeOk(b,function(h,k){h=h.document.title;$(g).find(".bg_c span:eq(0)").text(h)})}this.ShowTab(e)};this._CreateTabHead=function(b,
d){var e=this._Index,g=this._TabsParent.ownerDocument.createElement("table");g.cellPadding=0;g.cellSpacing=0;g.border=0;g.setAttribute("ewa_tab_url",b);g.title="\u53cc\u51fb\u5173\u95ed\u7a97\u53e3\r\n\u53f3\u952e\u5237\u65b0\u5f53\u524d\u7a97\u53e3";b=g.insertRow(-1);b.insertCell(-1).className="bg_l";var h=b.insertCell(-1);h.className="bg_c";h.innerHTML="<nobr><span>"+d+"</span><b class='ewa_tab_close'></b></nobr></div>";h.getElementsByTagName("b")[0].onclick=function(){var k=this.parentNode.parentNode.parentNode.parentNode.parentNode,
l=k.id.split("_");l=l[l.length-1];eval("window."+k.getAttribute("ewa_class_name")).RemoveTab(l)};b.insertCell(-1).className="bg_r";g.id=this._IdTabTag+e;g.className="ewa_tab_act";g.setAttribute("ewa_class_name",this._ClassName);g.onclick=function(){if(0==g.getAttribute("ewa_tab_act")){var k=this.id.split("_");k=k[k.length-1];eval("window."+this.getAttribute("ewa_class_name")).ShowTab(k)}};g.ondblclick=function(){var k=this.id.split("_");k=k[k.length-1];eval("window."+this.getAttribute("ewa_class_name")).RemoveTab(k)};
g.onselectstart=function(){return!1};g.oncontextmenu=function(k){this.onclick();EWA.B.IE?window.event.returnValue=!1:k.preventDefault();k=this.id.split("_");var l="__EWA_TAB_FRAME_"+k[k.length-1];k=new EWA_UrlClass;l=$X(l).contentWindow;k.SetUrl(l.location.href);k.RemoveParameter("________r");k.AddParameter("________r",Math.random());l.location.href=k.GetUrl();return!1};EWA.B.IE||(g.onmousedown=function(k){"undefined"!=typeof k.preventDefault&&k.preventDefault()});this._TabsParent.appendChild(g);
return g};this._CreateIframe=function(b){var d=this._ContentsParent.ownerDocument.createElement("IFRAME");d.frameBorder=0;d.width="100%";d.height="100%";d.src=b;d.id=this._IdFrameTag+this._Index;this._ContentsParent.appendChild(d);return d};this.RemoveCurrentTab=function(){this.RemoveTab(this._CurId)};this.RemoveTab=function(b){for(var d=9999999999999,e,g=this._ContentsParent.getElementsByTagName("iframe"),h=null,k=0;k<g.length;k++){var l=g[k];l.id!=this._IdFrameTag+b?d>1*l.getAttribute("ewa_tab_show_seq")&&
(d=1*l.getAttribute("ewa_tab_show_seq"),e=l.id):h=l}this._ContentsParent.removeChild(h);b=this._TabsParent.ownerDocument.getElementById(this._IdTabTag+b);this._TabsParent.removeChild(b);null!=e&&(e=e.split("_"),e=e[e.length-1],null!=this._ContentsParent.ownerDocument.getElementById(this._IdTabTag+e)&&this.ShowTab(e))};this._CheckExist=function(b){for(var d=this._TabsParent.childNodes,e=0;e<d.length;e++){var g=d[e];if(g.getAttribute("ewa_tab_url")==b)return b=g.id.split("_"),b[b.length-1]}return null};
this.ShowTab=function(b){this._CurId=b;var d=this._ContentsParent.getElementsByTagName("iframe");this.CurrentWindow=null;for(var e,g,h,k,l=0;l<d.length;l++){var m=d[l],n=m.id.split("_");n=m.ownerDocument.getElementById(this._IdTabTag+n[n.length-1]);m.id==this._IdFrameTag+b?(this.CurrentWindow=m.contentWindow,e=n,g=m):("none"!=m.style.display&&(h=n,k=m),n=1*m.getAttribute("ewa_tab_show_seq")+1,m.setAttribute("ewa_tab_show_seq",n))}this.showTabBeforeCallback&&this.showTabBeforeCallback(e,g,h,k)?console.log("showTabBeforeCallback return stop next"):
(e.className="ewa_tab_act",e.setAttribute("ewa_tab_act",1),g.setAttribute("ewa_tab_show_seq",0),g.style.display="",g.style.zIndex=1,(b=g.getAttribute("s_top"))&&m.contentWindow.document.scrollingElement&&(m.contentWindow.document.scrollingElement.scrollTop=1*b),k&&(h.className="ewa_tab_dact",h.setAttribute("ewa_tab_act",0),k.style.display="none",k.style.zIndex=0,m.contentWindow.document.scrollingElement&&(b=m.contentWindow.document.scrollingElement.scrollTop,k.setAttribute("s_top",b))),this.showTabAfterCallback&&
this.showTabCallback(e,g,h,k))};this.Init=function(b,d){if(!EWA.B.IE)try{b.style.MozUserFocus="ignore",b.style.MozUserInput="disabled",b.style.MozUserSelect="none"}catch(g){}var e=b.ownerDocument.createElement("table");e.style.width="100%";e.style.height="100%";e.onselectstart=function(){return!1};e.cellSpacing=0;e.cellPadding=0;e.insertRow(-1).insertCell(-1).vAlign="bottom";e.className="ewa_tab";b.appendChild(e);this._ContentsParent=d;this._TabsParent=e.rows[0].cells[0];e=null}}
function EWA_UI_DialogClass(){this.zIndex=999;this.Id=null;this.Height=this.Width="200px";this.Top=this.Left="-1000px";this.Offset="5";this.ShadowColor="#777777";this.IsShowTitle=!1;this.IsCanMove=!0;this.AutoSize=this.IsCover=!1;this.DisposeOnClose=!0;this._WindowIndex=this._CreateWindowIndex=this.CreateWindow=this.FrameTitle=this.FrameContent=this.Frame=null;this.GetFrame=function(){return this.GetObject(this.Frame)};this.GetFrameContent=function(){return this.GetObject(this.FrameContent)};this.GetFrameTitle=
function(){return this.GetObject(this.FrameTitle)};this.GetObject=function(a){return null==a?null:this.CreateWindow.$X(a)};this.SetHtml=function(a){this.GetFrameContent().innerHTML=a};this.SetObject=function(a){this.GetFrameContent().appendChild(a)};this.SetTitle=function(a){null!=this.GetFrameTitle()&&(this.GetFrameTitle().innerHTML=a)};this.ScrollMoveDiv=function(){var a=this.GetFrame();if(null!=a){var b=a.ownerDocument,d=b.body.scrollLeft;b=b.body.scrollTop;var e=1*a.getAttribute("_SCROLL_X"),
g=1*a.getAttribute("_SCROLL_Y");a.style.left=d-e+$X(this.Frame).offsetLeft+"px";a.style.top=b-g+$X(this.Frame).offsetTop+"px";a.setAttribute("_SCROLL_X",d);a.setAttribute("_SCROLL_Y",b)}};this.MoveBottom=function(a){var b=$(a).offset();b.Y=b.top+$(a).height();b.X=b.left;var d=a.ownerDocument,e=d.parentWindow?d.parentWindow:d.defaultView;if(e==this.CreateWindow){var g=document.body.clientWidth;d=document.body.clientHeight;var h=b.X;e=b.Y;var k=1*(this.Height+"").replace("px",""),l=1*(this.Width+"").replace("px",
"");b.Y+a.clientHeight+k>d&&(e=b.Y-a.clientHeight-k);b.X+l>g&&(h=g-l-a.clientWidth);EWA.B.PAD&&(h=0);this.Move(h,e+4)}else h=e._EWA_DialogWnd._Dialog.GetFrame(),g=h.offsetLeft,d=h.offsetTop,k=this.GetFrame(),k.setAttribute("_SCROLL_X",h.getAttribute("_SCROLL_X")),k.setAttribute("_SCROLL_Y",h.getAttribute("_SCROLL_Y")),a=$(a).height(),h=b.X+g,EWA.B.PAD&&(h=0),g=e._EWA_DialogWnd._Dialog.GetFrameTitle().clientHeight,this.Move(h,b.Y+d+a+g)};this.Move=function(a,b){var d=this.GetFrame();null!=d&&EWA.UI.Utils.MoveTo(d,
a,0>b?0:b)};this.MoveCenter=function(){var a=this.GetFrame(),b=a.clientWidth,d=a.clientHeight,e=EWA.UI.Utils.GetDocSize(this.CreateWindow);d=(e.H-d)/2-40;b=(e.W-b)/2;0>b&&(b=0);0>d&&(d=0);var g=e.SH;e=e.SW;a.setAttribute("_SCROLL_X",e);a.setAttribute("_SCROLL_Y",g);this.Move(b+e,d+g)};this.ResizeByContent=function(){var a=this.GetFrame(),b=this.GetFrameContent().childNodes[0];if("IFRAME"==b.tagName){var d=b.contentWindow;d&&d.document&&d.document.body&&(d=d.document.getElementById("Test1"))&&(b=d)}d=
this.GetFrameContent().parentNode.parentNode.parentNode;var e=1*$(d).css("border-left-width").replace("px","")+1*$(d).css("border-right-width").replace("px","");var g=1*$(d).css("border-top-width").replace("px","")+1*$(d).css("border-bottom-width").replace("px","");this._calc_frame_table=e;d=$(b).width();d+=e;b=$(b).height()+g;e=1*a.style.left.replace("px","");a=1*a.style.top.replace("px","");d+e>this.CreateWindow.document.body.clientWidth&&this.Move(this.CreateWindow.document.body.clientWidth-d-
20,a);this.Resize(d,b,!0)};this.Resize=function(a,b,d){if(this.IsShowTitle){var e=this.GetFrameTitle();b+=$(e).parent().height()}var g=e=0;d||(d=this.GetFrameContent().parentNode.parentNode.parentNode,this._calc_frame_table=e=1*$(d).css("border-left-width").replace("px","")+1*$(d).css("border-right-width").replace("px",""),g=1*$(d).css("border-top-width").replace("px","")+1*$(d).css("border-bottom-width").replace("px",""));a+=e;b+=g;d=this.GetFrame();d.style.width=a+"px";d.style.height=b+"px";for(e=
0;e<d.childNodes.length;e+=1)g=d.childNodes[e],g.style.width=a+"px",g.style.height=b+"px",0<g.id.indexOf("divContent")&&(g.style.overflow="hidden");this.GetFrameContent();a=this.GetObject(this._DivCover);$(a).css("background-image","none");$(a).attr("background-image","none")};this.Show=function(a){var b=this.GetFrame();a?(b.style.display="",this.IsShowTitle&&this.AutoSize&&(_EWA_DIALOG_ON_TIMER=this,this.TimerHandle=window.setInterval(function(){var d=_EWA_DIALOG_ON_TIMER;window.clearInterval(d.TimerHandle);
var e=d.GetFrame(),g=d.GetFrameContent(),h=g.childNodes[0].offsetWidth,k=d.GetObject(d._FrameFore).offsetHeight;e.style.width=h+"px";e.style.height=k+"px";d.GetObject(d._FrameBack1)&&(d.GetObject(d._FrameBack1).style.width=h+"px",d.GetObject(d._FrameBack1).style.height=k+"px");d.GetObject(d._FrameBack2)&&(d.GetObject(d._FrameBack2).style.width=h+"px",d.GetObject(d._FrameBack2).style.height=k+3+"px");if(d=g.childNodes[0])d.style.width=h-2+"px",d.style.height=k-2+"px";d=_EWA_DIALOG_ON_TIMER=null;h=
d.GetObject(this._DivCover);$(h).css("background-image","none");$(h).attr("background-image","none")},32))):b.style.display="none";b=oCover=null};this.Dispose=function(){this.CreateWindow&&(this.CreateWindow._EWA_DIALOGS[this._CreateWindowIndex]=null,_EWA_DIALOGS[this._WindowIndex]=null,null!=this._DivCover&&(EWA$UI$COMMON.Drop(this.GetObject(this._DivCover)),this._DivCover=null),this.GetObject(this.Frame).innerHTML="",EWA$UI$COMMON.Drop(this.GetObject(this.Frame)),this.CreateWindow=null,EWA.B.IE&&
CollectGarbage())};this.SetZIndex=function(a){this.CreateWindow._EWA_UI_DIALOG_COVERINDEX+=a;this.zIndex=this.CreateWindow._EWA_UI_DIALOG_COVERINDEX;this.GetObject(this.Frame).style.zIndex=this.zIndex};this.CreateId=function(){var a=Math.random();return(new Date).getTime()+"_"+a};this.Create=function(){null==this.CreateWindow&&(this.CreateWindow=window);this.IsCover&&this._CreateCover();var a=this.CreateId(),b=this.CreateWindow;null==b._EWA_UI_DIALOG_COVERINDEX&&(b._EWA_UI_DIALOG_COVERINDEX=0);b._EWA_UI_DIALOG_COVERINDEX+=
1;this.zIndex=b._EWA_UI_DIALOG_COVERINDEX;var d=EWA$UI$COMMON.CreateObject(b,"div","display:none; "+(window.EWA_UI_DIALOG_FIXED?"position:fixed":"position:absolute")+"; width:"+this.Width+"; height:"+this.Height+"; z-index:"+this.zIndex+"; left:"+this.Left+"; top:"+this.Top+";",b.document.body);d.setAttribute("EWA_NAME","DIV_FRAME");d.className="ewa-dialog";d.id=a+"divFrame";this.Frame=d.id;var e=EWA$UI$COMMON.CreateObject(b,"div","position: absolute; width: 100%; height: 100%; left: 0px; top: 0px;",
d);e.setAttribute("EWA_NAME","DIV_BACK1");e.id=a+"divBack1";this._FrameBack1=e.id;if(null!=this.ShadowColor&&""!=this.ShadowColor){var g=EWA$UI$COMMON.CreateObject(b,"div","position: absolute; background-color:"+this.ShadowColor+"; width:100%; height:100%; left:"+this.Offset+"px; top: "+(1*this.Offset+2)+"px;",d);g.style.filter="alpha(opacity=50)";g.style.opacity=.5;g.id=a+"divBack2";this._FrameBack2=g.id}EWA.B.IE&&(e.innerHTML="<iframe src='javascript:false' style=\"position:absolute;top:0px;left:0px;width:100%; height:100%; z-index:-1; filter='progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)';\"></iframe>",
null!=this.ShadowColor&&""!=this.ShadowColor&&(g.innerHTML="<iframe src='javascript:false' style=\"position:absolute;top:0px;left:0px;width:100%; height:100%; z-index:-1; filter='progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)';\"></iframe>"));d.setAttribute("_SCROLL_X",0);d.setAttribute("_SCROLL_Y",0);this._CreateContent();$(d).append("<i style='z-index:"+this.zIndex+"0' onclick='this.parentNode.style.display=\"none\"' class='ewa-dialog-close'></i>");this.CreateWindow._EWA_DIALOGS||(this.CreateWindow._EWA_DIALOGS=
[],addEvent(this.CreateWindow,"scroll",EWA.UI.DialogOnScroll));window._EWA_DIALOGS||(_EWA_DIALOGS=[],addEvent(window,"scroll",EWA.UI.DialogOnScroll));this._CreateWindowIndex=this.CreateWindow._EWA_DIALOGS.length;this.CreateWindow._EWA_DIALOGS[this._CreateWindowIndex]=this;this._WindowIndex=_EWA_DIALOGS.length;_EWA_DIALOGS[this._WindowIndex]=this};this._CreateContent=function(){var a=this.CreateId(),b=EWA$UI$COMMON.CreateObject(null==this.CreateWindow?window:this.CreateWindow,"div","position: absolute; width: 100%; height: 100%; z-index: 2; left: 0px; top: 0px;  background-color:white",
this.GetFrame());b.setAttribute("EWA_NAME","CONTENT");b.className="EWA_POP_MAIN";b.id=a+"divContent";if(this.IsShowTitle){var d=" EWA_WND_ID='"+this.Id+"'",e="this.ownerDocument.parentWindow";EWA.B.IE||(e="this.ownerDocument.defaultView");if(this.IsCanMove){var g=e+"._EWA_UI_WINDOW_LIST[this.getAttribute('EWA_WND_ID')]._OpenerWindow.EWA$UI$COMMON$Move.";d=d+(' onmousedown="'+g+'OnMouseDown(this.parentNode.parentNode,event,true,true);" onmousemove="')+(g+'OnMouseMove(this.parentNode.parentNode,event,true,true);" onmouseup="')+
(g+'OnMouseUp(this.parentNode.parentNode);" onmouseout="try{')+(g+"OnMouseOut(this.parentNode.parentNode);}catch(e){}\" style='cursor:pointer' ")}g="<img src='"+(null==EWA.RV_STATIC_PATH?"/EmpScriptV2":EWA.RV_STATIC_PATH)+"/EWA_STYLE/images/dialog/but_1.gif' style='cursor:pointer'  onmouseover=\"var m=this.src.lastIndexOf('.');var s = this.src.substring(0, m);if(s.substring(s.length - 1).toUpperCase() == 'C'){return;}s+='c'+this.src.substring(m);this.src = s;\"";if(this.DisposeOnClose){var h=' ondblclick="'+
e+"._EWA_UI_WINDOW_LIST['"+this.Id+"'].CloseWindow();\"";e=' onclick="'+e+"._EWA_UI_WINDOW_LIST['"+this.Id+"'].CloseWindow();\""}else h=' ondblclick="'+e+"._EWA_UI_WINDOW_LIST['"+this.Id+"']._Dialog.Show(false);\"",e=' onclick="'+e+"._EWA_UI_WINDOW_LIST['"+this.Id+"']._Dialog.Show(false);\"";d="<table unselectable='on' onselectstart='return false;' style='cursor:pointer;margin-bottom:1px;width:100%;height:100%;-moz-user-select:none;' cellpadding='0' cellspacing='0' "+d+"><tr><td "+(h+" class='EWA_POP_TITLE_L'>...</td><td class='EWA_POP_TITLE_R' align=\"right\">")+
(g+" onmouseout =\"var m=this.src.lastIndexOf('.');var s = this.src.substring(0, m - 1);s = s + this.src.substring(m);this.src = s;\""+(e+" /></td></tr><tr><td class='EWA_POP_CNT' colspan=\"2\" valign=top></td></tr></table>"));b.innerHTML=d;d=a+"FrameContent";this.FrameContent=b.childNodes[0].rows[1].cells[0].id=d;a+="FrameTitle";this.FrameTitle=b.childNodes[0].rows[0].cells[0].id=a;this._FrameFore=b.id}else this.FrameContent=b.id};this._CreateCover=function(){var a=this.CreateWindow;null==a._EWA_UI_DIALOG_COVERINDEX&&
(a._EWA_UI_DIALOG_COVERINDEX=1E7);a._EWA_UI_DIALOG_COVERINDEX+=1;var b=a.document.createElement("div");b.style.cssText="display:block; width:100%; height:100%; ";b.setAttribute("style","display:block; width:100%; height:100%; ");b.style.zIndex=a._EWA_UI_DIALOG_COVERINDEX;b.className="ewa-ui-dialog-cover";b.id=this.CreateId()+"_DivCover";this._DivCover=b.id;a.document.body.appendChild(b)}}
function EWA_UI_PopWindowClass(a,b){this._DivCover=null;this._Dialog=new EWA_UI_DialogClass;this._Dialog.DisposeOnClose=b;this.OpendDialogs=[];this.ClassName=this._Name=this.Id=null;this._Url="about:blank";this._ParentWindow=a;this._OpenerWindow=window;this.OpendObject=EWA.B.IE?window.event?window.event.srcElement:null:null;this._CallBack=null;this.SetCallBack=function(d){this._CallBack=d};this._ReturnBack=null;this.SetReturnBack=function(d){this._ReturnBack=d};this.GetReturnBack=function(){return this._ReturnBack};
this.Show=function(d){this._Dialog.Show(d)};this.Hidden=function(){this._Dialog.Show(!1)};this.CloseWindow=function(){for(var d=0;d<this.OpendDialogs.length;d+=1)this.OpendDialogs[d].Dispose(),this.OpendDialogs[d]=null;this._Dialog.Dispose();if(this._OpenerWindow)try{this._OpenerWindow.document.body.focus(),this.OpendObject&&this.OpendObject.focus()}catch(e){}this.Dispose()};this.Dispose=function(){if(null!=this._CallBack)try{this._CallBack.Dispose()}catch(e){}if(null!=this._ReturnBack)try{this._ReturnBack.Dispose()}catch(e){}try{var d=
this.GetIframeWindow();d&&(d._EWA_DialogWnd=null)}catch(e){}if(this._OpenerWindow)try{this._OpenerWindow.EWA.UI.Dialog.WND[this.Id]=null,this._ParentWindow._EWA_UI_WINDOW_LIST[this.Id]=null}catch(e){}try{this._Dialog.Dispose(),this._ReturnBack=this._CallBack=this.OpendObject=this._OpenerWindow=this._ParentWindow=this._Dialog=null}catch(e){}EWA.B.IE&&CollectGarbage()};this.SetNewSize=function(d,e){this._Dialog.Resize(d,e)};this.Move=function(d,e){this._Dialog.Move(d,e)};this.MoveCenter=function(){this._Dialog.MoveCenter()};
this.GetIframeWindow=function(){if(null!=this._ParentWindow){var d="__EMP_COMMON_IFRAME"+this._Name;if(EWA.B.IE)var e=this._ParentWindow.frames[d];else for(var g=0;g<this._ParentWindow.frames.length;g+=1)if(this._ParentWindow.frames[g].name==d){e=this._ParentWindow.frames[g];break}return e}};this.SetCaption=function(d){this._Dialog.SetTitle(d)};this.SetUrl=function(d){"about:blank"!=d&&(this.GetIframeWindow().location=d)};this.Create=function(d,e,g){this._Name=g;this._CreateDialog(d,e);null==this._ParentWindow._EWA_UI_WINDOW_LIST&&
(this._ParentWindow._EWA_UI_WINDOW_LIST={});this._ParentWindow._EWA_UI_WINDOW_LIST[this.Id]=this};this._CreateDialog=function(d,e){this._Dialog.Id=this.Id;this._Dialog.Width=d;this._Dialog.Height=e;this._Dialog.CreateWindow=this._ParentWindow;this._Dialog.IsShowTitle=!0;this._Dialog.IsCanMove=!0;this._Dialog.IsCover=!0;this._Dialog.Create();this._Dialog.Show(!0);this.SetHtml("<iframe style='width:100%;height:100%;' name='__EMP_COMMON_IFRAME"+this._Name+"' frameborder='0'></iframe>")};this.SetHtml=
function(d){this._Dialog.SetHtml(d)};this.ResizeByContent=function(){this._Dialog.ResizeByContent()}}EWA.UI.DialogOnScroll=function(){if(!window.EWA_UI_DIALOG_FIXED&&"undefined"!=typeof _EWA_DIALOGS)for(var a=0;a<_EWA_DIALOGS.length;a+=1)if(null!=_EWA_DIALOGS[a])try{_EWA_DIALOGS[a].ScrollMoveDiv()}catch(b){_EWA_DIALOGS[a]=null}};
function EWA_Command(){this.CmdWindow=window;this.Cmd=null;this.CmdArgus=[];this.IsRunAuto=!1;this.Run=function(){if("function"==(typeof this.Cmd).toLowerCase())this.Cmd(this.CmdArgus);else{var a=this.CmdWindow.eval(this.Cmd);null==a?alert("EWA_Command.Cmd undefined! Pls check call method"):a(this.CmdArgus)}};this.Dispose=function(){for(var a=0;a<this.CmdArgus.length;a++)this.CmdArgus[a]=null;this.CmdArgus.length=0;this.Cmd=this.CmdWindow=this.CmdArgus=null}}
var __Dialog={D:EWA_UI_DialogClass,C:EWA_UI_PopWindowClass,WND:{},WNDCUR:null,CMD:EWA_Command,Pop:function(a,b,d){b=new EWA_UI_PopWindowClass(window,!0);"undefined"!=typeof _EWA_DialogWnd&&(b.CreateWindow=_EWA_DialogWnd._ParentWindow);b.Width=172;b.Height=200;b.ShadowColor="";__Cal.WND=new EWA_CalendarClass;"undefined"==typeof _EWA_DialogWnd?b.CreateWindow=window:(b.CreateWindow=_EWA_DialogWnd._ParentWindow,_EWA_DialogWnd.OpendDialogs[_EWA_DialogWnd.OpendDialogs.length]=b);b.Create();b.SetHtml(a);
b.MoveCenter();b.Show(!0);return b},_GetTopWindow:function(){for(var a=window;a.parent!=a;)a=a.parent;return 0<=a.document.documentElement.innerHTML.toUpperCase().indexOf("<FRAMESET")?window:a},_DialogMointer:function(){var a=EWA.UI.Dialog.WNDCUR;__Dialog.TimerInc++;if(!(null==a&&100<__Dialog.TimerInc)&&null!=a){var b=a.GetIframeWindow();null==b?(window.clearInterval(a._TimerHandle),EWA.UI.Dialog.WNDCUR=null):b.location.href!=a._Url&&(b.document.readyState?"complete"==b.document.readyState&&(window.clearInterval(a._TimerHandle),
EWA.UI.Dialog._SetTitle(a)):null!=b.document.body&&(b=b.document.documentElement.innerHTML,b=b.toLowerCase(),0<b.indexOf("</body>")||0<b.indexOf("</html>"))&&(0==a._IncNoIe?a._IncNoIe=1:EWA.UI.Dialog._SetTitle(a)))}},_SetTitle:function(a){if(null!=a){var b=a.GetIframeWindow();b._EWA_DialogWnd=a;a._Url=b.location.href;a.SetCaption(b.document.title);b.document.getElementsByTagName("INPUT");b.document.body.onunload=function(){try{this._EWA_DialogWnd._Url=""}catch(e){}};var d=__Dialog._SetInputFocus(b.document);
d||__Dialog._SetTextAreaFocus(b.document);d||b.document.body.focus();__Dialog._SetClose(b.document);b.document.body.style.margin="0px";b.document.body.style.overflow="hidden";a._Dialog.ResizeByContent();a.MoveCenter();null!=a._CallBack&&a._CallBack.Run();b=null}},_SetClose:function(a){for(var b=a.getElementsByTagName("INPUT"),d=0;d<b.length;d+=1){var e=b[d].type.toLowerCase();"button"!=e&&"submit"!=e||__Dialog._SetCloseFunction(b[d])}b=a.getElementsByTagName("BUTTON");for(d=0;d<b.length;d++)__Dialog._SetCloseFunction(b[d])},
_SetCloseFunction:function(a){var b=a.value.trim().toLowerCase();"button"==a.tagName.toLowerCase()&&(b=a.innerHTML);!(0<=b.indexOf("\u5173\u95ed")||0<=b.indexOf("\u53d6\u6d88")||0<=b.indexOf("close")||0<=b.indexOf("cancel"))||null!=a.onclick&&0<=a.onclick.toString().indexOf("EWA")||(a.onclick=function(){var d=this.ownerDocument;(d.parentWindow?d.parentWindow:d.defaultView)._EWA_DialogWnd.CloseWindow()})},_SetInputFocus:function(a){a=a.getElementsByTagName("INPUT");for(var b=0;b<a.length;b+=1){var d=
a[b],e=d.type.toLowerCase();if("text"==e||"password"==e)if(e=d.parentNode.innerHTML,!(null!=e&&0<=e.toString().indexOf("EWA.F.I.Date")))try{return d.focus(),a=null,!0}catch(g){}}return!1},_SetTextAreaFocus:function(a){a=a.getElementsByTagName("TEXTAREA");for(var b=0;b<a.length;b+=1)try{return a[b].focus(),a=null,!0}catch(d){}return!1},OpenReloadClose:function(a,b,d,e,g,h,k){EWA.UI.Dialog.OpenFrame(a,b,d,e,g,"RELOAD_PARENT,CLOSE_SELF",h,k)},OpenReload:function(a,b,d,e,g,h,k){EWA.UI.Dialog.OpenFrame(a,
b,d,e,g,"RELOAD_PARENT",h,k)},OpenReloadClear:function(a,b,d,e,g,h,k){EWA.UI.Dialog.OpenFrame(a,b,d,e,g,"RELOAD_PARENT,CLEAR_SELF",h,k)},OpenFrame:function(a,b,d,e,g,h,k,l){null==h&&(h="");__Dialog[a]||(__Dialog[a]={});__Dialog[a].AfterMsg=null==k?"":k;if("yes"==l&&EWA.F&&EWA.F.FOS[a]&&EWA.F.FOS[a].Url){l=new EWA_UrlClass(EWA.F.FOS[a].Url);l.RemoveEwa();g=new EWA_UrlClass("a1?"+g);for(var m in g._Paras)k=g.GetParameter(m),l.AddParameter(m,k);g=l.GetParas()}h="EWA_P_BEHAVIOR="+h+"&EWA_PARENT_FRAME="+
a;a=EWA.UI.Dialog.GetUrl(b,d,g?g+"&"+h:h);EWA.UI.Dialog.OpenWindow(a,b+"-"+d,100,50,e)},OpenWindow:function(a,b,d,e,g,h,k,l){var m=void 0===l?!0:l;var n=g?window:EWA.UI.Dialog._GetTopWindow();g=a;null!=g&&"about:blank"!=g&&(g=0<a.indexOf("?")?g+("&_r="+Math.random()):g+("?_r="+Math.random()));g=g.replace(/\|/ig,"%7c");a="_EWA_UI_DIALOG_"+b;EWA.UI.Dialog.WND[a]=null;EWA.UI.Dialog.WND[a]=new EWA.UI.Dialog.C(n,m);m=EWA.UI.Dialog.WND[a];m.Id=a;m.DisposeOnClose=l;m.Create(d,e,b);null!=g&&m.SetUrl(g);null!=
h&&m.SetCallBack(h);null!=k&&m.SetReturnBack(k);__Dialog.TimerInc=0;m._TimerHandle=window.setInterval(EWA.UI.Dialog._DialogMointer,155);m._IncNoIe=0;EWA.UI.Dialog.WNDCUR=m;return EWA.UI.Dialog.WND[a]},GetUrl:function(a,b,d){return EWA.CP+"/EWA_STYLE/cgi-bin/?XMLNAME="+a.toURL()+"&ITEMNAME="+b.toURL()+"&"+d}};
EWA.OW={Dia:null,PWin:null,Frame:null,Close:function(){EWA.OW.Dia?EWA.OW.Dia.CloseWindow():alert("Dialog not Load")},Load:function(){EWA.OW.Dia=window._EWA_DialogWnd;EWA.OW.PWin=EWA.OW.Dia?EWA.OW.Dia._OpenerWindow:null;EWA.OW.Frame=EWA.OW.PWin?EWA.OW.PWin.EWA.F.FOS[EWA.OW.PWin.EWA.F.CID]:null}};EWA.UI.Dialog=__Dialog;
function EWA_UI_DiaNewClass(){this.Id=null;this.IS_AUTO_SIZE=!0;this._GetIndex=function(){var a=window;null==a._EWA_UI_DIALOG_COVERINDEX&&(a._EWA_UI_DIALOG_COVERINDEX=1E7);a._EWA_UI_DIALOG_COVERINDEX++;return a._EWA_UI_DIALOG_COVERINDEX};this._GetCover=function(){return $X(this.Id+"_cover")};this.Create=function(a,b,d,e,g,h,k){this._isUrl=g;this._width=a;this._height=b;this._title=d;this._content=e;this._noHeader=h;var l=this._GetIndex();this.index=l;this.Id=("_EWA_UI_DIA_"+Math.random()).replace(".",
"");var m=["<div id='"+this.Id+"' class='ewa-ui-dialog'>"];m.push("<div id='"+this.Id+"_cover'  class='ewa-ui-dialog-cover' style='position: fixed;z-index: "+l+";'></div>");l=" EWA_WND_ID='"+this.Id+"'";l+=' onmousedown="window.EWA$UI$COMMON$Move.OnMouseDown(this.parentNode.parentNode,event,true,true);" onmousemove="window.EWA$UI$COMMON$Move.OnMouseMove(this.parentNode.parentNode,event,true,true);" onmouseup="window.EWA$UI$COMMON$Move.OnMouseUp(this.parentNode.parentNode);" onmouseout="window.EWA$UI$COMMON$Move.OnMouseOut(this.parentNode.parentNode);"';
m.push("<div id='"+this.Id+"_box'  class='ewa-ui-dialog-box'  style='position: fixed;z-index: "+this._GetIndex()+";'>");m.push("<div style='position:relative;'>");h?m.push("<div id='"+this.Id+"_title' class='ewa-ui-dialog-title-noheader' style=''><a href='javascript:class_"+this.Id+".Close();' class='fa' style='text-decoration:none;padding:2px 2px 3px 3px;display:block'>&#xf00d</a></div>"):m.push("<div  id='"+this.Id+"_title'  class='ewa-ui-dialog-title'"+l+" style=''><span style='margin-left: 5px;'></span><a href='javascript:class_"+
this.Id+".Close();' class='fa' style=''>&#xf00d</a></div>");m.push("<div  id='"+this.Id+"_content' class='ewa-ui-dialog-content' style='width: 100%;overflow: auto;'></div>");m.push("</div>");m.push("</div>");m.push("</div>");$("body").append(m.join(""));$(".ewa-ui-dialog-title a.fa").css({color:"#aaa"}).hover(function(){$(this).css({color:"orangered"})},function(){$(this).css({color:"#aaa"})});$("#"+this.Id+"_box");this.SetSize(a,b);this.SetTitle(d);this.ShowCover(!0);this.MoveCenter();window["class_"+
this.Id]=this;this.SetContent(e,g,k);return this};this.SetSize=function(a,b){var d=$("#"+this.Id+"_content");b=b?b:200;d.css("width",a?a:400);d.css("height",b);0<$("#"+this.Id+"_title span").length&&$("#"+this.Id+"_title").height()};this.SetTitle=function(a){a&&$("#"+this.Id+"_title span").html(a)};this.getTitleContainer=function(){var a=$("#"+this.Id+"_title");return 0==a.length?null:a[0]};this.SetContent=function(a,b,d){var e=$("#"+this.Id+"_content");b?(a='<iframe style="width:100%;height:100%" frameborder="0" src="'+
a+'"></iframe>',e.css("overflow","hidden")):$(this._GetCover()).css("background-image","none");e.html(a);if(b){var g=this;setTimeout(function(){g._ChkIframeLoaded(d)},222)}else d&&d(this)};this.SetObject=function(a,b){var d=$("#"+this.Id+"_content");$(this._GetCover()).css("background-image","none");b||d.html("");d.append(a)};this._ChkIframeLoaded=function(a){var b=$("#"+this.Id+"_content iframe");if(0!=b.length){b=b[0];try{if(b.contentWindow&&b.contentWindow.document&&"complete"==b.contentWindow.document.readyState&&
b.contentWindow.$)try{this._IframeLoaded(b.contentWindow,a)}catch(e){this._IframeLoaded(b.contentWindow,a)}else{var d=this;setTimeout(function(){d._ChkIframeLoaded(a)},222)}}catch(e){console.log(e)}}};this._IframeLoaded=function(a,b){a._EWA_DialogWnd=this;this.SetTitle(a.document.title);new EWA_UrlClass(a.location.href);this.IS_AUTO_SIZE&&this.AutoSize();this.MoveCenter();var d=this;a=a.$.find("button,input");for(var e=0;e<a.length;e++){var g=a[e],h=!1;if(g.id&&0<=g.id.toLowerCase().indexOf("close"))h=
!0;else{var k=g.value||g.innerHTML;k&&(0<=k.indexOf("\u5173\u95ed")||0<=k.indexOf("\u53d6\u6d88"))&&(h=!0)}h&&(g.onclick=function(){d.Close()})}$(this._GetCover()).css("background-image","none");b&&b(this)};this.AutoSize=function(){var a=$(this.getContent());if(this._isUrl){if(a=a.find("iframe"),a=a[0].contentWindow,a.$){var b=a.$("#Test1");0<b.length&&(a=b.outerWidth(),b=b.outerHeight(),this.SetSize(a,b),this.MoveCenter())}}else b=a.find("#Test1"),0<b.length?(a=b.outerWidth(),b=b.outerHeight()):
(b=a[0].scrollHeight,a=a[0].scrollWidth),this.SetSize(a,b),this.MoveCenter()};this.getContent=function(){return $("#"+this.Id+"_content")[0]};this.getMain=function(){return $("#"+this.Id+"_box")[0]};this.ShowCover=function(a){var b=$("#"+this.Id+"_cover");if(a){a=$(window).width();var d=$(window).height();b.css("width",a);b.css("height",d);b.show()}else b.hide()};this.MoveCenter=function(){var a=$(window).width(),b=$(window).height(),d=$("#"+this.Id+"_box"),e=d.width();d=d.height();a=(a-e)/2;b=(b-
d)/2;0>a&&(a=0);0>b&&(b=0);this.Move(a,b)};this.Move=function(a,b){var d=$("#"+this.Id+"_box");d.css("top",b);d.css("left",a)};this.Close=function(){this.IsCloseAsHidden?$("#"+this.Id).hide():this.Dispose()};this.Dispose=function(){$("#"+this.Id).remove();window["class_"+this.Id]=null;delete window["class_"+this.Id]};this.Show=function(){this.IsCloseAsHidden?$("#"+this.Id).show():alert("\u8bf7\u8bbe\u7f6e\u53c2\u6570 IsCloseAsHidden=true")}}
$Dialog=function(a,b,d,e,g,h){var k=!(d&&e),l=new EWA_UI_DiaNewClass;l.IS_AUTO_SIZE=k;l.Create(d,e,b,a,!0,g,h);l.MoveCenter();return l};$DialogHtml=function(a,b,d,e,g,h){var k=new EWA_UI_DiaNewClass;k.Create(d,e,b,a,!1,g);k.MoveCenter();h&&h(k,id);return k};
$DialogInstall=function(a,b,d,e,g,h){var k=EWA_Utils.tempId("dialogInstall"),l=$DialogHtml("<div id='"+k+"'></div>","",d,e,g);$Install(a,k,function(){var m=!(d&&e);if(g||b)m&&l.AutoSize(),h&&h(l,q);else{var n=l.getContent(),p=$(n).find(".EWA_TABLE");if(0!=p.length&&p[0].id){var q=p[0].id;p=q.replace("EWA_FRAME_","").replace("EWA_LF_","");if(EWA&&EWA.F&&EWA.F.FOS&&EWA.F.FOS[p])if(p=EWA.F.FOS[p].Title,q.startsWith("EWA_LF_"))var t=0,u=setInterval(function(){t++;if(90<t)window.clearInterval(u),m&&l.AutoSize(),
h&&h(l,q);else{var r=$(n).find(".ewa_lf_func");if(0!=r.length){window.clearInterval(u);var w=l.getTitleContainer();if(w){r.css({"background-color":"transparent",display:"block","float":"left","font-size":"14px"});var v=r.find(".ewa_lf_func_caption");v.css("color","#08c");v.text(v.text().replace("[","").replace("]","").trim());$(w).find("span:eq(0)").remove();$(w).append(r).css("border-bottom","1px solid #eee")}m&&l.AutoSize();h&&h(l,q)}}},10);else p&&l.SetTitle(p),m&&l.AutoSize(),h&&h(l,q);else m&&
l.AutoSize(),h&&h(l,q)}else m&&l.AutoSize(),h&&h(l,q)}});return l};
function EWA_UI_CalendarYearClass(){this.Create=function(a,b,d,e,g){console.log(b,d,e);this.classId=("CY"+Math.random()).replace(".","");EWA.UI.CalendarYear=EWA.UI.CalendarYear||{};EWA.UI.CalendarYear[this.classId]=this;$($X(a)).append('<div class="ewa-ui-calendar-year" id="'+this.classId+'"></div>');a=$("#"+this.classId);var h=new EWA_CalendarClass,k=new Date;b&&d&&(k=new Date(b,d-1,1));b=d=k.getMonth();g||(b=3*Math.round(d/3-.5));g=k.getFullYear();if(!e||0>=e)e=12;for(k=1;k<=e;k++){if("enus"==EWA.LANG){var l=
b+1+"/"+g;h.SetDate("dd/MM/yyyy"==_EWA_G_SETTINGS.DATE?"01/"+(b+1)+"/"+g:b+1+"/01/"+g)}else l=g+"-"+(b+1),h.SetDate(l+"-01");d=h.CreateCalendar();var m=this.classId+"_"+g+"_"+b;d.id=m;d.setAttribute("yearmonth",g+(10>b?"0":"")+b);a.append(d);$(d.rows[3]).remove();$(d.rows[0].cells[1]).remove();l="<a href='javascript:EWA.UI.CalendarYear."+this.classId+'.chooeseMonth("'+m+"\",event)'>"+l+"</a>";$(d.rows[0].cells[0]).html(l);$(d).find("th").attr("onclick","EWA.UI.CalendarYear."+this.classId+".chooeseWeek('"+
m+"',this, event)");b++;12==b&&(b=0,g++);$(d).find("th:eq(0)").addClass("rq-sun");$(d).find("th:eq(6)").addClass("rq-sat")}a.append('<div style="clear:both"></div>');a.find(".ewa-ui-days td").attr("onclick","EWA.UI.CalendarYear."+this.classId+".Click(this,event)");_EWA_CALENDAR_ITEM=h};this.chooeseWeek=function(a,b,d){var e=b.cellIndex;a=$("#"+a).find(".ewa-ui-days")[0];for(var g=$(b).attr("chooese"),h=[],k=1;k<a.rows.length;k++){var l=a.rows[k].cells[e];0!=l.childNodes.length&&(g?$(l).removeClass("ewa-ui-calendar-year-chooese").attr("chooese",
null):$(l).addClass("ewa-ui-calendar-year-chooese").attr("chooese",1),h.push($(l).find("div:eq(0)").attr("title")))}g?$(b).attr("chooese",null):$(b).attr("chooese",1);this.ClickEvent&&this.ClickEvent(h,!g,d)};this.chooeseMonth=function(a,b){var d=$("#"+a),e=d.attr("all1"),g=[];e?(d.attr("all1",null),$("#"+a+" .ewa-ui-days .ewa-ui-calendar-year-chooese").each(function(){$(this).removeClass("ewa-ui-calendar-year-chooese").attr("chooese",null);g.push($(this).find("div:eq(0)").attr("title"))}),d.find("th").attr("chooese",
null)):(d.attr("all1","yes"),$("#"+a+" .ewa-ui-days tr:gt(0) td div[title]").parent().each(function(){$(this).addClass("ewa-ui-calendar-year-chooese").attr("chooese",1);g.push($(this).find("div:eq(0)").attr("title"))}),d.find("th").attr("chooese",1));this.ClickEvent&&this.ClickEvent(g,!e,b)};this.SetChooeses=function(a,b){for(var d in a){var e=a[d][b];e&&(e=e.split(" ")[0],$("#"+this.classId+" .ewa-ui-days td div[title='"+e+"']").parent().addClass("ewa-ui-calendar-year-chooese").attr("chooese",1))}$("#"+
this.classId+" .ewa-ui-date").each(function(){$(this).find(".ewa-ui-calendar-year-chooese").length==$(this).find("td div[title]").length&&($(this).attr("all1","yes"),$(this).find("th").attr("chooese","yes"))})};this.GetChooeses=function(a){var b=[];(a?$(a):$("#"+this.classId+" .ewa-ui-days")).find(".ewa-ui-calendar-year-chooese").each(function(){b.push($(this).find("div:eq(0)").attr("title"))});return b};this.GetUnChooeses=function(a){var b=[];(a?$(a):$("#"+this.classId+" .ewa-ui-days")).find("td").each(function(){if(!$(this).attr("chooese")){var d=
$(this).find("div:eq(0)").attr("title");d&&b.push(d)}});return b};this.Click=function(a,b){if(""!=a.innerHTML.trim()){if($(a).attr("chooese")){$(a).removeClass("ewa-ui-calendar-year-chooese").attr("chooese",null);var d=!1}else $(a).addClass("ewa-ui-calendar-year-chooese").attr("chooese",1),d=!0;this.ClickEvent&&(a=[$(a).find("div:eq(0)").attr("title")],this.ClickEvent(a,d,b))}};this.ClickEvent=function(a,b,d){console.log("overwrite xxx.ClickEvent(rqs,   isChecked, evt)")}}
function EWA_UI_CalendarYearGroupClass(){this.denysBefore=function(a){a=new EWA_DateClass(a);for(var b=1;1500>b;b++){var d=a.AddDays(-1);d=d.split(" ")[0];if(0==this.denyDay(d).length)break}};this.denysAfter=function(a){a=new EWA_DateClass(a);for(var b=1;1500>b;b++){var d=a.AddDays(1);d=d.split(" ")[0];if(0==this.denyDay(d).length)break}};this.denyDay=function(a){a=$("#"+this.classId).find(".ewa-ui-days td").find("div[title='"+a+"']").parent();a.addClass("ewa-ui-calendar-year-deny").attr("deny",1);
return a};this.unDenyDay=function(a){a=$("#"+this.classId).find(".ewa-ui-days td").find("div[title='"+a+"']").parent();a.removeClass("ewa-ui-calendar-year-deny").attr("deny",null);return a};this.CUR_GROUP_NAME=null;this.setGroupName=function(a){a?(this.CUR_GROUP_NAME="CYG_"+a.replace(/:|\?|\.|=|;|\(|\)|\-/ig,""),this.CUR_GROUP_NAME_O=a):this.CUR_GROUP_NAME_O=this.CUR_GROUP_NAME=null};this.Create=function(a,b,d,e,g,h,k){this.classId=("CY"+Math.random()).replace(".","");EWA.UI.CalendarYear=EWA.UI.CalendarYear||
{};EWA.UI.CalendarYear[this.classId]=this;$($X(a)).append('<div class="ewa-ui-calendar-year" id="'+this.classId+'"></div>');a=$("#"+this.classId);var l=new Date;b&&d&&(l=new Date(b,d-1,1));b=d=l.getMonth();g||(b=3*Math.round(d/3-.5));g=l.getFullYear();if(!e||0>=e)e=12;l=new EWA_CalendarClass;for(d=1;d<=e;d++){var m=b+1;if("enus"==EWA.LANG){var n=m+"/"+g;l.SetDate("dd/MM/yyyy"==_EWA_G_SETTINGS.DATE?"01/"+m+"/"+g:m+"/01/"+g)}else n=g+"-"+(b+1),l.SetDate(n+"-01");var p=l.CreateCalendar(),q=g+(10>m?"0":
"")+m;m=this.classId+"_"+q;p.id=m;p.setAttribute("yearmonth",q);a.append(p);$(p.rows[3]).remove();$(p.rows[0].cells[1]).remove();n="<a href='javascript:EWA.UI.CalendarYear."+this.classId+'.chooeseMonth("'+m+"\",event)'>"+n+"</a>";$(p.rows[0].cells[0]).html(n);$(p).find("th").attr("onclick","EWA.UI.CalendarYear."+this.classId+".chooeseWeek('"+m+"',this, event)");b++;12==b&&(b=0,g++);$(p).find("th:eq(0)").addClass("rq-sun");$(p).find("th:eq(6)").addClass("rq-sat")}a.append('<div style="clear:both"></div>');
a.find(".ewa-ui-days td").attr("onclick","EWA.UI.CalendarYear."+this.classId+".Click(this,event)");_EWA_CALENDAR_ITEM=l;h&&this.denysBefore(h);k&&this.denysAfter(k)};this.getChooeseName=function(){return this.CUR_GROUP_NAME?this.CUR_GROUP_NAME:"chooese"};this.addOrRemoveMark=function(a,b,d){var e=this.getChooeseName(),g=$(a);b?(g.find("."+e).remove(),g.attr(e,null),this.unMarkEvent&&this.unMarkEvent(a,d)):0==g.find("."+e).length&&(g.append("<nobr class='ewa-ui-calendar-year-item "+e+"'></nobr>"),
g.attr(e,1),this.markEvent&&this.markEvent(a,d));g.attr("_last_item_count_")&&g.removeClass(g.attr("_last_item_count_"));a=g.find(".ewa-ui-calendar-year-item").length;0<a?(g.addClass("ewa-ui-calendar-year-chooese"),a=100>a?"N"+a:"NP",g.addClass("N "+a).attr("_last_item_count_",a)):g.removeClass("ewa-ui-calendar-year-chooese").removeClass("N")};this.chooeseWeek=function(a,b,d){for(var e=$("#"+a).find(".ewa-ui-days")[0],g=this.getChooeseName(),h=[],k=b.cellIndex,l=!0,m=!1,n=1;n<e.rows.length;n++){var p=
e.rows[n].cells[k];if(0!=p.childNodes.length&&($(p).attr("deny")||(m=!0),$(p).attr(g)||(l=!1),m&&!l))break}if(!m)$Tip("\u6ca1\u6709\u53ef\u9009\u7684\u65e5\u671f");else if(!this.ClickBeforeEvent||this.ClickBeforeEvent(a,b,d,"WEEK")){for(n=1;n<e.rows.length;n++)p=e.rows[n].cells[k],0==p.childNodes.length||$(p).attr("deny")||(a=$(p).find("div:eq(0)").attr("title"),h.push(a),this.addOrRemoveMark(p,l,a));l?$(b).attr(g,null):$(b).attr(g,1);this.ClickEvent&&this.ClickEvent(h,!l,d)}};this.chooeseMonth=function(a,
b){for(var d=$("#"+a+" .ewa-ui-days")[0],e=this.getChooeseName(),g=!0,h=!1,k=1;k<d.rows.length;k++){for(var l=d.rows[k],m=0;m<l.cells.length;m++){var n=l.cells[m];0!=n.childNodes.length&&(h||$(n).attr("deny")||(h=!0),$(n).attr(e)||(g=!1))}if(!g&&h)break}if(!h)$Tip("\u6ca1\u6709\u53ef\u9009\u7684\u65e5\u671f");else if(!this.ClickBeforeEvent||this.ClickBeforeEvent(a,null,b,"MONTH")){a=[];for(k=1;k<d.rows.length;k++)for(l=d.rows[k],m=0;m<l.cells.length;m++)n=l.cells[m],0==n.childNodes.length||$(n).attr("deny")||
(e=$(n).find("div:eq(0)").attr("title"),a.push(e),this.addOrRemoveMark(n,g,e));this.ClickEvent&&this.ClickEvent(a,!g,b)}};this.SetChooeses=function(a,b,d,e){this._RQ_MAP=null;var g=$("#"+this.classId);g.find(".ewa-ui-days td");for(var h in a){var k=a[h],l=k[b];if(l){d&&this.setGroupName(k[d]);l=l.split(" ")[0];var m=this.findTdByRq(l);m&&0<m.length?(this.addOrRemoveMark(m,!1,l),e&&e(m[0],l,k)):console.log("\u65e0\u6548\u7684\u65e5\u671f"+l)}}this._RQ_MAP=null;g.find(".ewa-ui-date").each(function(){$(this).find(".ewa-ui-calendar-year-chooese").length==
$(this).find("td div[title]").length&&($(this).attr("all1","yes"),$(this).find("th").attr("chooese","yes"))})};this.findTdByRq=function(a){if(!a)return null;if(!this._RQ_MAP)this._RQ_MAP={};else if(this._RQ_MAP[a])return this._RQ_MAP[a];var b=a.replace(/-/ig,""),d=b.substring(0,6);d=$("#"+this.classId+" table[yearmonth='"+d+"']");if(0==d.length)return this._RQ_MAP[a]=null;this._RQ_MAP[a]=d.find("div[date='"+b+"']").parent();return this._RQ_MAP[a]};this.GetChooeses=function(a){var b=[];(a?$(a):$("#"+
this.classId+" .ewa-ui-days")).find(".ewa-ui-calendar-year-chooese").each(function(){b.push($(this).find("div:eq(0)").attr("title"))});return b};this.GetUnChooeses=function(a){var b=[];(a?$(a):$("#"+this.classId+" .ewa-ui-days")).find("td").each(function(){if(!$(this).attr("chooese")){var d=$(this).find("div:eq(0)").attr("title");d&&b.push(d)}});return b};this.Click=function(a,b){if(!$(a).attr("deny")&&""!=a.innerHTML.trim()&&(!this.ClickBeforeEvent||this.ClickBeforeEvent(a.id,a,b,"DAY"))){var d=
$(a).find("div:eq(0)").attr("title"),e=this.getChooeseName();e=$(a).attr(e);this.addOrRemoveMark(a,e,d);this.ClickEvent&&this.ClickEvent([d],!e,b)}};this.ClickBeforeEvent=function(a,b,d,e){console.log("overwrite xxx.ClickBeforeEvent(id, obj, evt, type)");return!0};this.ClickEvent=function(a,b,d){console.log("overwrite xxx.ClickEvent(rqs,   isChecked, evt)")}}
function EWA_CalendarClass(){this._Weeks=_EWA_G_SETTINGS.WEEKS.split(",");this._Days=[31,28,31,30,31,30,31,31,30,31,30,31];this._Months=_EWA_G_SETTINGS.MONTHS.split(",");this._CurDate=new Date;this._SelectMinute=this._SelectHour=this._SelectYear=this._SelectMonth=this._DaysTable=null;this.CreateWindow=window;this.IsShowTime=!1;this.Dialog=this.Object=null;this.ChangeDate=function(){this._SetNewDate(this._SelectYear.value,this._SelectMonth.value,1);this._WriteDays(!1)};this._SetNewDate=function(a,
b,d){if(!a){a=this._SelectYear.value;b=this._SelectMonth.value;d=this._DaysTable.getAttribute("EMP_CURRENT_DAY");var e=(0==(a-2008)%4&&0!=a%100||0==a%400)&&1==b?29:this._Days[b];d>e&&(d=e)}this._CurDate=new Date(a,b,d);this.IsShowTime&&(a=this._SelectMinute.value,this._CurDate.setHours(this._SelectHour.value),this._CurDate.setMinutes(a))};this.SetDate=function(a){a=a.split(" ");var b=a[0].split("-");3>b.length&&(b=a[0].split("/"));3>b.length&&(b=a[0].split("."));3==b.length&&(b[0]=parseInt(b[0]),
"0"==b[1].substring(0,1)&&(b[1]=b[1].substring(1)),"0"==b[2].substring(0,1)&&(b[2]=b[2].substring(1)),b[1]=parseInt(b[1]),b[2]=parseInt(b[2]),"NaN"!=b[0]+""&&"NaN"!=b[1]+""&&"NaN"!=b[2]+""&&("ENUS"==EWA.LANG.toUpperCase()?this._CurDate="dd/MM/yyyy"==_EWA_G_SETTINGS.DATE?new Date(b[2],b[1]-1,b[0]):new Date(b[2],b[0]-1,b[1]):this._CurDate=new Date(b[0],b[1]-1,b[2]),1<a.length&&(b=a[1].split(":"),this._CurDate.setHours(b[0]),1<b.length&&this._CurDate.setMinutes(b[1]),2<b.length&&this._CurDate.setSeconds(b[2].split(".")[0]))),
a=this._CurDate.getDate(),this._DaysTable&&this._DaysTable.setAttribute("EMP_CURRENT_DAY",a))};this._CreateTime=function(){var a=this._CurDate,b=this.CreateWindow.document.createElement("div"),d=this.CreateWindow.document.createElement("select"),e=this.CreateWindow.document.createElement("select"),g=this.CreateWindow.document.createElement("span");"enus"==EWA.LANG.toLowerCase()?g.innerHTML="Time ":g.innerHTML="\u65f6\u95f4 ";var h=this.CreateWindow.document.createElement("span");h.innerHTML=":";for(var k=
0;24>k;k++){var l=10>k?"0"+k:k+"";d.options[d.options.length]=new Option(l,l)}d.value=(100+a.getHours()+"").substring(1);b.appendChild(g);b.appendChild(d);b.appendChild(h);b.appendChild(e);d=this.CreateWindow.document.createElement("span");d.innerHTML="&nbsp;";g=this.CreateWindow.document.createElement("span");g.style.cursor="pointer";g.style.color="blue";g.setAttribute("IS_ALL",0);g.onclick=function(){e.options.length=0;if(1==this.getAttribute("IS_ALL")){for(var m=0;12>m;m++){var n=(100+5*m+"").substring(1);
e.options[e.options.length]=new Option(n,n)}m=a.getMinutes();m=0==m%5?m:5*parseInt(m/5);e.value=(100+m+"").substring(1);this.setAttribute("IS_ALL",0);this.innerHTML="\u5168\u90e8"}else{for(m=0;60>m;m++)n=(100+m+"").substring(1),e.options[e.options.length]=new Option(n,n);m=a.getMinutes();e.value=(100+m+"").substring(1);this.setAttribute("IS_ALL",1);this.innerHTML="\u6bcf5\u5206\u949f"}};b.appendChild(d);b.appendChild(g);return b};this.CreateTime=function(){var a=[];a.push("<table border=0 class='ewa-ui-date-picker' style='border:1px solid #aaa' bgcolor='#E1E1E1' onselectstart='return false'>");
a.push("<tr><td><nobr></nobr></td></tr>");a.push("</table>");var b=this.CreateWindow.document.createElement("DIV");b.innerHTML=a.join("");a=b.childNodes[0].rows[0].cells[0].childNodes[0];for(var d=this._CreateTime();0<d.childNodes.length;)a.appendChild(d.childNodes[0]);d=a.getElementsByTagName("span")[3];d.setAttribute("IS_ALL",1);d.click();d.style.display="none";d=this.CreateWindow.document.createElement("input");d.type="button";if("enus"==EWA.LANG.toLowerCase()){d.value="OK";var e="Clear"}else d.value=
"\u786e\u5b9a",e="\u6e05\u9664";d.onclick=function(){var g=EWA.B.IE?this.ownerDocument.parentWindow:this.ownerDocument.defaultView,h=this.parentNode.getElementsByTagName("select"),k=g._EWA_CALENDAR_TIME_ITEM.Object.value;h=h[0].value+":"+h[1].value;g._EWA_CALENDAR_TIME_ITEM.Object.value=h;g._EWA_CALENDAR_TIME_ITEM.Dialog.Show(!1);k!=h&&($(g._EWA_CALENDAR_TIME_ITEM.Object).trigger("keyup"),$(g._EWA_CALENDAR_TIME_ITEM.Object).trigger("blur"))};a.appendChild(d);d="<a href='javascript:void(0)' style='margin:0 5px;color:#08c;font-size:12px;'>"+
e+"</a>";$(a).append(d);$(a).find("a").click(function(){var g=EWA.B.IE?this.ownerDocument.parentWindow:this.ownerDocument.defaultView,h=g._EWA_CALENDAR_TIME_ITEM.Object.value;g._EWA_CALENDAR_TIME_ITEM.Object.value="";g._EWA_CALENDAR_TIME_ITEM.Dialog.Show(!1);""!=h&&($(g._EWA_CALENDAR_TIME_ITEM.Object).trigger("keyup"),$(g._EWA_CALENDAR_TIME_ITEM.Object).trigger("blur"))});$(a).append("<b class='fa fa-close' style='color:#666;font-size:12px;'></b>");$(a).find("b").click(function(){(EWA.B.IE?this.ownerDocument.parentWindow:
this.ownerDocument.defaultView)._EWA_CALENDAR_TIME_ITEM.Dialog.Show(!1)});return b.childNodes[0]};this.CreateCalendar=function(a){this.IsShowTime=a;var b=[];b.push("<table border=0 class='ewa-ui-date' onselectstart='return false'>");b.push("<tr>");b.push("<td height=28>"+this._CreateMonth()+"</td>");b.push("<td align=right>"+this._CreateYear()+"</td>");b.push("</tr>");b.push("<tr><td colspan=2>"+this._CreateDaysTable()+"</td></tr>");b.push("<tr style='display:none'><td colspan=2></td></tr>");b.push("<tr><td colspan=2>"+
this._CreateToDay()+"</td></tr>");b.push("</table>");var d=this.CreateWindow.document.createElement("DIV");d.innerHTML=b.join("");this._DaysTable=d.childNodes[0].rows[1].cells[0].childNodes[0];b=d.getElementsByTagName("select");this._SelectMonth=b[0];this._SelectYear=b[1];this._WriteDays();if(a){a=d.childNodes[0].rows[2];a.style.display="";a=a.cells[0];for(b=this._CreateTime();0<b.childNodes.length;)a.appendChild(b.childNodes[0]);a.getElementsByTagName("span")[3].click();this._SelectHour=a.getElementsByTagName("select")[0];
this._SelectMinute=a.getElementsByTagName("select")[1]}return d.childNodes[0]};this._CreateToDay=function(){var a={};"enus"==EWA.LANG.toLowerCase()?(a.today="Today",a.empty_title="Empty",a.empty="Empty",a.close="Close"):(a.today="\u8bbe\u7f6e\u4e3a\u4eca\u5929",a.empty_title="\u6e05\u7a7a\u65e5\u671f",a.empty="\u7a7a",a.close="\u5173\u95ed");var b="<div class='ewa-ui-date-today-day' title='"+a.today+"' onclick='_EWA_CALENDAR_ITEM.Object.value=this.innerHTML;if(_EWA_CALENDAR_ITEM.Object.onkeyup!=null)_EWA_CALENDAR_ITEM.Object.onkeyup();if(_EWA_CALENDAR_ITEM.Object.onblur!=null)_EWA_CALENDAR_ITEM.Object.onblur();_EWA_CALENDAR_ITEM.Dialog.Show(false);'>"+
this.GetDate(new Date)+"</div>";var d="<table border=0 class='ewa-ui-date-today' width=100%><tr><td class='ewa-ui-date-today-day' onclick='_EWA_CALENDAR_ITEM.Object.value=$(this).next().text();if(_EWA_CALENDAR_ITEM.Object.onkeyup!=null)_EWA_CALENDAR_ITEM.Object.onkeyup();if(_EWA_CALENDAR_ITEM.Object.onblur!=null)_EWA_CALENDAR_ITEM.Object.onblur();_EWA_CALENDAR_ITEM.Dialog.Show(false);'>"+(_EWA_G_SETTINGS.Today+"</td>");d=d+("<td>"+b+"</td><td><div class='ewa-ui-date-today-clear' title='")+(a.empty_title+
"' onclick='_EWA_CALENDAR_ITEM.Object.value=\"\";if(_EWA_CALENDAR_ITEM.Object.onkeyup!=null)_EWA_CALENDAR_ITEM.Object.onkeyup();if(_EWA_CALENDAR_ITEM.Object.onblur!=null)_EWA_CALENDAR_ITEM.Object.onblur();_EWA_CALENDAR_ITEM.Dialog.Show(false);'>"+a.empty+"</div></td>");d+="<td align=right><div class='ewa-ui-date-close' title='"+a.close+"' onclick='_EWA_CALENDAR_ITEM.Hidden()'><b>X</b></div></td>";return d+"</tr></table>"};this.MarkDay=function(){for(var a=1*this._DaysTable.getAttribute("EMP_CURRENT_DAY"),
b=1;b<this._DaysTable.rows.length;b+=1)for(var d=this._DaysTable.rows[b],e=0;e<d.cells.length;e+=1){var g=d.cells[e];0<g.childNodes.length&&1*GetInnerText(g.childNodes[0])==a?this.MarkSelected(g):this.MarkUnSelected(g)}};this.MarkSelected=function(a){$(a).addClass("ewa-ui-date-selected")};this.MarkUnSelected=function(a){$(a).removeClass("ewa-ui-date-selected")};this.MarkBlur=function(a){$(a).addClass("ewa-ui-date-blur")};this.MarkUnBlur=function(a){$(a).removeClass("ewa-ui-date-blur")};this._CreateMonth=
function(){for(var a=this._CreatePervNext(),b="<select onchange='_EWA_CALENDAR_ITEM.ChangeDate();'>",d=this._CurDate.getMonth(),e=0;e<this._Months.length;e+=1)b=e==d?b+("<option value='"+e+"' selected>"+this._Months[e]+"</option>"):b+("<option value='"+e+"'>"+this._Months[e]+"</option>");return a=a.replace("[$]",b+"</select>")};this._CreateYear=function(){for(var a=this._CurDate.getFullYear(),b=this._CreatePervNext(),d=["<select onchange='_EWA_CALENDAR_ITEM.ChangeDate();'>"],e=1900;2050>=e;e+=1)e==
a?d.push("<option value='"+e+"' selected>"+e+"</option>"):d.push("<option value='"+e+"'>"+e+"</option>");d.push("</select>");return b=b.replace("[$]",d.join(""))};this._CreatePervNext=function(){return"<table cellpadding=0 cellspacing=0 border=0><tr><td><div class='ewa-ui-date-prev'  onclick='var o=this.parentNode;var o1=o.nextSibling.childNodes[0];if(o1.selectedIndex>0){o1.value=o1.value*1-1;o1.onchange();}o=o1=null'><b class='fa fa-caret-left'></b></div></td><td>[$]</td><td><div class='ewa-ui-date-next' onclick='var o=this.parentNode;var o1=o.previousSibling.childNodes[0];if(o1.options.length-1>o1.selectedIndex){o1.value=o1.value*1+1;o1.onchange();}o=o1=null'><b class='fa fa-caret-right'></div></td></tr></table>"};
this._WriteDays=function(a){if(this.__LAST__WriteDaysDate!=this._CurDate){this.__LAST__WriteDaysDate=this._CurDate;var b=this._CreateDays();this._CurDate.getDate();var d=this._CurDate.getMonth(),e=this._CurDate.getFullYear();this._SelectMonth.value=d;this._SelectYear.value=e;var g=d+1;10>g&&(g="0"+g);d=e+"-"+g+"-DD";var h=this._CurDate.getFullYear()+""+g;null!=EWA.LANG&&"ENUS"==EWA.LANG.toUpperCase()&&(d="dd/MM/yyyy"==_EWA_G_SETTINGS.DATE?"DD/"+g+"/"+e:g+"/DD/"+e);for(g=1;g<this._DaysTable.rows.length;g+=
1){for(var k=this._DaysTable.rows[g],l=0;l<k.cells.length;l+=1)e=k.cells[l],e.innerHTML=null==b[g]||null==b[g][l]?"":"<div date='"+(h+b[g][l])+"' title='"+d.replace("DD",b[g][l])+"'>"+b[g][l]+"</div>",this.MarkUnSelected(e);""==$(k).text()?$(k).hide():$(k).show()}}a&&this.MarkDay()};this._CreateDaysTable=function(){var a=[];a[0]="<table class='ewa-ui-days' align ='center' border=0 cellpadding=1 cellspacing=1 EMP_CURRENT_DAY='"+this._CurDate.getDate()+"'>";for(var b=0;7>b;b+=1){a.push("<tr>");for(var d=
0;7>d;d+=1)0==b?a.push("<th>"+this._Weeks[d]+"</th>"):(a.push("<td onmouseover='if(this.innerHTML.length>0)_EWA_CALENDAR_ITEM.MarkBlur(this);'"),a.push(" onmouseout='if(this.innerHTML.length>0)_EWA_CALENDAR_ITEM.MarkUnBlur(this);'"),a.push(" onclick='_EWA_CALENDAR_ITEM.Clicked(this);'></td>"));a.push("</tr>")}a.push("</table>");return a.join("")};this.Clear=function(){this.Object.value="";this.Hidden()};this.Hidden=function(a){if(null!=this.Object.onblur&&!a)this.Object.onblur();this.Object=null;
this.Dialog.Show(!1)};this.Clicked=function(a){if(0<a.innerHTML.length){this._DaysTable.setAttribute("EMP_CURRENT_DAY",a.childNodes[0].innerHTML);this._SetNewDate();this.MarkDay();this.Object.value=this.GetDate();if(null!=this.Object.onkeyup)this.Object.onkeyup();if(null!=this.Object.onblur)this.Object.onblur();if(null!=this.Object.onchange)this.Object.onchange();else $(this.Object).trigger("change");this.Hidden(!0)}};this.GetDate=function(a){var b=_EWA_G_SETTINGS.DATE;null==a&&(a=this._CurDate);
var d=a.getFullYear(),e=a.getMonth()+1,g=a.getDate();10>e&&(e="0"+e);10>g&&(g="0"+g);b=b.replace("yyyy",d);b=b.replace("MM",e);b=b.replace("dd",g);this.IsShowTime&&(e=a.getHours(),a=a.getMinutes(),b+=" "+(10>e?"0"+e:e)+":"+(10>a?"0"+a:a));return b};this._CreateDays=function(){var a=(new Date(this._CurDate.getFullYear(),this._CurDate.getMonth(),1)).getDay(),b=1,d=[];d[0]=this._Weeks;for(var e=1,g=this._getCurMonthDays(),h=0;49>h;h+=1){if(0==h||7==a)d[e]=[],e+=1;7==a&&(a=0);if(b<=g)d[e-1][a]=10>b?"0"+
b:b+"";else break;b+=1;a+=1}return d};this._getCurMonthDays=function(){return(0==(this._CurDate.getFullYear()-2008)%4&&0!=(this._CurDate.getFullYear()-400)%100||0==(this._CurDate.getFullYear()-400)%400)&&1==this._CurDate.getMonth()?29:this._Days[this._CurDate.getMonth()]}}
var __Cal={C:EWA_CalendarClass,WND:null,WND_PARENT:null,WND_DIA:null,Pop:function(a,b){var d="WND_PARENT/Pop/"+b;__Cal[d]||(__Cal[d]={});d=__Cal[d];d.OBJ=a;if(null==d.WND){var e=d.WND_DIA=new EWA_UI_DialogClass;e.Width=172;e.Height=200;e.ShadowColor="";d.WND=new EWA_CalendarClass;"undefined"==typeof _EWA_DialogWnd?e.CreateWindow=window:(e.CreateWindow=_EWA_DialogWnd._ParentWindow,_EWA_DialogWnd.OpendDialogs[_EWA_DialogWnd.OpendDialogs.length]=e);e.CreateWindow._EWA_CALENDAR_ITEM=d.WND;e.Create();
d.WND.CreateWindow=e.CreateWindow;d.WND.SetDate(a.value);b=d.WND.CreateCalendar(b);e.SetObject(b);d.WND.Dialog=e;$(e.GetFrameContent()).css("width","").css("height","")}d.WND.SetDate(a.value);d.WND._WriteDays(!0);d.WND.Dialog.SetZIndex(10);d.WND.Object=a;d.WND_DIA.MoveBottom(a);d.WND_DIA.Show(!0)},PopTime:function(a){__Cal["WND_PARENT/PopTime/"]||(__Cal["WND_PARENT/PopTime/"]={});var b=__Cal["WND_PARENT/PopTime/"];b.OBJ=a;if(null==b.WND){var d=b.WND_DIA=new EWA_UI_DialogClass;d.Width=180;d.Height=
20;d.ShadowColor="";b.WND=new EWA_CalendarClass;"undefined"==typeof _EWA_DialogWnd?d.CreateWindow=window:(d.CreateWindow=_EWA_DialogWnd._ParentWindow,_EWA_DialogWnd.OpendDialogs[_EWA_DialogWnd.OpendDialogs.length]=d);d.CreateWindow._EWA_CALENDAR_TIME_ITEM=b.WND;d.Create();b.WND.CreateWindow=d.CreateWindow;b.WND.SetDate(a.value);var e=b.WND.CreateTime();d.SetObject(e);b.WND.Dialog=d;$(d.GetFrameContent()).css("width","").css("height","")}b.WND.CreateWindow._EWA_CALENDAR_TIME_ITEM.Object=a;b.WND.CreateWindow._EWA_CALENDAR_TIME_ITEM.Dialog=
b.WND_DIA;b.WND.SetDate(a.value);b.WND.Dialog.SetZIndex(10);b.WND.Object=a;b.WND_DIA.MoveBottom(a);b.WND_DIA.Show(!0)}};EWA.UI.Calendar=__Cal;
function EWA_UI_MsgClass(a,b){this._IsSelfWindow=b;this._Dialog=null;this._Msg=a;this._Buttons=[];this._Caption=null;this._Icon="MSG_ICON";this.SetIcon=function(d){this._Icon=d};this.SetCaption=function(d){this._Caption=d};this.AddButton=function(d,e){this._Buttons.push({Text:d,Event:e})};this.AddButtons=function(d){if(null!=d)for(var e=0;e<d.length;e++)this._Buttons.push(d[e])};this._Init=function(){this._Dialog=__Dialog.OpenWindow("about:blank",Math.random(),500,200,this._IsSelfWindow);this._Dialog._FromMsgClass=
this;this._Dialog.SetHtml(this._CreateHtml());this._Dialog.SetCaption(this._Caption);var d=this._Dialog._Dialog.GetFrameContent().getElementsByTagName("table")[0],e=this._Dialog._Dialog.GetFrame();e.style.width=d.clientWidth+"px";e.style.height=d.clientHeight+"px"};this._CreateHtml=function(){var d=[];d.push("<table border=0 class='MSG_INFO'>");d.push("<tr><td rowspan=2 style='width:130px;' align='center'>");d.push("<div class='"+this._Icon+"'>&nbsp;</div></td>");d.push("<td class='MSG_TEXT'>");d.push(this._Msg);
d.push("</td></tr>");d.push("<tr><td class='MSG_BUTS'>");var e=this._CloseWindowJs();if(0<this._Buttons.length){d.push("<hr><table><tr>");for(var g=0;g<this._Buttons.length;g++){var h=this._Buttons[g];d.push("<td>");var k="<button _ewa_msg_default='"+(h.Default?1:0)+"'  type='button' _ewa_dialog_='"+this._Dialog.Id+"' ";k=h.Event&&"function"==typeof h.Event?k+(" onclick=\"_EWA_UI_WINDOW_LIST[this.getAttribute('_ewa_dialog_')]._FromMsgClass.fire("+g+')">'+h.Text+"</button>"):k+(' onclick="'+(h.Event?
h.Event+";"+e:e)+'">'+h.Text+"</button>");d.push(k);d.push("</td>")}d.push("</tr></table>")}d.push("</td></tr></table>");return d.join("")};this.fire=function(d){if((d=this._Buttons[d])&&d.Event)try{d.Event(this)}catch(e){console.log(e)}this.Hidden()};this._CloseWindowJs=function(){return"var a=this.getAttribute('_ewa_dialog_'); _EWA_UI_WINDOW_LIST[a].CloseWindow();"};this.Show=function(d,e){null==this._Dialog&&this._Init();if(d)if(d=this._Dialog._ParentWindow.document.getElementsByTagName("button"),
e){var g=[];for(e=0;e<d.length;e++){var h=$(d[e]);h.attr("_ewa_dialog_")==this._Dialog.Id&&(h.prop("disabled",!0),g.push(h))}setTimeout(function(){for(var k in g)g[k].prop("disabled",!1)},435)}else for(this._Dialog.ResizeByContent(),this._Dialog.MoveCenter(),e=0;e<d.length;e++)if(1==d[e].getAttribute("_ewa_msg_default")&&d[e].getAttribute("_ewa_dialog_")==this._Dialog.Id){d[e].focus();break}};this.Hidden=function(){this.Show(!1);this._Dialog.CloseWindow()}}
EWA.UI.Msg={IS_IN_APP:!1,C:EWA_UI_MsgClass,Show:function(a,b,d,e){if(0<a.indexOf("(")&&a.trim().endsWith(")"))try{a=eval(a)}catch(g){console.log(a)}a=new EWA_UI_MsgClass(a);a.SetCaption(d);a.AddButtons(b);a.SetIcon(e);a.Show(!0,EWA.UI.Msg.IS_IN_APP);return a},ShowInfo:function(a,b,d){__EWA_MSG__=EWA.UI.Msg.Show(a,b,d,"MSG_ICON");$(__EWA_MSG__._Dialog._Dialog.GetFrame()).addClass("ewa-msg-info");return __EWA_MSG__},ShowError:function(a,b){var d=[];d[0]={Text:_EWA_INFO_MSG["BUT.OK"],Event:null,Default:!0};
__EWA_MSG__=EWA.UI.Msg.Show(a,d,b,"ERR_ICON");$(__EWA_MSG__._Dialog._Dialog.GetFrame()).addClass("ewa-msg-err");return __EWA_MSG__},Alter:function(a,b){var d=[];d[0]={Text:_EWA_INFO_MSG["BUT.OK"],Event:null,Default:!0};__EWA_MSG__=EWA.UI.Msg.Show(a,d,b,"MSG_ICON");$(__EWA_MSG__._Dialog._Dialog.GetFrame()).addClass("ewa-msg-alert");return __EWA_MSG__},Alert:function(a,b){var d=[];d[0]={Text:_EWA_INFO_MSG["BUT.OK"],Event:null,Default:!0};__EWA_MSG__=EWA.UI.Msg.Show(a,d,b,"MSG_ICON");$(__EWA_MSG__._Dialog._Dialog.GetFrame()).addClass("ewa-msg-alert");
return __EWA_MSG__},Confirm:function(a,b,d,e){var g=[];g[0]={Text:_EWA_INFO_MSG["BUT.YES"],Event:d};g[1]={Text:_EWA_INFO_MSG["BUT.NO"],Event:e,Default:!0};__EWA_MSG__=EWA.UI.Msg.Show(a,g,b,"QUS_ICON");$(__EWA_MSG__._Dialog._Dialog.GetFrame()).addClass("ewa-msg-confirm");return __EWA_MSG__},_Tip:function(a,b,d,e){var g=document.createElement("table");document.body.appendChild(g);$(g).css(b);b=g.insertRow(-1).insertCell(-1);$(b).css(d);if(e&&e instanceof Function){b.innerHTML='<i class="fa fa-refresh fa-spin"></i> '+
a;var h=setInterval(function(){e()&&(window.clearInterval(h),$(g).animate({opacity:0},200,function(){$(g).remove()}))},300)}else{b.innerHTML=a;if(!e||isNaN(e))e=1500;setTimeout(function(){$(g).animate({opacity:0},200,function(){$(g).remove()})},e)}},Tip:function(a,b){var d={width:300,height:80,padding:10,"background-color":"rgba(10,20,30,0.7)",position:"fixed",top:"50%",left:"50%","margin-left":-150,"margin-top":-60,"border-radius":10,"z-index":window._EWA_UI_DIALOG_COVERINDEX?window._EWA_UI_DIALOG_COVERINDEX+
10:1E6,color:"#fff"};EWA.B.IE&&9>1*EWA.B.VERSION&&(d.filter="progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr='#77000000',EndColorStr='#77000000')");EWA.UI.Msg._Tip(a,d,{"text-align":"center","font-size":16,"line-height":1.5},b)},TipBR:function(a,b){var d={height:20,padding:2,"background-color":"rgba(222,222,0,0.7)",position:"fixed",bottom:5,right:5,"border-radius":1,"z-index":window._EWA_UI_DIALOG_COVERINDEX?window._EWA_UI_DIALOG_COVERINDEX+10:1E6,color:"#111"};EWA.B.IE&&9>
1*EWA.B.VERSION&&(d.filter="progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr='#66000000',EndColorStr='#66000000')");EWA.UI.Msg._Tip(a,d,{"text-align":"center","font-size":12,"line-height":1.5},b)},TipBL:function(a,b){var d={height:20,padding:2,"background-color":"rgba(222,222,0,0.7)",position:"fixed",bottom:5,left:5,"border-radius":1,"z-index":window._EWA_UI_DIALOG_COVERINDEX?window._EWA_UI_DIALOG_COVERINDEX+10:1E6,color:"#111"};EWA.B.IE&&9>1*EWA.B.VERSION&&(d.filter="progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr='#66000000',EndColorStr='#66000000')");
EWA.UI.Msg._Tip(a,d,{"text-align":"center","font-size":12,"line-height":1.5},b)},TipTL:function(a,b){var d={height:20,padding:2,"background-color":"rgba(222,222,0,0.7)",position:"fixed",top:5,left:5,"border-radius":1,"z-index":window._EWA_UI_DIALOG_COVERINDEX?window._EWA_UI_DIALOG_COVERINDEX+10:1E6,color:"#111"};EWA.B.IE&&9>1*EWA.B.VERSION&&(d["background-color"]="filter:progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr='#00000000',EndColorStr='#66000000')");EWA.UI.Msg._Tip(a,
d,{"text-align":"center","font-size":12,"line-height":1.5},b)},TipTR:function(a,b){var d={height:20,padding:2,"background-color":"rgba(222,222,0,0.7)",position:"fixed",top:5,right:5,"border-radius":1,"z-index":window._EWA_UI_DIALOG_COVERINDEX?window._EWA_UI_DIALOG_COVERINDEX+10:1E6,color:"#111"};EWA.B.IE&&9>1*EWA.B.VERSION&&(d["background-color"]="filter:progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr='#00000000',EndColorStr='#66000000')");EWA.UI.Msg._Tip(a,d,{"text-align":"center",
"font-size":12,"line-height":1.5},b)}};$Mark=function(a,b){var d=1E3*b||3E3,e="<div class='ewa-mark' style='transition-duration:"+(b||3)+"s;'></div>";$(a).each(function(){var g=$(e),h=$(this).offset();h={left:h.left+2,top:h.top-2,width:$(this).outerWidth(),height:$(this).outerHeight()};g.css(h);$("body").append(g);setTimeout(function(){g.css("opacity",0)},10);setTimeout(function(){g.remove()},d+10)})};$Confirm=EWA.UI.Msg.Confirm;$Tip=EWA.UI.Msg.Tip;$TipBR=EWA.UI.Msg.TipBR;$TipBL=EWA.UI.Msg.TipBL;
$TipTR=EWA.UI.Msg.TipTR;$TipTL=EWA.UI.Msg.TipTL;
function EWA_UI_FlowChartClass(){this.DEF_CHART_WIDTH=200;this.DEF_CHART_HEIGHT=50;this.DEF_BG_COLOR="#08c";this.DEF_COLOR="#fff";this.Create=function(a,b,d,e,g,h,k,l){this.PID=a;this.FIELD_ID=d;this.FIELD_TEXT=e;this.CHART_WIDTH=g||this.DEF_CHART_WIDTH;this.CHART_HEIGHT=h||this.DEF_CHART_HEIGHT;this.BG_COLOR=k||this.DEF_BG_COLOR;this.COLOR=l||this.DEF_COLOR;this.OFF=Math.round(this.CHART_HEIGHT*Math.sqrt(2)/2);this._CreateCss();d=["<div style='z-index:1;padding-left:"+this.OFF+"px;height:"+this.CHART_HEIGHT+
"px;position:relative;margin:auto;width:"+(this.CHART_WIDTH*b.length-(this.OFF-4)*(b.length-1)+4)+"px'>"];for(e=0;e<b.length;e++)g=this._CreateChart(b[e],e,e==b.length-1),d.push(g);d.push("</div>");$X(a)?$($X(a)).append(d.join("")):$("body").append(d.join(""))};this._CreateCss=function(){var a=this.CHART_HEIGHT,b=this.OFF,d=Math.round(b);this.CSS={main:"position:relative;margin-left:-"+(b-4)+"px;float:left;z-index:[ZINDEX];height:"+a+"px;width:[WIDTH]px;overflow:hidden;",leftbox:"background-color:[BGCOLOR];float:left;width:"+
d+"px;height:"+a+"px;overflow:hidden",leftarrow:"background: #fff;margin-left: -"+b+"px;width:"+a+"px;height:"+a+"px;-webkit-transform: rotate(45deg);transform: rotate(45deg);",center:"height:"+a+"px;float:left;text-overflow: ellipsis;overflow: hidden;line-height:"+a+"px;background-color:[BGCOLOR];width:"+(this.CHART_WIDTH-2*d)+"px;text-align:center;font-size:16px",centertd:"color:[COLOR];text-overflow: ellipsis;overflow: hidden;width:100%;text-align:center;font-size:16px",rightbox:"float:right;width:"+
d+"px;height:"+a+"px;overflow:hidden",rightarrow:"background:[BGCOLOR];margin-left: -"+d+"px;width:"+a+"px;height:"+a+"px;-webkit-transform: rotate(45deg);transform: rotate(45deg);"}};this._CreateChart=function(a,b,d){console.log(a);var e=[],g=this.CSS.main.replace("[ZINDEX]",1E3-b).replace("[LEFT]",(this.CHART_WIDTH-20)*b);g=g.replace("[WIDTH]",this.CHART_WIDTH);e.push("<div id='"+a[this.FIELD_ID]+"' style='"+g+"'>");var h=a.bgColor||this.BG_COLOR;g=this.CSS.leftbox.replace("[BGCOLOR]",h);var k=
this.CSS.center.replace("[BGCOLOR]",h);h=this.CSS.rightarrow.replace("[BGCOLOR]",h);var l=this.CSS.centertd.replace("[COLOR]",a.color||this.COLOR);e.push("<div style='"+g+"'>");e.push("<div style='"+this.CSS.leftarrow+"'></div>");e.push("</div>");e.push("<table border=0 cellpadding=0 cellspacing=0  style='"+k+"'><tr><td style='"+l+"'>");"function"==typeof this.FIELD_TEXT?(a=this.FIELD_TEXT(a,b,d),e.push(a)):e.push(a[this.FIELD_TEXT]);e.push("</td></tr></table>");e.push("<div style='"+this.CSS.rightbox+
"'>");e.push("<div style='"+h+"'></div>");e.push("</div>");e.push("</div>");return e.join("")}}
var EWA_UI_HtmlEditorConfig={OPT_PopImgProperties:!0,OPT_ImageResizes:null,fonts:[{name:"\u5fae\u8f6f\u96c5\u9ed1",font:"Microsoft YaHei"},{name:"\u5b8b\u4f53",font:"\u5b8b\u4f53"},{name:"Arial",font:"Arial"},{name:"STHeiti",font:"STHeiti"}],formats:[{name:"H1",format:"h1"},{name:"H2",format:"h2"},{name:"H3",format:"h3"},{name:"H4",format:"h4"},{name:"H5",format:"h5"},{name:"\u666e\u901a",format:"p"}],sizes:[{name:"\u8d85\u5927",size:"7"},{name:"\u7279\u5927",size:"6"},{name:"\u5927",size:"5"},{name:"\u6807\u51c6",
size:"4"},{name:"\u5c0f",size:"3"},{name:"\u7279\u5c0f",size:"2"},{name:"\u7279\u5c0f",size:"1"}],css:"img{max-width:100%}html{background:#2f2f2f}body{width: 800px; padding:10px 20px; margin: auto; box-shadow: rgb(241, 241, 241) 1px 1px 13px; font-size:14px; box-sizing: border-box;overflow-y: scroll;   font-family: 'Microsoft YaHei', STHeiti, \u5fae\u8f6f\u96c5\u9ed1, tahoma, Verdana, Arial, sans-serif, \u5b8b\u4f53; background: rgb(255, 255, 255);}",colors:"#ffffff #000000 #eeece1 #1f497d #4f81bd #c0504d #9bbb59 #8064a2 #4bacc6 #f79646 #f2f2f2 #7f7f7f #ddd9c3 #c6d9f0 #dbe5f1 #f2dcdb #ebf1dd #e5e0ec #dbeef3 #fdeada #d8d8d8 #595959 #c4bd97 #8db3e2 #b8cce4 #e5b9b7 #d7e3bc #ccc1d9 #b7dde8 #fbd5b5 #bfbfbf #3f3f3f #938953 #548dd4 #95b3d7 #d99694 #c3d69b #b2a2c7 #92cddc #fac08f #a5a5a5 #262626 #494429 #17365d #366092 #953734 #76923c #5f497a #31859b #e36c09 #7f7f7f #0c0c0c #1d1b10 #0f243e #244061 #632423 #4f6128 #3f3151 #205867 #974806 #c00000 #ff0000 #ffc000 #ffff00 #92d050 #00b050 #00b0f0 #0070c0 #002060 #7030a0".split(" "),
buts:{FormatBlock:{id:"fn_FormatBlock",cmd:"PopFormatBlock",title:"\u683c\u5f0f","class":"fa fa-header"},FontSize:{id:"fn_FontSize",cmd:"PopFontSize",title:"\u5b57\u9ad4\u5927\u5c0f","class":"fa fa-text-height"},FontName:{id:"fn_FontName",cmd:"PopFont",title:"\u5b57\u4f53","class":"fa fa-font"},BOLD:{id:"st_bold",cmd:"BOLD",title:"BOLD","class":"fa fa-bold"},ITALIC:{id:"st_italic",cmd:"ITALIC",title:"ITALIC","class":"fa fa-italic"},UNDERLINE:{id:"st_underline",cmd:"UNDERLINE",title:"UNDERLINE","class":"fa fa-underline"},
InsertOrderedList:{id:"st_insertorderedlist",cmd:"InsertOrderedList",title:"InsertOrderedList","class":"fa fa-list-ol"},InsertunOrderedList:{id:"st_insertunorderedlist",cmd:"InsertunOrderedList",title:"InsertunOrderedList","class":"fa fa-list-ul"},INDENT:{id:"st_indent",cmd:"INDENT",title:"INDENT","class":"fa fa-indent"},Outdent:{id:"st_outdent",cmd:"Outdent",title:"Outdent","class":"fa fa-outdent"},JustifyLEFT:{id:"st_justifyleft",cmd:"JustifyLEFT",title:"\u5de6\u5bf9\u9f50","class":"fa fa-align-left"},
JustifyCENTER:{id:"st_justifycenter",cmd:"JustifyCENTER",title:"\u5c45\u4e2d","class":"fa fa-align-center"},JustifyRIGHT:{id:"st_justifyright",cmd:"JustifyRIGHT",title:"\u53f3\u5bf9\u9f50","class":"fa fa-align-right"},CreateLink:{id:"st_createlink",cmd:"CreateLink",title:"\u521b\u5efa\u94fe\u63a5","class":"fa fa-chain"},CODE_TXT:{id:"code_txt",cmd:"CODE_TXT",title:"\u6e90\u4ee3\u7801","class":"fa fa-html5"},eraser:{id:"eraser",cmd:"eraser",title:"\u6e05\u9664\u683c\u5f0f","class":"fa fa-eraser"},
ForColor:{id:"fn_ForColor",cmd:"PopForColor",title:"\u5b57\u9ad4\u984f\u8272","class":"fa fa-font ewa-editor-for"},BackColor:{id:"fn_BackColor",cmd:"PopBackColor",title:"\u80cc\u666f\u984f\u8272","class":"fa fa-font ewa-editor-bg"},Img:{id:"fn_Img",cmd:"PopImg",title:"\u5716\u7247","class":"fa fa-camera"},FullScreen:{id:"fn_FullScreen",cmd:"FullScreen",title:"\u5168\u5c4f","class":"fa fa-square-o"},Word2Html:{id:"fn_Word2Html",cmd:"Word2Html",title:"\u8f6c\u6362Word","class":"fa fa-file-word-o"}},
defaultConf:[["FontName","FormatBlock","FontSize"],["BOLD","ITALIC","UNDERLINE"],["InsertOrderedList","InsertunOrderedList"],["JustifyLEFT","JustifyCENTER","JustifyRIGHT"],["INDENT","Outdent"],["CreateLink","eraser"],["ForColor","BackColor"],["Word2Html","Img","FullScreen"],["CODE_TXT"]],pop:function(a,b){for(var d in __Cal)0==d.indexOf("EDITOR_Pop_")&&__Cal[d].WND.Show(!1);d="EDITOR_Pop_"+(a?a.id:"");__Cal[d]||(__Cal[d]={});var e=__Cal[d];e.OBJ=a;if(null==e.WND){var g=e.WND=new EWA_UI_DialogClass;
g.Width=172;g.Height=50;g.ShadowColor="";g.CreateWindow=window;g.CreateWindow._EWA_CALENDAR_ITEM=e.WND;g.Create();g.SetHtml(b);$(g.GetFrameContent()).find("a").attr("onclick",'__Cal["'+d+'"].WND.Show(false);');$('div[ewa_name="DIV_BACK1"]').hide()}e.WND.SetZIndex(10);a?(e.WND.Object=a,e.WND.MoveBottom(a)):e.WND.MoveCenter();e.WND.Show(!0);return e},pop1:function(a,b,d,e){a="EDITOR_Pop_"+a;__Cal[a]||(__Cal[a]={});var g=__Cal[a];if(null==g.WND){var h=g.WND=new EWA_UI_DialogClass;h.Width=d;h.Height=
e;h.ShadowColor="";"undefined"==typeof _EWA_DialogWnd?h.CreateWindow=window:(h.CreateWindow=_EWA_DialogWnd._ParentWindow,_EWA_DialogWnd.OpendDialogs[_EWA_DialogWnd.OpendDialogs.length]=h);h.CreateWindow._EWA_CALENDAR_ITEM=g.WND;h.Create()}g.WND.SetHtml(b);$(g.WND.GetFrameContent()).find("#butClose").attr("onclick",'__Cal["'+a+'"].WND.Show(false);');g.WND.SetZIndex(10);g.WND.MoveCenter();g.WND.Show(!0);return g}};
function EWA_UI_HtmlEditorClass(){this.DEF_CHART_WIDTH=200;this.DEF_CHART_HEIGHT=50;this.DEF_BG_COLOR="#08c";this.DEF_COLOR="#fff";this.OBJ_REPLACE=null;this.pasteClass=new EWA_MiscPasteToolClass;this._CreateFonts=function(){for(var a=["<table class='ewa-editor-pop'>"],b=0;b<EWA_UI_HtmlEditorConfig.fonts.length;b++){var d=EWA_UI_HtmlEditorConfig.fonts[b];a.push("<tr><td>");a.push("<a style='font-size:16px;line-height:1.5;font-family:"+d.font+"' href='javascript:"+this.Id+'.executeSetFont("'+d.font+
"\")'>"+d.name+"</a>");a.push("</td></tr>")}a.push("</table>");return a.join("\n")};this._CreateFormats=function(){for(var a=["<table class='ewa-editor-pop'>"],b=0;b<EWA_UI_HtmlEditorConfig.formats.length;b++){var d=EWA_UI_HtmlEditorConfig.formats[b];a.push("<tr><td>");a.push("<"+d.format+"><a href='javascript:"+this.Id+'.executeSetFormat("'+d.format+"\")'>"+d.name+"</a></"+d.format+">");a.push("</td></tr>")}a.push("</table>");return a.join("\n")};this._CreateFontSizes=function(){for(var a=["<table class='ewa-editor-pop'>"],
b=0;b<EWA_UI_HtmlEditorConfig.sizes.length;b++){var d=EWA_UI_HtmlEditorConfig.sizes[b];a.push("<tr><td>");a.push("<font size="+d.size+"><a href='javascript:"+this.Id+'.executeFontSize("'+d.size+"\")'>"+d.name+"</a></font>");a.push("</td></tr>")}a.push("</table>");return a.join("\n")};this.executeFontSize=function(a){$("#"+this.BoxId+" iframe:eq(0)");this.execDocumentCommand("FontSize",!1,a)};this.executeSetFont=function(a){$("#"+this.BoxId+" iframe:eq(0)");this.execDocumentCommand("FontName",!1,a)};
this.executeSetFormat=function(a){$("#"+this.BoxId+" iframe:eq(0)");this.execDocumentCommand("FormatBlock",!1,a)};this.executeForColor=function(a){$("#"+this.BoxId+" iframe:eq(0)");this.execDocumentCommand("ForeColor",!1,a)};this.executeBackColor=function(a){var b=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow;this.execDocumentCommand("BackColor",!1,a);$(b.document.body).css("background","#fff")};this.execDocumentCommand=function(a,b,d){$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow.document.execCommand(a,
b,d);this.executeAfterEvent(a,d)};this.executeImages=function(a){for(var b=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow,d=0,e=0,g=this,h=0;h<a.files.length;h++){var k=a.files[h];if(k.type&&0==k.type.indexOf("image/")){d++;var l=new FileReader;l.onloadend=function(m){var n=new Image;n.src=m.target.result;n.style.maxWidth="100%";b.document.body.appendChild(n);e++;e==d&&(g.pasteClass.target=b.document.body,g.pasteClass.processAsHtml(),g.pasteClass.process());g.executeAfterEvent("executeImages",
n)};l.readAsDataURL(k)}}};this.executeWord=function(a){for(var b=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow,d=EWA.CP+(EWA.CP.endsWith("/")?"":"/")+"EWA_STYLE/cgi-bin/_re_/?method=2Html",e=this,g=0;g<a.files.length;g++){var h=a.files[g],k=h.name.lastIndexOf(".");if(0<k){if(k=h.name.substring(k).toLowerCase(),".doc"!=k&&".docx"!=k&&".xls"!=k&&".xlsx"!=k&&".odt"!=k){$Tip("\u4ec5\u652f\u6301 doc/docx/xls/xlsx/odt\u6587\u4ef6");break}}else{$Tip("\u4ec5\u652f\u6301 doc/docx/xls/xlsx/odt\u6587\u4ef6");
break}k=new FileReader;k.onloadend=function(l){var m={};m.src=l.target.result;d+="&name="+h.name.toURL();l=$X(e.BoxId).parentNode;var n=e.BoxId+"_cover",p='<div id="'+n+'" style="width:100%;height:100%" class="ewa-ui-dialog-cover"></div>';$(l).css("position","relative").append(p);$JP(d,m,function(q){q.rst?(b.document.body.innerHTML=q.cnt,$(b.document.body).find("img").each(function(){$(this).attr("src",q.img_root+$(this).attr("src"))}),$("#"+n).remove(),$Tip("\u5904\u7406\u5b8c\u6210"),e.executeAfterEvent("executeWord",
q)):$Tip(q.msg)})};k.readAsDataURL(h)}};this.PopFontSize=function(a){var b=this._CreateFontSizes();EWA_UI_HtmlEditorConfig.pop(a,b)};this.PopFont=function(a){var b=this._CreateFonts();EWA_UI_HtmlEditorConfig.pop(a,b)};this.PopFormatBlock=function(a){var b=this._CreateFormats();EWA_UI_HtmlEditorConfig.pop(a,b)};this.PopForColor=function(a){var b=this._CreateColorBox("executeForColor");EWA_UI_HtmlEditorConfig.pop(a,b)};this.PopBackColor=function(a){var b=this._CreateColorBox("executeBackColor");EWA_UI_HtmlEditorConfig.pop(a,
b)};this.PopImg=function(){};this.FullScreen=function(){var a=$("#"+this.BoxId);if(a.attr("isfull")){var b=a.attr("old_css");a.attr("style",b).attr("isfull","")}else{window._EWA_UI_DIALOG_COVERINDEX?_EWA_UI_DIALOG_COVERINDEX++:_EWA_UI_DIALOG_COVERINDEX=999;var d=_EWA_UI_DIALOG_COVERINDEX;b=a.attr("style");a.attr("old_css",b).attr("isfull","1");a.css({position:"fixed",left:0,top:0,right:0,bottom:0,width:"100%",height:"100%","z-index":d})}};this._CreateColorBox=function(a){for(var b=["<table class='ewa-editor-pop'><tr>"],
d=0;d<EWA_UI_HtmlEditorConfig.colors.length;d++){0<d&&0==d%10&&b.push("</tr><tr>");var e=EWA_UI_HtmlEditorConfig.colors[d];b.push("<td><a href='javascript:"+this.Id+"."+a+'("'+e+"\")' class='ewa-edit-pop-color' style='background:"+e+"'>&nbsp;</a></td>")}b.push("</table>");return b.join("\n")};this.Word2Html=function(){};this.GetHtml=function(){var a=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow,b=$("#"+this.BoxId+" iframe:eq(1)")[0].contentWindow;return"none"==$("#"+this.BoxId+" iframe:eq(0)").css("display")?
a.document.body.innerHTML=b.getText():a.document.body.innerHTML};this.GetText=function(){var a=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow,b=$("#"+this.BoxId+" iframe:eq(1)")[0].contentWindow;return"none"==$("#"+this.BoxId+" iframe:eq(0)").css("display")?a.document.body.innerHTML=b.getText():a.document.body.innerText};this.Create=function(a){this.OBJ_REPLACE=a;this.Id=("EWA_Html_"+Math.random()).replace(".","_");this.BoxId=this.Id+"box";window[this.Id]=this;EWA.F.FOS[this.Id]=this;var b=a.value||
a.innerHTML,d=$(a).height(),e={border:"1px solid #ccc",position:"relative",width:$(a).width(),height:d,overflow:"hidden"};"1"==a.getAttribute("EWA_DHTML")&&(e.width="100%");d=document.createElement("table");d.id=this.BoxId;$(d).css(e).addClass("ewa-editor").attr("cellpadding",0).attr("cellspacing",0);e=d.insertRow(-1).insertCell(-1);e.className="ewa-editor-buts";var g=d.insertRow(-1).insertCell(-1);$(g).css("position","static").css("opacity",1).addClass("ewa-ui-dialog-cover");var h=[],k=EWA_UI_HtmlEditorConfig.defaultConf,
l;for(l in k){0<l&&h.push("<span class='ewa-editor-but-spt '>|</span>");for(var m in k[l]){var n=this._CreateButton(EWA_UI_HtmlEditorConfig.buts[k[l][m]]);h.push(n)}}e.innerHTML=h.join("");a.parentNode.insertBefore(d,a);a.style.display="none";this._CreateIframe(g,b,a);a="<input onchange='"+this.Id+".executeImages(this)' multiple accept='image/jpeg,image/png,image/bmp' type=file  style='width:30px;height:30px;position:absolute;top:4px;left:0px;opacity:0.0'>";$("#"+this.BoxId).find("a[id=fn_Img]").append(a);
a="<input onchange='"+this.Id+".executeWord(this)' accept='doc,docx,odt' type=file  style='width:30px;height:30px;position:absolute;top:4px;left:0px;opacity:0.0'>";$("#"+this.BoxId).find("a[id=fn_Word2Html]").append(a);this.executeAfterEvent("init","ok");if(window.__Cal)for(l in __Cal)0==l.indexOf("EDITOR_Pop_")&&delete window.__Cal[l]};this._CreateIframe=function(a,b,d){a.innerHTML="<iframe id='"+this.Id+"cntent' frameborder=0 width=100% height=100%></iframe><iframe id='"+this.Id+"code' src0='"+
(EWA.RV_STATIC_PATH||"/EmpScriptV2")+"/EWA_STYLE/editor/CodeMirror/index.html' style='display: none; width: 100%; height: 100%' frameborder=0></iframe>";var e=this;setTimeout(function(){var g=$("#"+e.BoxId+" iframe:eq(0)"),h=g[0].contentWindow,k=h.document;k.body.style.minHeight=g.height()+"px";840>g.width()&&(k.body.style.boxSizing="border-box",k.body.style.width="100%");g=k.createElement("style");g.textContent=EWA_UI_HtmlEditorConfig.css;k.getElementsByTagName("head")[0].appendChild(g);g=EWA.CP+
(EWA.CP.endsWith("/")?"":"/")+"EWA_STYLE/cgi-bin/_re_/index.jsp?method=HtmlImages";EWA_UI_HtmlEditorConfig.OPT_ImageResizes&&(g+="&ImageReiszes="+EWA_UI_HtmlEditorConfig.OPT_ImageResizes.toURL());e.pasteClass.bind(h.document.body,g,function(l){e.executeAfterEvent("HtmlImages",l)});k.contentEditable=!0;k.designMode="on";k.body.innerHTML=b;$(k.body).css(EWA_UI_HtmlEditorConfig.css);EWA_UI_HtmlEditorConfig.OPT_PopImgProperties&&(k.onmousedown=function(l){l=l||event;l=l.target||l.srcElement;"IMG"==l.tagName&&
e.PopImgProperties(l)});$(k.body).bind("cut",function(){setTimeout(function(){e.executeAfterEvent("cut")},10)});$(k.body).bind("keyup",function(){e.executeAfterEvent("keyup")});$(k.body).bind("paste",function(){setTimeout(function(){e.executeAfterEvent("paste")},10)});$(k.body).bind("undo",function(){e.executeAfterEvent("undo")});$(k.body).bind("redo",function(){e.executeAfterEvent("redo")})},411)};this.PopImgProperties=function(a){var b=["<table style='background:rgba(0,0,0,0.77);color:#f1f1f1;' border=0 width=300 height=140>"];
b.push("</tr><td colspan=2 align=center>\u8bbe\u5b9a\u56fe\u7247\u5c5e\u6027</td></tr>");b.push("<tr><td>\u5c3a\u5bf8\uff1a</td><td><input name='width' value='"+a.width+"' size=4 maxlength=4> x ");b.push("<input name='height' value='"+a.height+"' size=4 maxlength=4>");b.push("</td></tr>");b.push("<tr><td>\u6d6e\u52a8\uff1a</td><td><select name='float'><option value=''></option>");b.push("<option value='left'>\u5de6</option>");b.push("<option value='right'>\u53f3</option>");b.push("</select></td></tr>");
b.push("<tr><td>\u8fb9\u754c\uff1a</td><td><input name='margin' value='2' size=4 maxlength=2> \u50cf\u7d20 ");b.push("</td></tr>");b.push("<tr><td>\u8fb9\u754c\uff1a</td><td><input type='checkbox' name='bt'> \u8bbe\u4e3a\u6807\u9898\u56fe ");b.push("</td></tr>");b.push("</tr><td colspan=2 align=center><input type=button value='\u786e\u5b9a' id='butOk'>&nbsp;");b.push("<input type=button onclick='$(this).parentsUntil(\"div[ewa_name=DIV_FRAME]\").last().parent().hide()' value='\u5173\u95ed'></td></tr>");
b.push("</table>");var d=EWA_UI_HtmlEditorConfig.pop1(a.getAttribute("_tmp_id"),b.join(""),300,150).WND.GetFrameContent(),e=this;$(d).find("#butOk").bind("click",function(){$(this.parentNode).find("#butClose").click();var g=$(d).find("[name=width]").val();""!=g?a.width=g:$(a).attr("width",null);g=$(d).find("[name=height]").val();""!=g?a.height=g:$(a).attr("height",null);g=$(d).find("[name=float]").val();$(a).css("float",g);$(a).css("margin",$(d).find("[name=margin]").val()+"px");$(d).find("[name=bt]")[0].checked&&
(g=a.src.replace(location.origin,""),g=g.replace("//","/"),$("#NWS_HEAD_PIC").val(g),e.userSetHeaderPic&&e.userSetHeaderPic(g))})};this._CreateButton=function(a){try{return"<a href='javascript:void(0)' class='btn "+a["class"]+"' onclick='"+this.Id+".execute(this)' id='"+a.id+"' cmd='"+a.cmd+"' title='"+a.title+"'></a>"}catch(b){return console.log(a),""}};this.showCode=function(a){var b=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow,d=$("#"+this.BoxId+" iframe:eq(1)")[0].contentWindow;b=d.style_html(b.document.body.innerHTML,
4," ",80);a.setAttribute("tag","txt");d.editor?d.editor.setValue(b):d.initEditor(b,"html")};this.execute=function(a){var b=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow,d=$("#"+this.BoxId+" iframe:eq(1)")[0].contentWindow,e=b.document,g=a.getAttribute("cmd");if(0==a.id.indexOf("st_"))"CreateLink"==g?e.execCommand(g,!0,null):e.execCommand(g,!1,null);else if(0==a.id.indexOf("fn_"))this[g](a);else if("eraser"==g)this.executeEraser();else if("CODE_TXT"==g){var h=a.getAttribute("tag"),k=$("#"+this.BoxId+
" iframe:eq(0)");e=$("#"+this.BoxId+" iframe:eq(1)");if(h)k.show(),e.hide(),a.setAttribute("tag",""),b.document.body.innerHTML=d.getText();else if(k.hide(),e.show(),e.attr("src0")){b=e.attr("src0");e.attr("src",b);e.removeAttr("src0");var l=this;this._WAIT_CODE_LOAD_COMPLETE=setInterval(function(){"complete"==d.document.readyState&&(window.clearInterval(l._WAIT_CODE_LOAD_COMPLETE),l._WAIT_CODE_LOAD_COMPLETE=null,l.showCode(a))},100)}else this.showCode(a)}else"IMG"==a.id?insertImg(window):("CreateLink"==
a.id?b.document.execCommand(a.id,!0,null):b.document.execCommand(a.id,!1,null),b.document.body.focus());this.executeAfterEvent(g)};this.executeEraser=function(){var a=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow.document.body;$(a).find("p,h1,h2,h3,h4,h5").each(function(){0==$(this).find("img").length&&(this.innerText=this.innerText,""==this.innerText.trimEx()&&$(this).remove())});$(a).find("div,font,span,a").each(function(){0==$(this).find("img").length&&""==this.innerText.trimEx()&&$(this).remove()});
$(a).find("script").remove();$(a).find("style").remove();$(a).find("link").remove();$(a).find("meta").remove();$(a).find("title").remove();$(a).find("colgroup").remove();$(a).find("*").each(function(){for(var b={},d=0;d<this.attributes.length;d++){var e=this.attributes[d].name;"src"!=e&&(b[e]=null)}$(this).attr(b)});this.OBJ_REPLACE.value=a.innerHTML=a.innerHTML.replace(/\x3c!--[\w\W\r\n]*?--\x3e/gim,"")};this.executeAfterEvent=function(a,b){var d=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow.document.body;
if("init"!=a||"ok"!=b)this.OBJ_REPLACE.value=d.innerHTML;this.userAfterEvent&&this.userAfterEvent(a,b,d)};this.userAfterEvent=function(a,b,d){}}
function EWA_MiscPasteToolClass(){this.target=document.body;this.handleUrl=null;this.images=[];this.paste=function(a){if((a=a.originalEvent)&&a.clipboardData&&a.clipboardData.items&&0<a.clipboardData.items.length)for(var b=0;b<a.clipboardData.items.length;b++){var d=a.clipboardData.items[b];if("image/png"==d.type)this.processAsPaste(d);else if("text/html"==d.type){var e=this;a.clipboardData.getData("text/html")&&setTimeout(function(){e.processAsHtml();e.process()},311);break}}};this.processAsPaste=
function(a){var b=new FileReader,d=this,e={};$(d.target).find("img").each(function(){e[this]=!0});b.onloadend=function(){var g=null;$(d.target).find("img").each(function(){null!=g||e[this]||(g=this)});g||d.target.ownerDocument.execCommand("InsertImage",!1,this.result);$(d.target).find("img").each(function(){null!=g||e[this]||(g=this)});if(g){var h=d.tmpId(g);d.images.push({id:h,src:g.src,mode:"base64"});d.process()}else console.log("not img")};b.readAsDataURL(a.getAsFile())};this.processAsHtml=function(){var a=
this.target,b=this;$(a).find("img").each(function(){if(!this.getAttribute("_tmp_id")){var d=b.tmpId(this);this.src&&0!=this.src.indexOf(location.origin)&&b.images.push({id:d,src:this.src,mode:0==this.src.indexOf("data:image")?"base64":"normal"})}});this.processRemoveComments();$(a).find("*").each(function(){var d=$(this).css("background-image");d&&(d=d.replace("url(","").replace(")",""))&&d.startsWith("http://")&&b.images.push({id:EWA_MiscPasteTool.tmpId(this),src:d,mode:"background"});$(this).attr({onclick:null,
onload:null,onkeydown:null,onkeyup:null,onerror:null,onmousedown:null,onmouseout:null,onmouseover:null,onkeypress:null,onblur:null,onscroll:null})})};this.processRemoveComments=function(a){null==a&&(a=this.target);var b=[],d;for(d in a.childNodes){var e=a.childNodes[d];8==e.nodeType||"SCRIPT"==e.tagName||"LINK"==e.tagName||"STYLE"==e.tagName||"IFRAME"==e.tagName?b.push(e):"SPAN"==e.tagName&&(GetInnerText(e)||b.push(e))}for(d in b)a.removeChild(b[d]);for(d in a.childNodes)e=a.childNodes[d],1==e.nodeType&&
e.childNodes&&this.processRemoveComments(e)};this.tmpId=function(a){if(a.getAttribute("_tmp_id"))return a.getAttribute("_tmp_id");var b=("r_"+Math.random()).replace(".","");a.setAttribute("_tmp_id",b);$(a).css("max-width","100%");return b};this.process=function(){if(0!=this.images.length){var a={d:JSON.stringify(this.images)};this.images=[];var b=this;$JP(this.handleUrl,a,function(d){if(d.rst)for(var e=0;e<d.rsts.length;e++){var g=d.rsts[e],h=g.id,k=g.local;"background"==g.mode?$(b.target).find('[_tmp_id="'+
h+'"]').css("background-image","url("+k+")"):$(b.target).find('img[_tmp_id="'+h+'"]').attr("src",k)}else $Tip("\u5904\u7406\u9519\u8bef");b.handleUrlAfterEvent&&b.handleUrlAfterEvent(d)})}};this.bind=function(a,b,d){if(b){this.handleUrl=b;this.images=[];this.target=a;var e=this;$(document).ready(function(){$(a).bind("paste",function(g){e.paste(g)})});this.handleUrlAfterEvent=d?d:null}else alert("\u8bf7\u5b9a\u4e49\u63d0\u4ea4\u5730\u5740")}}
function EWA_UI_MapClass(a,b){this.cfg=a;this._FromId=b;this.showFull=function(){var d="div$"+this._FromId+"$MAP1",e=d+"d";if(!$X(d)){var g="<div class='ewa-map-full' id='"+d+"'><div class='ewa-map-full-cnt' id='"+e+"'></div><p title='\u9000\u51fa\u5168\u5c4f' onclick='$(this.parentNode).hide();' class='fa fa-power-off' id='"+d+"1p'></p></div>";$("body").append(g)}$($X(d)).show();this.gps1=new EWA_GMapClass;this.gps1.init(14);g=this.getLngLat();d=g[0];g=g[1];d&&g?this.gps1.showMap(e,d,g,$X(this._FromId).value):
this.search_addr($X(this._FromId),this.gps1,e)};this.getLngLat=function(){if(this.cfg.lng)var d=$X(this.cfg.lng).value;else(d=$($X(this._FromId+"_LNG")).val())||(home_lang=$($X(this._FromId.split("_")[0]+"_LNG")).val());if(this.cfg.lat)var e=$X(this.cfg.lat).value;else(e=$($X(this._FromId+"_LAT")).val())||(e=$($X(this._FromId.split("_")[0]+"_LAT")).val());return[d,e]};this.init=function(){var d=this._FromId+"$MAPClass",e="div$"+this._FromId+"$MAP",g=this;addEvent($X(this._FromId),"blur",function(){g.search_addr(this,
g.gps,e)});var h=$X(this._FromId).parentNode.parentNode,k=h.parentNode.insertRow(h.rowIndex+1).insertCell(-1);k.innerHTML="<div class='ewa-map-small'><div class='ewa-map-small-cnt' id='"+e+"'></div><div class='ewa-map-full-but' title='\u5168\u5c4f\u67e5\u770b' onclick='"+d+".showFull()'><b class='fa fa-square-o'></b></div></div>";k.colSpan=h.cells.length;k.className="ewa-map-small-td";this.gps=new EWA_GMapClass;this.gps.init(10);h=this.getLngLat();d=h[0];h=h[1];d&&h?this.gps.showMap(e,d,h,$X(this._FromId).value):
this.search_addr($X(this._FromId),this.gps,e)};this.setSearchResult=function(d,e,g){this.cfg.lng?$X(this.cfg.lng).value=d.Q_LNG:($X(this._FromId+"_LNG")&&($X(this._FromId+"_LNG").value=d.Q_LNG),$X(this._FromId.split("_")[0]+"_LNG")&&($X(this._FromId.split("_")[0]+"_LNG").value=d.Q_LNG));this.cfg.lat?$X(this.cfg.lat).value=d.Q_LAT:($X(this._FromId+"_LAT")&&($X(this._FromId+"_LAT").value=d.Q_LAT),$X(this._FromId.split("_")[0]+"_LAT")&&($X(this._FromId.split("_")[0]+"_LAT").value=d.Q_LAT));this.cfg.zip?
$X(this.cfg.zip).value=d.Q_ZIP||"":($X(this._FromId+"_ZIP")&&($X(this._FromId+"_ZIP").value=d.Q_ZIP),$X(this._FromId.split("_")[0]+"_ZIP")&&($X(this._FromId.split("_")[0]+"_ZIP").value=d.Q_ZIP));this.cfg.province?$X(this.cfg.province).value=d.Q_STATE||"":($X(this._FromId+"_STATE")&&($X(this._FromId+"_STATE").value=d.Q_STATE),$X(this._FromId.split("_")[0]+"_STATE")&&($X(this._FromId.split("_")[0]+"_STATE").value=d.Q_STATE));this.cfg.city&&($X(this.cfg.city).value=d.Q_CITY||"");this.cfg.country&&($X(this.cfg.country).value=
d.Q_COUNTRY||"");g=e.showMap(g,d.Q_LNG,d.Q_LAT,d.Q_SEARCH);e.map.setCenter(g);this.searchResultAfter&&this.searchResultAfter(d)};this.search_addr=function(d,e,g){d=d.value;if(""!=d){var h=this;d=[d];h.cfg.city&&d.push($X(h.cfg.city).value);h.cfg.province&&d.push($X(h.cfg.province).value);h.cfg.country&&d.push($X(h.cfg.country).value);d=d.join(", ");e.getGpsFromAddress(d,function(k,l,m){h.setSearchResult(m,e,g)})}}}
function EWA_UI_PicViewClass(){this.id=("EWAUIPicView"+Math.random()).replace(".","Gdx");this.t_start=-1;this.dist_base=0;this.is_move=!1;this.table=null;this.prevIdx=-1;this.setImg=function(a){$(a).attr("mw",a.width).attr("mh",a.height).css("margin-left",0).css("margin-top","0");$(a).parent().css("background-image","none")};this.addPic=function(a){var b=this.table.rows[0].cells.length,d=this.table.rows[0].insertCell(b);d.align="center";var e="<img style='max-width:100%;max-height:100%' onload='"+
this.id+".setImg(this)' id='"+(this.id+"_"+b)+"' ";e+=" src1='"+a+"'>";$(d).hide().css({"background-image":"url('/static/images/loading2.gif')","background-position":"center center","background-repeat":"no-repeat"});d.innerHTML=e;$(this.table1).find("td").append("<b>&bull;</b>");0==b?this.changePhoto(0):$(this.table1).show();this.total=b+1};this.changePhoto=function(a){if(this.prevIdx!=a){if(0<=this.prevIdx){var b=$("#"+this.id+"_"+this.prevIdx);$(b).parent().hide();$(this.table1).find("b:eq("+this.prevIdx+
")").css("color","#ccc")}this.prevIdx=a;b=$("#"+this.id+"_"+a);if(b.attr("src1"))b.attr("src",b.attr("src1")),b.attr("scr1",""),b[0].setAttribute("src1","");else{try{if(b.attr("mw")){var d=1*b.attr("mw");b.attr("mh");b.css("width",d).css("height".mh)}}catch(e){console.log(e)}b.css("margin-left",0).css("margin-top",0).attr("r",null).attr("rold",null).css("transform","scale(1)")}b.parent().show();$(this.table1).find("b:eq("+a+")").css("color","yellow")}};this.close=function(){$(this.table).parent().remove();
delete window[this.id]};this.create=function(){window[this.id]=this;var a=document.createElement("div"),b=document.createElement("table");b.insertRow(-1);var d=document.createElement("table");d.insertRow(-1).insertCell(-1).align="center";var e=document.createElement("div");e.innerHTML="<b class='fa fa-close'></b>";$(a).css({position:"fixed",top:0,left:0,width:"100%",height:"100%","z-index":99999999,background:"rgba(0, 0, 0, 0.9)"});$(b).css({position:"absolute",left:0,top:0,height:"100%",width:"100%",
"table-layout":"fixed"});$(d).css({position:"absolute",left:0,height:30,width:"100%",overflow:"hidden",bottom:"5px","z-index":3,color:"#ccc","font-size":"30px",display:"none"});$(e).css({position:"absolute",right:20,top:30,height:40,width:40,"line-height":"40px",overflow:"hidden","z-index":4,color:"darkred","font-size":"30px","text-align":"center",display:"block"}).attr("onclick",this.id+".close()");this.table=b;this.table1=d;$(a).append(b);$(a).append(d);$(a).append(e);$("body").append(a);var g=
this;b.ontouchstart=function(h){1==h.targetTouches.length?g.t_start=h:2==h.targetTouches.length&&(g.t_start1=h,g.dist_base=0);g.is_move=!1;h.preventDefault();h.stopPropagation()};b.ontouchmove=function(h){if(2==h.targetTouches.length){g.t_start1a=h;var k=h.targetTouches[0].pageX-g.t_start1.pageX,l=h.targetTouches[0].pageY-g.t_start1.pageY,m=h.targetTouches[1].pageX-g.t_start1.pageX,n=h.targetTouches[1].pageY-g.t_start1.pageY;l=Math.sqrt((k-m)*(k-m)+(l-n)*(l-n));0==g.dist_base?g.dist_base=l:(l/=g.dist_base,
k=$(h.target).attr("rold"),l*=k?1*k:1,1>=l&&(l=1),5<l&&(l=5),$(h.target).css("transform","scale("+l+")").attr("r",l),1==l&&$(h.target).css("margin-left",0).css("margin-top",0))}else if(1==h.targetTouches.length){l=$(h.target).attr("r");if(null==l||1==l)return;k=h.pageX-g.t_start.pageX;l=h.pageY-g.t_start.pageY;n=1*$(h.target).css("margin-left").replace("px","");m=1*$(h.target).css("margin-top").replace("px","");k=n+k;l=m+l;$(h.target).css("margin-left",k).css("margin-top",l);g.t_start=h;g.is_move=
!0}h.preventDefault();h.stopPropagation()};b.ontouchend=function(h){h.preventDefault();h.stopPropagation();if(g.t_start){var k=h.pageX-g.t_start.pageX,l=h.timeStamp-g.t_start.timeStamp;-50>k&&244>l?(k=g.prevIdx,k++,k==g.total&&(k=0),g.changePhoto(k)):50<k&&244>l?(k=g.prevIdx,k--,0>k&&(k=g.total-1),g.changePhoto(k)):10>Math.abs(k)&&150>l&&!g.is_move&&g.click_page()}console.log(g.t_start1);g.t_start1&&(k=$(h.target).attr("r"),console.log(k),$(h.target).attr("rold",k));g.t_start=null;g.t_start1=null}}}
function EWA_UI_H5FrameSet(){this.Create=function(a,b){this.Id=a;this.FrameType=b;this.LOC_ID="EWA_UI_H5FrameSet_"+this.Id;this.ParentDiv=$("#F0_"+this.Id).parent();this.objOne=this.ParentDiv.find(".ewa-frameset-one");this.objTwo=this.ParentDiv.find(".ewa-frameset-two");this.objSplit=this.ParentDiv.find(".ewa-frameset-split");this.objCover=this.ParentDiv.find(".ewa-frameset-cover");$("body").css("height","100vh");"H5"==b?this.CreateMoveH5():this.CreateMoveV5();window.localStorage[this.LOC_ID]&&this.ChangeLocation(1*
window.localStorage[this.LOC_ID])};this._GetMoveInstance=function(){if(window.__EWA_MOVE_EWA_UI_H5FrameSetInstance)return window.__EWA_MOVE_EWA_UI_H5FrameSetInstance;window.__EWA_MOVE_EWA_UI_H5FrameSetInstance=new EWA.UI.Move;window.__EWA_MOVE_EWA_UI_H5FrameSetInstance.NAME="__EWA_MOVE_EWA_UI_H5FrameSetInstance";window.__EWA_MOVE_EWA_UI_H5FrameSetInstance.Init(window.__EWA_MOVE_EWA_UI_H5FrameSetInstance);return window.__EWA_MOVE_EWA_UI_H5FrameSetInstance};this.CreateMoveV5=function(){this.mv1=this._GetMoveInstance();
var a=this.objSplit[0],b=this;this.mv1.AddMoveObjectY(a,a,function(d){b.objCover.hide();b.objSplit.css("z-index",1)},document.body,function(d,e){d=1*$(d).css("top").replace("px","");b.ChangeLocation(d);window.localStorage[b.LOC_ID]=d},function(){b.objCover.show()})};this.CreateMoveH5=function(){this.mv1=this._GetMoveInstance();var a=this.objSplit[0],b=this;this.mv1.AddMoveObjectX(a,a,function(d){b.objCover.hide();b.objSplit.css("z-index",1)},document.body,function(d,e){d=1*$(d).css("left").replace("px",
"");b.ChangeLocation(d);window.localStorage[b.LOC_ID]=d},function(){b.objCover.show()})};this.ChangeLocation=function(a){"H5"==this.FrameType?(this.objOne.css("width",a),this.objTwo.css("left",a+1),this.objSplit.css("left",a)):(this.objOne.css("height",a),this.objTwo.css("top",a+1),this.objSplit.css("top",a))}}
var EWA_UI_Dock={dockObj:null,dockTitleObj:null,menuMap:{},init:function(a){var b=["<div class='ewa-dock'><table class='ewa-dock-table'><tr>"],d;for(d in a){var e=a[d],g=EWA_Utils.tempId("_EWA_UI_Dock_");this.menuMap[g]=e;var h=this.getMenuText(e);h=this.filterHtml(h);b.push("<td class='ewa-dock-item-td' ><div class='ewa-dock-item-div' id='"+g+"' _title=\""+h+"\" onclick='EWA_UI_Dock.click(this)' onmouseover='EWA_UI_Dock.showTitle(this)' onmouseout='EWA_UI_Dock.hideTitle(this)'><div class='ewa-dock-item-icon "+
e.ICON+"'></div></div></td>")}b.push("</tr></table></div>");this.dockObj=$(b.join(""));this.dockTitleObj=$('<div class="ewa-dock-title" style="display: none;"><div>--</div><p></p></div>');$("body").append(this.dockObj).append(this.dockTitleObj)},click:function(a){var b=this.menuMap[a.id];b||console.log("menu ["+a.id+"]?");b.CMD?b.CMD instanceof Function?b.CMD(a):eval(b.CMD):console.log("NO CMD in menu",b)},getMenuText:function(a){return a.TEXT},filterHtml:function(a){return a.replace(/</ig,"&lt;").replace(/>/ig,
"&gt;").replace(/"/ig,"&quot;")},showTitle:function(a){if(""==a.getAttribute("_title")||null==a.getAttribute("_title")){var b=a.title;if(""==b||null==b)return;a.setAttribute("_title",b);a.title=""}this.dockTitleObj.find("div:eq(0)").html(a.getAttribute("_title"));b=$(a).offset();a=$(a).width();var d=this.dockTitleObj.height(),e=this.dockTitleObj.width();this.dockTitleObj.css("top",b.top-d-8);this.dockTitleObj.show();this.dockTitleObj.css("left",b.left-(e-a)/2)},hideTitle:function(){this.dockTitleObj.hide()}},
EWA_Behavior={RELOAD_PARENTA:function(a){var b=window.parent;try{b.EWA.F.FOS[a]&&b.EWA.F.FOS[a].Reload?b.EWA.F.FOS[a].Reload():b.location=b.location.href}catch(d){b.location=b.location.href}},RELOAD_PARENT:function(a){var b=EWA_Behavior.getParentWindow();if(b){var d=EWA_Behavior.getParentFrame(a);try{d?d.Reload(window.location.href):(console.warn("not found parent frame:"+a),_EWA_DialogWnd.CloseWindow(),b.location=b.location.href)}catch(e){console.log(e),b.location=b.location.href}}},getParentWindow:function(){return null==
window._EWA_DialogWnd?null:_EWA_DialogWnd._OpenerWindow},getParentFrame:function(a){var b=EWA_Behavior.getParentWindow();return b&&b.EWA&&b.EWA.F&&b.EWA.F.FOS&&b.EWA.F.FOS[a]?b.EWA.F.FOS[a]:null},CLOSE_SELF:function(){null==window._EWA_DialogWnd?self.close():_EWA_DialogWnd.CloseWindow()},CLEAR_SELF:function(){self.document.forms[0].reset()}};
function EWA_PostBehavior(a,b){if(0>a.indexOf("RELOAD_PARENTA"))try{if(!window._EWA_DialogWnd){console.log("not parent window");return}if(window.STOP_RELOAD){window.STOP_RELOAD=!1;return}var d=_EWA_DialogWnd._OpenerWindow,e=d.__Dialog[b];e&&e.AfterMsg&&d.EWA.UI.Msg.Alert(e.AfterMsg,_EWA_INFO_MSG["EWA.SYS.CHOOSE_ITEM_TITLE"])}catch(g){console.log(g)}if(d=EWA_Behavior.getParentFrame(b))for(d.outParams=[],e=2;e<arguments.length;e++)d.outParams.push(arguments[e]);d=a.split(",");for(e=0;e<d.length;e+=
1)EWA_Behavior[d[e]](b)}EWA.UI.Ext=EWA.UI.Ext||{};
EWA.UI.Ext.initExtsMap=function(){function a(d,e,g){d=d.split(",");for(var h in d){var k=d[h].trim().toLowerCase();b.mapImg[k]=e;b.mapIcon[k]=g}}if(!this.mapImg){this.mapImg={def:"Edit.png"};this.mapIcon={def:"fa fa-file-text-o"};var b=this;a(".doc,.docx,.rtf","MSWD.png","fa fa-file-word-o ewa-file-ext-color-word");a(".xls,.xlsx","XCEL.png","fa fa-file-excel-o ewa-file-ext-color-excel");a(".ppt,.pptx","PPT3.png","fa fa-file-powerpoint-o ewa-file-ext-color-powerpoint");a(".txt,.cvs,.pom","Edit.png",
"fa fa-file-text-o ewa-file-ext-color-text");a(".pdf","ACR_App.png","fa fa-file-pdf-o ewa-file-ext-color-pdf");a(".7z,.zip,.rar,.arc,.gz,.tar","zip.png","fa fa-file-zip-o ewa-file-ext-color-zip");a(".odt","openoffice.png","fa fa-file-text-o ewa-file-ext-color-text");a(".html,.htm","html.png","fa fa-internet-explorer ewa-file-ext-color-html");a(".mp3,.wav,.mid,.m4a,.oga,.flac,.weba,.opus,.ogg","mp3.png","fa fa-file-audio-o ewa-file-ext-color-audio");a(".mp4,.mov,.flv,.vod,.ogm,.ogv,.wmv,.mpg,.mpeg,.m4v,.avi,.asx,.webm",
"vod.png","fa fa-file-video-o ewa-file-ext-color-video");a(".jpg,.jpeg,.jiff,jfif,.png,.bmp,.webp,.tiff,.avif","vod.png","fa fa-file-image-o ewa-file-ext-color-image")}};EWA.UI.Ext.getFileIco=function(a){this.initExtsMap();var b=(EWA.RV_STATIC_PATH||"/EmpScriptV2")+"/EWA_STYLE/images/file_png/";null==a&&(a="");a=a.toLowerCase();0>a.indexOf(".")&&(a="."+a);return this.mapImg[a]?b+this.mapImg[a]:b+this.mapImg.def};EWA.UI.Ext.FileIco=EWA.UI.Ext.getFileIco;
EWA.UI.Ext.getFileIcon=function(a){this.initExtsMap();null==a&&(a="");a=a.toLowerCase();0>a.indexOf(".")&&(a="."+a);return this.mapIcon[a]?this.mapIcon[a]:this.mapIcon.def};EWA.UI.Ext.FileExt=function(a){if(null==a)return"";a=a.toLowerCase();var b=a.lastIndexOf("."),d="";0<b&&(d=a.substring(b));return d};
EWA.UI.Ext.getFileLen=function(a,b){if(null==a||isNaN(a))return a||"";if(null==b||isNaN(b))b=0;return 1099511627776<=a?(a/1099511627776).fm(b)+"T":1073741824<=a?(a/1073741824).fm(b)+"G":1048576<=a?(a/1048576).fm(b)+"M":1024<=a?(a/1024).fm(b)+"K":a+"B"};EWA.UI.Ext.FileLen=EWA.UI.Ext.getFileLen;
EWA.UI.Ext.Mobile=function(a){if(a){var b=a.id||"R"+Math.random();a.id=b;b="__mobile_"+b;$(a).attr("mobile_id",b);if(!$X(b)){var d=[];d.push("<table class='ewa-text-help-box' border=0 cellpadding=3 cellspacing=0 id='"+b+"'>");d.push("<tr><td>");d.push(EWA.UI.Ext.IdCard1(3));d.push("</td><td>-</td><td>");d.push(EWA.UI.Ext.IdCard1(4));d.push("</td><td>-</td><td>");d.push(EWA.UI.Ext.IdCard1(4));d.push("</td><td><i></i></td></tr></table>");$("body").append(d.join(""));d=$X(b);$(d).find("td").css("background-color",
"#fff").attr("align","center");$(a).attr("maxLength",11)}d=$X(b);addEvent(a,"focus",function(){var e=$(this).attr("mobile_id");e=$($X(e)).show();e.css("top",$(this).offset().top-e.height()-7);e.css("left",$(this).offset().left);EWA.UI.Ext.Mobile2(this)});addEvent(a,"blur",function(){var e=$(this).attr("mobile_id");$($X(e)).hide()});addEvent(a,"keyup",function(){EWA.UI.Ext.Mobile2(this)})}};
EWA.UI.Ext.Mobile2=function(a){var b=$(a).attr("mobile_id");b=$($X(b));a=a.value;var d=b.find("div");d.html("");for(var e=!0,g=0;g<a.length;g++){var h=a.substring(g,g+1),k="";isNaN(h)&&(k="red",e=!1);d[g]&&(d[g].innerHTML="<span style='font-size:16px;color:"+k+"'>"+h+"</span>")}a.length==d.length&&e?b.find("i").html("<font color=green>\u6b63\u786e</font>"):b.find("i").html("<font color=red>\u9519\u8bef</font>")};
EWA.UI.Ext.IdCard=function(a){if(a){var b=a.id||"R"+Math.random();a.id=b;b="__sfz_"+b;$(a).attr("sfz_id",b);if(!$X(b)){var d=[];d.push("<table class='ewa-text-help-box' border=0 cellpadding=1 cellspacing=1 id='"+b+"'>");d.push("</tr><td height=18>\u5730\u533a</td><td >\u5e74</td><td>\u6708</td><td>\u65e5</td><td>\u987a\u5e8f\u53f7</td></tr>");d.push("<tr><td>");d.push(EWA.UI.Ext.IdCard1(6));d.push("</td><td>");d.push(EWA.UI.Ext.IdCard1(4));d.push("</td><td>");d.push(EWA.UI.Ext.IdCard1(2));d.push("</td><td>");
d.push(EWA.UI.Ext.IdCard1(2));d.push("</td><td>");d.push(EWA.UI.Ext.IdCard1(4));d.push("</td></tr><tr><td colspan=5>\u72b6\u6001 <i></i></td></tr></table>");$("body").append(d.join(""));d=$X(b);$(d).find("td").css("background-color","#fff").attr("align","center");$(a).attr("maxLength",18)}d=$X(b);addEvent(a,"focus",function(){var e=$(this).attr("sfz_id");e=$($X(e)).show();e.css("top",$(this).offset().top-e.height()-8);e.css("left",$(this).offset().left);EWA.UI.Ext.IdCard2(this)});addEvent(a,"blur",
function(){var e=$(this).attr("sfz_id");$($X(e)).hide()});addEvent(a,"keyup",function(){EWA.UI.Ext.IdCard2(this)})}};EWA.UI.Ext.IdCard1=function(a){for(var b=[],d=0;d<a;d++)b.push("<div></div>");return b.join("")};
EWA.UI.Ext.IdCard2=function(a){var b=[1,31,28,31,30,31,30,31,31,30,31,30,31],d=$(a).attr("sfz_id");d=$($X(d)).show();var e=a.value,g=d.find("div");g.html("");for(var h=!0,k=[],l=[],m=[],n=[],p=0;p<e.length;p++){var q=e.substring(p,p+1),t="";6>p?k.push(q):6<=p&&10>p?l.push(q):10<=p&&12>p?m.push(q):12<=p&&14>p&&n.push(q);17>p?isNaN(q)&&(t="red",h=!1):"x"!=q&&"X"!=q&&isNaN(q)&&(t="red",h=!1);g[p]&&(g[p].innerHTML="<span style='font-size:16px;color:"+t+"'>"+q+"</span>")}k=l.join("");l=[];if(isNaN(k))h=
!1,l.push("\u5e74:"+k);else{if(1900>k||2100<k){h=!1;for(p=6;10>p;p++)$(g[p]).find("span").css("color","red");l.push("\u5e74:"+k)}b[2]=0==(k-1996)%4?29:28}m=m.join("");ismonth1=!0;if(isNaN(m))h=ismonth1=!1,l.push("\u6708:"+m);else if(1>m||12<m){ismonth1=h=!1;for(p=10;12>p;p++)$(g[p]).find("span").css("color","red");l.push("\u6708:"+m)}n=n.join("");if(isNaN(n))h=!1;else if(ismonth1&&(1>n||n>b[1*m])){h=!1;for(p=12;14>p;p++)$(g[p]).find("span").css("color","red");l.push("\u65e5:"+n)}e.length==g.length&&
h?(d.find("i").html("<font color=green>\u6b63\u786e</font>"),b={YEAR:k,MONTH:m,DAY:n,SEX:1*$(g[16]).text()%2},$(a).attr("sfz_json",JSON.stringify(b))):d.find("i").html("<font color=red>"+l.join(", ")+"\u9519\u8bef</font>")};"undefined"==typeof EWA&&(EWA={});
EWA.F={FOS:{},GetFOSOne:function(){for(var a in EWA.F.FOS)return EWA.F.FOS[a]},getSubEwas:function(a){var b=[];$(a).find(".EWA_TABLE").each(function(){var d=$(this).attr("id");d&&(d=d.replace("EWA_FRAME_","").replace("EWA_LF_",""),(d=EWA.F.FOS[d])&&b.push(d))});return b},U:{WND:null},Cmd:function(){this.EWA_ACTION=null;this.EWA_NO_CONTENT=this.EWA_AJAX="1";this.EWA_TREE_TEXT=this.EWA_TREE_PARENT_KEY=this.EWA_TREE_KEY=null;this.EWA_AFTER_EVENT=""},Install:function(a,b,d,e,g){b=(window.EWA_CGI?window.EWA_CGI:
EWA.CP+"/EWA_STYLE/cgi-bin/")+"?xmlName="+b+"&itemName="+d+"&EWA_FRAMESET_NO=1&EWA_AJAX=INSTALL&"+e;(new EWA.C.Ajax).Install(b,"_r=1",a,g)},InstallHtml:function(a,b,d){var e=$X(a);if(null==e)alert("Object ["+a+"] not found");else{e.innerHTML=b;try{EWA.C.Utils.JsRegisters(rst)}catch(g){console.log(g)}if(null!=d)try{d(a)}catch(g){console.log(g)}}}};
EWA.F.POP={AJAX:null,PostBehavior:function(a,b,d){var e=EWA.F.FOS[a];if(null==e)alert("Object EWA.F.FOS."+a+" not exists!");else if(e=null==e.Url?e._Url:e.Url,null==e)alert("Object EWA.F.FOS."+a+".Url not exists!");else{a="EWA_AJAX=1&EWA_NO_CONTENT=1&EWA_ACTION="+d;if(null!=b)for(d=0;d<b.length;d+=1){var g=b[d].Name,h=b[d].Value;null!=g&&""!=g&&null!=h&&""!=h&&(h=encodeURIComponent(h),a=a+"&"+g+"="+h)}EWA.F.POP.AJAX=new EWA.C.Ajax;EWA.F.POP.AJAX.LoadingType="image";EWA.F.POP.AJAX.Post(e,a,EWA.F.POP.CallBack)}},
CallBack:function(){var a=EWA.F.POP.AJAX;if(4==a._Http.readyState)if(a.HiddenWaitting(),200==a._Http.status){if(a=a._Http.responseText,EWA.F.CheckCallBack(a))try{eval(a)}catch(b){alert(a)}}else alert("ERROR:\r\n"+a._Http.statusText)}};EWA.F.CheckCallBack=function(a){return 0<=a.indexOf("\x3c!--EWA_ERROR_INFOMATION--\x3e")?(1==EWA.SHOW_ERROR&&$DialogHtml(a,"ERROR","90vw","90vh"),!1):!0};EWA.F.ST={};
EWA.F.ST.SaveStatus=function(a,b){var d=EWA.CP+"/EWA_STYLE/cgi-bin/_st_/";d=d.replace("//","/");var e=new EWA.C.Ajax;e.AddParameter("U",document.location.href);e.AddParameter("T",b);e.AddParameter("V",a);e.AddParameter("M","1");e.PostNew(d,function(){});e.HiddenWaitting()};
EWA.F.ST.GetStatus=function(a,b){var d=EWA.CP+"/EWA_STYLE/cgi-bin/_st_/";d=d.replace("//","/");EWA.F.ST.Ajax=new EWA.C.Ajax;EWA.F.ST.Ajax.AddParameter("U",document.location.href);EWA.F.ST.Ajax.AddParameter("T",a);EWA.F.ST.Ajax.AddParameter("M","0");EWA.F.ST.Ajax.FrameClass=b;EWA.F.ST.Ajax.PostNew(d,EWA.F.GetStatusCallBack)};
EWA.F.GetStatusCallBack=function(){var a=EWA.F.ST.Ajax;4==a._Http.readyState&&(a.HiddenWaitting(),200==a._Http.status?(eval(a._Http.responseText),a.FrameClass.LoadStatus()):alert("ERROR:\r\n"+a._Http.statusText),EWA.F.ST.Ajax=null)};
EWA.F.Ajax={TIMER_ID:null,AJAX_LIST:[],_GetId:function(a){var b=this.AJAX_LIST.length;this.AJAX_LIST[b]=a;return b},_StartMonitor:function(){null==this.TIMER_ID&&(this.TIMER_ID=window.setInterval(this._Moninter,100))},_Moninter:function(){for(var a=!0,b=0;b<EWA.F.Ajax.AJAX_LIST.length;b++){var d=EWA.F.Ajax.AJAX_LIST[b];null==d||d.isStop||EWA.F.Ajax._CallBack(d)||(a=!1)}a&&(window.clearInterval(EWA.F.Ajax.TIMER_ID),EWA.F.Ajax.TIMER_ID=null)},_CallBack:function(a){var b=a.ajax;if(4!=b._Http.readyState)return!1;
a.isStop=!0;b.HiddenWaitting();a.ret=200==b._Http.status?b._Http.responseText:"ERROR:\r\n"+b._Http.statusText;a.ReplaceObject();return!0},Install:function(a,b){this.replaceId=b;this.CLASS_NAME="EWA.F.Ajax.Install";this.ajax=new EWA.C.Ajax;this.ret=null;this.isStop=!0;this.id=EWA.F.Ajax._GetId(this);this.ajax.Get(a,function(){});this.isStop=!1;EWA.F.Ajax._StartMonitor();this.ReplaceObject=function(){$X(this.replaceId).innerHTML=this.ret;this.AddScripts()};this.AddScripts=function(){var d=this.ret.match(/<script(.|\n|\r)*?>(.|\n|\r)*?<\/script(.|\n|\r)*?>/ig);
if(null!=d)for(var e=document.getElementsByTagName("head")[0]||document.documentElement,g=0;g<d.length;g++){var h=d[g];h=h.replace(/<script(.|\n|\r)*?>/ig,"").replace(/<\/script(.|\n|\r)*?>/ig,"").trim();if(0!=h.length)try{var k=document.createElement("script");k.type="text/javascript";EWA.B.IE?k.text=h:k.appendChild(document.createTextNode(h));e.insertBefore(k,e.firstChild);e.removeChild(k)}catch(l){}}}}};
EWA.F.U.Upload=function(a,b,d){var e=new EWA.UI.Dialog.CMD;e.CmdArgus[0]=d;e.CmdArgus[1]="UPFILE";EWA.UI.Dialog.OpenWindow(EWA.CP+"/EWA_STYLE/cgi-bin/_up_/?xmlName="+a+"&ITEMNAME="+b+"&FROMITEM="+d.id,"upfile",420,310,!1,null,e)};EWA.F.Tip=function(a){var b=_EWA_INFO_MSG[a];null==b&&(b=a);null!=b&&""!=b.trim()&&alert(b)};EWA.F.I={};
EWA.F.I.DropList=function(a){null==EWA.F.FOS[a.id]&&(EWA.F.FOS[a.id]=new EWA_FrameItemClass);EWA.F.FOS[a.id].DropList(a);$(a).next().val("");a.getAttribute("_check_blank")||(a.setAttribute("_check_blank","haha"),addEvent(a,"blur",function(){if(""==$(this).next().val()){this.value="";var b=$(this).next().attr("afterevent");if(b)if(window[b])window[b]("","",$(this).next()[0],this);else try{eval(b)("","",$(this).next()[0],this)}catch(d){console.log(d)}}}))};
EWA.F.I.Date=function(a,b){EWA.F.FOS[a.id]=new EWA.UI.Calendar.Pop(a,b)};function EWA_Parameters(){this.ParaNames=[];this.ParaValues=[];this.Add=function(a,b){null!=a&&""!=a.trim()&&(this.ParaNames[this.ParaNames.length]=a.trim(),this.ParaValues[this.ParaValues.length]=b)};this.GetString=function(){for(var a="",b=0;b<this.ParaNames.length;b=1+b)0<a.length&&(a+="&"),a+=encodeURIComponent(this.ParaValues[b]);return a}}
function EWA_FrameInstallClass(a,b,d,e){this.Xml=new EWA.C.Xml;this.XmlName=b;this.ItemName=d;this.Parameters=e;this.Install=function(g){null==g&&(g=this.GetUrl());this.Xml.LoadXmlFile(g);var h=this.Xml.GetElement("FrameData"),k=this.Xml.GetElementAttribute(h,"Type"),l=this.Xml.GetElementAttribute(h,"ClassName");h=this.Xml.GetElement("Css",h);h=this.Xml.GetElementText(h);document.write(h);"TREE"==k.toUpperCase()&&(g=new EWA.F.T.C(a,l,g),eval(l+"=c"),EWA.F.FOS[l]=g,g.CreateByXml(this.Xml))};this.GetUrl=
function(){var g=EWA.CP+"/EWA_STYLE/cgi-bin/?XMLNAME=";g+=this.XmlName.toURL()+"&ITEMNAME="+this.ItemName.toURL();g+="&EWA_AJAX=XML";null!=this.Parameters&&(g+="&"+this.Parameters.GetString());return g}}
function EWA_FrameCommonItems(){this._ClassXml=null;this.Items={};this._EWA_JS_ALERT_DEFAULT={MaxMinLength:"\u957f\u5ea6\u5e94\u5728{MinLength}-{MaxLength}\u4e4b\u95f4 ",MaxMinValue:"\u503c\u5e94\u5728({MinValue} - {MaxValue})\u4e4b\u95f4",IsMustInput:"*"};this.Init=function(a){this._ClassXml=a;a=a.GetElements("root/XItem");var b=!1;if(this.F){var d=new EWA_UrlClass;d.SetUrl(this.F.Url);"M"==d.GetParameter("EWA_MTYPE")&&(b=!0)}for(d=0;d<a.length;d++){var e=this.GetItemValue(a[d],"Name","Name"),g=
e.toUpperCase(),h=a[d];this.Items[g]=h;var k=this.GetItemValue(h,"DataItem","Valid");k&&"MOBILE"==k.toUpperCase()?EWA.UI.Ext.Mobile($X(g)):k&&"IDCARD"==k.toUpperCase()&&EWA.UI.Ext.IdCard($X(g));b&&this.disableOnModify(h,e)}};this.disableOnModify=function(a,b){(a=this.GetItemValue(a,"DataItem","DisableOnModify"))&&"YES"==a.toUpperCase()&&(b=$X(b))&&(b.setAttribute("disabled","disabled"),b.getAttribute("DlsShow")&&$(b).prev().attr("disabled","disabled"))};this.GetItem=function(a){a=a.toUpperCase().trim();
return this.Items[a]};this.GetItemValue=function(a,b,d){if(null==a)return null;a=this._ClassXml.GetElement(b+"/Set",a);return null==a?null:a.getAttribute(d)};this.GetDescription=function(a){a=$(this.GetItem(a)).find("DescriptionSet Set[Lang="+EWA.LANG+"]");return{Info:a.attr("Info"),Memo:a.attr("Memo")}};this.GetValue=function(a,b,d){a=this.GetItem(a);return this.GetItemValue(a,b,d)};this.CheckValid=function(a,b){if("SPAN"==a.tagName||"IMG"==a.tagName)return!0;var d=this.GetItem(a.id),e=[],g=this._CheckMustInput(a,
b,d);g&&e.push(g);if(null==b||""==b){if(0==e.length)return EWA_FrameRemoveAlert(a),!0;EWA_FrameShowAlert(a,e.join(", "));return!1}(g=this._CheckMaxMinLength(a,b,d))&&e.push(g);(g=this._CheckDataValid(a,b,d))&&e.push(g);(g=this._CheckDataType(a,b,d))&&e.push(g);(g=this._CheckMaxMinValue(a,b,d))&&e.push(g);(g=this._CheckPassword(a,b,d))&&e.push(g);(g=this._CheckExtent(a,b,d))&&e.push(g);if(0==e.length)return EWA_FrameRemoveAlert(a),!0;EWA_FrameShowAlert(a,e.join(", "));return!1};this._CheckExtent=function(a,
b,d){b=null;a=a.getAttribute("EWA_VALID_EX");a=null==a?"":a;0<a.length&&(b=a);return b};this._CheckDataType=function(a,b,d){if(null==b||""==b.trim())return null;d=null;this.isNumber(a)&&(a=b.replace(/,/ig,""),isNaN(a)&&(d=_EWA_INFO_MSG["EWA.SYS.INVALID_NUMBER_FORMAT"]));return d};this._CheckPassword=function(a,b,d){if("input"!=a.tagName.toLowerCase()||"password"!=a.type.toLowerCase())return null;d=$("#USR_PWD").parentsUntil("form").last().find("input[type=password]");b=null;for(var e=a.id,g=0;g<d.length;g+=
1)if("password"==d[g].type&&d[g]!=a&&d[g].id==e+"1"){b=d[g];break}d=null;null!=b&&(b.value!=a.value?(isok=!1,d=_EWA_INFO_MSG["EWA.F.PASSWORD"]):EWA_FrameRemoveAlert(b));return d};this._CheckMustInput=function(a,b,d){var e=null;"1"!=this.GetItemValue(d,"IsMustInput","IsMustInput")||null!=b&&0!=b.length||(e=(e=_EWA_JS_ALERT.IsMustInput)?e.replace("{Name}",a.id):"*");return e};this._CheckMaxMinLength=function(a,b,d){if(!b)return null;var e=this.GetItemValue(d,"MaxMinLength","MaxLength");d=this.GetItemValue(d,
"MaxMinLength","MinLength");e=null==e?-1:parseInt(e);d=null==d?-1:parseInt(d);var g=!0;!isNaN(e)&&0<e&&b.length>e&&(g=!1);g&&!isNaN(d)&&0<d&&b.length<d&&(g=!1);b=null;g||(b=_EWA_JS_ALERT.MaxMinLength||this._EWA_JS_ALERT_DEFAULT.MaxMinLength,b=b.replace("{Name}",a.id),b=b.replace("{MaxLength}",e),b=b.replace("{MinLength}",d));return b};this._CheckDataValid=function(a,b,d){a=this.GetItemValue(d,"DataItem","Valid");if(null==a||""==a.trim())return"";if(0<b.length)return a=_EWA_VALIDS[a.toUpperCase().trim()],
null==a?"":a.REGEX.test(b)?"":a.MSG};this._CheckMaxMinValue=function(a,b,d){a=this.GetItemValue(d,"MaxMinValue","MaxValue");d=this.GetItemValue(d,"MaxMinValue","MinValue");var e=null==a||""==a.trim()?null:1*a,g=null==d||""==d.trim()?null:1*d,h=!0;null!=e&&(h=1*b<=e?!0:!1);null!=g&&(h=1*b>=g?h&1:!1);if(h)return"";errorInfo=_EWA_JS_ALERT.MaxMinValue||this._EWA_JS_ALERT_DEFAULT.MaxMinValue;errorInfo=errorInfo.replace("{MaxValue}",a);return errorInfo=errorInfo.replace("{MinValue}",d)};this.isNumber=function(a){if(!a)return null;
a=(a=this.GetItem(a.id))?this.GetItemValue(a,"DataItem","DataType"):"";a=null==a?"":a.toUpperCase();return"NUMBER"==a||"INT"==a||"BIGINT"==a};this.isTrim=function(a){if(!a)return null;if($(a).attr("ewa_trim"))return!0;var b=this.GetItem(a.id);b=(b=b?this.GetItemValue(b,"DataItem","Trim"):"")?b.toUpperCase():"YES";if(b="YES"==b)$(a).attr("ewa_trim","yes").on("blur",function(){this.value=this.value.trim()});return b};this.getFormat=function(a){return a?(a=this.GetItem(a.id))?this.GetItemValue(a,"DataItem",
"Format"):"":""};this.GetObjectValue=function(a){var b=a.tagName.toUpperCase(),d=a,e="";if("DIV"==b&&$(a).hasClass("ewa-switch"))return a.getElementsByTagName("input")[0].checked?"on":"off";if("DIV"==b&&"REPT"==a.getAttribute("TAG")){a=a.getElementsByTagName("input");for(var g=0;g<a.length;g+=1)a[g].checked&&(0<e.length&&(e+=","),e+=a[g].value);return e}if("DIV"==b&&"1"==a.getAttribute("EWA_DHTML"))return e=a.getElementsByTagName("iframe")[0].contentWindow,b=e.document.getElementsByTagName("textarea"),
e=0<b.length&&"none"!=b[0].style.display?b[0].value:e.frames[0].document.body.innerHTML,null!=location.search&&0>location.search.toUpperCase().indexOf("EWA_DHTML_HOST")&&(g="http:\\/\\/"+eval("document.location.host")),g=eval("/"+g+"/ig"),e=e.replace(g,""),a=a.getElementsByTagName("input")[0],a.value=e,a.value;if("SELECT"==b)return e="",0<=d.options.selectedIndex&&(e=d.options[d.options.selectedIndex].value),e;if("TEXTAREA"==b&&"none"==d.style.display)return a.value;if("INPUT"==b&&"IMG_UPLOAD"==d.getAttribute("ewa_tag"))return e=
"/"!=EWA.CP?d.value.replace(EWA.CP,""):d.value,e=e.replace("//","/");if("INPUT"==b&&d.getAttribute("val_ref")){a=d.getAttribute("val_ref");try{e=eval("(function(){var a="+a+";return a;})()")}catch(h){console.log(a),console.log(h),e=""}return e}if("INPUT"==b&&("checkbox"==d.type||"radio"==d.type))return e=d.checked?d.value:"";(e=d.value)&&this.isTrim(a)&&(g=e.trim(),g!==e&&(e=g));if("INPUT"!==b||!this.isNumber(a))return e;if(""!==e&&"-"!==e&&"."!==e){if(isNaN(e)&&(e=e.replace(/,/ig,""),isNaN(e)))try{e=
EWA_Utils.chineseToNumber(e)+"",a.value=e}catch(h){return e}g=this.getFormat(a);if("LeastMoney"==g||"Money"==g)g=e.split("."),a.value=1==g.length?(1*e).fm(0):(1*e).fm(g[1].length)+(0==g[1].length?".":"");return e}}}function EWA_FrameResourceDescription(){this.Memo=this.Info=this.Lang=null}
function EWA_FrameResoure(){this.Name=null;this.Descriptions={};this.GetDescription=function(){var a=this.Descriptions[EWA.LANG];if(null==a)for(var b in this.Description)return this.Description[b];return a};this.GetInfo=function(){var a=this.GetDescription();return null==a?null:a.Info};this.GetMemo=function(){var a=this.GetDescription();return null==a?null:a.Memo}}
function EWA_FrameResoures(){this.Init=function(a){var b=a.GetElements("root/PageInfo");if(null!=b){for(var d=0;d<b.length;d+=1){var e=new EWA_FrameResoure;e.Name=b[d].getAttribute("Name");for(var g=a.GetElements("Set",b[d]),h=0;h<g.length;h++){var k=new EWA_FrameResourceDescription;k.Info=g[h].getAttribute("Info");k.Memo=g[h].getAttribute("Memo");k.Lang=g[h].getAttribute("Lang");e.Descriptions[k.Lang]=k}this[e.Name]=e}this.ReplaceResById();this.ReplaceRes()}};this.ReplaceResById=function(){for(var a in this){var b=
this[a],d=$X(a);d&&("input"==d.tagName.toLowerCase()?d.value=b.GetInfo():d.innerHTML=b.GetInfo(),d.title=b.GetMemo())}};this.ReplaceRes=function(){var a=[];a.push(document.getElementsByTagName("div"));a.push(document.getElementsByTagName("span"));a.push(document.getElementsByTagName("input"));a.push(document.getElementsByTagName("button"));for(var b=0;b<a.length;b++)for(var d=a[b],e=0;e<d.length;e+=1){var g=d[e].getAttribute("res");if(null!=g&&(g=g.trim(),0==g.indexOf("EWA.F.FOS")&&(0<g.indexOf(".Resources.")||
0<g.indexOf(".Resources[")))){var h="";try{h=eval(g)}catch(k){h=k.message}"INPUT"==d[e].tagName?d[e].value=h:d[e].innerHTML=h}}a.length=0}}
function EWA_FrameClass(){this._Ajax=this.Xml=null;this.ItemList=new EWA_FrameCommonItems;this.Resources={};this.doPostAfter=this._Id=this._ValidExObj=this._ValidExFail=this._ValidExOk=this.Url=null;this.isShowPostWaitting=!0;this.textareaAutoSize=function(){window.autosize?autosize(this.getObj("textarea").addClass("ewa-textarea-auto-size")):console.warn("autosize.js \u6ca1\u6709\u5f15\u5165\uff0c/third-party/autosize-master/dist/autosize.min.js")};this.getObj=function(a){var b=$("#EWA_FRAME_"+this._Id);
return a?b.find(a):b};this.switchButtonAction=function(a,b){if(b){var d=this.getUrlClass(),e={};e.ewa_switch_name=a.name;e.ewa_action=b;e.ewa_ajax="json";e.ewa_switch=a.checked?"on":"off";b=a.parentNode;var g=b.getAttributeNames(),h;for(h in g){var k=g[h],l=b.getAttribute(k);0!=k.indexOf("on")&&"name"!=k&&"id"!=k&&"class"!=k&&(e[k]=l)}var m=this;d=d.GetUrl();$JP(d,e,function(n){m.extSwitchCallBack&&m.extSwitchCallBack(a,n)})}};this.setDisable=function(){var a=this.getObj();a.find("input,textarea,select,label").each(function(){this.disabled||
"hidden"==this.type||(this.disabled=!0,this.setAttribute("ewadisabled",1))});a.find(".EWA_DHTML").each(function(){if("DIV"==this.tagName)var b=$(this).find("iframe")[0].contentWindow,d=setInterval(function(){if("complete"==b.document.readyState){window.clearInterval(d);b.frames[0].document.body.contentEditable=!1;b.frames[0].document.body.style.backgroundColor="#eee";var g=b.document.getElementsByClassName("but")[0];g.style.pointerEvents="none";g.style.filter="grayscale(1) opacity(0.8)"}},300);else if("TEXTAREA"==
this.tagName){var e=$(this).parent();d=setInterval(function(){var g=e.find("iframe");0<g.length&&(g=g[0].contentWindow)&&"complete"==g.document.readyState&&(window.clearInterval(d),g.document.body.contentEditable=!1,g.document.body.style.backgroundColor="#eee",e.find(".ewa-editor").attr("ewadisabled",1))},300)}})};this.setEnable=function(){var a=this.getObj();a.find("input,textarea,select,label").each(function(){this.disabled&&this.getAttribute("ewadisabled")&&(this.disabled=!1,this.removeAttribute("ewadisabled"))});
a.find(".EWA_DHTML").each(function(){if("DIV"==this.tagName){var b=$(this).find("iframe")[0].contentWindow;b.frames[0].document.body.contentEditable=!0;b.frames[0].document.body.style.backgroundColor="";b=b.document.getElementsByClassName("but")[0];b.style.pointerEvents="";b.style.filter=""}else if("TEXTAREA"==this.tagName){var d=$(this).parent();b=d.find("iframe")[0].contentWindow;b.document.body.contentEditable=!0;b.document.body.style.backgroundColor="";d.find(".ewa-editor").removeAttr("ewadisabled")}})};
this.convertFilterCheckbox=function(a,b,d,e,g,h){function k(v){var y=$("<nobr></nobr>");q.append(y);q.append(" ");var x=$(v).parent();v=$(v).attr("id")+"_"+t;x.attr("id",v);y.append(x.children());y.attr("ref_id",v)}function l(v){v=$(v).parent();var y=v.attr("ref_id");y&&($("#"+y).append(v.children()),v.remove())}var m={},n=this.getObj(".ewa-row-"+a),p=this.getObj(".ewa-row-"+b),q=$("<div class='ewa-filter-checked'></div>");n.find("#"+a).prepend(q).addClass("ewa-filter-chks");var t=this._Id;d||(d=
"PY");n.find("input[type=checkbox]").each(function(){var v=JSON.parse($(this).attr("json"))[d];v&&(v=v.toUpperCase().trim().substring(0,1),m[v]||(m[v]=[]),m[v].push(this.id),this.checked&&k(this),$(this).on("change",function(){this.checked?k(this):l(this)}))});a="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");b=["<a class='ewa-filter-char ewa-filter-char-all' code=''>ALL</a>"];for(var u in a){var r=a[u],w=m[r];w&&b.push("<a class='ewa-filter-char' code='"+r+"'>"+r+"<span class='ewa-filter-char-num'>("+w.length+
")</span></a>")}p.find(".EWA_TD_M").html(b.join(" "));e&&(n.find(".EWA_TD_L").hide(),n.find(".EWA_TD_M").attr("colspan",2));p.find("a.ewa-filter-char").on("click",function(){var v=$(this).attr("code");n.find("input[type=checkbox]").each(function(){v?this.checked?q.append($(this).parent()):($(this).parent().attr("ref_id")&&l(this),$(this).parent().hide()):$(this).parent().show()});if(v){for(var y=m[v],x=0;x<y.length;x++)n.find("#"+y[x]).parent().show();h&&h(this,n,p)}});g&&g(n,p)};this.createFilterCheckbox=
function(a,b,d,e,g,h,k){var l=this;$J(e,function(m){l.createFilterCheckboxByData(a,b,d,m,g,h,k)})};this.createFilterCheckboxByData=function(a,b,d,e,g,h,k){var l={},m=m?"[]":d.split(",");d={};for(var n in m)d[m[n]]=1;m=[];var p=[],q=a.id;for(n in e){var t=e[n],u=t[g];u&&(u=u.replace(/</ig,"&lt;"));var r=t[h];r&&(r=r.replace(/</ig,"&lt;"));var w=t[k],v=d[u],y=[];y.push("<nobr class='ewa-filter-chk' style='float:left;margin-right:4px'>");y.push('<input class="ewa-filter-chkbox" type="checkbox" ');v&&
y.push(" checked ");t=q+"_"+n;y.push(' value="'+u+'" id="'+t+'" name="'+q+'"><label ');y.push(' for="'+t+'">'+r+"</label></nobr>");v?p.push(y.join("")):m.push(y.join(""));b&&(u=w?w.substring(0,1).toUpperCase():"",l[u]||(l[u]=[]),l[u].push(t))}a.innerHTML=p.join(" ")+" "+m.join(" ");if(b){e=['<a href="javascript:void(0)">ALL</a>'];for(n="A".charCodeAt();n<="Z".charCodeAt();n++)g=String.fromCharCode(n),l[g]&&e.push('<a href="javascript:void(0)">'+g+"</a>");b.innerHTML=e.join(" ");$(b).find("a").each(function(){var x=
$(this).text();"ALL"!=x&&$(this).attr("ids",l[x].join(","));$(this).on("click",function(){if("ALL"==$(this).text())$(a).find("nobr.ewa-filter-chk").show();else{var z=$(this).attr("ids").split(","),A={},B;for(B in z)A[z[B]]=1;$(a).find("input.ewa-filter-chkbox").each(function(){this.checked||A[this.id]?$(this).parent().show():$(this).parent().hide()})}})})}};this.hiddenNoContentRow=function(){var a=$("#EWA_FRAME_"+this._Id);a.find(".EWA_TD_M").each(function(){if(""==$(this).text()&&0==$(this).find("img,a,input[type=text],input[type=button],textarea").length){$(this).parent().hide();
var b=$(this).find("*:eq(0)").attr("id");b&&a.find(".ewa-row-"+b).hide().attr("hiddennocontentrow",1)}})};this.itemReload=function(a,b,d){if(a){var e=new EWA_UrlClass(this.Url);e.AddParameter("EWA_AJAX","SELECT_RELOAD");e.AddParameter("EWA_RELOAD_ID",a);this.getObj("input,select").each(function(){this.name!=a&&100>this.value.length&&e.AddParameter(this.name,this.value)});for(var g=e.GetUrl(),h=this.getObj("#"+a)[0],k={},l=0;l<h.options.length;l++)k[h.options[l].value]=1;$J(g,function(m){if(m.RST){var n=
m.ITEM.LST;h.options.length=0;var p=[],q;for(q in n){var t=n[q];if(!t.V||!k[t.V]){var u=new Option(t.T,t.V);t.json&&$(u).attr("json",t.json);h.options[h.options.length]=u;p.push(u);t._used=!0}}for(q in n)t=n[q],t._used||(u=new Option(t.T,t.V),t.json&&$(u).attr("json",t.json),h.options[h.options.length]=u);if(b)h.value=b;else for(var r in p)if(p[r].value){h.value=p[r].value;break}if(d)try{d(m,h)}catch(w){console.log(w)}}else $Tip(m.ERR)})}};this._checkSelectOptionsChange=function(){if(this._SelectFilters){var a=
this;this.isSelectFilter&&setTimeout(function(){a._checkSelectOptionsChange()},311);for(var b in this._SelectFilters){var d=this._SelectFilters[b];this.getObj("#"+d.id).html()!=d.html&&a._selectOptionsChangeed(d)}setTimeout(function(){a._checkSelectOptionsChange()},311)}};this._selectOptionsChangeed=function(a){console.log("changed");var b=this.getObj("select#"+a.id),d="initSelectFilter"+this._Id+"-"+a.id+"-filter",e="initSelectFilter"+this._Id+"-"+a.id+"-filter2",g=this._initSelectFilterCreateCode(a.codeJsonFrom||
a.filterFrom,b);this.getObj("#"+d).html(g);this.getObj("#"+e).html("");a.html=b.html()};this._initSelectFilterCreateCode=function(a,b){var d=["<option value=''>-ALL-</option>"];if(a){var e={},g=[];b.find("option").each(function(){if(""!=this.value){var l;this.hasAttribute("para_"+a)?l=this.getAttribute("para_"+a):this.getAttribute("json")&&(l=JSON.parse(this.getAttribute("json"))[a]);l&&(e[l]?e[l]+=1:(e[l]=1,g.push(l)))}});var h=g.sort(),k;for(k in h)b=h[k],b=b.replace(/>/ig,"&lt;").replace(/"/,"&quot;"),
d.push('<option value="'+b+'">'+b+" ["+e[b]+"]</option>")}else for(k="A".charCodeAt();k<="Z".charCodeAt();k++)b=String.fromCharCode(k),d.push('<option value="'+b+'">'+b+"</option>");return d.join("")};this.initSelectFilter=function(a,b,d,e){if(!this["INIT_SELECT_FILTER"+a]){this["INIT_SELECT_FILTER"+a]=!0;var g=$("#EWA_FRAME_"+this._Id+" select#"+a),h=g.parent(),k="initSelectFilter"+this._Id+"-"+a+"-filter",l="initSelectFilter"+this._Id+"-"+a+"-filter2",m="initSelectFilter"+this._Id+"-"+a+"-filter-table";
$X(m)&&(h.append(g),$($X(m)).remove());h.addClass("ewa-select-filter");k=["<table id='"+m+"' cellpadding=0 cellspacing=0 width=100%><tr><td class='ewa-select-filter-char'><select class='EWA_SELECT' style='margin-right:4px' id='"+k+"' onchange='EWA.F.FOS[\""+this._Id+'"]._chCode(this,"'+b+'","'+d+"\")'>"];m=this._initSelectFilterCreateCode(e||d,g);k.push(m);k.push("</select><select id='"+l+"' style='display:none'></select></td><td class='ewa-select-filter-target'></td></tr></table>");h.prepend(k.join(""));
h.find(".ewa-select-filter-target").append(g);this._SelectFilters||(this._SelectFilters={});h={};h.html=g.html();h.id=a;h.filterType=b;h.filterFrom=d;h.codeJsonFrom=e;this._SelectFilters[h.id]=h}};this._chCode=function(a,b,d){this.isSelectFilter=!0;var e=$(a).next(),g=$(a).parent().parent().find(".ewa-select-filter-target select");0==e[0].options.length&&e.html(g.html());if(""==a.value)g.html(e.html());else{for(var h=["<option></option>"],k=1;k<e[0].options.length;k++){var l=e[0].options[k];this._chCodeFilter(l,
b,d,a.value)&&h.push(GetOuterHTML(l))}g.html(h.join(""));this._SelectFilters[g[0].id].html=g.html();this.isSelectFilter=!1}};this._chCodeFilter=function(a,b,d,e){"json"==b?(a=JSON.parse(a.getAttribute("json"))[d],"ADM_LID"==d&&(d=a.split("."),a=d[d.length-1])):a="text"==b?a.text:a.value;return a?a.substring(0,e.length).toUpperCase()==e.toUpperCase()?!0:!1:!1};this.setUnMust=function(a){(a=this.ItemList.Items[a.toUpperCase()])&&a.getElementsByTagName("IsMustInput")[0].getElementsByTagName("Set")[0].setAttribute("IsMustInput",
0)};this.setMust=function(a){(a=this.ItemList.Items[a.toUpperCase()])&&a.getElementsByTagName("IsMustInput")[0].getElementsByTagName("Set")[0].setAttribute("IsMustInput",1)};this.RedrawCreateSpans=function(){for(var a=$("#EWA_FRAME_"+this._Id+" tr"),b=0;b<a.length;b++){var d=a[b];if("none"!=d.style.display)for(var e=0,g=!1,h=d.cells.length-1;0<=h;h--){var k=d.cells[h];"none"==k.style.display?g?e++:(e=1,g=!0):g&&(k.colSpan=e+1,g=!1)}}EWA_FrameShowAlert=EWA_FrameShowAlert1;EWA_FrameRemoveAlert=EWA_FrameRemoveAlert1;
$("#EWA_FRAME_"+this._Id+" .ewa_d1").each(function(){this.title=this.innerHTML});for(var l in this.ItemList.Items)a=this.GetItemDescription(l).Memo,null!=a&&0<a.trim().length&&($("#"+l).attr("placeHolder",a),$("#"+l).attr("title",a));this.RedrawChangWidth()};this.GetItemDescription=function(a){return this.ItemList.GetDescription(a)};this.ShowPlaceHolder=function(a){$("#EWA_FRAME_"+this._Id).addClass("ewa-frame-cols-"+a);for(var b in this.ItemList.Items){var d=this.ItemList.GetValue(b,"Name","Name");
if(d=this.GetObject(d)){d=$(d);var e=this.GetItemDescription(b),g=e.Memo,h=e.Info;e=null;1==a?(e=h,null!=g&&0<g.trim().length&&g!=e&&("smsValid"==d.attr("ewa_tag")?e=g:(g="<div class='ewa-item-memo'>"+g+"</div>",d.parentsUntil("tr").last().append(g))),d.hasClass("ewa-switch")&&d.prepend("<div class='ewa-switch-info'>"+e+"</div>")):2==a&&null!=g&&0<g.trim().length&&(e=g);e&&("hidden"==d[0].type?d.prev().attr("placeholder",e):"SELECT"==d[0].tagName?0<d[0].options.length&&""==d[0].options[0].value&&
(d[0].options[0].text="-- "+e+" --",d[0].options[0].value=""):(d.attr("placeHolder",e),d.attr("title",e)))}}};this.RedrawChangWidth=function(){var a=$("#EWA_FRAME_"+this._Id),b=a.width(),d=a.find(".ewa_msg_box")[0].colSpan/2;$("#EWA_FRAME_"+this._Id+">tbody>tr[class*='ewa-row-']:not('.ewa-row-msg-box')").each(function(){var g=$(this).find("td.ewa_redraw_info:visible").length,h=(b-90*g)/d;$(this).find("td.ewa_redraw_ctl:visible").each(function(){var k=this.colSpan||1;$(this).css("width",h*k)})});var e=
this;addEvent(window,"size",function(){e.RedrawChangWidth()})};this.Mearge=function(a,b,d){console.log("\u62fc\u5199\u9519\u8bef\uff1a\u8bf7\u7528 Merge");this.Merge(a,b,d)};this.Merge=function(a,b,d){if(a||b){var e=$("#EWA_FRAME_"+this._Id),g=e.find("#"+a),h=e.find("#"+b);if(0==g.length)console.log("Mearge:"+a+"\u4e0d\u5b58\u5728");else if(0==h.length)console.log("Mearge:"+b+"\u4e0d\u5b58\u5728");else{var k=!1,l=e.find(".ewa-row-"+b+" .EWA_TD_M"),m=null;0==l.length&&(k=!0,l=e.find(".ewa-row-"+b+
" .EWA_TD_1"),m=e.find(".ewa-row-"+b+" .EWA_TD"),1==m.length&&(k=!0),b=m.html(),m.html("<table cellpadding=0 cellspacing=0 width=100%><tr><td style='width:50%'></td><td style='display:none'></td><td style='width:50%'></td></tr></table>"),m.find("td:eq(0)").html(b));if(0==l.length)alert("target parent not exists");else{var n="border-box"==g.css("box-sizing")?0:1*g.css("padding-left").replace("px","")+1*g.css("padding-right").replace("px",""),p="border-box"==g.css("box-sizing")?0:1*h.css("padding-left").replace("px",
"")+1*h.css("padding-right").replace("px","");e.find(".ewa-row-"+a).hide();null==d&&(d=" - ");var q=l.width(),t=g[0].tagName,u=h[0].tagName;g.parent().hasClass("ewa-select-filter-target")&&(g=e.find(".ewa-row-"+a+" .EWA_TD_M table:eq(0)"),t="SELECT_WITH_FILTER");var r=0;b=null;d&&(l.append('<span class="mearge-span">'+d+"</span>"),k&&m.find("table:eq(0) td:eq(1)").html('<span class="mearge-span">'+d+"</span>").show(),b=l.find(".mearge-span"),r=b.width()+1+1*b.css("padding-left").replace("px","")+
1*b.css("padding-right").replace("px","")+1*b.css("margin-left").replace("px","")+1*b.css("margin-right").replace("px",""));t==u?(d=(q-r)/2-n-2,g.css("width",d),h.css("width",d),k&&m.find("table:eq(0) td:eq(2), table:eq(0) td:eq(0)").css("width",d)):"SELECT"==t?(g.css("width",100),h.css("width",q-r-n-p-2-2-g.width())):"SELECT_WITH_FILTER"==t?(g.css("width",200),h.css("width",q-r-n-p-2-2-g.width())):"SELECT"==u&&(h.css("width",100),g.css("width",q-r-n-p-2-2-g.width()));h.css("float","left");b&&b.css("float",
"left");g.css("float","right");l.append(g);l.addClass("ewa-frame-merge");k&&(a=e.find(".ewa-row-"+a+" .EWA_TD").html(),m.find("table:eq(0) td:eq(2)").html(a))}}}};this.MergeExp=function(a,b,d,e){if(b){var g=b.match(/@@[a-zA-Z0-9\-\._:]*\b/ig),h=[],k=b;b={};for(var l=$("#EWA_FRAME_"+this._Id),m=0;m<g.length;m++){var n=g[m];h.push(n);var p=n.replace("@@","");k=k.replace(n,"<span class='ewa-row-merge ewa-row-merge-"+p+"' mid=\""+n+'"></span>');p!=a&&l.find(".ewa-row-"+p).hide();b[p]=this.GetItemDescription(p).Info}g=
document.createElement("div");g.style.display="none";g.innerHTML=k;document.body.appendChild(g);n=l.find('[id="'+a+'"]');if(0==n.length)console.log("not find "+a);else{a=n.parent();for(var q in h)m=h[q],n=m.replace("@@",""),k=l.find('[id="'+n+'"]'),0==k.length?console.log("not found [id="+n+"]"):(m=$(g).find('span[mid="'+m+'"]'),"placeholder"==d?k.attr("placeholder",b[n]):d&&(m.append("<span class='ewa-row-merge-memo'></span>"),m.find(".ewa-row-merge-memo").text(b[n])),m.append(k));for(;0<g.childNodes.length;)a.append(g.childNodes[0]);
$(g).remove();e&&e(a)}}else console.log("mergeExp \u6ca1\u6709\u8bbe\u7f6e")};this.MergeItems=function(){for(var a in this.MeargeMap){var b=this.MeargeMap[a],d=$X("_ewa_tr$"+a);if(d){for(var e=d.cells.length,g=$(d.cells[0]);1<d.cells.length;)g.append(d.cells[1].innerHTML),d.removeChild(d.cells[1]);d.cells[0].colSpan=e;d=[];for(e=0;e<b.length;e++){for(var h=$X("_ewa_tr$"+b[e]),k=["<nobr>"],l=0;l<h.cells.length;l++)k.push(h.cells[l].innerHTML);k.push("</nobr>");d.push(k.join(" "));h.parentNode.removeChild(h)}g.append(d.join(" "))}}};
this.LoadJson=function(a,b){null!=a&&$J(this.Url+"&EWA_ACTION="+a+"&EWA_AJAX=JSON",b)};this.DoAction=function(a,b,d,e,g,h){EWA.F.CID=this._Id;if(null!=b&&""!=b.trim()){if(null!=d&&0<d.trim().length)if(a=_EWA_INFO_MSG[d],null!=a&&""!=a){if(!window.confirm(a))return}else if(!window.confirm(d))return;this.DoPostBefore();this._Ajax=this.CreateAjax(null,!0);this._Ajax.LoadingType="image";this._Ajax.AddParameter("EWA_AJAX","1");this._Ajax.AddParameter("EWA_ACTION",b);this._Ajax.AddParameter("EWA_ID",this._Id);
this._Ajax.AddParameter("EWA_NO_CONTENT","1");this._Ajax.AddParameter("EWA_ACTION_TIP",e);null!=h&&0<h.trim().length?(this._Ajax.AddParameter("EWA_AFTER_EVENT",h),this.StopAjaxAfterReload=!0,this._Ajax.AddParameter("EWA_ACTION_RELOAD","0")):this.StopAjaxAfterReload=!1;if(null!=g&&0<g.length)for(b=0;b<g.length;b+=1)this._Ajax.AddParameter(g[b].Name,g[b].Value);g=new EWA.C.Url;g.SetUrl(this.Url);g=g.RemoveParameter("EWA_ACTION");this._Ajax.PostNew(g,EWA.F.FOS[EWA.F.CID]._CallBackJs)}};this.GuideShowCreate=
function(a){this._GroupInfos=a;var b=$X("EWA_FRAME_"+this._Id);a=a.length-1;b.setAttribute("EWA_GUIDE_IDX","0");b.setAttribute("EWA_GUIDE_IDX_MAX",a);b.rows[b.rows.length-1].style.display="none";100<b.clientHeight&&(b.parentNode.style.height=b.clientHeight+"px");a=document.createElement("input");a.id="ewa_but_"+Math.random();a.type="button";a.value="enus"==EWA.LANG?"Back":"\u4e0a\u4e00\u6b65";a.style.display="none";a.onclick=function(){var k=b.getAttribute("EWA_GUIDE_IDX");if(0==1*k)$Tip("\u5230\u5934\u4e86");
else{var l=b.id.replace("EWA_FRAME_","");EWA.F.FOS[l].GuidePrevBefore&&EWA.F.FOS[l].GuidePrevBefore(k,this,b);EWA.F.FOS[l].GuideShow(1*k-1);EWA.F.FOS[l].GuidePrevAfter&&EWA.F.FOS[l].GuidePrevAfter(k,this,b)}};var d=document.createElement("input");d.id="ewa_but_"+Math.random();d.type="submit";d.value="enus"==EWA.LANG?"Next":"\u4e0b\u4e00\u6b65";d.onclick=function(){var k=b.getAttribute("EWA_GUIDE_IDX"),l=b.id.replace("EWA_FRAME_","");EWA.F.FOS[l].GuideShowCheck(k)&&(EWA.F.FOS[l].GuideNextBefore&&EWA.F.FOS[l].GuideNextBefore(k,
this,b),"ok"==this.getAttribute("ewa_guide_method")?$F(b,"input","type","submit")[0].click():EWA.F.FOS[l].GuideShow(1*k+1),EWA.F.FOS[l].GuideNextAfter&&EWA.F.FOS[l].GuideNextAfter(k,this,b))};var e=b.parentNode.parentNode.parentNode.parentNode.insertRow(-1).insertCell(-1);e.appendChild(a);e.appendChild(d);e.className="EWA_FRAME_GROUP_BUTTONS";tdTitle=b.parentNode.parentNode.parentNode.parentNode.insertRow(0).insertCell(-1);e="ewa_title_"+Math.random();for(var g=[],h=0;h<this._GroupInfos.length;h++)g.push('<div style="float:left" id="ewa_'+
this._Id+"_"+h+'">'+(h+1)+". "+this._GroupInfos[h].DES+"</div>");tdTitle.innerHTML="<div style='text-align:left'>"+g.join(" <div style='float:left;color:#aaa'>&nbsp;&gt;&nbsp;</div> ")+"</div><div id='"+e+"'></div>";tdTitle.className="EWA_FRAME_GROUP_TITLE";b.setAttribute("EWA_GUIDE_ID_PREV",a.id);b.setAttribute("EWA_GUIDE_ID_NEXT",d.id);b.setAttribute("EWA_GUIDE_ID_TITLE",e);this.GuideShowTitle(0);a=document.createElement("div");100<b.clientHeight&&(a.style.width=b.clientWidth+"px",a.style.height=
b.clientHeight+20+"px",a.style.overflow="auto");b.parentNode.appendChild(a);a.appendChild(b);b.parentNode.className="EWA_GROUP_GUIDE"};this.GuideShowTitle=function(a){for(var b=$X("EWA_FRAME_"+this._Id).getAttribute("EWA_GUIDE_IDX_MAX"),d=0;d<=b;d++){var e="ewa_"+this._Id+"_"+d;d==a?($X(e).style.color="blue",$X(e).style.borderBottom="2px solid green"):($X(e).style.color="green",$X(e).style.borderBottom="2px")}};this.GuideShowCheck=function(a){var b=!0,d=null,e;for(e in this.ItemList.Items){var g=
this.ItemList.GetItemValue(this.ItemList.Items[e],"Name","Name"),h=$X(g);null==h?alert(g+" not exists"):(g=this._GetTr(h),null!=g&&g.getAttribute("groupindex")==a&&((b&=this.CheckValid(h))||null!=d||(d=h)))}null!=d&&d.focus();return b};this._GetTr=function(a){for(var b=0;100>b;){b++;a=a.parentNode;try{if("TR"==a.tagName.toUpperCase()&&null!=a.getAttribute("id")&&0==a.getAttribute("id").indexOf("_ewa_tr$"))return a}catch(d){break}}return null};this.GuideShow=function(a){this.GuideShowTitle(a);var b=
$X("EWA_FRAME_"+this._Id);if(b.getAttribute("EWA_GUIDE_IDX")!=a){var d=b.getAttribute("EWA_GUIDE_IDX_MAX"),e=b.getAttribute("EWA_GUIDE_ID_PREV"),g=b.getAttribute("EWA_GUIDE_ID_NEXT");a==d?($X(g).value="enus"==EWA.LANG?"Confirm":"\u786e\u5b9a",$X(g).setAttribute("ewa_guide_method","ok")):($X(g).value="enus"==EWA.LANG?"Next":"\u4e0b\u4e00\u6b65",$X(g).setAttribute("ewa_guide_method",""));0==a?$X(e).style.display="none":$X(e).style.display="";b.setAttribute("EWA_GUIDE_IDX",a);this._ShowHidenGroup(b,
a)}};this._ShowHidenGroup=function(a,b){for(var d=0;d<a.rows.length-1;d++){var e=a.rows[d];if(null!=e.getAttribute("groupIndex")&&""!=e.getAttribute("groupIndex")){var g=1*e.getAttribute("groupIndex");e.style.display=b==g?"":"none"}}};this.GroupShow=function(a,b){if(!(0<a.className.indexOf("1"))){this.GroupShowBefore&&this.GroupShowBefore(a,b);for(var d=$X("EWA_FRAME_"+this._Id),e=a.parentNode.parentNode,g=0;g<d.rows.length;g++){var h=d.rows[g];if(h!=e&&!(1==h.cells.length&&h.cells[0].className&&
0<=h.cells[0].className.indexOf("EWA_TD_B"))&&"1"!=h.getAttribute("hiddennocontentrow")){var k=0;null!=h.getAttribute("groupIndex")&&""!=h.getAttribute("groupIndex")&&(k=1*h.getAttribute("groupIndex"));h.style.display=b==k?"":"none"}}d=e.getElementsByTagName("div");for(g=0;g<d.length;g++)e=d[g],e.className=e==a?e.className+"1":e.className.replace("1","");this.GroupShowAfter&&this.GroupShowAfter(a,b)}};this.DoActionJSON=function(a,b,d,e){EWA.F.CID=this._Id;this._Ajax=new EWA.C.Ajax;this._Ajax.LoadingType=
"image";this._Ajax.AddParameter("EWA_AJAX","JSON");this._Ajax.AddParameter("EWA_ACTION",a);this._Ajax.AddParameter("EWA_ID",this._Id);this._Ajax.AddParameter("EWA_JSON_NAME",b);this._AjaxJsonAfter=null!=e?e:null;if(null!=d&&0<d.length)for(a=0;a<d.length;a+=1)this._Ajax.AddParameter(d[a].Name,d[a].Value);d=new EWA.C.Url;d.SetUrl(this.Url);d=d.RemoveParameter("EWA_ACTION");this._Ajax.PostNew(d,EWA.F.FOS[EWA.F.CID]._CallBackJs)};this._CallBackJs=function(){var a=EWA.F.FOS[EWA.F.CID],b=a._Ajax;if(4==
b._Http.readyState)if(b.HiddenWaitting(),200==b._Http.status){if(b=b._Http.responseText,EWA.F.CheckCallBack(b)){eval(b);a._AjaxJsonAfter&&(a._AjaxJsonAfter(),a._AjaxJsonAfter=null);try{a.ReloadAfter&&a.ReloadAfter(b)}catch(d){alert(b)}}}else alert("ERROR:\r\n"+b._Http.statusText)};this.RewriteInfo=function(a,b,d,e,g){var h=$("#EWA_FRAME_"+this._Id),k=[];b=b||"id";d=d||"info";e=e||"memo";for(var l=0;l<a.length;l++){var m=a[l],n=h.find("#"+m[b]);0!=n.length&&(n=n.parentsUntil("tr[show_msg]").last().parent(),
null==m[d]||""==m[d].trim()?(n.hide(),g&&g(n[0],m,l)):3==n[0].cells.length?(k.push(n[0]),n[0].cells[2].innerHTML=m[e],n[0].cells[0].innerHTML=m[d],g&&g(n[0],m,l)):2==n[0].cells.length?(k.push(n[0]),n[0].cells[0].innerHTML=m[d],g&&g(n[0],m,l)):1==n[0].cells.length&&(n=n.prev(),1<n[0].cells.length&&(n[0].cells[1].innerHTML=m[e]),k.push(n[0]),n[0].cells[0].innerHTML=m[d],g&&g(n[0],m,l)))}return k};this._HiddenMemo=function(a,b){var d=a.parentNode.parentNode;b=!1;"none"==d.style.display&&(b=!0);d.style.display=
"none";d.id="tr_"+a.id;d=d.previousSibling;3==d.nodeType&&(d=d.previousSibling);d.style.display="none";a="<span id=tab_"+a.id+' class="ewa_merge_tab" onclick="EWA.F.FOS[\''+this._Id+"'].ShowMemo(this.id);\">"+d.cells[0].innerHTML+"</span>";return b?"":a};this.ShowMemo=function(a){for(var b=$X(this._Id+"__ewa_meger").getElementsByTagName("SPAN"),d=0;d<b.length;d++){var e=b[d].id.replace("tab_","tr_");"ewa_merge_tab1"==b[d].className&&(b[d].className="ewa_merge_tab",$X(e).style.display="none");b[d].id==
a&&(b[d].className="ewa_merge_tab1",$X(e).style.display="")}};this.MergeMemo=function(){var a=$X("EWA_FRAME_"+this._Id).getElementsByTagName("textarea");if(0!=a.length&&"1"!=a[0].getAttribute("ewa_merge")){for(var b=[],d=0;d<a.length;d++){var e=this._HiddenMemo(a[d]);e="<nobr>"+e.replace("\u2022 ","").trim()+"</nobr>";b.push(e)}a=a[0];d=a.parentNode.parentNode;e=d.previousSibling;3==e.nodeType&&(e=e.previousSibling);e.id=this._Id+"__ewa_meger";e.cells[0].colSpan=3;e.cells[0].innerHTML=b.join("");
e.cells[0].style.width="100%";e.cells[0].style.height="25px";e.style.display="";d.style.display="";$X("tab_"+a.id).className="ewa_merge_tab1";null!=window._EWA_DialogWnd&&EWA.UI.Dialog._SetTitle(window._EWA_DialogWnd)}};this.DoValidEx=function(a,b,d,e,g,h){""!=a.value&&(this._ValidExOk=this.Resources[g],this._ValidExFail=this.Resources[h],this._ValidExObj=a,"action"==b.toLowerCase().trim()?this._DoValidExAction(a,e,this.Resources[g].GetInfo(),this.Resources[h].GetInfo()):eval(d)?(EWA_FrameShowAlert(a,
this._ValidExOk.GetInfo()),a.setAttribute("EWA_VALID_EX","")):(EWA_FrameShowAlert(a,this._ValidExFail.GetInfo()),a.setAttribute("EWA_VALID_EX",this._ValidExFail.GetInfo())))};this._DoValidExAction=function(a,b,d,e){if(null!=a&&!$(a).is(":hidden"))if(null==b||""==b.trim())alert("action not value");else{var g=a.id+","+a.value;if(this.DoValidExAction_RETS&&null!=this.DoValidExAction_RETS[g])0==this.DoValidExAction_RETS[g]?(EWA_FrameRemoveAlert(a,d),a.setAttribute("EWA_VALID_EX","")):(EWA_FrameShowAlert(a,
e),a.setAttribute("EWA_VALID_EX",e));else{var h=new EWA.C.Ajax;h.LoadingType="image";h.AddParameter("EWA_AJAX","HAVE_DATA");h.AddParameter("EWA_ACTION",b);h.AddParameter("EWA_ID",this._Id);h.AddParameter("EWA_NO_CONTENT","1");h.AddParameter(a.id,a.value);this.DoValidExAction_RETS||(this.DoValidExAction_RETS={});var k=this;h.PostNew(this.Url,function(){if(4==h._Http.readyState){h.HiddenWaitting();if(200==h._Http.status){var l=h._Http.responseText;if(EWA.F.CheckCallBack(l))try{var m=parseInt(l.trim());
k.DoValidExAction_RETS[g]=m;0==m?(EWA_FrameRemoveAlert(a,d),a.setAttribute("EWA_VALID_EX","")):(EWA_FrameShowAlert(a,e),a.setAttribute("EWA_VALID_EX",e))}catch(n){alert(n+","+l)}}else alert("ERROR:\r\n"+h._Http.statusText);h=null}})}}};this.ValidCodeError=function(a){var b=this._t_ValidCodeError||0,d=(new Date).getTime();1E3>d-b?a||(a=_EWA_EVENT_MSG.ValidCodeError,$Tip(a),$(".ewa-valid-code-img").parent().parent().find("input").focus().select()):(this._t_ValidCodeError=d,$(".ewa-valid-code-img").each(function(){this.click()}),
a||(a=_EWA_EVENT_MSG.ValidCodeError,$Tip(a),$(".ewa-valid-code-img").parent().parent().find("input").focus().select()))};this.Init=function(a){this.Xml=new EWA.C.Xml;this.Xml.LoadXml(a);this.ItemList.F=this;this.ItemList.Init(this.Xml);this.Resources=new EWA_FrameResoures;this.Resources.Init(this.Xml);"enus"==EWA.LANG&&$(".ewa-ipt-droplist").attr("placeholder","Input character selection");this._InitTranslations();this._GetDropListValue();this._InitMustInputs();this._InitEncyptions()};this._InitMustInputs=
function(){var a=$("#EWA_FRAME_"+this._Id),b;for(b in this.ItemList.Items){var d=this.ItemList.Items[b],e=this.ItemList.GetItemValue(d,"Name","Name");0<$(d).find('IsMustInput Set[IsMustInput="1"]').length&&(d="#"+e,a.find(".ewa-row-"+e).addClass("ewa-row-must"),e=a.find(d),e.addClass("ewa-row-item-must"),0<e.length&&e.attr("type")&&"hidden"==e.attr("type").toLowerCase()&&e.prev().addClass("ewa-row-item-must"))}};this._InitEncyptions=function(){var a=$("#EWA_FRAME_"+this._Id),b;for(b in this.ItemList.Items){var d=
this.ItemList.Items[b],e=this.ItemList.GetItemValue(d,"Name","Name");d=$(d).find("DispEnc Set");if(0!=d.length&&(e=a.find("#"+e),0!=e.length&&d.attr("EncType"))){if("INPUT"==e[0].tagName||"TEXTAREA"==e[0].tagName){if(!e.val())continue;e.prop("disabled",!0);e.attr("ewa_encyrption","yes")}var g=$("<div class='ewa-enc-cover' style='position:absolute;left:0;top:0;width:100%;height:100%;'><div></div></div>");e.parent().append(g);e.parent().css("position","relative");if(d=d.attr("EncShowUrl")){g.find("div").html("\u70b9\u51fb\u67e5\u770b").css({position:"absolute",
height:30,"line-height":"30px",top:"50%","margin-top":"-15px",right:10,"text-align":"right"});d=new EWA_UrlClass(d);g=new EWA_UrlClass(this.Url);for(var h in g._Paras)if(!d.GetParameter(h)){var k=g._Paras[h];null!=k&&(k=k.unURL());d.AddParameter(h,k)}d.AddParameter("EWA_ENCY_FROM_ID",e.attr("id"));d=d.GetUrl();e.parent().attr("enc_url",d).attr("fid",e.attr("id"));e.parent().on("click",function(){if(!$(this).attr("enc_ok")){var l=$(this).attr("t")||100,m=(new Date).getTime();if(!(400>m-l)){$(this).attr("t",
m);l=$(this).attr("enc_url");var n=$(this).find("#"+$(this).attr("fid"));$J(l,function(p){p.RST?(n.prop("disabled",!1),n.removeAttr("ewa_encyrption"),n.val(p.VALUE),$(n).parent().find(".ewa-enc-cover").remove(),$(n).parent().attr("enc_ok","1")):(p.ERR||p.MSG)&&$Tip(p.ERR||p.MSG)})}}})}}}};this._InitTranslations=function(){var a="EWA.F.FOS[&quot;"+this._Id+"&quot;]._Trans(this)",b;for(b in this.ItemList.Items){var d=this.ItemList.Items[b],e=this.ItemList.GetItemValue(d,"Name","Name"),g=$(d).find("DataItem Set[Translation]");
if(d=g.attr("Translation")){g=g.attr("TransTarget");var h="en2zh"==d?" \u82f1\u8bd1\u4e2d":" \u4e2d\u8bd1\u82f1";"enus"==EWA.LANG&&(h="en2zh"==d?" En-Zh":" Zh-En");d=$('<a class="ewa-but-trans" href="javascript:void(0)" onclick="'+a+'" _transf="'+e+'" _transp="'+d+'" _transt="'+g+'">'+h+"</a>");g=$("#EWA_FRAME_"+this._Id+" .ewa-row-"+e+" .EWA_TD_L");0==g.length&&(g=$("#EWA_FRAME_"+this._Id+" .ewa-row-"+e+" .EWA_TD"));0==g.length&&(g=$("#EWA_FRAME_"+this._Id+" #"+e).parent().prev().find(".ewa_d1"));
0==g.length&&(g=$("#EWA_FRAME_"+this._Id+" #"+e).parent(),g.css("position","relative"),d.addClass("ewa-but-trans-float"));g.append(d)}}};this._Trans=function(a){if(a){var b=$(a).attr("_transf"),d=$(a).attr("_transp");a=$(a).attr("_transt");b=$("#EWA_FRAME_"+this._Id+" #"+b);a=$("#EWA_FRAME_"+this._Id+" #"+a);if(0==b.length||0==a.length)console.log("trans ex:",b,a);else{var e=b[0].tagName.toLowerCase();if(b="input"==e||"textarea"==e||"hidden"==e?b.val():b.text()){var g=new EWA_TransClass;"en2zh"==
d?g.transToCn(b,a[0]):g.transToEn(b,a[0]);$Tip("enus"==EWA.LANG?"Translating...":"\u7ffb\u8bd1\u4e2d...",function(){return!g.IsRun})}}}};this._bindCompostion=function(a,b){if(!EWA.B.IE){var d=this;d._droplist_||(d._droplist_={});d._droplist_[b.id]={_is_composition:!1};$(a).on("compositionstart",function(){d._droplist_[b.id]._is_composition=!0}).on("compositionend",function(){d._droplist_[b.id]._is_composition=!1;EWA.F.I.DropList(this)}).removeAttr("oninput").removeAttr("onkeyup").on("input",function(){d._droplist_[b.id]._is_composition||
EWA.F.I.DropList(this)})}};this._GetDropListValue=function(){var a=this.getObj();if(0!=a.length){a=a[0];var b=a.getElementsByTagName("input");this._droplist_={};for(var d=0;d<b.length;d++){var e=b[d];if("droplist"==e.getAttribute("ewa_class")){var g=e.nextSibling;"INPUT"==g.tagName.toUpperCase()&&"HIDDEN"==g.type.toUpperCase()&&(this._GetDropListValue1(e,g),this._bindCompostion(e,g))}}a=a.getElementsByTagName("select");for(d=0;d<a.length;d++)if(e=a[d],b=e.getAttribute("_ListFilterType"))g=e.getAttribute("_ListFilterField"),
this.initSelectFilter(e.id,b,g);this._SelectFilters&&this._checkSelectOptionsChange()}};this._GetDropListValue1=function(a,b){if(""==b.value)b.setAttribute("setvalue",1);else{var d=b.getAttribute("DlsShow");if(null==d||""==d)b.setAttribute("canopen",0),a.value=b.value,b.setAttribute("canopen",1);else{var e=new EWA_AjaxClass,g=b.getAttribute("xmlName"),h=b.getAttribute("itemName"),k=b.getAttribute("paraName"),l=b.getAttribute("DlsAction");e=new EWA.C.Ajax;var m=b.value;var n=this.EWA_CGI?this.EWA_CGI:
window.EWA_CGI?window.EWA_CGI:EWA.CP+"/EWA_STYLE/cgi-bin/";var p=-1==n.indexOf("?")?"?":"&";n=(n+(p+"XMLNAME="+g+"&ITEMNAME="+h+"&EWA_AJAX=JSON")).replace("//","/");n=n.replace("//","/");n=n.replace("//","/");e.AddParameter(k,m);null!=l&&0<l.trim().length&&(e.AddParameter("EWA_ACTION",l),e.AddParameter(b.id,b.value));e.PostNew(n,function(){if(e.IsRunEnd()){var q=e.GetRst(),t="__json"+Math.random();try{eval('window["'+t+'"]='+q)}catch(v){b.setAttribute("canopen",0);a.value=v;b.setAttribute("canopen",
1);return}q=window[t];if(0!=q.length){t=q[0];var u=[];q={};for(var r in t)u.push(t[r]),q["@"+r.toUpperCase()]=t[r],t[r]&&b.setAttribute("para_"+r.toLowerCase(),t[r]);if(null==d||""==d)q=u.join("/");else{r=d.match(/@[a-zA-Z0-9\-\._:]*\b/ig);for(t=0;t<r.length;t++){u=r[t];var w=q[u.toUpperCase()];d=d.replace(u,w)}q=d}b.setAttribute("canopen",0);a.value=q;b.id=null==b.id||""==b.id?Math.random():b.id;"yes"==b.getAttribute("isdlseventload")&&(EWA.F.FOS[b.id]=new EWA_FrameItemClass,EWA.F.FOS[b.id].DropList(a),
EWA.F.FOS[b.id].CallAfterEvent());b.setAttribute("canopen",1);b.setAttribute("setvalue",1)}}})}}};this.DoPostEx=function(){EWA.F.F.CUR=this;if(this.CheckValidAll(document.forms[0])){this._Ajax=new EWA.C.Ajax;this._Ajax.LoadingType="image";this._Ajax.AddParameter("EWA_AJAX","1");this._Ajax.AddParameter("EWA_POST","1");this._Ajax.AddParameter("EWA_NO_CONTENT","1");for(var a=document.getElementsByTagName("input"),b=0;b<a.length;b+=1){var d=a[b],e=""==d.name?d.id:d.name;null!=e&&""!=e&&this._Ajax.AddParameter(e,
d.value)}a=document.getElementsByTagName("select");for(b=0;b<a.length;b+=1)d=a[b],e=""==d.name?d.id:d.name,null!=e&&""!=e&&this._Ajax.AddParameter(e,d.value);a=document.getElementsByTagName("textarea");for(b=0;b<a.length;b+=1)d=a[b],e=""==d.name?d.id:d.name,null!=e&&""!=e&&this._Ajax.AddParameter(e,d.value);this._Ajax.PostNew(this.Url,EWA.F.F.CUR._CallBack)}};this.CreateAjax=function(a,b){EWA.F.F.CUR=this;null==a&&(a=$("#f_"+this._Id)[0]);if(!b&&!this.CheckValidAll(a))return null;b=new EWA.C.Ajax;
for(var d in this.ItemList.Items){var e=this.ItemList.GetItemValue(this.ItemList.Items[d],"Name","Name"),g=this.GetObject(e,a);if(null!=g&&!$(g).attr("ewa_encyrption")){var h=g.getAttribute("ewa_tag");if("signature"==h){var k="N";var l=this.tablets[d];for(var m=0;m<l.lines.length;m++)if(l.lines[m]){k="Y";break}l="Y"==k?this._GetObjectValue(g):"";b.AddParameter(e+"_CHANGED",k)}else l=this._GetObjectValue(g);null!=l&&b.AddParameter(e,l);"DIV"==g.tagName.toUpperCase()&&"1"==g.getAttribute("EWA_DHTML")&&
(k=$X("UP_IMG_"+e).value,b.AddParameter(e+"_imgs_split",k));if("swffile"==h||"IMG_UPLOAD"==h)if(e=g.getAttribute("UP_PARAS"),null!=e&&0<e.length)for(e=e.split(","),h=0;h<e.length;h++){var n=e[h];b.AddParameter(n,g.getAttribute(n))}else b.AddParameter("UP_URL",g.value);else"markdown"==h&&(g=g.parentNode.getElementsByTagName("textarea"),1<g.length&&b.AddParameter(g[1].id,g[1].value))}}if(this.PostAddData)for(n in this.PostAddData)b.AddParameter(n,this.PostAddData[n]);return b};this.CreatePostData=function(){var a=
$("#f_"+this._Id)[0],b={},d;for(d in this.ItemList.Items){var e=this.ItemList.GetItemValue(this.ItemList.Items[d],"Name","Name"),g=this.GetObject(e,a);if(null!=g){var h=this._GetObjectValue(g);null!=h&&(b[e]=h);"DIV"==g.tagName.toUpperCase()&&"1"==g.getAttribute("EWA_DHTML")&&(h=$X("UP_IMG_"+e).value,b[e+"_imgs_split"]=h);e=g.getAttribute("ewa_tag");if("swffile"==e||"IMG_UPLOAD"==e)if(h=g.getAttribute("UP_PARAS"),null!=h&&0<h.length){h=h.split(",");for(var k=0;k<h.length;k++){var l=h[k];b[l]=g.getAttribute(l)}}else b.UP_URL=
g.value;"markdown"==e&&(g=g.parentNode.getElementsByTagName("textarea"),1<g.length&&(b[g[1].id]=g[1].value))}}return b};this.DoPostBefore=function(){return!0};this.isDoPostBeforeTimer=function(){return null!=this._checkStatusFristResult};this._uploadingFileCheck=function(a){a=window["h5u_"+this._Id+"$"+a.id];if(!a.haveFile())return!1;if("ok"==a.UPLOAD_STATUS)return a.removeWaitBox(),this.uploadProcess=!1;if("nofile"==a.UPLOAD_STATUS)return this.uploadProcess=!1,a.removeWaitBox(),!1;if("error"==a.UPLOAD_STATUS||
"abort"==a.UPLOAD_STATUS)return this._stopPost=!0,this._stopPostError="enus"==EWA.LANG?"Upload file error or aborted":"\u4e0a\u4f20\u6587\u4ef6\u9519\u8bef\u6216\u88ab\u4e2d\u6b62",console.log(this._stopPostError),!1;if("start"==a.UPLOAD_STATUS||"checking"==a.UPLOAD_STATUS)return!0;a.submitUploads();if("nofile"==a.UPLOAD_STATUS)return this.uploadProcess=!1,a.removeWaitBox(),!1;$X(a.WAIT_ID)||a.createWaitBox();return this.uploadProcess=!0};this.DoPost=function(a,b,d){if(this.posting)return!1;if(!d){d=
this.DoPostBefore();if(d instanceof Array){var e=this;this._checkStatusInc=0;this._checkStatusFristResult=d;this._checkStatusTimer=window.setInterval(function(){var n=0==e._checkStatusInc?e._checkStatusFristResult:e.DoPostBefore();e._checkStatusInc++;var p=n[0];if(null!==p&&void 0!==p){window.clearInterval(e._checkStatusTimer);e._checkStatusTimer=null;e._checkStatusInc=null;e._checkStatusFristResult=null;var q=n[1];n=n[2];p&&!n?e.DoPost(a,b,!0):p&&n?$Confirm(q,q,function(){e.DoPost(a,b,!0)},function(){}):
q&&$Tip(q)}},232);return}if(!d)return}var g=$(a).find("input[ewa_tag=ht5upload]");if(!(0<g.length)||this.uploadProcess||this.CheckValidAll(a)){var h=0;e=this;for(d=0;d<g.length>0;d++){var k=g[d];this._uploadingFileCheck(k)&&h++}if(0<h)setTimeout(function(){e.DoPost(a,b)},700);else{g=$(a).find("input[ewa_tag=ht5takephoto]");if(0<g.length&&!this.uploadProcess&&!this.CheckValidAll(a))return!1;for(d=0;d<g.length>0;d++){k=g[d];h=!1;k=window["h5takephoto_"+this._Id+"$"+k.id];if("ok"!=k.UPLOAD_STATUS){if(!$X(k.H5_UPLOAD.WAIT_ID)){try{k.submitUpload()}catch(n){console.log("ht5takephotos - ht5.submitUpload: "+
n);$Tip("\u60a8\u6ca1\u6709\u83b7\u53d6\u7167\u7247");return}k.H5_UPLOAD.createWaitBox();this.uploadProcess=!0}h||(e=this,setTimeout(function(){e.DoPost(a,b)},700),h=!0);return}k.H5_UPLOAD.removeWaitBox()}if(this._stopPostError)return EWA.UI.Msg.ShowError(this._stopPostError,""),!1;d=this.CreateAjax(a);if(null==d)return!1;null==b&&(b=this.Url);if(""==b||null==b)b=window.location.href;this._Ajax=d;this._Ajax.AddParameter("EWA_AJAX","1");this._Ajax.AddParameter("EWA_POST","1");this._Ajax.AddParameter("EWA_NO_CONTENT",
"1");this._Ajax.LoadingType="image";this.DoPostStart&&this.DoPostStart(this._Ajax);d=new EWA_UrlClass(b);for(var l in this._Ajax._Parameters)d.RemoveParameter(l);b=d.GetUrl();this.posting=!0;var m=this;this._Ajax.PostNew(b,function(){m._CallBack()});this.isShowPostWaitting||this._Ajax.HiddenWaitting();$("#EWA_FRAME_"+this._Id+" input[type=submit]").attr("disabled","disabled");return!0}}};this._CallBack=function(){var a=this._Ajax;if(a.IsRunEnd())if($("#EWA_FRAME_"+this._Id+" input[type=submit]").attr("disabled",
null),this.posting=!1,this.DoPostEnd&&this.DoPostEnd(a,a._Http.status,a._Http.responseText,a._Http.statusText),200==a._Http.status){if(a=a._Http.responseText,EWA.F.CheckCallBack(a)){this.ValidCodeError(!0);try{this.doPostAfter?this.doPostAfter(a):this.ReloadAfter&&(console.log("\u8bf7\u7528\uff1adoPostAfter"),this.ReloadAfter(a)),eval(a)}catch(b){console.log(a),console.error(b),alert(a)}}}else alert("ERROR:\r\n"+a._Http.statusText)};this.Reload=function(){};this.Reload1=function(){console.log("Reload1 \u8fd9\u4e2a\u5e72\u561b\u7528\uff1f\u8c01\u5728\u8c03\u7528\uff1f")};
this.ReloadFrame=function(a){var b=$("#EWA_FRAME_"+this._Id);if(0!=b.length){var d=b.parentsUntil("#EWA_FRAME_MAIN").last().parent();if(0!=d.length){b=EWA_Utils.tempId("ewa_frame_relaod");d.attr("id",b);var e=new EWA_UrlClass(this.Url);e.AddParameter("ewa_ajax","install");e=e.GetUrl();$Install(e,b,function(){a&&a(d,this)})}}};this.CheckValidAll=function(a){var b=!0,d=null,e;for(e in this.ItemList.Items){var g=this.ItemList.GetItemValue(this.ItemList.Items[e],"Name","Name");g=this.GetObject(g,a);null!=
g&&((b&=this.CheckValid(g))||null!=d||(d=g))}null!=d&&d.focus();return b};this.H5Type=function(){var a=$("#EWA_FRAME_"+this._Id),b;for(b in this.ItemList.Items){var d=this.ItemList.Items[b],e=this.ItemList.GetItemValue(d,"Name","Name");e=a.find('[id="'+e+'"]');if(0!=e.length){var g=this.ItemList.GetItemValue(d,"Tag","Tag"),h=this.ItemList.GetItemValue(d,"DataItem","Valid");this.ItemList.GetItemValue(d,"DataItem","Format");d=this.ItemList.GetItemValue(d,"IsMustInput","IsMustInput");"Email"==h&&e.attr("type",
"email");"valid"==g&&e.attr("type","tel");1==d&&e.attr("required","required")}}};this.GetObject=function(a,b){b||(b=$("FORM#f_"+this._Id));a=$(b).find('[id="'+a+'"]');return 0<a.length?a[0]:null};this.CheckValid=function(a,b){if("SPAN"==a.tagName||"IMG"==a.tagName)return!0;if(a&&b&&"DIV"==a.tagName&&"REPT"==a.getAttribute("tag")){b=b.target.tagName;if("LABEL"==b||"INPUT"==b){var d=this;setTimeout(function(){d._GetObjectValue(a);d.ItemList.CheckValid(a,e)},10)}return!0}var e=this._GetObjectValue(a);
return this.ItemList.CheckValid(a,e)};this._GetObjectValue=function(a){return this.ItemList.GetObjectValue(a)};this.getUrlClass=function(){var a=new EWA_UrlClass;a.SetUrl(this.Url);return a}}var __EWA_ALTER_MSG=null;
function EWA_FrameShowAlert(a,b){if(1!=a.getAttribute("show_alert")){a.setAttribute("show_alert",1);var d=a;do if(d=d.parentNode,"BODY"==d.tagName){d=null;break}while("TR"!=d.tagName||1!=d.getAttribute("SHOW_MSG"));if(d)if(1==d.cells.length||"1"==d.parentNode.parentNode.getAttribute("error_show_type")){a=$(d);var e=a.next();if(!e.attr("error")){e=d.parentNode.insertRow(d.rowIndex+1);e.setAttribute("error",1);var g=e.insertCell(-1);g.colSpan=d.cells.length;g.className="ewa-tip-error";e=$(e);g.innerHTML=
'<div class="ewa-tip-error-info"></div>'}a.find("td").addClass("ewa-tip-error");e.find(".ewa-tip-error-info").html(b)}else 3==d.cells.length?(d.style.backgroundColor="lightyellow",null==a.getAttribute("ori_msg")&&(a.setAttribute("ori_msg",d.cells[2].innerHTML),a.setAttribute("ori_st",d.cells[2].style.borderLeft)),d.cells[2].innerHTML=a.getAttribute("ORI_MSG")+"(<font color=red>"+b+"</font>)",d.cells[2].style.borderLeft="2px solid red"):($(d).find("td").css("background-color","lightyellow"),"SELECT"!=
a.tagName&&a.focus(),1==d.cells.length?(d=$(d).prev(),d.attr("id")&&0<d.attr("id").indexOf(a.id)?(null==a.getAttribute("ori_msg")&&a.setAttribute("ori_msg",d[0].cells[0].innerHTML),d[0].cells[0].innerHTML=a.getAttribute("ori_msg")+"(<font color=red>"+b+"</font>)"):(alert("\u8bf7\u8f93\u5165\uff1a"+b),a.focus())):(null==a.getAttribute("ori_msg")&&a.setAttribute("ori_msg",d.cells[0].innerHTML),d.cells[0].innerHTML=a.getAttribute("ori_msg")+"(<font color=red>"+b+"</font>)"));else b=$(a),b.attr("ori_bc",
b.css("background-color")),b.css("background-color","pink"),"SELECT"!=a.tagName&&a.focus()}}
function EWA_FrameRemoveAlert(a){__EWA_ALTER_MSG&&(__EWA_ALTER_MSG.style.display="none");if(1==a.getAttribute("show_alert")){a.setAttribute("show_alert",0);var b=a;do if(b=b.parentNode,"BODY"==b.tagName){b=null;break}while("TR"!=b.tagName||1!=b.getAttribute("SHOW_MSG"));b?(b.style.backgroundColor="",1==b.cells.length||"1"==b.parentNode.parentNode.getAttribute("error_show_type")?(a=$(b),a.find("td").removeClass("ewa-tip-error"),a=a.next(),a.attr("error")&&a.remove()):3==b.cells.length?(b.cells[2].innerHTML=
a.getAttribute("ori_msg"),b.cells[2].style.borderLeft=a.getAttribute("ori_st")):1==b.cells.length?(b=$(b).prev(),b.attr("id")&&0<b.attr("id").indexOf(a.id)&&(b[0].cells[0].innerHTML=a.getAttribute("ori_msg"))):($(b).find("td").css("background-color",""),b.cells[0].innerHTML=a.getAttribute("ori_msg"))):(a=$(a),a.css("background-color",a.attr("ori_bc")))}}
function EWA_FrameShowAlert1(a,b){var d=a;do if(d=d.parentNode,"BODY"==d.tagName){d=null;break}while("TD"!=d.tagName||1!=d.getAttribute("SHOW_MSG")&&"ewa_redraw_info"!=d.className);if(d){var e=d.parentNode.parentNode.parentNode,g=d.previousElementSibling?d.previousElementSibling:d.previousSibling;d.style.backgroundColor="lightblue";g&&1==g.nodeType?(g.style.backgroundColor="lightblue",null==a.getAttribute("ori_msg")&&(a.setAttribute("ori_msg",g.innerHTML),a.setAttribute("ori_st",g.style.borderLeft)),
"*"==b&&(b=$(g).find(".ewa_d1").html()+"\uff1a\u9700\u8981\u8f93\u5165"),g.style.borderLeft="2px solid red"):d.style.borderLeft="2px solid red";a="ERR_"+a.id;d=$(e).find('.ewa_msg_err span[id="'+a+'"]');0<d.length?d.html(b+"&nbsp;"):$(e).find(".ewa_msg_err").append('<span id="'+a+'">'+b+"&nbsp;</span>")}else"*"==b&&(b=a.parentNode.innerText+"\uff1a\u9700\u8981\u8f93\u5165"),$(".ewa_msg_err").html(b),a.focus()}
function EWA_FrameRemoveAlert1(a){if(null!=a.getAttribute("ori_msg")){var b=a;do if(b=b.parentNode,"BODY"==b.tagName)return;while("TD"!=b.tagName||1!=b.getAttribute("SHOW_MSG")&&"ewa_redraw_info"!=b.className);var d=b.parentNode.parentNode.parentNode,e=b.previousElementSibling?b.previousElementSibling:b.previousSibling;b.style.backgroundColor="";e&&1==e.nodeType?(e.style.backgroundColor="",e.style.borderLeft=a.getAttribute("ori_st")):b.style.borderLeft=a.getAttribute("ori_st");a="ERR_"+a.id;$(d).find('.ewa_msg_err span[id="'+
a+'"]').remove()}}EWA.F&&EWA.F.F?EWA.F.F.C=EWA_FrameClass:(EWA.F||(EWA.F={}),EWA.F.F={CUR:null,C:EWA_FrameClass});
function EWA_FrameItemClass(){this._Dialog=this._Object1=this._Object=this._Ajax=null;this._Items={};this._SelectedValue=this._LastMoveTr=null;this.DropList=function(a,b){var d=a.nextSibling;this._Object=a;this._Object1=d;if(""==a.value)d.value="";else if(0!=d.getAttribute("canopen"))if(b||null==this._SelectedValue||this._SelectedValue!=a.value){this._inputValue=a.value;var e=d.getAttribute("xmlName"),g=d.getAttribute("itemName");b=d.getAttribute("paraName");_EWA_FRAME_ITEM=this;var h=new EWA.C.Ajax;
h.LoadingType="none";var k="%"+a.value+"%";var l=window.EWA_CGI?window.EWA_CGI:EWA.CP+"/EWA_STYLE/cgi-bin/";l+="?XMLNAME="+e.toURL()+"&ITEMNAME="+g.toURL()+"&EWA_AJAX=NOJS&EWA_LF_NOHEADER=1";(e=$U())&&(l+="&"+e);$(a).attr("ewa_drop_list_para")?l+="&"+$(a).attr("ewa_drop_list_para"):$(d).attr("ewa_drop_list_para")&&(l+="&"+$(d).attr("ewa_drop_list_para"));a=new EWA_UrlClass(l);a.RemoveParameter(b);l=a.GetUrl();h.AddParameter(b,k);h.PostNew(l,function(){if(h.IsRunEnd()){var m=h.GetRst();_EWA_FRAME_ITEM.Show(!0);
_EWA_FRAME_ITEM.SetContent(m)}});this.SetContent(this._Items[d.value])}else this._SelectedValue=null};this.MouseOver=function(a){a=a?a:window.event;a=a.srcElement?a.srcElement:a.target;if("TD"==a.tagName){a=a.parentNode;if(null!=this._LastMoveTr)for(var b=0;b<this._LastMoveTr.cells.length;b+=1)this._LastMoveTr.cells[b].style.backgroundColor="";if("HEADER"==a.getAttribute("EWA_TAG"))this._LastMoveTr=null;else{for(b=0;b<a.cells.length;b+=1)a.cells[b].style.backgroundColor="#cccccc";this._LastMoveTr=
a}}};this.MouseDown=function(a){a=a?a:window.event;a=a.srcElement?a.srcElement:a.target;if("DIV"!=a.tagName){if("TR"==a.tagName)var b=a;else{var d=$(a).parentsUntil("tbody").last();if(0==d.length){console.log(a);return}b=d[0]}if(null==b)console.log(a);else if("TR"!=b.tagName)console.log(a);else if("HEADER"!=b.getAttribute("ewa_tag")){a=this._Object.nextSibling;a.setAttribute("canopen",0);d=[];for(var e={},g=0;g<b.cells.length;g+=1){var h=b.cells[g];h.style.backgroundColor="lightyellow";var k=GetInnerText(h).trim();
d[d.length]=k;h=h.childNodes[0].id;null!=h?(e["@"+h.toUpperCase()]=k,this._Object1.setAttribute("para_"+h.toLowerCase(),k)):e[g]=k}this._LastMoveTr=null;this._SelectedValue=d[0];this._Object1.value=d[0];b=this._Object1.getAttribute("DlsShow");if(null==b||""==b)this._Object.value=d[0];else{k=b.match(/@[a-zA-Z0-9\-\._:]*\b/ig);for(g=0;g<k.length;g++){h=k[g];var l=e[h.toUpperCase()];b=b.replace(h,l)}this._Object.value=b}this._Object.parentNode.setAttribute("title",d.join("\n"));this._Object1.getAttribute("afterEvent");
this.CallAfterEvent();this.Show(!1);a.setAttribute("canopen",1)}}};this.CallAfterEvent=function(){var a=this._Object1.getAttribute("afterEvent");if(null!=a&&0!=a.trim().length){var b=eval("window."+a);if("function"==typeof b)try{b(this._Object1.value,this._Object.value,this._Object1,this._Object)}catch(d){alert("\u5b9a\u4e49\u7684Js "+a+"\u6267\u884c\u9519\u8bef\uff1a"+d)}else alert("\u5b9a\u4e49\u7684Js "+a+"\u4e0d\u5b58\u5728, \u5bf9\u8c61\u4e3a"+typeof b)}};this.Show=function(a){if(null==this._Dialog){var b=
$(this._Object).width();b=400<b?b+"px":"500px";var d="180px";null!=this._Object1.getAttribute("set-dialog-width")&&(b=this._Object1.getAttribute("set-dialog-width"));null!=this._Object1.getAttribute("set-dialog-height")&&(d=this._Object1.getAttribute("set-dialog-height"));EWA.B.PAD&&(b=document.documentElement.clientWidth+"px",d=document.documentElement.clientHeight-300+"px");this._Dialog=new EWA_UI_DialogClass;this._Dialog.Width=b;this._Dialog.Height=d;this._Dialog.ShadowColor="";"undefined"==typeof _EWA_DialogWnd?
this._Dialog.CreateWindow=window:(this._Dialog.CreateWindow=_EWA_DialogWnd._ParentWindow,_EWA_DialogWnd.OpendDialogs[_EWA_DialogWnd.OpendDialogs.length]=this._Dialog);this._Dialog.Create();b="<div style='position:absolute;width:"+b+";height:"+d+";overflow-y:scroll;overflow-x:hidden;border:1px solid #ccc;cursor:pointer'";b=EWA.B.PAD?b+" onclick='_EWA_FRAME_ITEM.MouseDown(event)' ></div>":b+" onmouseover='_EWA_FRAME_ITEM.MouseOver(event)'  onmousedown='_EWA_FRAME_ITEM.MouseDown(event)' ></div>";this._Dialog.SetHtml(b);
$(this._Dialog.GetFrame()).addClass("ewa-ddl-list")}this._Dialog.ShowType=a;this._Dialog.MoveBottom(this._Object);this._Dialog.Show(a);this._Dialog.CreateWindow._EWA_FRAME_ITEM=this;_EWA_FRAME_ITEM=this};this.SetContent=function(a){if(null!=a)if(a=a.replace(/onmouseout/ig,"z1"),a=a.replace(/onmousedown/ig,"z2"),a=a.replace(/onmouseover/ig,"z3"),null==this._Items[this._Object.value]&&(this._Items[this._Object.value]=a),this._Dialog.GetFrameContent().childNodes[0].innerHTML=a,a=this._Dialog.GetFrameContent().childNodes[0].getElementsByTagName("table")[0],
a.style.position="absolute",1>=a.rows.length||0==this._Object.value.length)1>=a.rows.length&&this.Show(!1);else{try{for(var b=eval("/("+this._Object.value+")/ig"),d=1;d<a.rows.length;d+=1)for(var e=a.rows[d],g=0;g<e.cells.length;g++){var h=GetInnerText(e.cells[g].childNodes[0]);e.cells[g].childNodes[0].innerHTML=h.replace(b,"<font color=blue><b>$1</b></font>")}}catch(k){}this.Show(!0)}}}EWA.F.F?EWA.F.F.FI=EWA_FrameItemClass:EWA.F.F={CUR:null,FI:EWA_FrameItemClass};
function EWA_FrameMapToClass(){this.EWA=null;this.mapRef=function(a,b,d){this.POST_URL=d;this.EWA=b;var e=$("#EWA_FRAME_"+this.EWA._Id);this._Id=this.EWA._Id+"_MAPTO";EWA.F.FOS[this._Id]=this;var g=this;$(a).find("[ref]").each(function(){try{g.mapRefItem(this,e)}catch(h){console.log(h,this)}})};this.checkbox=function(a){a=$(a).parentsUntil('div[tag="REPT"]').last().parent();var b=[];a.find("input:checked").each(function(){b.push(this.value)});a={key:a.attr("id"),val:b.join(",")};$JP(this.POST_URL||
window.location.href,a,function(d){d.RST?$TipTL("\u4fdd\u5b58\u5b8c\u6bd5"):$Tip(d.ERR)})};this.showGpsMap=function(a,b){var d=a.attr("ref_map");if(d){var e=b.parent().parent().next().find(".ewa-map-small");if(0==e.length){var g=this;setTimeout(function(){g.showGpsMap(a,b)},100)}else 0==d.indexOf(".")||0==d.indexOf("#")?$(d).append(e.css("height","100%")):$("#"+d).append(e.css("height","100%"))}};this.mapRefItem=function(a,b){var d=$(a),e=d.attr("ref");e=b.find('[id="'+e+'"]');var g=!1,h=this,k="",
l="EWA.F.FOS['"+this._Id+"']";if("hidden"==e[0].type){if(!e.attr("setvalue")){setTimeout(function(){h.mapRefItem(a,b)},100);return}e=e.prev();k=e.val();d.attr("onclick",l+".modifyRef(this)").css("cursor","pointer")}else if("addressMap"==e.attr("ewa_tag"))k=e.val(),d.attr("onclick",l+".modifyRef(this)").css("cursor","pointer"),this.showGpsMap(d,e);else{if("REPT"==e.attr("tag")){d=$(a);d.offset();d.offset();d.outerWidth();d.append(e);e.find("input[type=checkbox]").attr("onclick",l+".checkbox(this)");
return}"1"==e.attr("ewa_dhtml")?(g=!0,k=e[0].textContent,d.attr("onclick",l+".modifyRefHtml(this)").css("cursor","pointer")):("SELECT"==e[0].tagName?k=e[0].options[e[0].selectedIndex].text:"TEXTAREA"==e[0].tagName?((k=e.val())&&(k="<div>"+k.replace(/</,"&lt;").replace(/>/,"&gt;").replace(/\n/ig,"</div><div>")+"</div>"),g=!0):k=e.val(),d.attr("onclick",l+".modifyRef(this)").css("cursor","pointer"))}k||(k="...................");g?d.html(k):d.text(k);d.append('<i style="margin-left:5px" class="fa fa-edit"></i>')};
this.createRefCaption=function(a,b,d,e){if($X(a+"_____tip"))g=$($X(a+"_____tip")),g.show();else{g=document.createElement("div");var g=$(g);g.css({position:"absolute",left:d,top:e-30,height:30,"line-height":"30px",background:"antiquewhite",padding:"0 10"}).text(b);g.attr("id",a+"_____tip");$("body").append(g)}return g};this.modifyRefHtml=function(a){var b=$(a),d=b.attr("ref"),e=$("#EWA_FRAME_"+this.EWA._Id).find('[id="'+d+'"]').prev(),g=b.offset().left,h=b.offset().top,k=b.outerWidth(),l=b.outerHeight();
k={position:"absolute",left:g,top:h,width:k,height:l,font:b.css("font"),border:"2px solid antiquewhite",outline:"none"};e.css(k);$(e.find("iframe")[0].contentWindow.document.body).css("width","auto").css("font",b.css("font"));oldv=window[e.attr("id").replace("box","")].GetHtml();e.attr("oldv",oldv);k=$($X("_ewa_tr$"+d).cells[0]).text();var m=this.createRefCaption(d,k,g,h);e.focus();var n=this;window.onmousedown=function(p){if(!n.checkInHtmlEditor(p.target)){p=e.attr("id").replace("box","");var q=
window[p].GetHtml();window.onmousedown=null;p=e.attr("oldv");q==p?($(e).attr("style",""),m.hide()):(p={key:$(a).attr("ref"),val:q},$JP(n.POST_URL||window.location.href,p,function(t){$(e).attr("style","");m.hide();t.RST?(""==q&&(q="............."),b.html(q),$TipTL("\u4fdd\u5b58\u5b8c\u6bd5"),b.append('<i style="margin-left:5px" class="fa fa-edit"></i>')):$Tip(t.ERR)}))}}};this.checkInHtmlEditor=function(a){a=$(event.target).parents();for(var b=0;b<a.length;b++){var d=$(a[b]);if(d.hasClass("ewa-editor")||
d.hasClass("ewa-editor-pop")||d.hasClass("ewa-dialog"))return!0}return!1};this.modifyRef=function(a){var b=$(a);a=b.attr("ref");var d=$("#EWA_FRAME_"+this.EWA._Id).find('[id="'+a+'"]');"hidden"==d[0].type&&(d=$(d).prev());var e=b.offset().left,g=b.offset().top,h=b.outerWidth(),k=b.outerHeight();"TEXTAREA"==d[0].tagName&&(k+=30);h={position:"absolute",left:e,top:g,width:h,height:k,font:b.css("font"),border:"2px solid antiquewhite",outline:"none"};d.css(h);h=d.val();d.attr("oldv",h);h=$($X("_ewa_tr$"+
a).cells[0]).text();var l=this.createRefCaption(a,h,e,g);d.focus();if(!d.attr("evtblur")){d.attr("evtblur","is_setted");var m=this;addEvent(d[0],"keydown",function(n){n=n.keyCode;13==n&&"TEXTAREA"!=d[0].tagName?this.blur():27==n&&(this.value=$(this).attr("oldv"),this.blur())});addEvent(d[0],"blur",function(){var n=$(this.parentNode.parentNode.cells[0]),p=n.css("background-color"),q=$(this).attr("onmousedown");if(q){var t=q.indexOf(".CheckValid");q=q.substring(0,t);if(eval(q).CheckValid(this))$(this).css("background",
"");else{this.focus();$(this).css("background","pink");return}}q=this.id;t=this.value;"droplist"==$(this).attr("ewa_class")&&(t=$(this).next().val(),q=$(this).next().attr("id"));q={key:q,val:t};if("rgb(255, 255, 224)"==p)$Tip(n.html()),l.hide(),this.focus();else if(this.value==$(this).attr("oldv"))$(this).attr("style",""),l.hide();else{var u=this;$JP(m.POST_URL||window.location.href,q,function(r){$(u).attr("style","");l.hide();r.RST?(r="SELECT"==u.tagName?u.options[u.selectedIndex].text:u.value,"TEXTAREA"==
u.tagName?""==r?b.html("............."):(r=r.replace(/</ig,"&lt;").replace(/>/ig,"&gt;"),r="<div>"+r.split("\n").join("</div><div>")+"</div>",b.html(r)):(""==r&&(r="............."),b.text(r)),b.append('<i style="margin-left:5px" class="fa fa-edit"></i>'),$TipTL("\u4fdd\u5b58\u5b8c\u6bd5")):$Tip(r.ERR)})}})}}}
function EWA_ListFrameClass(){this._Ajax=this.Xml=null;this.ItemList=new EWA_FrameCommonItems;this._SortName=this._Sort=this._RecordCountName=this._PageCountName=this._PageSizeName=this._PageCurrentName=this._RecordCount=this._PageCount=this._PageSize=this._PageCurrent=null;this._SearchExp="";this._SearchHtml=null;this._SearchFields=[];this._Id=null;this._IsCheckedAll=!0;this._SearchDialog=null;this._SearchJson={};this.Resources={};this.GotoParas=[];this._CurTr=null;this._TrSelectMulti=!0;this.IsTrSelect=
!1;this.CheckedAllAfter=this.ReloadAfter=null;this.REPLACE_HISTORY_STATE=this.IsNotMDownAutoChecked=!1;this.composeSearchTexts=function(){var a=[],b=[],d=$("#EWA_RESHOW_"+this._Id+" .ewa-lf-search-type-text");if(0==d.length)return null;d.each(function(h){var k=$(this).find(".ewa-lf-search-item-title").text();k=k.replace(":","").replace("\uff1a","").replace("\u5305\u542b","").replace("Like","").trim();var l=$(this).find("input[type=text]").attr("name");a.push(k);b.push(l);0<h&&$(this).hide()});var e=
$(d[0]);e.addClass("ewa-app-lf-search-compose");e.find("input[type=text]").attr("name",b.join(",")).attr("placeholder",a.join(", "));var g=e.find("a").clone();e.find(".ewa-lf-search-item-title b").text("enus"==EWA.LANG?"Search":"\u7efc\u5408\u641c\u7d22").append(g);return d};this.switchButtonAction=function(a,b){if(b){var d=this.getUrlClass();d.AddParameter("ewa_switch_name",a.name);d.AddParameter("ewa_action",b);d.AddParameter("ewa_ajax","json");d.AddParameter("ewa_switch",a.checked?"on":"off");
d.AddParameter("ewa_action_key",$(a).parentsUntil("tbody").last().attr("ewa_key"));var e=a.parentNode,g=e.getAttributeNames();b={};for(var h in g){var k=g[h],l=e.getAttribute(k);0!=k.indexOf("on")&&"name"!=k&&"id"!=k&&"class"!=k&&(b[k]=l)}var m=this;d=d.GetUrl();$JP(d,b,function(n){m.extSwitchCallBack&&m.extSwitchCallBack(a,n)})}};this.ShowRecycle=function(){var a=$X("EWA_LF_"+this._Id);if(null!=a&&(a=$(a).parentsUntil("table").last().find(".ewa_lf_func_caption"),0!=a.length)){var b="\u56de\u6536\u7ad9";
window._EWA_INFO_MSG&&window._EWA_INFO_MSG.RECYCLE&&(b=window._EWA_INFO_MSG.RECYCLE);b="<div class='ewa_lf_func_dact ewa-lf-func-recycle' onclick='EWA.F.FOS[\""+this._Id+"\"].ShowRecycle1(this)' ><b class='fa fa-recycle'></b>"+b+"</div>";a.parent().append(b)}};this.ShowRecycle1=function(a){var b=new EWA_UrlClass(this.Url);$(a).attr("recycle")?(b=b.RemoveParameter("ewa_recycle"),$(a).attr("recycle",null).removeClass("ewa-lf-func-recycle-yes")):(b=b.AddParameter("ewa_recycle","1"),$(a).attr("recycle",
1).addClass("ewa-lf-func-recycle-yes"));this.Url=b;this.Goto(1)};this.BindButton=function(a,b){$("#EWA_LF_"+this._Id+' tr[ewa_key] [id="'+a+'"]').each(function(){$(this).attr("onclick","$(this).parent().parent().find('[id=\""+b+"\"]')[0].click()");$(this).addClass("ewa-map-button")})};this.Merges=function(a){if(null==a||0==a.length)console.log("cfg.from, cfg.to, cfg.str, cfg.func, cfg.header");else for(var b=0;b<a.length;b++){var d=a[b];this.Merge(d.from,d.to,d.str,d.func,d.header)}};this.Merge=function(a,
b,d,e,g){var h=$("#EWA_LF_"+this._Id);null==d?d="":-1==d.indexOf("<")&&(d="<span class='ewa-merge-str ewa-mearge-str'>"+d+"</span>");h.find("tr[ewa_key],tr.ewa-lf-sub-tr").each(function(){var k=$(this).find('[id="'+b+'"]').parentsUntil("tr").last();if("yes"!=k.attr("ewa-merged")){k.attr("ewa-merged","yes");var l=$(this).find('[id="'+a+'"]');l.parentsUntil("tr").last().hide();k.append(d);k.append(l);e&&e(k,this)}});g&&(g="<span class='ewa-lf-merge-header-split'></span>"+h.find('tr[ewa_tag="HEADER"] [id="'+
a+'"]').html(),h.find('tr[ewa_tag="HEADER"] [id="'+b+'"]').append(g));h.find('tr[ewa_tag="HEADER"] [id="'+a+'"]').parent().hide();h.find("td#ADD_ROW_"+a).hide()};this.Mearge=function(a,b,d){console.log("\u62fc\u5199\u9519\u8bef\uff0c\u8bf7\u7528 Merge");this.Merge(a,b,d)};this.MergeExp=function(a,b,d,e,g){if(b){var h=$("#EWA_LF_"+this._Id),k=b.match(/@@[a-zA-Z0-9\-\._:]*\b/ig),l=[],m=b,n={};b=[];for(var p=0;p<k.length;p++){var q=k[p];l.push(q);var t=q.replace("@@","");m=m.replace(q,"<span class='ewa-lf-merge ewa-lf-merge-"+
t+" ewa-lf-mearge ewa-lf-mearge-"+t+"' mid=\""+t+'"></span>');t!=a&&(h.find('tr[ewa_tag="HEADER"] [id="'+t+'"]').parent().hide(),h.find("td#ADD_ROW_"+t).hide());q=h.find('tr[ewa_tag="HEADER"] [id="'+t+'"]').html();n[t]=q;b.push(q)}g&&(g=b.join("<span class='ewa-lf-merge-header-split'></span>"),h.find('tr[ewa_tag="HEADER"] [id="'+a+'"]').html(g));h.find("tr[ewa_key],tr.ewa-lf-sub-tr").each(function(){if(0==$(this).find('[id="'+a+'"]').length)console.log("not find "+a);else{var u=$(this).find('[id="'+
a+'"]').parent();if("yes"!=u.attr("ewa-merged")){u.attr("ewa-merged","yes");var r=$('<div style="display:none"></div>');r.html(m);for(var w in l){var v=l[w].replace("@@",""),y=$(this).find('[id="'+v+'"]');if(0!=y.length){v!=a&&y.parent().hide();var x=r.find('span[mid="'+v+'"]');d&&(x.append("<span class='ewa-lf-mearge-memo'></span>"),x.find(".ewa-lf-mearge-memo").html(n[v]));x.append(y)}}for(;0<r[0].childNodes.length;)u.append(r[0].childNodes[0]);$(r).remove();e&&e(u,this)}}})}else console.log("mergeExp \u6ca1\u6709\u8bbe\u7f6e")};
this.MeargeExp=function(a,b,d,e){console.log("\u62fc\u5199\u9519\u8bef\uff0c\u8bf7\u7528 MereExp");this.MergeExp(a,b,d,e)};this.SubBottoms=function(a){this.SubBottomsArray=a.split(",");this._SubBottoms()};this.reCalcBottoms=function(){this._SubBottoms()};this._SubBottoms=function(){var a=$("#EWA_LF_"+this._Id).find(".ewa-lf-sub-tr");0==a.length?(a=$(this.AddRow([])),a.addClass("ewa-lf-sub-tr"),a.find("td").addClass("ewa-lf-sub-td")):a.find("td").text("");var b={},d;for(d in this.SubBottomsArray){var e=
this.SubBottomsArray[d];b.$jscomp$loop$prop$total$31=0;var g="#EWA_LF_"+this._Id+' .ewa-lf-data-row [name="'+e+'"]';b.$jscomp$loop$prop$fm_length$32=0;$(g).each(function(h){return function(){var k=this.hasAttribute("value")?this.value:this.hasAttribute("title")?this.title:this.innerText;null!=k&&0!==k.length&&(k=k.replace(/,/ig,""),isNaN(k)||(h.$jscomp$loop$prop$total$31+=1*k,0<k.indexOf(".")&&(h.$jscomp$loop$prop$fm_length$32=2)))}}(b));g="<span id='"+e+"' name='"+e+"' class='ewa-lf-sub'>"+b.$jscomp$loop$prop$total$31.fm(b.$jscomp$loop$prop$fm_length$32)+
"</span>";a.find("td[id=ADD_ROW_"+e+"]").html(g);b={$jscomp$loop$prop$total$31:b.$jscomp$loop$prop$total$31,$jscomp$loop$prop$fm_length$32:b.$jscomp$loop$prop$fm_length$32}}};this.ChangeRowStyle=function(a,b,d){for(var e=$X("EWA_LF_"+this._Id),g=1;g<e.rows.length;g++){var h=e.rows[g];if(!(0==h.cells.length||h.cells.length<=a)){var k=h.cells[a].childNodes[0].getAttribute(b);if(null!=k&&d[k])for(var l=0;l<h.cells.length;l++)h.cells[l].style.cssText=h.cells[l].style.cssText+";"+d[k]}}if(null==this.ReloadAfter){var m=
this;this.ReloadAfter=function(){m.ChangeRowStyle(a,b,d)}}};this.MDownEvent=function(a,b){};this.LoadJson=function(a,b){null!=a&&$J(this.Url+"&EWA_ACTION="+a+"&EWA_AJAX=JSON",b)};this.Workflow=function(a,b,d,e,g,h){EWA.F.CID=this._Id;this._Ajax=this.CreateAjax();this._Ajax.AddParameter("EWA_AJAX","WORKFLOW");this._Ajax.AddParameter("EWA_ID",this._Id);this._Ajax.AddParameter("EWA_WF_NAME",b);null!=d?(a=this.GetRowKey(d),this._Ajax.AddParameter("EWA_ACTION_KEY",a),"true"==d.getAttribute("ewa_wf_control")?
this._Ajax.AddParameter("EWA_WF_CTRL",1):this._Ajax.AddParameter("EWA_WF_CTRL",0)):this._Ajax.AddParameter("EWA_WF_CTRL",1);null!=e&&this._Ajax.AddParameter("EWA_ACTION_KEY",e);g&&this._Ajax.AddParameter("EWA_WF_UOK",g);h&&this._Ajax.AddParameter("EWA_WF_UMSG",h);var k=this;this._Ajax.PostNew(this.Url,function(){k._CallBackJs()})};this.GetRowKey=function(a){a=this.GetRow(a);return null!=a?a.getAttribute("EWA_KEY"):null};this.GetRow=function(a){if(null==a||null==a.tagName||""==a.tagName)return null;
var b=0;for(a=a.parentNode;"TR"!=a.tagName||null==a.getAttribute("EWA_KEY");){a=a.parentNode;if("BODY"==a.tagName){a=null;break}b++;if(100<b){alert("\u5faa\u73af100\u6b21\uff0c\u672a\u53d1\u73b0TR");break}}return a};this.RecordModify=function(a,b,d){var e=this.SelectChecked();if(0==e.length)EWA.UI.Msg.Alter("\u8bf7\u5148\u9009\u62e9","\u4fee\u6539");else{var g="EWA_MTYPE=M";null!=d&&0<d.trim().length&&(g+="&"+d);EWA.UI.Dialog.OpenReloadClose(this._Id,a,b,!1,g+e)}};this.RecordNew=function(a,b,d){var e=
"EWA_MTYPE=N";null!=d&&0<d.trim().length&&(e+="&"+d);EWA.UI.Dialog.OpenReloadClose(this._Id,a,b,!1,e)};this.SelectSingle=function(){this.IsTrSelect=!0;this._TrSelectMulti=!1};this.SelectMulti=function(){this._TrSelectMulti=this.IsTrSelect=!0};this.MOver=function(a,b){if(this.IsTrSelect&&this._CurTr!=a&&(null!=this._CurTr&&("1"!=this._CurTr.getAttribute("__ewa_lf_mdown")?this._MSetBg(this._CurTr,""):this._MSetBg(this._CurTr,"down")),"1"!=a.getAttribute("__ewa_lf_mdown")?this._MSetBg(a,"over"):this._MSetBg(a,
"down"),this._CurTr=a,this.MOverEvent))try{this.MOverEvent(a,b)}catch(d){console.log(d,this.MOverEvent)}};this.MOut=function(a){if(this.IsTrSelect&&null!=this._CurTr&&"1"!=this._CurTr.getAttribute("__ewa_lf_mdown")){this._MSetBg(this._CurTr,"out");if(this.MOutEvent)try{this.MOutEvent(this._CurTr,a)}catch(b){console.log(b,this.MOutEvent)}this._CurTr=null}};this.MDownEnableCheck=function(a,b){return!0};this.checkMDownEnable=function(a,b){if(!b)return!0;b=b.srcElement?b.srcElement:b.target;return!b||
"TD"==b.tagName&&b.parentNode==a?!0:"A"==b.tagName||"A"==b.parentNode.tagName||"INPUT"==b.tagName||"SELECT"==b.tagName||"BUTTON"==b.tagName||"TEXTAREA"==b.tagName||0<=b.className.indexOf("EWA_LF_EDIT")||0<=b.className.indexOf("ewa-lf-edit")||0<=b.className.indexOf("ewa-lf-search-text-click")||0<=b.parentNode.className.indexOf("ewa-lf-search-text-click")||0<=b.parentNode.parentNode.className.indexOf("ewa-lf-search-text-click")||0<=b.className.indexOf("ewa-mdown-stop")?!1:!0};this.mDownAutoCheck=function(a,
b,d){for(var e,g=0;g<b.length&&!(0<=b[g].parentNode.className.indexOf("ewa-switch"));g++){if("RADIO"==b[g].type.toUpperCase())return e=b[g],e.click(),e;if("CHECKBOX"==b[g].type.toUpperCase()){e=b[g];e.click();if(!this._TrSelectMulti){var h=$(b[g]).attr("id")||$(b[g]).attr("name");0==$(d).find(b[g]).length&&$(a).siblings(".ewa-lf-data-row").find("input[name='"+h+"']:checked").prop("checked",!1);e.checked=!0}return e}}return null};this.MDown=function(a,b){if(this.IsTrSelect){var d=(new Date).getTime(),
e=$(a).attr("mdown_time_last");if(!(null!=e&&500>d-e)&&($(a).attr("mdown_time_last",d),b=null==b?window.event:b,this.MDownEnableCheck(a)&&this.checkMDownEnable(a,b))){e=b.srcElement?b.srcElement:b.target;var g=null;d=a.getElementsByTagName("input");this.IsNotMDownAutoChecked||(g=this.mDownAutoCheck(a,d,e));if("1"==a.getAttribute("__ewa_lf_mdown"))this._TrSelectMulti&&(g&&"CHECKBOX"==g.type.toUpperCase()&&(g.checked=!1),this._MSetBg(a,""),a.removeAttribute("__ewa_lf_mdown"),$(a).removeClass("ewa-lf-mdown"));
else{g&&(g.checked=!0);this._MSetBg(a,"down");a.setAttribute("__ewa_lf_mdown",1);$(a).addClass("ewa-lf-mdown");if(!this._TrSelectMulti&&(g=a.parentNode)&&g.rows)for(e=0;e<g.rows.length;e++){var h=g.rows[e];"1"==h.getAttribute("__ewa_lf_mdown")&&h!=a&&(h.removeAttribute("__ewa_lf_mdown"),$(h).removeClass("ewa-lf-mdown"),this._MSetBg(h,""))}if(this.IsReShow)for(e=0;e<d.length;e++)"BUTTON"==d[e].type.toUpperCase()&&(g=d[e],"true"==g.getAttribute("disabled")||1==g.getAttribute("disabled")||"true"==g.parentNode.getAttribute("disabled")||
1==g.parentNode.getAttribute("disabled")?(this._ReshowButs[g.value].disabled=!0,this._ReshowButs[g.value].style.display="none"):(this._ReshowButs[g.value].disabled=!1,this._ReshowButs[g.value].style.display=""))}if(this._IsAddPreRow){if(d=a.getAttribute("ewa_key"),this.AddPreRowCheck(a,d,b)){g=a.parentNode.rows[a.rowIndex+1];if(null==g||1!=g.getAttribute("add_pre_row"))g=a.parentNode.parentNode,e=g.rows[0].cells.length,g=g.insertRow(a.rowIndex+1),g.setAttribute("add_pre_row",1),h=g.insertCell(-1),
h.colSpan=e,h.className="ewa-lf-add-pre-cell",g.style.display="none",h.id=EWA_Utils.tempId("EWA_LF_NR_"+this._Id),$(g).addClass("ewa-lf-add-pre-row");this.prevTr&&(this.AddPreRowCloseBeforeEvent&&this.AddPreRowCloseBeforeEvent(this._Id,a,d,this.prevTr,b),this.prevTr.style.display="none",this.prevTr.cells[0].innerHTML="",this.AddPreRowCloseEvent&&this.AddPreRowCloseEvent(this._Id,a,d,this.prevTr,b));this.prevTr==g?this.prevTr=null:(this.prevTr=g,this.prevTr.style.display="",this.MDownEvent(this._Id,
a,d,this.prevTr,b))}}else this.MDownEvent(a,b)}}};this.AddPreRow=function(a){this._IsAddPreRow||(this.MDownEvent=a);this._IsAddPreRow=!0};this.AddPreRowCheck=function(a,b,d){return!0};this.AddPreRowCloseBeforeEvent=function(a,b,d,e,g){};this.AddPreRowCloseEvent=function(a,b,d,e,g){};this._MSetBg=function(a,b){var d="EWA_TD_M";"down"==b?d="ewa_grid_down":"over"==b&&(d="ewa_grid_mover");for(b=0;b<a.cells.length;b++)$(a.cells[b]).removeClass("ewa_grid_mover ewa_grid_down EWA_TD_M").addClass(d)};this._ReShowSearchQuick=
function(){var a=this,b=EWA_ListFrameClass.prototype.RESOURCES.search_text_items,d,e,g;for(g in b){var h=b[g];"eq"==h.Id&&(d=h);"lk"==h.Id&&(e=h)}for(g in this._SearchJson){var k=this._SearchJson[g];k.isSearchQuick&&(b=$("#EWA_LF_"+this.Id+' .ewa-lf-data-row [id="'+g+'"]'),b.bind("click",function(l){l.stopPropagation();l=$(this).attr("search_tag");var m=$(this).text(),n=m,p=$("#EWA_SEARCH_ITEM_"+a.Id+' .ewa-lf-search-item-ctl [name="'+this.id.toUpperCase()+'"]');if("number"==l||"date"==l)p=p.parentsUntil(".ewa-lf-search-item").last().find("input");
var q=p.parentsUntil(".ewa-lf-search-item").last().find("a");if("date"==l)m=m.split(" ")[0],n=m+" 23:59:59";else if("fix"==l){var t=null;p.find("option").each(function(){this.text==m&&(t=this.value)});m=null===t?"":t}p.val()==m?("text"==l&&e&&0<q.length&&(q.attr("tag",e.Id),q.html("enus"==EWA.LANG?e.TxtEn:e.Txt)),p.val("")):("text"==l&&d&&0<q.length&&(q.attr("tag",d.Id),q.html("enus"==EWA.LANG?d.TxtEn:d.Txt)),p.val(m),"date"==l&&(p[1].value=n))}),b.each(function(){$(this).text()&&$(this).addClass("ewa-lf-search-text-click").attr("search_tag",
k.T)}))}};this.ReShowWithNoButtons=function(){var a=$X("EWA_LF_"+this._Id),b=[],d;for(d in this.ItemList.Items){var e=this.ItemList.Items[d],g=this._GetSubValue("Tag","Tag",e);if(null!=g&&"button"==g.trim().toLowerCase())for(g=0;g<a.rows[0].cells.length;g++)if(a.rows[0].cells[g].childNodes[0].id.toUpperCase()==d){b.push(g);e.setAttribute("but_show","1");break}}this.ShowHiddenColumns(b,!1)};this.ReShowButtonsInDailogTitle=function(){EWA.OW.Load();if(EWA.OW.Dia){var a=$(EWA.OW.Dia._Dialog.GetFrameTitle()),
b=$($X("EWA_RESHOW_"+this._Id)).find("td.ewa_lf_func:eq(0)"),d=this;b.find(".ewa_lf_func_dact").each(function(){this.id=EWA_Utils.tempId("gDx_"+d._Id+"_")});a.html(b.html());a.find(".ewa_lf_func_dact").each(function(){this.onclick=function(){b.find('div[id="'+this.id+'"]').click()}});b.parent().hide();$(EWA.OW.Dia._Dialog.GetFrame()).addClass("ewa-lf-btns-in-title")}};this.ReShow=function(a){this.IsReShow=!0;var b="_G_"+this._Id;this.NewDivId=b;a=[];a.push("<table class='ewa-lf-reshow' id='EWA_RESHOW_"+
this._Id+"'>");a.push("<tr style='display:none'><td style='padding:0'></td></tr>");a.push("<tr><td class='ewa_lf_func' style='padding:0'>");a.push("<div style='display:none'></div>");a.push("<div><div style='cursor:pointer' class='ewa_lf_func_caption'></div></div>");a.push("</td></tr>");a.push("<tr><td style='width:100%;padding:0;vertical-align:top'>");a.push("<div id='"+b+"' style=''></div>");a.push("</td></tr>");a.push("</table>");var d=$(a.join("")),e=!(0<this.Url.toUpperCase().indexOf("EWA_AJAX=INSTALL")||
0<this.Url.toUpperCase().indexOf("EWA_CALL_METHOD=INNER_CALL")||0<this.Url.toUpperCase().indexOf(".JSP"));e?EWA.UI.Utils.SetStyle(d[0],"width:100%;height:100%;border-spacing:0"):EWA.UI.Utils.SetStyle(d[0],"width:100%;border-spacing:0");css="";var g=$X("EWA_LF_"+this._Id);a=g.parentNode.parentNode;var h=g.parentNode;d.find("td:eq(2)>div").append(h);h=d[0];var k=d.find("tr:eq(0)")[0],l=d.find("td:eq(0)")[0],m=d.find("td:eq(1)")[0],n=d.find("td:eq(2)")[0];e&&(window.setTimeout(function(){$X("__EWA_DEBUG")&&
n.childNodes[0].appendChild($X("__EWA_DEBUG"));var C=$X(b);C.getElementsByTagName("table");var E=EWA.UI.Utils.GetDocSize(window),F=C.parentNode.parentNode.previousSibling.offsetHeight;C.style.top=F+"px";C.style.height=E.H-F+"px"},100),addEvent(window,"resize",function(){var C=$X(b),E=EWA.UI.Utils.GetDocSize(window),F=C.parentNode.parentNode.previousSibling.offsetHeight;C.style.top=F+"px";C.style.height=E.H-F+"px"}));for(;0<a.childNodes.length;)m.childNodes[0].appendChild(a.childNodes[0]);d=d.find(".ewa_lf_func_caption")[0];
var p=!1;e=GetInnerText(m);e=e.trim();this._ReshowButs={};g=$(g.rows[0]);for(var q in this.ItemList.Items){var t=this.ItemList.Items[q],u=this._GetSubValue("Tag","Tag",t);if(u&&("button"==u.toLowerCase()||"butflow"==u.toLowerCase())&&(u=this._GetSubValue("Name","Name",t),0!==g.find(".ewa-col-"+u).length)){p=!0;var r=this._GetSubValue("DescriptionSet","Info",t),w=this._GetSubValue("DescriptionSet","Memo",t),v=this._GetSubValue("EventSet","EventName",t),y="";null!=v&&"ewa_click"==v.toLowerCase().trim()&&
(y=this._GetSubValue("EventSet","EventValue",t));e=e.replace(r,"");t=this._ReShowButton(r,w,null);this._ReshowButs[r]=t;t.setAttribute("f_id",this._Id);t.setAttribute("t_id",u);m.childNodes[1].appendChild(t);""==y?t.setAttribute("onclick","EWA.F.FOS['"+this._Id+"'].reShowButtonClick(this)"):t.setAttribute("onclick",y)}}p&&this._ReShowSplit(m.childNodes[1]);u=m.getElementsByTagName("input");p={};for(g=0;g<u.length;g++){var x=u[g];x.style.display="none";if(null==x.id||""==x.id)x.id=("_tmp_"+Math.random()).replace(".",
"_");if("button"==x.type){if(t=this._ReShowButton(x.value,x.title,x.id),r=x.nextSibling){var z="";3==r.nodeType&&(z=r.nodeValue.trimEx());"|"==z&&this._ReShowSplit(m.childNodes[1])}}else(r=x.nextSibling)&&(z=3==r.nodeType?r.nodeValue.replace("|",""):r.innerHTML),t=this._ReShowButton(z.trimEx(),x.title,x.id),t.id=("_tmp_"+Math.random()).replace(".","_"),p[x.name]||(p[x.name]=[]),p[x.name].push(t.id);m.childNodes[1].appendChild(t)}e=e.replace(/ /ig,"").replace(/\|/ig,"").trimEx();""!=e?0<=e.indexOf("if")?
k.style.display="none":l.innerHTML=e.replace(/ /,""):k.style.display="none";a.appendChild(h);for(q in p)for(z=p[q],g=0;g<z.length;g++)x=$X(z[g]),x.setAttribute("_r_ids",z.join(",")),x.onclick=function(){var C=this.getAttribute("_ewa_event_id");$X(C).click();C=this.getAttribute("_r_ids").split(",");for(var E=0;E<C.length;E++)x.id!=C[E]&&($X(C[E]).style.fontWeight="",$X(C[E]).style.color="");this.style.fontWeight="bold";this.style.color="blue"};d.innerHTML='<b><i class="fa fa-star-o">&nbsp;</i>'+this.Description+
"</b>";if(0<this.Url.toUpperCase().indexOf("EWA_BTNS_IN_TITLE"))var A=this,B=0,D=setInterval(function(){B++;1E3<B&&window.clearInterval(D);EWA.OW.Load();EWA.OW.Dia&&(window.clearInterval(D),A.ReShowButtonsInDailogTitle())},10)};this.reShowButtonClick=function(a){a=a.getAttribute("t_id");var b=this.SelectCheckedRows();if(null==b||0==b.length)EWA.UI.Msg.Alert(_EWA_INFO_MSG["EWA.SYS.CHOOSE_ITEM"],_EWA_INFO_MSG["EWA.SYS.CHOOSE_ITEM_TITLE"]);else{b=b[0].getElementsByTagName("input");for(var d=0;d<b.length;d++){var e=
b[d];if(e.name===a){e.click();break}}}};this._ReShowSplit=function(a){EWA.UI.Utils.CreateObject(window,"div","",a).className="ewa_lf_func_split"};this._ReShowButton=function(a,b,d){var e=EWA.UI.Utils.CreateObject(window,"div","cursor:pointer",document.body);e.innerHTML="<nobr>"+a+"</nobr>";null!=d&&(e.setAttribute("_ewa_event_id",d),e.onclick=function(){var g=this.getAttribute("_ewa_event_id");$X(g).click()});EWA.B.IE&&(e.onselectstart=function(){return!1});e.className="ewa_lf_func_dact";e.title=
b;return e};this.CheckValid=function(a){var b=a.tagName.toLowerCase();if("input"!=b&&"textarea"!=b&&"select"!=b||"button"==a.type||"submit"==a.type||"image"==a.type)return!0;b=this.ItemList.GetObjectValue(a);return this.ItemList.CheckValid(a,b)};this.ShowEdit=function(a){a.parentNode.style.width=a.clientWidth+"px";a.style.display="none";__show_obj__=a.nextSibling;__show_obj__.style.display="";var b=__show_obj__.childNodes[0];3==b.nodeType&&(b=__show_obj__.childNodes[1]);b.setAttribute("old",b.value);
"SELECT"!=b.tagName||b.getAttribute("func")||(b.setAttribute("func",1),b.onchange=function(){EWA.F.FOS[this.getAttribute("__ewa_fid__")].EditAfter(this)});null==b.getAttribute("__ewa_fid__")&&(b.setAttribute("__ewa_fid__",this._Id),b.onblur=function(){EWA.F.FOS[this.getAttribute("__ewa_fid__")].EditAfter(this)},b.onkeydown=function(d){d=null==d?window.event:d;var e=d.target?d.target:d.srcElement;13==d.keyCode&&"INPUT"==e.tagName&&EWA.F.FOS[this.getAttribute("__ewa_fid__")].EditAfter(this);27==d.keyCode&&
EWA.F.FOS[this.getAttribute("__ewa_fid__")].EditReset(this)});setTimeout(function(){b.focus()},10)};this.EditReset=function(a){a.parentNode.style.display="none";var b=a.parentNode.previousSibling;b.style.display="";b.innerHTML=a.getAttribute("old");"select"==a.tagName.toLowerCase()?b.innerHTML=a.options[a.selectedIndex].text:a.value=a.getAttribute("old").replace(/</ig,"&lt;").replace(/>/ig,"&gt;")};this.EditAfter=function(a){if(this.CheckValid(a))if(a.getAttribute("old")==a.value)this.EditReset(a);
else{a.parentNode.style.display="none";var b=a.parentNode.previousSibling;b.style.display="";if("droplist"==a.getAttribute("ewa_class")){var d=$(a.parentNode.getElementsByTagName("input")[1]).attr("name");var e=a.parentNode.getElementsByTagName("input")[1].value;b.innerHTML=a.parentNode.getElementsByTagName("input")[0].value}else"select"==a.tagName.toLowerCase()?(d=$(a).attr("name"),b.innerHTML=a.options[a.selectedIndex].text):(d=a.value.replace(/</ig,"&lt;").replace(/>/ig,"&gt;").replace(/\n/ig,
"<br>"),b.innerHTML=d,d=$(a).attr("name")),e=a.value;b=a.getAttribute("action_name");if(""==b||null==b)b="OnListFrameUpdateCell";var g=a.getAttribute("action_confirm");g=null==g?"":g;var h=a.getAttribute("action_tip");null==h&&(h="");var k=a.getAttribute("action_js"),l=this.ItemList.GetValue(d,"DataItem","DataType");d=[{Name:"EWA_FIELD_ID",Value:d},{Name:"EWA_FIELD_VAL",Value:e},{Name:"EWA_ACTION_RELOAD",Value:"0"},{Name:d,Value:e},{Name:"EWA_DATA_TYPE",Value:l},{Name:"EWA_FIELD_VAL_OLD",Value:a.getAttribute("old")}];
this.EditEvent={FROM:a,OLD_VAL:a.getAttribute("old"),NEW_VAL:a.value};this.DoAction(a,b,g,h,d,k)}else a.focus()};this.RewriteInfo=function(a,b,d,e,g){var h=$("#EWA_LF_"+this._Id),k=[];if(a)this._INFO={},this._INFO.INFO=a,this._INFO.ID_NAME=b||"id",this._INFO.INFO_NAME=d||"info",this._INFO.MEMO_NAME=e||"memo";else if(!this._INFO||!this._INFO.INFO)return;for(a=0;a<this._INFO.INFO.length;a++)if(b=this._INFO.INFO[a],d=h.find('[id="'+b[this._INFO.ID_NAME]+'"]:eq(0)'),0!==d.length){e=d.parentsUntil("tr").last();
var l=b[this._INFO.INFO_NAME],m=b[this._INFO.MEMO_NAME];if(null==l||""==l.trim())for(l=e.parent()[0],m=0;m<l.cells.length;m++){if(l.cells[m]==e[0]){this.ShowHiddenColumn(m,!1);break}}else 0==d.children().length?d.text(l):d.children()[0].innerText=l,m&&d.attr("title",m);k.push(d[0]);g&&g(d[0],b,a)}return k};this.ShowHiddenColumn=function(a,b){var d=$X("EWA_LF_"+this._Id),e="";if(null==b||0==b||"none"==b)e="none";for(b=0;b<d.rows.length;b++)d.rows[b].cells.length==d.rows[0].cells.length&&(d.rows[b].cells[a].style.display=
e)};this.ShowHiddenColumns=function(a,b){var d=$X("EWA_LF_"+this._Id),e="";if(null==b||0==b||"none"==b)e="none";b=d.rows[0].cells.length;for(var g=0;g<d.rows.length;g++){var h=d.rows[g];if(h.cells.length==b)for(var k=0;k<a.length;k++)h.cells[a[k]].style.display=e}};this.GroupShowHidden=function(a){var b=$(a).attr("t"),d=(new Date).getTime();if(!(b&&333>d-b)){$(a).attr("t",d);b=a.parentNode.parentNode;d=b.getAttribute("ewa_group");""==d?(d="none",a.childNodes[0].innerHTML=" + "):(d="",a.childNodes[0].innerHTML=
" - ");b.setAttribute("ewa_group",d);for(var e=b.parentNode.parentNode,g=0,h=b.rowIndex+1;h<e.rows.length;h++){b=e.rows[h];if("group"==b.getAttribute("ewa_tag"))break;b.getAttribute("add_pre_row")?"none"==d?("none"!=b.style.display&&b.setAttribute("ewa_group_show_old",b.style.display),b.style.display="none"):b.hasAttribute("ewa_group_show_old")&&(b.style.display=b.getAttribute("ewa_group_show_old"),b.removeAttribute("ewa_group_show_old")):(b.style.display=d,g++)}a.childNodes[a.childNodes.length-1].innerHTML=
" ("+g+")"}};this.Sort=function(a){var b=this._last_sort_timer||0,d=this._Sort||"",e=(new Date).getTime();d==a&&500>e-b||(this._last_sort_timer=e,this._Sort=a,this.Goto(1))};this.SearchClear=function(a){a=a.parentNode.parentNode.parentNode.parentNode;for(var b=0;b<a.rows.length;b+=1)for(var d=a.rows[b].getElementsByTagName("input"),e=0;e<d.length;e++){var g=d[e];if("text"==g.type)g.value="";else if("radio"==g.type||"checkbox"==g.type)g.checked=!1}};this.SearchGetExpInit=function(){var a=$("#_G_"+
this._Id),b=[];$(a).find(".ewa-lf-search-item").each(function(){var d=$(this).find("input");if(0==d.length&&(d=$(this).find("select"),0==d.length))return;var e=d[0],g=$(e).attr("t");if(1==d.length){var h=e.value;if(""!=e.value.trim())for("text"==g&&(d=$(e.parentNode.parentNode).find("a").attr("tag"))&&(g=d),e=e.name.split(","),d=0;d<e.length;d++)b.push(e[d]+"["+g+"]"+h)}else if(("date"==g||"number"==g)&&2==d.length){if(h=e.value,g=d[1].value,""!=g||""!=h)b.push(e.name+"[gte]"+h),g&&b.push(e.name+
"[lte]"+g)}else if("fix"==g&&"INPUT"==e.tagName){var k=[""];$(this).find("input").each(function(){this.checked&&k.push(this.value)});1!=k.length&&b.push(e.name+"[or]"+k.join(";"))}});return b.join(",")};this.SearchGetExp=function(a){var b=[];$(a).find(".ewa-lf-search-item").each(function(){var d=$(this).find("input");if(0==d.length&&(d=$(this).find("select"),0==d.length))return;var e=d[0],g=$(e).attr("t");if(1==d.length){var h=e.value;""!=e.value.trim()&&("text"==g&&(d=$(e.parentNode.parentNode).find("a").attr("tag"))&&
(g=d),b.push("@!@"+e.name+"~!~"+g+"~!~"+h))}else if(("date"==g||"number"==g)&&2==d.length)h=e.value,d=d[1].value,""==d&&""==h||b.push("@!@"+e.name+"~!~"+g+"~!~"+h+"~!~"+d);else if("fix"==g&&"INPUT"==e.tagName){var k=[""];$(this).find("input").each(function(){this.checked&&k.push(this.value)});1!=k.length&&b.push("@!@"+e.name+"~!~"+g+k.join("~!~"))}});return b.join("")};this.DoSearch=function(a){var b=!1;a.id=="EWA_SEARCH_ITEM_"+this.Id?a=$X("EWA_SEARCH_ITEM_"+this.Id).childNodes[0]:(a=a.parentNode.parentNode.parentNode.parentNode,
b=!0);this._SearchExp=this.SearchGetExp(a);b&&(this._SearchHtml=a.parentNode.innerHTML,this._SearchDialog.Show(!1));this.Goto(1)};this.Search=function(a){null==this._SearchHtml?(this._SearchCreate(),this._SearchDialog=new EWA.UI.Dialog.OpenWindow("about:blank","aa",400,100,!0,null,null,!1),this._SearchDialog.SetCaption(_EWA_INFO_MSG["EWA.LF.SEARCH.BUT.TITLE"]),this._SearchDialog._Dialog.AutoSize=!0,this._SearchDialog._Dialog.SetHtml(this._SearchHtml),this._SearchDialog._Dialog.Show(!0),this._SearchDialog._Dialog.GetFrame().focus(),
this._SearchDialog.MoveCenter()):(this._SearchDialog._Dialog.AutoSize=!1,this._SearchDialog.Show(!0))};this.ShowSearch=function(a){$X("EWA_SEARCH_ITEM_"+this.Id)||(this._SearchCreateItm(),a&&this.composeSearchTexts(),this._ReShowSearchQuick())};this.ChangeSearchTextType=function(a){this._MENU_DATE_RANGE&&this._MENU_DATE_RANGE.HiddenMemu();this._MENU_TEXT_TYPE.ShowByObject(a,null,0);var b=$(this._MENU_TEXT_TYPE.Dialog.GetFrame());b.find(".search-text-tag").remove();b.find('div[ewa_mg="'+$(a).attr("tag")+
'"] td:eq(0)').html('<b class="fa fa-check search-text-tag"></b>')};this.ChangeSearchDateType=function(a){this._MENU_TEXT_TYPE&&this._MENU_TEXT_TYPE.HiddenMemu();this._MENU_DATE_RANGE.ShowByObject(a,null,0)};this.ChangeSearchTextTypeIt=function(a){var b=$(this._MENU_TEXT_TYPE.SHOW_BY_OBJECT).parentsUntil(".ewa-lf-search-item").last(),d=$J2MAP(this.RESOURCES.search_text_items,"Id")[a];d="enus"==EWA.LANG?d.TxtEn:d.Txt;b.find("a").attr("tag",a).html(d);var e=b.find("input");"blk"==a||"nblk"==a?e.val(d).prop("disabled",
!0):e.prop("disabled")&&b.find("input").val("").prop("disabled",!1)};this._GetInitSearchMap=function(){var a=new EWA_UrlClass(this.Url),b={},d=a.GetParameter("ewa_search");if(!d)return b;this.Url=a.RemoveParameter("ewa_search");d=d.unURL();a=d.split(",");for(var e in a){var g=a[e],h=g.indexOf("["),k=g.indexOf("]");0>h||k<h||(d=g.substring(0,h).trim(),0!=d.length&&(h=g.substring(h+1,k).trim().toLowerCase(),0!=h.length&&(g=g.substring(k+1).trim(),""!=g&&(b[d.toUpperCase()]||(b[d.toUpperCase()]={name:d,
tag:h}),d=b[d.toUpperCase()],"lt"==h||"lte"==h?d.para2=g.unURL().replace(/\+/ig," "):d.para1=g.unURL().replace(/\+/ig," ")))))}return b};this.SearchFilterDate=function(a){var b=$(this._MENU_DATE_RANGE.SHOW_BY_OBJECT).parentsUntil(".ewa-lf-search-item").last(),d=b.find("input")[0];b=b.find("input")[1];if("Clear"==a)$(d).val(""),$(b).val("");else{var e=EWA_Utils.Date(),g="",h="";"Today"==a?h=g=e.GetDateString():"Week"==a?(a=e.GetBenWeek(),g=a[0],h=a[1]):"Today-Weekend"==a?(a=e.GetBenWeek(),g=a[e.GetDateString()],
h=a[1]):"Month"==a?(a=e.GetBenMonth(),g=a[0],h=a[1]):"Today-EOM"==a?(a=e.GetBenMonth(),g=a[e.GetDateString()],h=a[1]):"Quarter"==a?(a=e.GetBenQ(),g=a[0],h=a[1]):"Today-EOQ"==a?(a=e.GetBenQ(),g=a[e.GetDateString()],h=a[1]):"Year"==a?(a=e.GetBenYear(),g=a[0],h=a[1]):"Today-EOY"==a&&(a=e.GetBenYear(),g=a[e.GetDateString()],h=a[1]);a=EWA_Utils.Date(g).FormatDate();e=EWA_Utils.Date(h).FormatDate();e+=" 23:59:59";$(d).val(a);$(b).val(e)}};this._SearchCreateDateRange=function(){var a="_MENU_DATE_RANGE"+
this._Id;$("."+a).remove();var b="enus"==EWA.LANG.toLowerCase()?"TxtEn":"Txt",d=JSON.parse(JSON.stringify(this.RESOURCES.search_date_items)),e="EWA.F.FOS[&quot;"+this._Id+"&quot;].SearchFilterDate",g;for(g in d){var h=d[g];h.Txt=h[b];h.Cmd=e+"(&quot;"+h.Id+"&quot;)"}b="EWA.F.FOS[&quot;"+this._Id+"&quot;]._MENU_DATE_RANGE";this._MENU_DATE_RANGE=new EWA_UI_MenuClass(b);this._MENU_DATE_RANGE.Create(d);$(this._MENU_DATE_RANGE.Dialog.GetFrame()).addClass("ewa-lf-search-menu "+a);return b};this._SearchCreateTextType=
function(){var a="_MENU_TEXT_TYPE"+this._Id;$("."+a).remove();var b="enus"==EWA.LANG.toLowerCase()?"TxtEn":"Txt",d=JSON.parse(JSON.stringify(this.RESOURCES.search_text_items)),e="EWA.F.FOS[&quot;"+this._Id+"&quot;].ChangeSearchTextTypeIt",g;for(g in d){var h=d[g];h.Txt=h[b];h.Cmd=e+"(&quot;"+h.Id+"&quot;)";h.Group=h.Id}b="EWA.F.FOS[&quot;"+this._Id+"&quot;]._MENU_TEXT_TYPE";this._MENU_TEXT_TYPE=new EWA_UI_MenuClass(b);this._MENU_TEXT_TYPE.Create(d);$(this._MENU_TEXT_TYPE.Dialog.GetFrame()).addClass("ewa-lf-search-menu "+
a);this._MENU_TEXT_TYPE.clickBeforeEvent=function(k,l){$(this.Dialog.GetFrame()).find(".search-text-tag").remove();$(l).find("td:eq(0)").html('<b class="fa fa-check search-text-tag"></b>')};return b};this._SearchCreateItm=function(){var a="EWA_SEARCH_ITEM_"+this.Id,b=[],d=[],e=[],g={},h;for(h in this._SearchJson)this._SearchJson[h].ORI_NAME=h,g[h.toUpperCase()]=this._SearchJson[h];this._SearchJson=g;var k="EWA.F.FOS[&quot;"+this._Id+"&quot;].ChangeSearchTextType(this)",l="EWA.F.FOS[&quot;"+this._Id+
"&quot;].ChangeSearchDateType(this)",m=$J2MAP(this.RESOURCES.search_text_items,"Id");g=this._GetInitSearchMap();var n=!1,p=!1;for(h in this.ItemList.Items)if(null!=this._SearchJson[h]){var q=[],t=this._SearchJson[h],u=t.T,r=this._GetSubValue("DescriptionSet","Info",this.ItemList.Items[h]);q.push("<table class='ewa-lf-search-item ewa-ref-"+h+" ewa-lf-search-type-"+u+" "+("fix"==u?"ewa-lf-search-fix-m"+(t.M||"0"):"")+"' cellspacing=0 cellpadding=0>");q.push("<tr><td class='ewa-lf-search-item-title' style='position:relative'><nobr><b>");
q.push(r);var w=r="",v="lk";g[h.toUpperCase()]&&(w=g[h.toUpperCase()],v=w.tag,r=w.para1,w=w.para2);var y="";"text"==u?(p=m[v]||m.lk,y="enus"==EWA.LANG?p.TxtEn:p.Txt,q.push("<a class='ewa-lf-search-type' tag='"+v+"' href='javascript:void(0)' onclick='"+k+"'>"),q.push(y),q.push("</a>"),p=!0):"date"==u&&(q.push("<a  href='javascript:void(0)' class='fa fa-calendar-check-o'  onclick='"+l+"'></a>"),n=!0);q.push("</b></nobr></td><td class='ewa-lf-search-item-ctl'>");"text"==u?"blk"==v||"nblk"==v?(t=this._SearchSingle(h,
y),t=t.replace("<input","<input disabled "),q.push(t)):q.push(this._SearchSingle(h,r)):"date"==u?q.push(this._SearchDate(h,r,w)):"number"==u?q.push(this._SearchNumber(h,r,w)):"fix"==u&&(t="<div >"+this._SearchFix(h,t,"span",r)+"</div>",q.push(t));q.push("</td></tr></table>");"fix"==u?d.push(q.join("")):e.push(q.join(""))}if(0!=e.length+d.length){b.push('<table class="ewa-lf-search-main" id="'+a+'" cellspacing="0" cellpadding="0" style="width:100%">');b.push("<tr><td class='ewa-lf-search-des'></td><td>");
0<e.length&&b.push(" "+e.join("")+" ");if(0<d.length)for(e=0;e<d.length;e++)b.push(" "+d[e]+" ");b.push("</td></tr></table>");var x=document.createElement("div");this._SEARCH_BOX=x;x.className="ewa-lf-search";x.innerHTML=b.join("");b=$X("EWA_LF_"+this.Id).parentNode;b.parentNode.insertBefore(x,b);a="EWA_SEARCH_ITEM_"+this.Id;var z=this;n&&this._SearchCreateDateRange();p&&this._SearchCreateTextType();z._SEARCH_ITEM_EXP=this.SearchGetExp(x);"{}"!=JSON.stringify(g)&&(z._SearchExp=z._SEARCH_ITEM_EXP);
$(x).find("input[type=text]").on("compositionstart",function(){z._is_search_composition=!0}).on("compositionend",function(){z._is_search_composition=!1});this._TIMER_SEARCH=window.setInterval(function(){if(!z._is_search_composition){try{if(!$X(a)){window.clearInterval(z._TIMER_SEARCH);return}}catch(B){window.clearInterval(z._TIMER_SEARCH);return}var A=z.SearchGetExp(x);A!=z._SEARCH_ITEM_EXP&&(z._SEARCH_ITEM_EXP=A,z.DoSearch($X(a)))}},700)}};this._SearchSingle=function(a,b){var d=[];d.push('<input t="text" type="text" autocomplete="off" class="EWA_INPUT" maxlength="40" name="');
d.push(a.toInputValue());d.push('"');null!=b&&(d.push(' value="'),a=b.toInputValue(),d.push(a),d.push('" '));d.push(" />");return d.join("")};this._SearchDate=function(a,b,d){var e=[];e.push("<table border=0 cellpadding=0 cellspacing=0>");e.push('<td  ><input type="text" autocomplete="off" class="EWA_INPUT" t="date" readonly maxlength="8" onclick="EWA.UI.Calendar.Pop(this)" name="');e.push(a);e.push('"');b&&(b=b.toInputValue(),e.push(' value="'),e.push(b),e.push('"'));e.push(' /></td><td><span class="ewa-lf-search-split"> - </span></td>');
e.push('<td  ><input type="text" autocomplete="off" class="EWA_INPUT" t="date" readonly maxlength="8" onclick="EWA.UI.Calendar.Pop(this)" name="');e.push(a);e.push('1"');d&&(b=d.toInputValue(),e.push(' value="'),e.push(b),e.push('"'));e.push("/></td></tr></table>");return e.join("")};this._SearchNumber=function(a,b,d){var e=[];e.push('<input type="text" t="number" size="10" name="');e.push(a);e.push('"');b&&(b*=1,e.push(' value="'),e.push(b),e.push('"'));e.push(' /><span class="ewa-lf-search-split"> - </span>');
e.push('<input type="text" t="number" size="10" name="');e.push(a);e.push('1"');d&&(b=1*d,e.push(' value="'),e.push(b),e.push('"'));e.push("/>");return e.join("")};this._SearchFix=function(a,b,d,e){var g=[],h="radio";if("1"==b.M)h="checkbox";else if("2"==b.M)return this._SearchFix1(a,b,d,e);d="<"+d+"><nobr><input t='fix' [@CHK] id='@ID' value=\"@V\" type='"+h+"' name='"+a+"' /><label for='@ID'>@T</label></nobr></"+d+"> ";h={};if(e){e=e.split(";");for(var k in e)h[e[k].trim().toUpperCase()]=1}for(k=
0;k<b.D.length;k++){var l=b.D[k];e=l[0];l=l[1];var m=this.Id+"_"+a+"_SearchFix_"+k,n=d.replace("@ID",m);n=n.replace("@ID",m);n=n.replace("@V",e);n=h[e.toUpperCase().trim()]?n.replace("[@CHK]","checked"):n.replace("[@CHK]","");n=n.replace("@T",l);g.push(n)}return g.join("")};this._SearchFix1=function(a,b,d,e){d=[];d.push("<select t='fix' name='"+a+"'><option></option>");for(var g=0;g<b.D.length;g++){var h=b.D[g],k="<option @CKD t='fix' id='@ID' value=\"@V\">@T</option> ".replace("@ID",this.Id+"_"+
a+"_SearchFix_"+g);k=k.replace("@V",h[0]);k=k.replace("@T",h[1]);k=e&&h[0]==e?k.replace("@CKD","selected"):k.replace("@CKD","");d.push(k)}d.push("</select>");return d.join("")};this._SearchCreate=function(){var a=[];a.push("<div><table border=0 style='margin:0px;' class=EWA_TABLE cellspacing=1>");for(var b in this.ItemList.Items)if(null!=this._SearchJson[b]){var d=this._SearchJson[b],e=d.T,g=this._GetSubValue("DescriptionSet","Info",this.ItemList.Items[b]);a.push("<tr><td class=EWA_TD_L width=140><nobr>"+
g+"<nobr></td><td width=350 class=EWA_TD_M>");"text"==e?a.push(this._SearchSingle(b)):"date"==e?a.push(this._SearchDate(b)):"number"==e?a.push(this._SearchNumber(b)):"fix"==e&&a.push(this._SearchFix(b,d,"div"));a.push("</td></tr>")}a.push("<tr><td class=EWA_TD_B colspan=2 align=right><input onclick='EWA.F.FOS[\""+this._Id+"\"].SearchClear(this);' type=button value='"+_EWA_INFO_MSG["EWA.LF.SEARCH.BUT.CLEAR"]+"'> <input type=submit value='"+_EWA_INFO_MSG["EWA.LF.SEARCH.BUT.SEARCH"]+"' onclick='EWA.F.FOS[\""+
this._Id+"\"].DoSearch(this);'> <input type=button value='"+_EWA_INFO_MSG["EWA.LF.SEARCH.BUT.CLOSE"]+"' onclick='EWA.F.FOS[\""+this.Id+"\"]._SearchDialog.Show(false);'></td></tr>");a.push("</table></div>");this._SearchHtml=a.join("")};this.SearchMark=function(){for(var a=this._SearchExp.split("@!@"),b=$X("EWA_LF_"+this._Id),d=0;d<a.length;d+=1){var e=a[d].split("~!~");if(!(3>e.length))for(var g=2;g<e.length;g++){var h=e[g];if(""!=h){if("fix"==e[1]){var k=e[2];$("table#EWA_SEARCH_ITEM_"+this.Id+' [name="'+
e[0]+'"]').find("option").each(function(){this.value==k&&(h=this.text)})}for(var l=[],m=0;m<h.length;m++){var n=h[m];"a"<=n&&"z">=n||"A"<=n&&"Z">=n||"0"<=n&&"9">=n?l.push(n):l.push("\\"+n)}h=l.join("");h=eval("/("+h+")/ig");l=e[0].split(",");for(var p in l){m=l[p];this._SearchJson[m]&&(m=this._SearchJson[m].ORI_NAME);m=$(b).find(".ewa-lf-data-row .ewa-col-"+m).not("[ewa-search-marked=yes]");m.attr("ewa-search-marked","yes");try{m.find("*").each(function(){0==this.children.length&&(this.innerHTML=
this.innerHTML.replace(h,"<font color=red><b>$1</b></font>"))})}catch(q){console.log(q)}}}}}};this.DblClick=function(a){this._IsDblClick=a;for(var b=$X("EWA_LF_"+this._Id),d=1;d<b.rows.length;d++)b.rows[d].ondblclick=function(){var e=this.getElementsByTagName("input");e.length>a&&0==e[a].disabled&&e[a].click()}};this.Init=function(a){this.Xml=new EWA.C.Xml;this.Xml.LoadXml(a);this.ItemList.Init(this.Xml);this.Resources=new EWA_FrameResoures;this.Resources.Init(this.Xml);if((a=$X("EWA_LF_"+this._Id))&&
"table"==a.tagName&&!(1>=a.rows.length)){a=a.rows[1].getElementsByTagName("input");for(var b=0;b<a.length;b++)if("RADIO"==a[b].type.toUpperCase()){this._TrSelectMulti=!1;break}}};this.SetPageParameters=function(a,b,d,e,g){this._PageCurrent=a;this._PageSize=d;this._PageCount=b;this._RecordCount=e;this._Sort=g};this.SetPageParametersName=function(a,b,d,e,g){this._PageCurrentName=a;this._PageSizeName=d;this._PageCountName=b;this._RecordCountName=e;this._SortName=g};this.CheckedAll=function(){var a=document.getElementById("EWA_LF_"+
this._Id);if(!(1>=a.rows.length)){for(var b=0;b<a.rows.length;b+=1){var d=a.rows[b].getElementsByTagName("input");0!=d.length&&(d[0].checked=this._IsCheckedAll)}this._IsCheckedAll=this._IsCheckedAll?!1:!0;this.CheckedAllAfter&&this.CheckedAllAfter(a)}};this.SelectChecked=function(){var a=$X("EWA_LF_"+this._Id);if(!a||1>a.rows.length)return"";var b=[],d=$F(a,"input","type","radio,checkbox");if(0<d.length)for(var e=0;e<d.length;e++)d[e].checked&&b.push(d[e].value);else for(e=0;e<a.rows.length;e++)d=
a.rows[e],1==d.getAttribute("__ewa_lf_mdown")&&b.push(d.getAttribute("EWA_KEY"));return b.join(",")};this.SelectCheckedInputs=function(){var a=[],b=$X("EWA_LF_"+this._Id);if(1>b.rows.length)return a;b=b.getElementsByTagName("input");a=[];for(var d=0;d<b.length;d++)("CHECKBOX"==b[d].type.toUpperCase()||"RADIO"==b[d].type.toUpperCase())&&b[d].checked&&a.push(b[d]);return a};this.SelectCheckedRows=function(){for(var a=[],b=$X("EWA_LF_"+this._Id),d=0;d<b.rows.length;d++){var e=b.rows[d],g=e.getElementsByTagName("input");
0!=g.length&&g[0].checked&&-1==g[0].parentNode.className.indexOf("ewa-switch")&&a.push(e)}if(0==a.length)for(d=0;d<b.rows.length;d++)e=b.rows[d],1==e.getAttribute("__ewa_lf_mdown")&&a.push(e);return a};this.Reload=function(a){this.StopAjaxAfterReload?this.StopAjaxAfterReload=!1:this.Goto(this._PageCurrent,a)};this.refreshPage=function(a,b){this.replaceRowsData(null,null,a,b)};this.replaceRowsData=function(a,b,d,e){var g=this.getUrlClass();g.AddParameter("EWA_AJAX","LF_RELOAD");g.AddParameter("EWA_IS_SPLIT_PAGE",
"no");g.AddParameter("EWA_IS_HIDDEN_CAPTION","yes");g=g.GetUrl();a&&(g+="&"+a);var h=a?new EWA_AjaxClass:this.CreateAjax(),k=this;h.PostNew(g,function(){if(4==h._Http.readyState){h.HiddenWaitting();var l=h._Http.responseText;200!=h._Http.status?(console.error(l),alert("ERROR:\r\n"+h._Http.statusText)):EWA.F.CheckCallBack(l)?k.replaceRowsWithDataHtml(l,b,d,e):console.error(l)}})};this.replaceRowsWithDataHtml=function(a,b,d,e){var g=$("<div></div>");g.html(a);var h=[],k=$("#EWA_LF_"+this._Id);g.find(".ewa-lf-data-row").each(function(){var l=
'tr[ewa_key="'+$(this).attr("ewa_key")+'"]',m=k.find(l);if(0==m.length)console.warn(l+" not found");else{l=$(this).attr("ewa_row_sign");var n=m.attr("ewa_row_sign"),p=!0;(l||n)&&n===l&&(p=!1);if(p){m.attr("ewa_row_sign",l);l=m.clone()[0];for(n=0;n<this.cells.length;n++){p=m[0].cells[n];var q=this.cells[n];p.removeAttribute("ewa-merged");p.removeAttribute("ewa-search-marked");b?b(q,p):p.innerHTML=q.innerHTML}h.push({before:l,current:m[0]})}}});g.remove();this.SearchMark();this.IsReShow&&this.ReShowWithNoButtons();
this._ReShowSearchQuick();null!=this._IsDblClick&&this.DblClick(c._IsDblClick);this.SubBottomsArray&&this._SubBottoms();this.ReloadAfter&&this.ReloadAfter(d);this.ReloadAfterApp&&this.ReloadAfterApp(d);e&&e(h)};this.DoAction=function(a,b,d,e,g,h){EWA.F.CID=this._Id;if(b){if(a&&$(a).parent().hasClass("scroll-delete")){var k=$(a).attr("do-action-time")||0,l=(new Date).getTime();if(1E3>l-k)return;$(a).attr("do-action-time",l)}this.lastAction=b;this._Ajax=new EWA_AjaxClass;this._Ajax.LoadingType="image";
this._Ajax.AddParameter("EWA_AJAX","1");this._Ajax.AddParameter("EWA_ACTION",b);this._Ajax.AddParameter("EWA_ID",this._Id);this._Ajax.AddParameter("EWA_NO_CONTENT","1");this._Ajax.AddParameter("EWA_ACTION_TIP",e);null!=h&&0<h.trim().length?(this._Ajax.AddParameter("EWA_AFTER_EVENT",h),this.StopAjaxAfterReload=!0,this._Ajax.AddParameter("EWA_ACTION_RELOAD","0")):this.StopAjaxAfterReload=!1;if(a&&a.getAttribute&&"yes"==a.getAttribute("box_menu_item")){if(this._Ajax.AddParameter("___CALL__FROM__","box"),
a=a.parentNode)a=a.getAttribute("json_ref"),a=JSON.parse(a),a.EWA_KEY&&this._Ajax.AddParameter("EWA_ACTION_KEY",a.EWA_KEY)}else(a=this.GetRowKey(a))&&this._Ajax.AddParameter("EWA_ACTION_KEY",a);a=this.SelectChecked();this._Ajax.AddParameter("IDS_SPLIT",a);if(null!=g&&0<g.length)for(a=0;a<g.length;a+=1)this._Ajax.AddParameter(g[a].Name,g[a].Value);g=new EWA.C.Url;g.SetUrl(this.Url);var m=g.RemoveParameter("EWA_ACTION"),n=this;d?((g=_EWA_INFO_MSG[d])||(g=d),$Confirm(g,"Confirm",function(){n._Ajax.PostNew(m,
function(){n._CallBackJs()})})):this._Ajax.PostNew(m,function(){n._CallBackJs()})}};this.NewPageSize=function(a){this._PageSize!=a&&(this._PageSize=a,this.Goto(1))};this.Goto=function(a,b){EWA.F.CID=this._Id;this._PageCurrent=a;this._Ajax=this.CreateAjax();a=new EWA_UrlClass;a.SetUrl(null==this.Url?document.location.href:this.Url);a.RemoveParameter("EWA_AJAX");var d=this;this._Ajax.PostNew(a.GetUrl(),function(){d._CallBack(b)});this.REPLACE_HISTORY_STATE&&this.replaceHistoryState()};this.createReplaceHistoryStateUrl=
function(){var a=new EWA_UrlClass;a.SetUrl(null==this.Url?document.location.href:this.Url);a.AddParameter(this._PageCurrentName,this._PageCurrent);this._PageSize&&a.AddParameter(this._PageSizeName,this._PageSize);null!=this._Sort&&a.AddParameter(this._SortName,this._Sort);var b=this.SearchGetExpInit();b&&a.AddParameter("EWA_SEARCH",b);if(null!=this.GotoParas&&0<this.GotoParas.length)for(b=0;b<this.GotoParas.length;b+=1)a.AddParameter(this.GotoParas[b].Name,this.GotoParas[b].Value);a.RemoveParameter("EWA_AJAX");
return a};this.replaceHistoryState=function(){var a=this.createReplaceHistoryStateUrl();window.history.replaceState("",null,a.GetUrl())};this.CreateAjax=function(){var a=new EWA.C.Ajax;a.LoadingType="image";a.AddParameter(this._PageCurrentName,this._PageCurrent);this._PageSize&&a.AddParameter(this._PageSizeName,this._PageSize);null!=this._Sort&&a.AddParameter(this._SortName,this._Sort);null!=this._SearchExp&&""!=this._SearchExp&&a.AddParameter("EWA_LF_SEARCH",this._SearchExp);a.AddParameter("EWA_AJAX",
"LF_RELOAD");if(null!=this.GotoParas&&0<this.GotoParas.length)for(var b=0;b<this.GotoParas.length;b+=1)a.AddParameter(this.GotoParas[b].Name,this.GotoParas[b].Value);return a};this.DownlodData=function(a,b){EWA.F.CID=this._Id;this._Ajax=new EWA.C.Ajax;this._Ajax.LoadingType="image";null!=this._Sort&&this._Ajax.AddParameter(this._SortName,this._Sort);null!=this._SearchExp&&""!=this._SearchExp&&this._Ajax.AddParameter("EWA_LF_SEARCH",this._SearchExp);this._Ajax.AddParameter("EWA_AJAX","DOWN_DATA");
this._Ajax.AddParameter("EWA_AJAX_DOWN_TYPE",a);b&&this._Ajax.AddParameter("EWA_ACTION",b);if(null!=this.GotoParas&&0<this.GotoParas.length)for(a=0;a<this.GotoParas.length;a+=1)this._Ajax.AddParameter(this.GotoParas[a].Name,this.GotoParas[a].Value);this._AjaxType="DOWN_DATA";a=new EWA_UrlClass;a.SetUrl(null==this.Url?document.location.href:this.Url);var d=this;this._Ajax.PostNew(a.GetUrl(),function(){d._CallBack()})};this.Get=function(a){EWA.F.CID=this._Id;this._Ajax=new EWA.C.Ajax;this._Ajax.LoadingType=
"image";var b=this;this._Ajax.Get(a,function(){b._CallBack()})};this.Post=function(a,b){EWA.F.CID=this._Id;this._Ajax=new EWA.C.Ajax;this._Ajax.LoadingType="image";var d=this;this._Ajax.Post(a,b,function(){d._CallBackJs()})};this._CallBack=function(a){var b=this._Ajax;if(4==b._Http.readyState){b.HiddenWaitting();if(top.EWA&&top.EWA.MQE){var d=new EWA_MqeClass;d.Data=b.GetRst();d.FromId=EWA.F.CID;d.Type="POST";top.EWA.MQE.AddMqe(d)}200==b._Http.status?(b=b._Http.responseText,EWA.F.CheckCallBack(b)&&
("DOWN_DATA"==this._AjaxType?(this._AjaxType=null,"DENY"==b.trim()?alert(_EWA_INFO_MSG["EWA.LF.DOWN_DATA.DENY"]):window.location.href=b.trim()):(d=$X("EWA_LF_"+this._Id).parentNode,$(d).replaceWith(b),this.SearchMark(),this.IsReShow&&this.ReShowWithNoButtons(),this._ReShowSearchQuick(),null!=this._IsDblClick&&this.DblClick(this._IsDblClick),this._IsAddPreRow&&this.AddPreRow(),this.SubBottomsArray&&this._SubBottoms(),this.ReloadAfter&&this.ReloadAfter(a),this.ReloadAfterApp&&this.ReloadAfterApp(a)))):
alert("ERROR:\r\n"+b._Http.statusText);this.RewriteInfo()}};this._CallBackJs=function(){var a=this._Ajax;if(4==a._Http.readyState){if(top.EWA&&top.EWA.MQE){var b=new EWA_MqeClass;b.Data=a.GetRst();b.FromId=EWA.F.CID;b.Type="POST";top.EWA.MQE.AddMqe(b)}a.HiddenWaitting();200==a._Http.status?(a=a._Http.responseText,EWA.F.CheckCallBack(a)&&eval(a)):alert("ERROR:\r\n"+a._Http.statusText);this.EditAfterEvent&&this.EditAfterEvent()}};this.EditAfterEvent=function(){};this._GetItem=function(a){for(var b=
this.ItemList,d=0;d<b.length;d+=1){var e=b[d],g=this._GetSubItem("Name",e);if(this.Xml.GetElementAttribute(g,"Name")==a)return e}};this._GetSubItem=function(a,b){b=this.Xml.GetElements(a+"/Set",b);if(null==b||0==b.length)return null;if("DescriptionSet"==a)for(a=0;a<b.length;a+=1){var d=b[a].getAttribute("Lang");if(null!=d&&d.trim().toUpperCase()==EWA.LANG.trim().toUpperCase())return b[a]}return b[0]};this._GetSubValue=function(a,b,d){a=this._GetSubItem(a,d);return null==a?null:this.Xml.GetElementAttribute(a,
b)};this.AddColumns=function(a,b,d,e,g,h,k,l){var m=$X("EWA_LF_"+this._Id);null==l&&(l=m.rows[0].cells.length);for(var n=0;n<a.length;n++)for(var p=a[n],q=l+n,t=0;t<m.rows.length;t++){var u=m.rows[t].insertCell(q);if(0==t)u.className="EWA_TD_H",u.innerHTML='<nobr cellIdx="'+q+'" id="'+p[b]+'">'+p[d]+"</nobr>",u.title=p[e],u.width=100;else{var r=m.rows[t].getAttribute("EWA_KEY");u.className="EWA_TD_M";r=r+"_"+p[b];var w=this._GetAddControl(p[h]);null==w&&(w=g);var v=k.replace("[ID]",p[b]);w=0<=w.indexOf("<select")?
w.replace("!!",v.replace("onblur=","onchange=")):w.replace("!!",v);u.innerHTML=w;u.childNodes[0].id=r}}};this._GetAddControl=function(a){if(null==a)return null;a=a.toUpperCase().trim();return"SELECT"==a?"<select !!></select>":"DATE"==a?'<input type=text class=EWA_INPUT onclick="EWA.UI.Calendar.Pop(this,false);" readonly !!>':"TIME"==a?'<input type=text class=EWA_INPUT onclick="EWA.UI.Calendar.Pop(this,true);" readonly !!>':"STRING"==a||"NUMBER"==a?"<input type=text class=EWA_INPUT !!>":null};this.AddedValues=
function(a,b,d,e,g){for(var h=0;h<a.length;h++){var k=a[h],l=$X(k[b]+"_"+k[d]);if(!l)break;var m=l.tagName.toUpperCase();"INPUT"==m||"SELECT"==m||"TEXTAREA"==m?l.value=k[e]:l.innerHTML=k[e];g&&(this.GetRow(l).getElementsByTagName("input")[0].checked=!0)}};this.AddRow=function(a){for(var b=$X("EWA_LF_"+this._Id),d=b.insertRow(-1),e=0;e<b.rows[0].cells.length;e++){var g=d.insertCell(-1),h=b.rows[0].cells[e];g.className="EWA_TD_M";null!=a[e]&&(g.innerHTML=a[e]);g.style.display=h.style.display;g.id="ADD_ROW_"+
h.childNodes[0].id}return d};this.Calc=function(a,b,d,e){for(var g=$X("EWA_LF_"+this._Id),h={},k=0;k<a.length;k++)h[a[k]]=0;for(k=b;k<d;k++)for(a=g.rows[k],b=0;b<a.cells.length;b++)if(null!=h[b]){var l=a.cells[b],m=l.getElementsByTagName("input");0<m.length?h[b]+=1*m[0].value:(l=GetInnerText(l),""==l&&(l=0),h[b]+=1*l)}d=g.rows[e];for(k=0;k<d.cells.length;k++)null!=h[k]&&(l=Math.round(100*h[k])/100,e=GetInnerText(d.cells[k]),l!=1*e&&(this.IsCalcChanged=!0),d.cells[k].innerHTML=l.fm())};this.mergeHeaders=
function(a,b,d){var e=$($X("EWA_LF_"+this._Id)),g=e.find('tr[ewa_tag="HEADER"]');if(0!=g.length&&(a=g.find('nobr[id="'+a+'"]').parent(),0!=a.length)){var h=e.find("tr[ewa_mearge]");0==h.length&&(h=$(e[0].insertRow(1)),h.attr("ewa_mearge","gdx"));e=-1;for(var k=0;k<g[0].cells.length;k++){var l=g[0].cells[k];l==a[0]&&(e=k,l.colSpan=d);if(-1==e)"1"!=$(l).attr("ewa_tdmearged")&&(l.rowSpan=2);else if(e+d==k)e=-1,l.rowSpan=2;else{l.rowSpan=1;var m=h[0].insertCell(-1);m.innerHTML=l.innerHTML;m.className=
l.className;m.style.cssText=l.style.cssText;l.style.display="none";$(l).attr("ewa_tdmearged",1)}l==a[0]&&(l.innerHTML=b,l.style.display="",l.style.width="")}}};this.MeargeHeader=function(a,b,d){console.log("\u62fc\u5199\u9519\u8bef\uff0c\u8bf7\u7528 mergeHeaders");this.mergeHeaders(a,b,d)};this.getUrlClass=function(){var a=new EWA_UrlClass;a.SetUrl(this.Url);return a}}
EWA_ListFrameClass.prototype.RESOURCES={search_text_items:[{Id:"lk",Txt:"\u5305\u542b",TxtEn:"Like"},{Id:"llk",Txt:"\u5de6\u5305\u542b",TxtEn:"Left like"},{Id:"rlk",Txt:"\u53f3\u5305\u542b",TxtEn:"Right like"},{Id:"eq",Txt:"\u7b49\u4e8e",TxtEn:"Equals"},{Id:"uneq",Txt:"\u4e0d\u7b49\u4e8e",TxtEn:"Not equals"},{Id:"nlk",Txt:"\u4e0d\u5305\u542b",TxtEn:"Not contains"},{Id:"blk",Txt:"\u7a7a\u767d",TxtEn:"Blank"},{Id:"nblk",Txt:"\u975e\u7a7a\u767d",TxtEn:"Not blank"}],search_date_items:[{Id:"Clear",Txt:"\u6e05\u7a7a",
TxtEn:"Clear",Img:"fa fa-eraser"},{Id:"Today",Txt:"\u4eca\u5929",TxtEn:"Today"},{Id:"Week",Txt:"\u672c\u5468",TxtEn:"Week"},{Id:"Today-Weekend",Txt:"\u4eca\u5929\u81f3\u5468\u65e5",TxtEn:"Today-Weekend"},{Id:"Month",Txt:"\u672c\u6708",TxtEn:"This Month"},{Id:"Today-EOM",Txt:"\u4eca\u5929\u81f3\u6708\u5e95",TxtEn:"Today-EOM"},{Id:"Quarter",Txt:"\u672c\u5b63\u5ea6",TxtEn:"This Quarter"},{Id:"Today-EOQ",Txt:"\u4eca\u5929\u81f3\u5b63\u672b",TxtEn:"Today-EOQ"},{Id:"Year",Txt:"\u672c\u5e74\u5ea6",TxtEn:"This Year"},
{Id:"Today-EOY",Txt:"\u4eca\u5929\u81f3\u5e74\u5e95",TxtEn:"Today-EOY"}]};EWA.F.L={CUR:null,C:EWA_ListFrameClass};
function EWA_ListFrame_CellResizeClass(a){this._Name=a;this._Cover=this._Table=null;this._CellResize=[];this.Init=function(b){this._Table=b;this._Table.style.tableLayout="fixed";this._Table.style.width=this._Table.clientWidth+"px";this._Cover=this._CreateElement("div","width:100%; height:100%;background-color:blue; position:absolute; top:0px; left:0px; display:block; filter:alpha(opacity=0);opacity:0",document.body);for(b=0;b<this._Table.rows[0].cells.length-1;b++)this._CreateMarker(b);this._SetLocation()};
this._ShowCover=function(b){this._Cover.style.display=b?"block":"none"};this._EventX=function(b){return b.x?b.x:b.pageX};this._OnMouseDown=function(b,d){this._ShowCover(!0);b.childNodes[0].style.borderLeft="1px solid black";b.setAttribute("D",1);d=d?d:event;var e=this._EventX(d);b.setAttribute("X",e);b.setAttribute("SX",e);"undefined"!=typeof d.preventDefault&&d.preventDefault();"undefined"!=typeof d.stopPropagation?d.stopPropagation():d.cancelBubble=!0};this._OnMouseUp=function(b,d){b.childNodes[0].style.borderLeft=
"1px";b.setAttribute("D",0);d=d?d:event;var e=this._EventX(d)-1*b.getAttribute("SX");b=b.getAttribute("TDINDEX");b=this._Table.rows[0].cells[b];e=b.clientWidth+e;b.style.width=4>e?4:e+"px";this._SetLocation();"undefined"!=typeof d.preventDefault&&d.preventDefault();"undefined"!=typeof d.stopPropagation?d.stopPropagation():d.cancelBubble=!0};this._OnMouseOut=function(b,d){"1"==b.getAttribute("D")&&(b.style.left=b.getAttribute("SX")+"px",b.setAttribute("D",0),this._SetLocation(),b.childNodes[0].style.borderLeft=
"1px");this._ShowCover(!1)};this._OnMouseMove=function(b,d){this._ShowCover(!0);if("1"==b.getAttribute("D")){d=d?d:event;var e=this._EventX(d),g=1*b.getAttribute("X");g=e-g;b.style.left=1*b.style.left.replace("px","")+g+"px";b.setAttribute("X",e);"undefined"!=typeof d.preventDefault&&d.preventDefault();"undefined"!=typeof d.stopPropagation?d.stopPropagation():d.cancelBubble=!0}};this._CreateMarker=function(b){var d=this._CreateElement("div","width:40px; height:"+this._Table.clientHeight+"px; position:absolute;cursor:e-resize",
document.body);d.setAttribute("TDINDEX",b);d.setAttribute("instanceName",a);d.onmouseover=function(){var e=this.getAttribute("instanceName");eval("window."+e)._ShowCover(!0)};d.onmousedown=function(e){var g=this.getAttribute("instanceName");eval("window."+g)._OnMouseDown(this,e)};d.onmouseup=function(e){var g=this.getAttribute("instanceName");eval("window."+g)._OnMouseUp(this,e)};d.onmouseout=function(e){var g=this.getAttribute("instanceName");eval("window."+g)._OnMouseOut(this,e)};d.onmousemove=
function(e){var g=this.getAttribute("instanceName");eval("window."+g)._OnMouseMove(this,e)};this._CreateElement("div","width:1px;height:100%;position:absolute;top:0px;left:20px;border-Left:1px ;",d);this._CellResize[b]=d;d=null};this._SetLocation=function(){for(var b=0;b<this._Table.rows[0].cells.length-1;b++){var d=this._Table.rows[0].cells[b],e=this._Location(d);""!=d.style.width&&(d.style.width=d.clientWidth+"px");this._CellResize[b].style.left=e[0]+d.clientWidth-this._CellResize[b].clientWidth/
2+"px";this._CellResize[b].style.top=e[1]+"px"}};this._CreateElement=function(b,d,e){b=document.createElement(b);null!=d&&(b.style.cssText=d,b.setAttribute("style",d));null!=e&&e.appendChild(b);return b};this._Location=function(b){var d;var e=d=0;do e+=b.offsetLeft,d+=b.offsetTop,b=b.offsetParent;while("BODY"!=b.tagName);return[e,d]}}
function EWA_ListFrame_ShowHideColumns(a){this._name=a;this.storageId=this.frameUnid="";this.inited=!1;this.notHideColsArr=[];this.defHideCols="";this.readme="\u5408\u5e76\u5217\u548c\u8bbe\u7f6e\u5b8c\u521d\u59cb\u67e5\u8be2\u6761\u4ef6\u540e\uff0c\u518d\u6267\u884cinit\u3002 \u53c2\u6570\u8bf4\u660e\uff1aSYS_FRAME_UNID;\u4e0d\u9690\u85cf\u7684\u5217\uff08\u9017\u53f7\u5206\u9694\uff09\uff0c\u590d\u9009\u5217\u4e0d\u9690\u85cf defHideCols \u9ed8\u8ba4\u9690\u85cf\u7684\u5217";this.wrap="";this.setWrap=
function(b){this.wrap="#"+b};this.initPart=function(b,d,e){if(0<$(".grp-part").length){var g=$("#EWA_LF_"+b).parentsUntil(".grp-part").parent().attr("id");this.setWrap(g)}this.init(b,d,e);g&&$("#"+g+" .but-shc-gear b.fa-gear").css({"line-height":"100%","font-size":"14px"})};this.init=function(b,d,e){if(!this.inited){var g=this;this.frameUnid=b;this.wrap||(this.wrap="#"+b+"_RESHOW");this.defHideCols=e;this.storageId="LF_HIDE_COLS_"+this.frameUnid;d&&(this.notHideColsArr=d.split(","));e&&!window.localStorage.hasOwnProperty(this.storageId)&&
(window.localStorage[this.storageId]=e);d=$(this.wrap+" .ewa_lf_func_caption").parent();var h=!1;0===d.find(".but-shc-gear").length&&(h=!0,d.append('<div class="ewa_lf_func_dact ewa-lf-func-recycle but-shc-gear"><b class="fa fa-gear"  style="font-size: 16px;line-height: 30px;"></b></div>'),d.find(".but-shc-gear").on("click",function(){g.togglePanel()}));if(e=window.localStorage[this.storageId]){if(e=e.split(","),!h)for(h=0;h<e.length;h++)$("#EWA_LF_"+b+" .ewa-col-"+e[h]+".EWA_TD_H:hidden").show()}else e=
[];var k=[];$("#EWA_LF_"+b+" .EWA_TD_H:not(:hidden)").each(function(){if(0===$(this).find("a[href*='CheckedAll']").length){var l=$(this).find("nobr").attr("id"),m=$(this).text();k.push({id:l,name:m})}});if(0===k.length){this.hideCols();return}b=[];b.push("<div class='custom-cols-panel-box' data-fid=\""+this.frameUnid+'">');h="";h="enus"==EWA.LANG.toLowerCase()?"Show/Hide&nbsp;&nbsp;<a href='javascript:void(0)' class='but-default'>Default</a>":"\u663e\u793a/\u9690\u85cf\u5217&nbsp;&nbsp;<a href='javascript:void(0)' class='but-default'>\u9ed8\u8ba4</a>";
b.push("<div class='custom-cols-header'>"+(h+"<b class='fa fa-close but-close'></b></div>"));b.push("<div class='custom-cols-contain'>");b.push("<ul>");for(h=0;h<k.length;h++)b.push("<li><input type='checkbox' checked  value='"+k[h].id+"' id='custom_cols_id_"+k[h].id+"'><label for='custom_cols_id_"+k[h].id+"'>"+k[h].name.replace(/>/ig,"&gt")+"</label></li>");b.push("</ul>");b.push("</div>");b.push("</div>");d.append(b.join(""));d.find(".but-default").on("click",function(){g.setDefault()});d.find(".but-close").on("click",
function(){g.togglePanel()});d.find("li input[type=checkbox]").on("click",function(){g.setCol(this.value)});if(0<e.length)for(h=0;h<e.length;h++)0<$(this.wrap+" .custom-cols-panel-box input[value='"+e[h]+"']").length?$(this.wrap+" .custom-cols-panel-box input[value='"+e[h]+"']")[0].checked=!1:this.setCol(e[h]);if(0<this.notHideColsArr.length)for(h=0;h<this.notHideColsArr.length;h++)b=this.notHideColsArr[h],d=$(this.wrap+" .custom-cols-panel-box input[value='"+b+"']"),0<d.length&&(d.parent().addClass("not-hide-col"),
d[0].checked||(this.setCol(b),d[0].checked=!0),d[0].disabled=!0);this.inited=!0}this.hideCols()};this.adjustPanel=function(){var b=window.innerHeight-80;$(this.wrap+" .custom-cols-contain").height();$(this.wrap+" .but-shc-gear").offset();var d=window.innerWidth,e=$(this.wrap+" .custom-cols-panel-box").width();d=(d-e)/2;$(this.wrap+" .custom-cols-contain").css({"max-height":b});$(this.wrap+" .custom-cols-panel-box").css({right:d,top:"0"})};this.togglePanel=function(){this.inited||this.init(this.frameUnid);
$('.custom-cols-panel-box[data-fid!="'+this.frameUnid+'"]').hide();$(this.wrap+" .custom-cols-panel-box").toggle();$(this.wrap+" .custom-cols-panel-box").is("hide")||this.adjustPanel()};this.hideCols=function(){var b=window.localStorage[this.storageId];if(b){b=b.split(",");for(var d=0;d<b.length;d++)this.hide(b[d])}};this.show=function(b){$("#EWA_LF_"+this.frameUnid+" .ewa-col-"+b).show();$("#EWA_SEARCH_ITEM_"+this.frameUnid+" .ewa-lf-search-item [name='"+b+"']").parentsUntil(".ewa-lf-search-item").last().parent().show();
$("#EWA_LF_"+this.frameUnid+" #ADD_ROW_"+b).show();$("#EWA_LF_"+this.frameUnid+" #INS_ROW_"+b).show()};this.hide=function(b){var d=$("#EWA_SEARCH_ITEM_"+this.frameUnid+" .ewa-lf-search-item [name='"+b+"']").parentsUntil(".ewa-lf-search-item").last().parent();d.find("select").val("");d.find("input[type=text]").val("");d.find("input:checked").each(function(){this.checked=!1});$("#EWA_LF_"+this.frameUnid+" .ewa-col-"+b).hide();d.hide();$("#EWA_LF_"+this.frameUnid+" #ADD_ROW_"+b).hide();$("#EWA_LF_"+
this.frameUnid+" #INS_ROW_"+b).hide()};this.setCol=function(b){this.frameUnid||$Tip("not init");if(!(0<$("#EWA_LF_"+this.frameUnid+" .ewa-col-"+b+" a[href*='CheckedAll']").length)){var d=window.localStorage[this.storageId];if(d){d=d.split(",");for(var e=[],g=0;g<d.length;g++)b==d[g]?this.show(b):e.push(d[g]);d.length==e.length&&(e.push(b),this.hide(b));window.localStorage[this.storageId]=e.join(",")}else window.localStorage[this.storageId]=b,this.hide(b)}};this.setDefault=function(){this.togglePanel();
window.localStorage[this.storageId]=this.defHideCols;for(var b=$(this.wrap+" .custom-cols-panel-box input"),d=0;d<b.length;d++)b[d].checked=!0;if(this.defHideCols)for(b=this.defHideCols.split(","),d=0;d<b.length;d++)0<$(this.wrap+" .custom-cols-panel-box input[value='"+b[d]+"']").length?$(this.wrap+" .custom-cols-panel-box input[value='"+b[d]+"']")[0].checked=!1:this.setCol(b[d]);EWA.F.FOS[this.frameUnid].Reload()}}
function EWA_MultiGridClass(a,b){this.ClassName=a;this.Url=b;this._Id=this.TransParent=null;this.Resources={};this.Init=function(d){this.Xml=new EWA.C.Xml;this.Xml.LoadXml(d);this.Resources=new EWA_FrameResoures;this.Resources.Init(this.Xml)};this.CollapseCol=function(d,e){var g="",h=e.parentNode;null==h.getAttribute("expand")||1==h.getAttribute("expand")?(h.setAttribute("expand",0),e.innerHTML="+",g="none",h.setAttribute("col_span",h.colSpan),h.colSpan=1,h.style.fontStyle="italic",h.style.color=
"blue"):(h.setAttribute("expand",1),e.innerHTML="-",h.colSpan=h.getAttribute("col_span"),h.style.fontStyle="",h.style.color="#000");var k=document.getElementsByTagName(d);d=[];var l=[];for(e=0;e<k.length;e++){var m=k[e],n=m.parentNode.parentNode.rowIndex;null==d[n]&&(d[n]=[]);m=m.parentNode;d[n].push(m);"none"==g&&"none"==m.style.display&&l.push(m.id)}if("none"==g)h.setAttribute("ids","["+l.join("][")+"]");else{var p=h.getAttribute("ids");p=null==p?"":p}for(e=0;e<d.length;e++)if(null!=d[e]){for(k=
h=0;k<d[e].length;k++)l=d[e][k],h+=1*l.getAttribute("val"),n="["+l.id+"]",0<k&&(""==g?0>p.indexOf(n)&&(l.style.display=g):l.style.display=g);l=d[e][0];""==g?(n="["+l.id+"]",0>p.indexOf(n)&&(l.childNodes[0].innerHTML=l.getAttribute("val"),l.style.fontStyle="",l.style.color="#000")):(l.childNodes[0].innerHTML="EWA_GRID_H"==l.className?l.childNodes[0].innerHTML+"...":h,l.style.fontStyle="italic",l.style.color="blue")}};this.Trans=function(){var d=new EWA_UrlClass;d.SetUrl(this.Url);0<this.Url.indexOf("&EWA_GRID_TRANS=")?
d.RemoveParameter("EWA_GRID_TRANS"):d.AddParameter("EWA_GRID_TRANS","1");this.TransParent=$X("EWA_MG_"+this._Id).parentNode;this.Url=d.GetUrl();this._DoTrans(d.GetUrl())};this._DoTrans=function(d){EWA.F.CID=this._Id;this._Ajax=new EWA.C.Ajax;this._Ajax.LoadingType="image";this._Ajax.AddParameter("EWA_AJAX","1");this._Ajax.AddParameter("EWA_ID",this._Id);this._Ajax.PostNew(d,EWA.F.FOS[EWA.F.CID]._CallBackJs)};this.Reload=function(){var d=new EWA_UrlClass;d.SetUrl(this.Url);this.TransParent=$X("EWA_MG_"+
this._Id).parentNode;this.Url=d.GetUrl();this._DoTrans(d.GetUrl())};this.ReloadAfter=function(){};this.getUrlClass=function(){var d=new EWA_UrlClass;d.SetUrl(this.Url);return d};this._CallBackJs=function(){var d=EWA.F.FOS[EWA.F.CID]._Ajax;4==d._Http.readyState&&(d.HiddenWaitting(),200==d._Http.status?(d=d._Http.responseText,EWA.F.CheckCallBack(d)&&(EWA.F.FOS[EWA.F.CID].TransParent.innerHTML=d,EWA.F.FOS[EWA.F.CID].ReloadAfter&&EWA.F.FOS[EWA.F.CID].ReloadAfter())):alert("ERROR:\r\n"+d._Http.statusText))}}
EWA.UI.MultiGrid={COLOR_BG:"rgba(173, 216, 230, 0.25)",COLOR_FOCUS:"gold",MTbId:null,MTbs:{},MOut:function(a){a=a||event;var b=a.srcElement||a.target;if(null!=b){a.stopPropagation?a.stopPropagation():a.cancelBubble();a=0;try{for(;!(b&&b.tagName&&"TD"==b.tagName.toUpperCase()&&0<b.id.indexOf("$MGC_"));)if(b=b.parentNode,a++,5<a)return}catch(n){return}var d=b.id;if(d!=EWA.UI.MultiGrid.MTbId){EWA.UI.MultiGrid.MTbId=d;var e=d.split("_"),g=e[2];a=e[1];var h=b.parentNode.parentNode.parentNode;null==this.MTbs[h.id]&&
(this.MTbs[h.id]=[]);b=this.MTbs[h.id];for(var k=0;k<b.length;k++)this._restoreBg(b[k]);for(k=b.length=0;1E3>k;k++){var l=e[0]+"_"+k+"_"+e[2],m=$X(l);if(!m)break;l==d?this._setBg(m,this.COLOR_FOCUS):this._setBg(m,this.COLOR_BG);b.push(m)}for(k=0;1E3>k;k++){l=e[0]+"_"+e[1]+"_"+k;m=$X(l);if(!m)break;l!=d&&(b.push(m),this._setBg(m,this.COLOR_BG))}d=$(h).find("#MGA_"+g+"_0");0<d.length&&(m=d[0],this._setBg(m,this.COLOR_BG),b.push(m));a=$(h).find("#MGB_"+a+"_0");0<a.length&&(m=a[0],this._setBg(m,this.COLOR_BG),
b.push(m))}}},_setBg:function(a,b){a.setAttribute("oldbg",a.style.backgroundColor);a.style.backgroundColor=b},_restoreBg:function(a){var b=a.getAttribute("oldbg");a.style.backgroundColor=b}};EWA.F.M={CUR:null,C:EWA_MultiGridClass};
function EWA_TreeNodeClass(){this.Next=this.Prev=this.Parent=this.MenuGroup=this.Text=this.Key=null;this.AddParas=[];this.Children=[];this.Cmd=this.ChildLast=null;this.tagName="TREE_NODE";this.Object=null;this.IsMoreChildren=!1;this.Mark=function(a){var b=$(this.GetObject().rows[0]);a?$(b).addClass("ewa-tree-node-marked"):$(b).removeClass("ewa-tree-node-marked")};this.SetKey=function(a){var b=this.GetObject();this.Key=a;b.id=a};this.SetText=function(a){this.Text=a;this.GetObject().rows[0].cells[2].childNodes[0].innerHTML=
a};this.SetAddParameters=function(a){this.AddParas=a.split(",");a=this.GetObject();for(var b=0;b<this.AddParas.length;b+=1)a.rows[0].cells[2].childNodes[0].setAttribute("EWA_P"+b,this.AddParas[b].trim())};this.SetMenuGroup=function(a){this.GetObject().setAttribute("EWA_MG",a)};this.AddChild=function(a){a.Parent=this;this.ChildLast=this.Children[this.Children.length]=a;this.IsMoreChildren=!1};this.GetObject=function(){null==this.Object&&(this.Object=document.getElementById(this.Key));return this.Object};
this.AddBackground=function(a){this.GetObject().rows[1].cells[0].background=a};this.SetBookIcon=function(a){this.GetObject().rows[0].cells[1].className=a};this.IsNodeOpen=function(){var a=this.GetObject().rows[0].cells[0];tag=this._GetTag(a);return"B"==tag};this.NodeShow=function(a){if("EWA_TREE_ROOT"!=this.Key){var b=this.GetObject(),d=b.rows[0].cells[0];if(null==a){var e=this._GetTag(d);if("C"==e||"D"==e)return;e="A"==e?"B":"A"}else e=a?"B":"A";for(var g=d.className.split(" "),h=[this._GetClassNameNoTag(d)+
e],k=1;k<g.length;k++)h.push(g[k]);d.className=h.join(" ");2==b.rows.length&&0<b.rows[1].cells[1].childNodes.length&&(b.rows[1].style.display="B"==e?"table-row":"none");this.BookShow(a);this.IsMoreChildren&&(this.Object.setAttribute("EWA_TREE_MORE","0"),a=new EWA.F.Cmd,a.EWA_ACTION="OnTreeNodeMore",a.EWA_TREE_KEY=this.Key,EWA.CurUI._PostChange(a));if(this.ewa&&this.ewa.OnBookShowAfter)try{this.ewa.OnBookShowAfter("B"==e,this)}catch(l){console.log(l)}}};this.BookShow=function(a){if("EWA_TREE_ROOT"!=
this.Key){var b=this.GetObject().rows[0].cells[1];null==a?(tag=this._GetTag(b),tag="A"==tag?"B":"A"):tag=a?"B":"A";a=b.className.split(" ");for(var d=[this._GetClassNameNoTag(b)+tag],e=1;e<a.length;e++)d.push(a[e]);b.className=d.join(" ")}};this.NodeClose=function(){this.NodeShow(!1)};this.NodeOpen=function(){this.NodeShow(!0)};this.BookOpen=function(){this.BookShow(!0)};this.BookClose=function(){this.BookShow(!1)};this.NodeCross=function(a){var b=this.GetObject(),d=b.rows[0].cells[0];if("D"==this._GetTag(d)||
a)d.className=this._GetClassNameNoTag(d)+"C";1==b.rows.length&&(a=b.insertRow(-1),a.insertCell(-1),a.insertCell(-1),a.cells[1].colSpan=2,a.style.display="none");d=b.rows[1].cells[0];d.className="TD10B"};this.NodeCrossEnd=function(a){var b=this.GetObject(),d=b.rows[0].cells[0],e=this._GetTag(d);if(1==b.rows.length){var g=b.insertRow(-1);g.insertCell(-1);g.insertCell(-1);g.cells[1].colSpan=2}b.rows[1].style.display="none";if("C"==e||a)d.className=this._GetClassNameNoTag(d)+"D";d=b.rows[1].cells[0];
d.className="TD10A"};this._GetTag=function(a){a=a.className.split(" ")[0];return a.substring(a.length-1)};this._GetClassNameNoTag=function(a){a=a.className.split(" ")[0];return a.substring(0,a.length-1)}}
function EWA_TreeClass(a,b,d){this.ParentObject=a;this.ClassName=b;this.Url=this._Url=d;this.Resources={};this.Icons=this.Menu=this._Ajax=null;this._CurNewNode=0;this.Fields={};this._LastFocus=this._Id=null;this._TempNode=document.createElement("DIV");this._MoveNode=document.createElement("DIV");this._HtmlTemplate1="<div oncontextmenu='"+this.ClassName+".ShowMenu(event);return false;' onclick='"+this.ClassName+".Click(event)'><table border=0 cellspacing=0 [ID] cellpadding=0 width=100% style='table-layout:fiexed'>";
this._HtmlTemplate1+="<tr><TD></TD><td class=CAPTION>&nbsp;&nbsp;&nbsp;</td><td width=99%><SPAN style='padding-left:4px'>[B]</SPAN></td></tr>";this._HtmlTemplate1+="<tr><td></td><td colspan=2></td></tr></table></div>";this._HtmlTemplate1+="<div style='display:none'><input style='margin:0px' type=text onblur='"+this.ClassName+".RenameBlur(this)'></div>";this._HtmlTemplate="<table class='ewa-tree-node ewa-tree-lvl-[LVL]' border=0 EWA_MG=\"[EWA_MENU_GROUP]\" EWA_T=1 [EWA_MORE_CHILDREN] cellspacing=0 [ID] cellpadding=0 width=100%>";
this._HtmlTemplate+="<tr class='ewa-node-row-0'><td nowrap class='[A] ewa-node-open-close'><div>&nbsp;</div></td><td nowrap class='[B] ewa-node-icon'><div>&nbsp;</div></td><td class='ewa-node-caption'><SPAN EWA_CMD=1 [TMP_ADD_PARAS]>[C]</SPAN></td>[TEMP_NODE_ADD_FIELDS]";this._HtmlTemplate+="</tr><tr class='ewa-node-row-1' style='display:none'><td class='[A1]'></td><td colspan=13></td></tr></table>";this.OpenAll=function(){this._OpenOrClose(".TD00A")};this.CloseAll=function(){this._OpenOrClose(".TD00B")};
this._OpenOrClose=function(e){var g=this;$("#EWA_TREE_"+this._Id).find(e).each(function(){g.Click({srcElement:this})})};this.DoAction=function(e,g,h,k,l,m){EWA.F.CID=this._Id;if(null==g||""==g.trim())alert("action not value");else{if(null!=h&&0<h.trim().length)if(e=_EWA_INFO_MSG[h],null!=e&&""!=e){if(!window.confirm(e))return}else if(!window.confirm(h))return;this._Ajax=new EWA.C.Ajax;this._Ajax.LoadingType="image";this._Ajax.AddParameter("EWA_AJAX","1");this._Ajax.AddParameter("EWA_ACTION",g);this._Ajax.AddParameter("EWA_ID",
this._Id);this._Ajax.AddParameter("EWA_NO_CONTENT","1");this._Ajax.AddParameter("EWA_ACTION_TIP",k);null!=m&&0<m.trim().length?(this._Ajax.AddParameter("EWA_AFTER_EVENT",m),this.StopAjaxAfterReload=!0,this._Ajax.AddParameter("EWA_ACTION_RELOAD","0")):this.StopAjaxAfterReload=!1;if(null!=l&&0<l.length)for(g=0;g<l.length;g+=1)this._Ajax.AddParameter(l[g].Name,l[g].Value);l=new EWA.C.Url;l.SetUrl(this.Url);l=l.RemoveParameter("EWA_ACTION");this._Ajax.PostNew(l,EWA.F.FOS[EWA.F.CID]._PostChangeCallback)}};
this.OnMouseDown=function(e){};this.OnMouseUp=function(e){};this.OnMouseMove=function(e){};this.OnMouseOut=function(e){};this.MoveNode=function(e){};this.GetParentNode=function(e){if(null==e||"EWA_TREE_ROOT"==e.Key)return null;e=e.GetObject().parentNode;e=this.GetNode(e);return null==e?null:"EWA_TREE_ROOT"==e.Key?null:e};this.CreateByXml=function(e){for(var g=e.GetElements("FrameData/Row"),h={},k,l=0;l<g.length;l+=1){var m=this._CreateNodeFromXml(g[l],e);h[m.Key]=m;if(0==l)k=m;else{var n=h[""==m.ParentKey?
"EWA_TREE_ROOT":m.ParentKey];null!=n&&n.AddChild(m)}}treeFirstNode=k;this.Create(k)};this.OnSelect=function(e){return"INPUT"!=e.srcElement.tagName?!1:!0};this.InitMenu=function(e){null!=e&&(this.Menu=new EWA_UI_MenuClass(b+".Menu"),this.Menu.Create(e))};this._PostChange=function(e){this.PostChangeType=e.EWA_ACTION;this.PostChangeKey=e.EWA_TREE_KEY;EWA.CurUI=this;this._Ajax=new EWA.C.Ajax;"OnTreeNodeMore"==this.PostChangeType&&(e.EWA_AJAX="XML",e.EWA_TREE_MORE="1");for(var g in e)this._Ajax.AddParameter(g,
e[g]);this._Ajax.PostNew(this._Url,EWA.CurUI._PostChangeCallback);this.IsPostChange=!0};this._PostChangeCallback=function(){var e=EWA.CurUI._Ajax;4==e._Http.readyState&&(e.HiddenWaitting(),200==e._Http.status?(e=e._Http.responseText,EWA.F.CheckCallBack(e)&&("OnTreeNodeMore"==EWA.CurUI.PostChangeType?EWA.CurUI.LoadChildrenAfter(e):"OnTreeNodeStatus"==EWA.CurUI.PostChangeType?EWA.CurUI.LoadChildrenStatus(e):"OnTreeNodeDelete"==EWA.CurUI.PostChangeType?EWA.CurUI.DeleteAfter():eval(e))):alert("ERROR:\r\n"+
e._Http.statusText),EWA.CurUI.IsPostChange=!1,EWA.SHOW_ERROR=!0)};this.LoadChildrenStatus=function(e){var g=new EWA.C.Xml;g.LoadXml(e);var h=g.GetElements("FrameData/Row");if(null!=h){e=[];for(var k={},l=0;l<h.length;l=1+l){var m=this._CreateNodeFromXml(h[l],g);""==m.Key||$[m.ParentKey]||(e.push(m),k[m.Key]=m)}if(0!=e.length&&(g=this.GetNodeById(e[0].ParentKey),null!=g)){k[g.Key]=g;for(l=0;l<e.length;l+=1)k[e[l].ParentKey].AddChild(e[l]);g.GetObject().setAttribute("EWA_TREE_MORE","0");g.IsMoreChildren=
!1;for(l=0;l<g.Children.length;l+=1)this.Create(g.Children[l]);g.NodeShow(!0);this.ShowNode(this.PostChangeKey)}}};this.LoadChildrenAfter=function(e){var g=new EWA.C.Xml;g.LoadXml(e);e=g.GetElements("FrameData/Row");if(null!=e&&0!=e.length){var h=this.GetNodeById(this.PostChangeKey),k={};k[h.Key]=h;for(var l=0;l<e.length;l=1+l){var m=this._CreateNodeFromXml(e[l],g);if("EWA_TREE_ROOT"!=m.Key){if(null==m.ParentKey||""==m.ParentKey)m.ParentKey=h.Key;k[m.Key]=m;var n=m.ParentKey;null!=k[n]&&k[n].AddChild(m)}}if(0<
h.Children.length)for(l=0;l<h.Children.length;l=1+l)this.Create(h.Children[l]);h.NodeShow(!0)}};this._CreateNodeFromXml=function(e,g){var h=new EWA_TreeNodeClass;h.ewa=this;h.Key=g.GetElementAttribute(e,"Key");h.ParentKey=g.GetElementAttribute(e,"ParentKey");h.Text=g.GetElementAttribute(e,"Text");h.IsMoreChildren="1"==g.GetElementAttribute(e,"IsMoreChildren")?!0:!1;h.MenuGroup=g.GetElementAttribute(e,"MenuGroup");for(var k=0;3>k;k+=1)h.AddParas[h.AddParas.length]=g.GetElementAttribute(e,"AddPara"+
k);return h};this.Rename=function(e,g,h,k){null==e&&(e=this._LastFocus);null!=e&&(this._RenameActionCmd=g,this._RenameRegex=h,this._RenameInfo=k,this._RenameNode="TREE_NODE"==e.tagName?e:this.GetNode(e),"EWA_TREE_ROOT"==this._RenameNode.Key?this._RenameNode=null:(e=this._RenameNode.GetObject(),e=e.rows[0].cells[e.rows[0].cells.length-1].childNodes[0],g=GetInnerText(e),e.style.display="none",h=this._GetInput(),e.parentNode.appendChild(h),h.value=g,h.setAttribute("EWA_OLD_VAL",g),h.style.width="300px",
h.focus()))};this._GetInput=function(){for(var e=this.ParentObject.getElementsByTagName("INPUT"),g=e.length-1;0<=g;g--){var h=e[g];if(h.getAttribute("onblur")&&0<h.getAttribute("onblur").indexOf("RenameBlur("))return this._InputDiv=h.parentNode,h}};this.RenameBlur=function(e){var g=this._RenameBlurT0||0,h=(new Date).getTime();if(!(100>h-g)){this._RenameBlurT0=h;h=e.getAttribute("EWA_OLD_VAL");g=this._RenameNode;for(var k=this.GetNode(g.GetObject().parentNode),l=0;l<k.Children.length;l+=1){var m=k.Children[l];
if(m.Key!=g.Key&&m.Text.trim()==e.value.trim()){alert(_EWA_EVENT_MSG.OnTreeNodeNameRepeat);e.focus();return}}k=e.parentNode.childNodes[0];this._InputDiv.appendChild(e);k.style.display="";if("NEW"==g.RenameType||h!=e.value){k.innerHTML=e.value;h=this._RenameActionCmd;null==h&&(h=new EWA.F.Cmd);if(null==h.EWA_ACTION||""==h.EWA_ACTION.trim())h.EWA_ACTION="NEW"==g.RenameType?"OnTreeNodeNew":"OnTreeNodeRename";"NEW"==g.RenameType&&(""==h.EWA_AFTER_EVENT&&(h.EWA_AFTER_EVENT='EWA.F.FOS["'+this._Id+'"].NewNodeAfter;'),
k=this.GetNode(g.GetObject().parentNode),h.EWA_TREE_PARENT_KEY=k.Key);h.EWA_TREE_TEXT=e.value;h.EWA_TREE_KEY=g.Key;this._PostChange(h);this._RenameActionCmd=null}}};this.RenameKeyDown=function(e,g){e=e.keyCode?e.keyCode:e.which;13==e&&this.RenameBlur(g);27==e&&(e=g.getAttribute("EWA_OLD_VAL"),g.value=e,this.RenameBlur(g))};this.Delete=function(e,g){var h=this.GetNode(this._LastFocus);null!=h&&"EWA_TREE_ROOT"!=h.Key&&window.confirm(_EWA_EVENT_MSG.OnTreeNodeDelete)&&(!e&&(0<h.Children.length||h.IsMoreChildren)?
(h.NodeShow(!0),alert(_EWA_EVENT_MSG.OnTreeNodeDeleteHaveChildren)):(e=g,null==e&&(e=new EWA.F.Cmd,e.EWA_ACTION="OnTreeNodeDelete"),""==e.EWA_AFTER_EVENT&&(e.EWA_AFTER_EVENT='EWA.F.FOS["'+this._Id+'"].DeleteAfter();'),e.EWA_TREE_KEY=h.Key,this._PostChange(e)))};this.DeleteAfter=function(){var e=this.GetNode(this._LastFocus).GetObject(),g=e.parentNode;g.removeChild(e);e=this.GetNode(g);0==e.Children.length?this.GetNode(e.GetObject().parentNode).ChildLast.Key==e.Key?e.NodeCrossEnd(!0):e.NodeCross(!0):
e.ChildLast.NodeCrossEnd();this._LastFocus=null};this.NewNode=function(e,g,h,k){null!=this._LastFocus&&(this._NewNodeTemp={TEXT:e,CMD:g,REGEX:h,INFO:k},this.GetNode(this._LastFocus).NodeShow(!0),this.IsPostChange?this._NewNodeTimer=window.setInterval(function(){EWA.CurUI.IsPostChange||(window.clearInterval(EWA.CurUI._NewNodeTimer),EWA.CurUI._NewNode())},100):this._NewNode())};this._NewNode=function(){var e=this._NewNodeTemp.TEXT,g=this._NewNodeTemp.CMD,h=this._NewNodeTemp.REGEX,k=this._NewNodeTemp.INFO;
this._NewNodeTemp=null;var l=new EWA_TreeNodeClass;l.ewa=this;this._CurNewNode+=1;l.Key="NEW_NODE_"+this._Id+"__"+this._CurNewNode;l.RenameType="NEW";var m=_EWA_EVENT_MSG.OnTreeNodeNew+this._CurNewNode;null!=e&&0<e.trim().length&&(m=e.trim());l.Text=m;e=this.GetNode(this._LastFocus);0<e.Children.length&&e.Children[e.Children.length-1].NodeCross();e.AddChild(l);this.Create(l);e.NodeShow(!0);this.Rename(l,g,h,k)};this.NewNodeAfter=function(e,g,h){var k=this.GetNodeById("NEW_NODE_"+this._Id+"__"+this._CurNewNode);
k.SetKey(e);k.SetAddParameters(null==g?"":g);k.SetMenuGroup(null==h?"":h);e=this.TestIcon(k);k.SetBookIcon(e)};this.GetNodeById=function(e){e=$("#EWA_TREE_"+this._Id+' .ewa-tree-node[id="'+e+'"]');return 0==e.length?null:this.GetNode(e[0])};this.GetFocusNode=function(){return this.GetNode(this._LastFocus)};this.GetNode=function(e){if(null==e||null==e.tagName)return null;var g=e;for(e=0;("TABLE"!=g.tagName||"1"!=g.getAttribute("EWA_T"))&&"EWA_TREE_ROOT"!=g.id;)if(g=g.parentNode,e++,33<e||"BODY"==g.tagName)return null;
e=new EWA_TreeNodeClass;e.ewa=this;e.Key=g.id;e.MenuGroup=g.getAttribute("EWA_MG");e.Object=g;var h=g.rows[0].cells[2];e.Text=GetInnerText(h);for(var k=0;3>k;k+=1)e.AddParas[k]=h.childNodes[0].getAttribute("EWA_P"+k);k=g.getAttribute("EWA_TREE_MORE");e.IsMoreChildren="1"==k?!0:!1;if(1<g.rows.length){g=g.rows[1].cells[g.rows[1].cells.length-1];for(k=0;k<g.childNodes.length;k=1+k)h=g.childNodes[k],3!=h.nodeType&&"TABLE"==h.tagName&&"1"==h.getAttribute("EWA_T")&&e.Children.push(this.GetNode(h));0<e.Children.length&&
(e.ChildLast=e.Children[e.Children.length-1])}return e};this.Click=function(e,g){if(!this.IsPostChange&&(EWA.CurUI=this,e=e.srcElement?e.srcElement:e.target,"INPUT"!=e.tagName))if("DIV"==e.tagName&&(e=e.parentNode),"TD"==e.tagName&&0==e.className.indexOf("TD00")){var h=this.GetNode(e);h.NodeShow()}else{for(;("SPAN"!=e.tagName||null==e.getAttribute("EWA_CMD"))&&"1"!=e.getAttribute("EWA_TREE_TOP");)if(e=e.parentNode,"BODY"==e.tagName)return;h=this.GetNode(e);if("SPAN"==e.tagName&&(null!=e.getAttribute("EWA_CMD")||
"1"==e.getAttribute("EWA_TREE_TOP"))){null!=this._LastFocus&&(this.GetNode(this._LastFocus).Mark(!1),this._LastFocus=null);"1"!=e.getAttribute("EWA_TREE_TOP")&&h.Mark(!0);this._LastFocus=e;if(g)return e;0>this.Url.toUpperCase().indexOf("EWA_TREE_SKIP_GET_STATUS")&&EWA.F.ST.SaveStatus(h.Key,"TREE");this._RunCmd(h);this.MoveNode(h.GetObject())}}};this._RunCmd=function(e){var g=this.GetNode(e.GetObject().parentNode);if(this.link)this.link(e.Key,e);else{console.warn('\u5efa\u8bae\u91c7\u7528\u5b9a\u4e49 EWA.F.FOS["xx"].link = function(nodeKey, node){}');
g='link("'+e.Key+'","'+g.Key+'","'+e.Text.replace(/\n/mig,"\\n").replace(/\r/mig,"\\r").replace(/"/mig,"&quot;")+'"';for(var h=0;h<e.AddParas.length;h+=1)g=null==e.AddParas[h]?g+",null":g+(',"'+e.AddParas[h]+'"');EWA.C.Utils.RunCmd(g+");")}};this.ShowMenu=function(e){EWA.CurUI=this;var g=this.Click(e,!0);null!=this.Menu&&null!=g&&(g=this.GetNode(g),this.Menu.ShowByMouse(e,g.MenuGroup))};this.TestIcon=function(e){if(null==this.Icons)return"TD01A";for(var g in this.Icons){var h=this.Icons[g],k=null;
switch(h.TEST.toUpperCase()){case "KEY":k=e.Key;break;case "PARENTKEY":k=e.Parent.Key;break;case "TEXT":k=e.Text;break;case "P0":k=e.AddParas[0];break;case "P1":k=e.AddParas[1];break;case "P2":k=e.AddParas[2];break;case "MG":k=e.MenuGroup}if(null!=k&&eval("/"+h.FILTER+"/ig").test(k))return h.NAME+"A"}return"TD01A"};this.Create=function(e,g){if(null!=e)if(null==e.Parent)this._CreateFirst(e);else{var h=this._HtmlTemplate.replace("[ID]",'id="'+e.Key+'"');h=h.replace("[TEMP_NODE_ADD_FIELDS]",this.AddCols||
"");for(var k="",l=0;l<e.AddParas.length;l+=1)null!=e.AddParas[l]&&void 0!=e.AddParas[l]&&(k+="EWA_P"+l+'="'+e.AddParas[l]+'" ');h=h.replace("[TMP_ADD_PARAS]",k);h=h.replace("[EWA_MENU_GROUP]",e.MenuGroup);k=this.TestIcon(e);h=h.replace("[B]",k);h=h.replace("[C]",e.Text);h=e.IsMoreChildren?h.replace("[EWA_MORE_CHILDREN]","EWA_TREE_MORE='1'"):h.replace("[EWA_MORE_CHILDREN]","");0<e.Children.length||e.IsMoreChildren?(h=h.replace("[A]","TD00A"),h=e!=e.Parent.ChildLast?h.replace("[A1]","TD10B"):h.replace("[A1]",
"TD10A")):h=e==e.Parent.ChildLast?h.replace("[A]","TD00D"):h.replace("[A]","TD00C");k=e.Parent.GetObject();1==k.rows.length&&(l=k.insertRow(-1),l.insertCell(-1),l.insertCell(-1),l.cells[1].colSpan=2);l=this.GetNodeLvl(e.Parent);h=h.replace("[LVL]",l+1);this._TempNode.innerHTML=h;h=this._TempNode.childNodes[0];k.rows[1].cells[k.rows[1].cells.length-1].appendChild(h);k.parentNode.childNodes[k.parentNode.childNodes.length-1]!=k&&(k.rows[1].cells[0].className="TD10B");e.Parent.NodeShow(!0);g&&g(h,this);
for(l=0;l<e.Children.length;l+=1)this.Create(e.Children[l],g)}};this.GetNodeLvl=function(e){var g=e;if(e.Object.getAttribute("tree_lvl"))return 1*e.Object.getAttribute("tree_lvl");for(var h=0;100>h;h++)if(g=this.GetParentNode(g),null==g)return e.Object.setAttribute("tree_lvl",h+1),h+1};this._CreateFirst=function(e,g){var h=this._HtmlTemplate1.replace("[ID]","id='"+e.Key+"'");h=h.replace("[B]",e.Text);this.ParentObject.innerHTML=h;for(h=0;h<e.Children.length;h+=1)this.Create(e.Children[h],g)};this.Init=
function(e){var g=new EWA.C.Xml;g.LoadXml(e);this.Resources=new EWA_FrameResoures;this.Resources.Init(g);-1!=this.Url.toUpperCase().indexOf("EWA_TREE_INIT_KEY")||0<this.Url.toUpperCase().indexOf("EWA_TREE_SKIP_GET_STATUS")||EWA.F.ST.GetStatus("TREE",this)};this.LoadStatus=function(){EWA.SHOW_ERROR=!1;this.ShowNode(_EWA_STATUS_VALUE)};this.ShowNode=function(e){if(null!=e&&""!=e&&"EWA_TREE_ROOT"!=e){var g=this.GetNodeById(e);null==g?(g=new EWA.F.Cmd,g.EWA_ACTION="OnTreeNodeStatus",g.EWA_AJAX="XML",
g.EWA_TREE_KEY=e,g.EWA_TREE_STATUS="1",this._PostChange(g)):(this._StatusNode=g,this.ShowNodeA())}};this.ShowNodeA=function(){var e=this._StatusNode;this._StatusNode=null;for(var g=e.GetObject().parentNode,h=this.GetNode(g);"EWA_TREE_ROOT"!=h.Key;)h.NodeShow(!0),h=this.GetNode(h.GetObject().parentNode);e.Mark(!0);this._LastFocus=e.GetObject();this._RunCmd(e);window.setTimeout(function(){g.focus()},0)};this.getUrlClass=function(){var e=new EWA_UrlClass;e.SetUrl(this.Url);return e};this.Reload=function(){}}
function EWA_Treelink(a,b,d,e,g,h){alert("key="+a+"\r\nparentKey="+b+"\r\ntext="+d+"\r\naddPara1="+e+"\r\naddPara2="+g+"\r\naddPara3="+h+"\r\n\r\n\u60a8\u9700\u8981\u8986\u76d6\u8fd9\u4e2a\u65b9\u6cd5\r\nlink(key, parentKey, text, addPara1, addPara2, addPara3)")}"undefined"==typeof link&&(link=EWA_Treelink);EWA.F.T={CUR:null,C:EWA_TreeClass,Node:EWA_TreeNodeClass};
function EWA_Html5UploadClass(){this.uploadIframes=[];this.files=[];this.UPLOAD_STATUS=this.POST_REF=this.POST_NAME=this.POST_ITEMNAME=this.POST_XMLNAME="";this.WAIT_ID=EWA_Utils.tempId("ht5upload_wait_");this.loadFiles=function(a,b,d,e,g){var h=this;$J(a,function(k){for(var l in k)h.loadFile(k[l],b,d,e,g)})};this.loadFile=function(a,b,d,e,g){d=this.showPreviewUrl(a[d]);if(e){var h=$("<a class='ewa_app_upload_remove'></a>").attr(a);h.on("click",function(){e(this)});$(d).css("position","relative").append(h)}if(g)$(d).find("img").css("cursor",
"pointer").attr(a).on("click",function(){g(this)});$(d).find(".name div").attr("title",a[b]).text(a[b])};this.remove=function(a){$(a).parent().remove()};this.changeUpExts=function(a){$("#"+this.INPUT_FILE_ID).attr("accept",a)};this.changeUpSizeLimit=function(a){this.UpLimit=a};this.haveFile=function(){for(var a=0;a<this.files.length;a++)if(""!=this.files[a].value)return!0;return!1};this.getValue=function(){if(0==this.uploadIframes.length&&0==this.files.length)return"";for(var a=[],b=0;b<this.uploadIframes.length;b++){var d=
this.uploadIframes[b];if("string"==typeof d){d=JSON.parse(d);for(var e in d)a.push(d[e])}}return JSON.stringify(a)};this.fileIco=function(a,b){a=EWA.UI.Ext.FileExt(a.name);$X(b).onerror=function(){};$X(b).src=EWA.UI.Ext.FileIco(a)};this.showPreview=function(a,b){if(10<a.files.length)"enus"==EWA.LANG?EWA.UI.Msg.ShowError("Upload up to 10 files at a time","limts"):EWA.UI.Msg.ShowError("\u4e00\u6b21\u6700\u591a\u4e0a\u4f2010\u4e2a\u6587\u4ef6","\u6587\u4ef6\u6570\u91cf\u9650\u5236"),a.value="";else{this.UpLimit||
(this.UpLimit="10M");b=(this.UpLimit+"").toLocaleLowerCase().replace(/,/ig,"").replace(/ /ig,"");if(b.endsWith("m")){b=b.substring(0,b.length-1);if(isNaN(b)){alert("Invalid sizeLimit parameter:"+this.sizeLimit);return}var d=1048576*b}else if(b.endsWith("k")){b=b.substring(0,b.length-1);if(isNaN(b)){alert("Invalid sizeLimit parameter:"+this.sizeLimit);return}d=1024*b}else{if(isNaN(b)){alert("Invalid sizeLimit parameter:"+this.sizeLimit);return}d=1*b}var e=[];if(0<d)for(b=0;b<a.files.length;b++){var g=
a.files[b];if(g.size>d){var h=EWA.UI.Ext.getFileLen(g.size,2);e.push(g.name.replace(/</ig,"%lt;").replace(/>/ig,"%gt;")+" ["+h+"]")}}if(0<e.length)a.value="","enus"==EWA.LANG?(e.push("Exceed "+this.UpLimit+" limit"),EWA.UI.Msg.ShowError(e.join("<br>"),"Exceed "+this.UpLimit+" limit")):(e.push("\u8d85\u8fc7"+this.UpLimit+"\u5927\u5c0f\u9650\u5236"),EWA.UI.Msg.ShowError(e.join("<br>"),"\u8d85\u8fc7"+this.UpLimit+"\u5927\u5c0f\u9650\u5236"));else{d=a.parentNode;e=d.outerHTML;d.style.display="none";a.setAttribute("ok",
1);gFileReaders={};for(b=0;b<a.files.length;b++)g=a.files[b],this.showPreview1(d,g),this.files.push(g);"yes"==this.UpMulti&&$(d).before(e)}}};this.addOther=function(a){for(var b=$X(this.POST_NAME).parentNode.getElementsByTagName("input")[1].parentNode,d=0;d<a.length;d++)this.showPreview1(b,a[d]);this.uploadIframes.push(JSON.stringify(a))};this.createPreviewBox=function(a){var b=a||$("#EWA_FRAME_"+this.SYS_FRAME_UNID+" input#"+this.POST_NAME).parent().find(".ewa_app_upload_form")[0],d="_upload_"+Math.random();
d=d.replace(".","G");a=document.createElement("img");a.id=d;d=document.createElement("table");d.cellPadding=0;d.cellSpacing=0;d.className="ewa_app_upload_form1";b.parentNode.appendChild(d);b=d.insertRow(-1).insertCell(-1);b.align="center";b.appendChild(a);b.className="img";b.vAlign="middle";d.insertRow(-1).insertCell(-1).className="name";var e=this;a.onerror=function(g){console.log(g);e.fileIco({name:this.src},this.id)};return d};this.showPreviewExists=function(){var a=$("#EWA_FRAME_"+this.SYS_FRAME_UNID+
" input#"+this.POST_NAME).val();if(""!=a){try{EWA.F.FOS[this.SYS_FRAME_UNID].setUnMust(this.POST_NAME)}catch(b){}this.showPreviewUrl(a)}};this.showPreviewUrl=function(a){var b=this.createPreviewBox(),d=$(b).find("td")[1],e=a.split("/");e=e[e.length-1];d.innerHTML="<div title='"+e+"'>"+e+"</div>";$(b).find("img")[0].src=a;return b};this.showPreview1=function(a,b){var d=this.createPreviewBox(a),e=$(d).find("td")[1],g=$(d).find("img")[0];a=g.id;b.ref=a;e.innerHTML="<div>"+b.name+"</div><div id='"+a+
"_process1' class='ewa-app-upload-process1'></div><div id='"+a+"_process' class='ewa-app-upload-process'>0%</div>";e.className="name";$(d).attr("file_name",b.name);$(d).attr("file_type",b.type);$(d).attr("file_size",b.size);if(b.type&&0==b.type.indexOf("image/")){g.src=(EWA.RV_STATIC_PATH||"/EmpScriptV2")+"/EWA_STYLE/images/loading2.gif";d=new FileReader;gFileReaders[a]=d;var h=this;d.onloadend=function(k){for(var l in gFileReaders)gFileReaders[l]==k.target&&($X(l).src=k.target.result,h.showPreviewAfter&&
h.showPreviewAfter($X(l),b))};d.readAsDataURL(b)}else this.fileIco(b,a),this.showPreviewAfter&&this.showPreviewAfter($X(a),b)};this.submitUploads=function(a){if(window.FormData){this.uploadIframes=[];var b=this;this.UPLOAD_STATUS="start";this.action=EWA.CP+"/EWA_STYLE/cgi-bin/_up_/?xmlname="+this.POST_XMLNAME+"&ITEMNAME="+this.POST_ITEMNAME+"&NAME="+this.POST_NAME+"&EWA_UP_TYPE=SWFUPLOAD&EWA_UP_REF="+this.POST_REF;try{$("input[type=file][ok=1]").each(function(){var d=this.id.split("_1_2_3_4_5_")[1];
if(b.POST_NAME==d)for(d=0;d<this.files.length;d++){var e=this.files[d];e.isDeleted?console.log(e):b.uploadIframes.push({file:e})}})}catch(d){alert(d)}0<this.uploadIframes.length?($("#f_"+this.SYS_FRAME_UNID).find(".ewa-app-upload-process,.ewa-app-upload-process1").show(),b.UPLOAD_STATUS="checking",this.asyncUpload()):this.UPLOAD_STATUS="nofile"}else this.submitUploads_old(a)};this.asyncUpload=function(){var a=this,b=null,d;for(d in this.uploadIframes){var e=this.uploadIframes[d];if("string"!=typeof e){b=
e;break}}null!=b?(b.submitting||(b.submitting=!0,this.submitUpload(b)),setTimeout(function(){a.asyncUpload()},111)):this.uploadsCompleted&&this.uploadsCompleted(this.uploadIframes)};this.createFormData=function(){var a=new FormData,b=new EWA_UrlClass;b.SetUrl(EWA.F.FOS[this.SYS_FRAME_UNID].Url);for(var d in b._Paras)0!=d.toUpperCase().indexOf("EWA")&&a.append(d,b._Paras[d]);if(b=$X("f_"+this.SYS_FRAME_UNID))for(d=0;d<b.length;d++){var e=b[d],g=e.name||e.id;"file"!=e.type&&"button"!=e.type&&"submit"!=
e.type&&("radio"!=e.type&&"checkbox"!=e.type||e.checked)&&"ht5upload"!=$(e).attr("ewa_tag")&&a.append(g,e.value)}return a};this.submitUpload=function(a){var b=a.file,d=this.createFormData();d.append(this.POST_NAME,b,b.name);var e=$('img[id="'+b.ref+'"]');this.createNewSizes(e[0],d);var g=this,h=$('div[id="'+b.ref+'_process"]');h.show().html("0%");var k=$('div[id="'+b.ref+'_process1"]');k.css("width",0).show();b=new XMLHttpRequest;b.upload.addEventListener("progress",function(l){l.lengthComputable?
(l=Math.round(100*l.loaded/l.total-10),0>l&&(l=0),h.html(l.toString()+"%"),k.css("width",l.toString()+"%")):h.html("unable to compute")},!1);b.addEventListener("load",function(l){h.html("100%");k.css("width","100%");for(var m in g.uploadIframes)if(g.uploadIframes[m].xhr==l.target){g.uploadIframes[m]=l.target.responseText;break}g.chkAllXhrComplete()},!1);b.addEventListener("error",function(l){console.log(l);h.html(l);g.UPLOAD_STATUS="error"},!1);b.addEventListener("abort",function(l){h.html("The upload has been canceled by the user or the browser dropped the connection.");
console.log(l);g.UPLOAD_STATUS="abort"},!1);b.open("POST",this.action,!0);b.send(d);a.xhr=b;delete a.file};this.createNewSizes=function(a,b){if("client"===this.NewSizesIn){if(!this.siezs){var d=this.UpNewSizes.split(",");this.siezs=[];for(var e in d){var g=d[e],h=g.split("x");2==h.length&&(g=h[0],h=h[1],isNaN(g)||isNaN(h)||this.siezs.push({w:1*g,h:1*h}))}}if(0!=this.siezs.length)for(e in this.siezs)g=this.siezs[e],d=EWA_ImageCalss.resizeAsBlob(a,g.w,g.h),b.append(this.POST_NAME,d,"resized$"+g.w+"x"+
g.h+".jpg")}};this.chkAllXhrComplete=function(){for(var a=0,b=0;b<this.uploadIframes.length;b++)"string"==typeof this.uploadIframes[b]&&a++;if(!(a<this.uploadIframes.length)){a=[];for(b=0;b<this.uploadIframes.length;b++){var d=JSON.parse(this.uploadIframes[b]);d.ERR&&a.push(d.ERR)}if(0===a.length)this.UPLOAD_STATUS="ok";else{b=[];var e=this;b[0]={Text:_EWA_INFO_MSG["BUT.OK"],Event:function(){e.UPLOAD_STATUS="error"},Default:!0};EWA.UI.Msg.Show(a.join("<br>"),b,"","ERR_ICON");this.removeWaitBox()}}};
this.createWaitBox=function(){if(!$X(this.WAIT_ID)){var a=document.createElement("div");a.id=this.WAIT_ID;var b=$("body");$(a).css({width:300,height:100,"line-height":"100px","font-size":"16px",position:"fixed",top:.5*b.height()-35,left:.5*b.width()-150,"z-index":12838,"background-color":"f0f0f0",color:"#08c","border-radius":"10px",opacity:.9}).addClass("ewa-upload-wait-box");a.innerHTML="<table height=100% align=center><tr><td><img src='"+((EWA.RV_STATIC_PATH||"/EmpScriptV2")+"/EWA_STYLE/images/loading2.gif'></td><td>")+
("enus"==EWA.LANG?"Please waitting ...":"\u8bf7\u7b49\u5f85\u6587\u4ef6\u4e0a\u4f20\u5b8c\u6bd5...")+"</td></table>";b.append(a);this.noWaitBox&&$(a).hide()}};this.removeWaitBox=function(){$("#"+this.WAIT_ID).remove()};this.submitUploads_old=function(a){this.uploadIframes=[];var b=this;this.UPLOAD_STATUS="start";try{$("input[type=file][ok=1]").each(function(d){var e=this.id.split("$")[1];b.POST_NAME==e&&b.submitUpload_old(d,this)})}catch(d){alert(d)}0<this.uploadIframes.length?window.setTimeout(function(){b.UPLOAD_STATUS=
"checking";b.chkframeSubmt()},400):this.UPLOAD_STATUS="nofile"};this.submitUpload_old=function(a,b){a="GDX"+a;var d=document.createElement("iframe");d.id=a;d.name=a;document.body.appendChild(d);d=$(d);d.hide();var e=document.createElement("form");document.body.appendChild(e);e.method="post";e.enctype="multipart/form-data";e.innerHTML="<input type=submit>";var g=$(e);g.hide();e=EWA.CP+"/EWA_STYLE/cgi-bin/_up_/?xmlname="+this.POST_XMLNAME+"&ITEMNAME="+this.POST_ITEMNAME+"&NAME="+this.POST_NAME+"&EWA_UP_TYPE=SWFUPLOAD&EWA_UP_REF="+
this.POST_REF;var h=b.id.split("_")[1].split("$")[0],k=EWA.F.FOS[h].Url,l=new EWA_UrlClass;l.SetUrl(k);for(var m in l._Paras)0!=m.toUpperCase().indexOf("EWA")&&(e+="&"+m+"="+l._Paras[m]);if(m=$X("f_"+h))for(h=0;h<m.length;h++)k=m[h],"file"!=k.type&&"button"!=k.type&&"submit"!=k.type&&("radio"!=k.type&&"checkbox"!=k.type||k.checked)&&(e+="&"+(k.name||k.id)+"="+k.value.toURL());g.attr("action",e);g.append(b);g.attr("target",a);this.uploadIframes.push(d[0]);setTimeout(function(){g.submit()},400)};this.chkframeSubmt=
function(){for(var a=0,b=0;b<this.uploadIframes.length;b++){var d=this.uploadIframes[b];if("string"==typeof d)a++;else if(d.contentDocument&&d.contentDocument.body){var e=GetInnerText(d.contentDocument.body);if(0<=e.indexOf("]")&&0<=e.indexOf("["))$("form[target="+d.id+"]").remove(),$(d).remove(),this.uploadIframes[b]=e;else if(""!=e.trim()){alert("\u7cfb\u7edf\u6267\u884c\u9519\u8bef\uff1a"+e);return}}}if(a==this.uploadIframes.length)this.UPLOAD_STATUS="ok";else{var g=this;window.setTimeout(function(){g.chkframeSubmt()},
100)}}}
function EWA_Html5TakePhotoClass(){this._wait_end=!0;this.UPLOAD_STATUS="NO";this.H5_UPLOAD=new EWA_Html5UploadClass;this.res={zhcn:{TAKE_PHOTO:"\u70b9\u51fb\u83b7\u53d6\u7167\u7247",RE_TAKE:"\u91cd\u65b0\u83b7\u53d6"},enus:{TAKE_PHOTO:"Take photo",RE_TAKE:"Re take"}};this.getRes=function(){return"enus"==EWA.LANG?this.res.enus:this.res.zhcn};this.getValue=function(){return this.responseText?this.responseText:""};this.init=function(a){this.objName=a;var b="#h5TakePhoto_"+a,d="h5TakePhotoVod_"+a;a=
$X("h5TakePhotoCan_"+a);a.height=$(b).height();a.width=$(b).width();this.context=a.getContext("2d");this.video=$X(d);$(this.video).show();d={video:!0};var e=this;navigator.getUserMedia?navigator.getUserMedia(d,function(g){e.video.src=g;e.video.play()},e.errBack):navigator.webkitGetUserMedia?navigator.webkitGetUserMedia(d,function(g){e.video.src=(window.URL||window.webkitURL).createObjectURL(g);e.video.play()},e.errBack):navigator.mozGetUserMedia&&navigator.mozGetUserMedia(d,function(g){e.video.src=
window.URL.createObjectURL(g);e.video.play()},e.errBack);$(b).find("button").html(this.getRes().TAKE_PHOTO)};this.errBack=function(a){EWA.UI.Msg.ShowError("\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u5728\u7ebf\u62cd\u6444<br>"+a.message,"\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u5728\u7ebf\u62cd\u6444");console.log(a)};this.takePhoto=function(a){if(this._wait_end){var b="#h5TakePhotoVod_"+this.objName,d=$(b).width();b=$(b).height();this.context.drawImage(this.video,0,0,d,b);this.createPic();this.setPhotoStatus("img");
if(a){var e=this;a.innerHTML=this.getRes().RE_TAKE;a.onclick=function(){e.showVideo(this)};$(a).show();$(a).parent().show()}}else $Tip("\u8fd0\u884c\u4e2d...")};this.showVideo=function(a){if(this._wait_end){if(this.setPhotoStatus("video"),a){var b=this;a.innerHTML=this.getRes().TAKE_PHOTO;a.onclick=function(){b.takePhoto(this)};$(a).show();$(a).parent().show()}}else $Tip("\u8fd0\u884c\u4e2d...")};this.setPhotoStatus=function(a){var b="#h5TakePhoto_"+this.objName,d="#h5TakePhotoCan_"+this.objName,
e="#h5TakePhotoVod_"+this.objName,g="#h5TakePhotoImg_"+this.objName;$(b).find("*").hide();"img"==a?(this._photo_status="img",$(b).css({border:"1px solid green"}),$(g).show()):"video"==a?(this._photo_status="video",$(b).css({border:"1px solid red"}),$(e).show()):"canvas"==a&&(this._photo_status="canvas",$(b).css({border:"1px solid blue"}),$(d).show())};this.createPic=function(){var a="#h5TakePhotoImg_"+this.objName,b=$X("h5TakePhotoCan_"+this.objName).toDataURL("image/jpeg",.7);$(a).attr("src",b);
this.setPhotoStatus("img");return $(a)[0]};this.submitUpload=function(){var a="#h5TakePhotoImg_"+this.objName,b=this.H5_UPLOAD.createFormData();a=$(a)[0];a=EWA_ImageCalss.resizeAsBlob(a,a.width,a.height);b.append(this.objName,a,this.objName+".jpg");a="#h5TakePhoto_"+this.objName;var d=this,e=$(a).find(".ewa-h5-take-photo-process");e.show();e.find("span").show().html("0%");var g=$(a).find(".ewa-h5-take-photo-process1");g.css("width",0).show();var h=new XMLHttpRequest;d=this;h.upload.addEventListener("progress",
function(l){l.lengthComputable?(l=Math.round(100*l.loaded/l.total-10),0>l&&(l=0),e.find("span").html(l.toString()+"%"),g.css("width",l.toString()+"%")):e.html("unable to compute")},!1);h.addEventListener("load",function(l){e.find("span").html("100%");g.css("width","100%");$("#EWA_FRAME_"+d.H5_UPLOAD.SYS_FRAME_UNID+" #"+d.objName).val(l.target.responseText);d.responseText=l.target.responseText;d.UPLOAD_STATUS="ok"},!1);h.addEventListener("error",function(l){console.log(l);e.html(l);d.UPLOAD_STATUS=
"error"},!1);h.addEventListener("abort",function(l){e.html("The upload has been canceled by the user or the browser dropped the connection.");console.log(l);d.UPLOAD_STATUS="abort"},!1);var k=EWA.CP+"/EWA_STYLE/cgi-bin/_up_/?xmlname="+this.H5_UPLOAD.POST_XMLNAME+"&ITEMNAME="+this.H5_UPLOAD.POST_ITEMNAME+"&NAME="+this.H5_UPLOAD.POST_NAME+"&EWA_UP_TYPE=SWFUPLOAD&EWA_UP_REF="+this.H5_UPLOAD.POST_REF;$(a).find("button").hide();h.open("POST",k,!0);h.send(b);this.xhr=h}}
function EWA_UI_BoxClass(){this._ClassName=("_eWAbOX"+Math.random()).replace(".","$");window[this._ClassName]=this;this._Cfg=this._JSON_URL=this._REF_DATA=null;this.Create=function(a){this._Cfg=a;if(EWA.F&&EWA.F.FOS)for(var b in EWA.F.FOS)a=EWA.F.FOS[b],a.BOX_CLASS==this&&(this.FOS=a);this.FOS&&(a=new EWA_UrlClass(this.FOS.Url),a.GetParameter("EWA_BOX_PARENT_ID")&&(a=a.GetParameter("EWA_BOX_PARENT_ID"),$X(a)&&(this._Cfg.parent_id=a)));if(this._Cfg.parent_id){a=this._Cfg.parent_id.split(",");for(var d=
0;d<a.length;d++){var e=a[d].trim();if($X(e)){$($X(e)).html("waiting...");this._Cfg.parent_id_init=this._Cfg.parent_id;this._Cfg.parent_id=e;break}}if(this._Cfg.parent_id_init){this.initBoxSize();a=new EWA_UrlClass;a.SetUrl(this.FOS.Url);d=a.GetParameter("EWA_PAGESIZE");e=a.GetParameter("EWA_PAGECUR");d&&!isNaN(d)?this._Cfg.EWA_PAGESIZE=d:this._Cfg.EWA_PAGESIZE=this._Cfg.EWA_PAGESIZE||10;e&&!isNaN(e)?this._Cfg.EWA_PAGECUR=e:this._Cfg.EWA_PAGECUR=this._Cfg.EWA_PAGECUR||1;d={};for(b in a._Paras)d["@"+
b.toUpperCase()]=a._Paras[b];this._REF_DATA=d;this.load_box_data()}else alert("parent_id["+this._Cfg.parent_id+"]\u627e\u4e0d\u5230\u5b9a\u4e49\u7684\u5bf9\u8c61")}else alert("parent_id\u672a\u5b9a\u4e49")};this.initBoxSize=function(){if(this._Cfg.page_width){if(isNaN(this._Cfg.page_width)){var a=this._ClassName+"_check_size";var b="<div id='"+a+"' style='height:1px;width:"+this._Cfg.page_width+"'></div>";$("body").append(b);b=$($X(a));a=b.width();b.remove()}else a=1*this._Cfg.page_width;if(!(50>=
a)){b={};b.width=a;var d=a-10-20-5;b.box_title=d;b.box_title_img=d-30-5;a-=10;b.box_txt=a;b.box_des1=a-2-58;this._Cfg._Fix=b}}};this.load_box_data=function(){var a;if(null==this.FOS){var b=[EWA.CP+"/EWA_STYLE/cgi-bin/?EWA_AJAX=JSON_EXT1&ewa_frameset_no=1"];for(a in this._Cfg){var d=a.toUpperCase();if("XMLNAME"==d||"ITEMNAME"==d||0==d.indexOf("EWA_")){var e=this._Cfg[a];e&&b.push(d+"="+e)}}b.push($U());this._JSON_URL=a=b.join("&")}else{b=new EWA_UrlClass;b.SetUrl(this.FOS.Url);b.AddParameter("EWA_AJAX",
"JSON_EXT1");b.AddParameter("ewa_frameset_no","1");for(a in this._Cfg)d=a.toUpperCase(),0==d.indexOf("EWA_")&&(e=this._Cfg[a])&&b.AddParameter(d,e);this._JSON_URL=a=b.GetUrl()}$J(a,this.load_box_data1,this)};this.load_box_data1=function(a,b){var d=b[b.length-1];b=d._Cfg;var e=d._Cfg.parent_id;EWA.F.FOS[a.FRAME_UNID]||(EWA_Utils.JsRegister(a.JSFRAME),EWA_Utils.JsRegister(a.JS));EWA.F.FOS[a.FRAME_UNID].Reload=function(){d.Create(d._Cfg)};EWA.F.FOS[a.FRAME_UNID].Goto=function(k){var l=new EWA_UrlClass;
l.SetUrl(d._JSON_URL);l.RemoveParameter("ewa_pagecur");l.AddParameter("ewa_pagecur",k);k=l.GetUrl();console.log(k);$J(k,d.load_box_data1,d._REF_DATA,k,d);this._JSON_URL=k};var g="___NeW_____"+b.parent_id;$X(g)||(b.new_parent_id=g,d.createToolbar(a));d.setPageInfo(a);d.enq_op_main_sub_boxs(a);1==b.autofocus&&(a=$X(e),a=$(a).offset().top,$("body").animate({scrollTop:a-30},300));if(b.callback)try{"function"==typeof b.callback?b.callback(d):eval(b.callback)}catch(k){console.log("EWA_UI_BoxClass->tmp.callback"+
k),console.log(b.callback)}if(EWA&&EWA.F&&EWA.F.FOS)for(var h in EWA.F.FOS)if(b=EWA.F.FOS[h],b.BOX_CLASS==d&&b.ReloadAfter)try{b.ReloadAfter(d)}catch(k){console.log("EWA_UI_BoxClass->EWA->ReloadAfter"+k),console.log(b.ReloadAfter)}};this.createToolbar=function(a){var b=this._Cfg,d=$($X(b.parent_id)),e=[];e.push('<div onselectstart="return false;" class="box-tool-bar">');for(var g=" onclick='"+this._ClassName+".toolBarClick(this)' ",h=["fa-table","fa-list aa","fa-sort aa","fa-search aa"],k=0;k<h.length;k++)e.push("<i class='fa "+
h[k]+"' "+g+"></i>");e.push("&nbsp;&nbsp;");h=["fa-fast-backward aa","fa-backward aa","fa-forward aa","fa-fast-forward aa"];for(k=0;k<h.length;k++)e.push("<i class='fa "+h[k]+"' "+g+"></i>"),1==k&&(e.push("<span class='aa' id='"+this._ClassName+"_records'></span>"),e.push("<select class='aa' id='"+this._ClassName+"_page' onchange='"+this._ClassName+".do_page(this)'><option value=5>5</option><option value=10>10</option><option value=20>20</option><option value=50>50</option><option value=100>100</option><option value=150>150</option><option value=200>200</option><option value=300>300</option><option value=500>500</option></select>"));
k=this.create_filter(a);g=k[0];k=k[1];e.push("<div class='sort_items' id='"+this._ClassName+"_search'>");e.push(g.join(""));e.push(k.join(""));e.push("</div>");a=this.create_sort(a);e.push("<div class='sort_items' id='"+this._ClassName+"_sort'>");e.push(a);e.push("</div>");e.push('</div><div id="'+b.new_parent_id+'"></div>');d.html(e.join(""));$X(this._ClassName+"_page").value=this._Cfg.EWA_PAGESIZE};this.setPageInfo=function(a){var b=1*a.RECORDS/this._Cfg.EWA_PAGESIZE,d=Math.round(b);d<b&&d++;this._Cfg._TOTALPAGE=
d;a=" ["+this._Cfg.EWA_PAGECUR+"/ <b >"+d+"</b> ("+a.RECORDS+")] ";if(b=$X(this._ClassName+"_records"))b.innerHTML=a};this.create_sort=function(a){var b=$J2MAP(a.CFG,"NAME"),d=[];for(e in EWA.F.FOS[a.FRAME_UNID].ItemList.Items)"1"==$(EWA.F.FOS[a.FRAME_UNID].ItemList.Items[e]).find("OrderSearch Set").attr("IsOrder")&&d.push(e);var e=[];e.push('<p class="sort-item" onclick="'+this._ClassName+'.do_sort(null,this)">\u6e05\u9664\u6392\u5e8f<b class="fa fa-times"></b></p>');for(var g=0;g<d.length;g++){var h=
d[g];b[h]&&(a=b[h].DES,e.push('<div  class="sort-item" onclick="'+this._ClassName+".do_sort(&quot;"+h+'&quot;,this)"><nobr><i class="fa fa-circle-o"></i>&nbsp;'+a+'&nbsp;<b class="fa"></b></nobr></div>'))}return e.join("")};this.do_sort=function(a,b){var d=$(".sort_items")[1];$(d).find(".sort-item i").attr("class","fa fa-circle-o");$(d).find(".sort-item b").attr("class","fa");if(a){var e=$(b).attr("desc");null==e||""==e?(a+=" DESC",$(b).attr("desc","desc"),e="fa fa-caret-down"):($(b).attr("desc",
""),e="fa fa-caret-up");$(b).find("i").attr("class","fa fa-dot-circle-o");$(b).find("b").attr("class",e)}this._Cfg.EWA_LF_ORDER=a;this._Cfg.EWA_PAGECUR=1;this.load_box_data();d.style.display="none";d.setAttribute("show","")};this.create_filter=function(a){var b=EWA.F.FOS[a.FRAME_UNID]._SearchJson,d=[],e=$J2MAP(a.CFG,"NAME"),g=[],h;for(h in b){var k=b[h];try{if("fix"==k.T){d.push("<select onchange='"+this._ClassName+".do_filter(this)' search_type='"+k.T+"' search_tag='"+h+"'>");d.push("<option value=''>--"+
e[h].DES+"--</option>");for(var l=0;l<k.D.length;l++)a=k.D[l],d.push('<option value="'+a[0]+'">'+a[1]+"</option>");d.push("</select>")}else if("text"==k.T)g.push("<div class='search_input'><input search_type='"+k.T+"' old='' onblur='"+this._ClassName+".checkTextChange(this)' search_tag='"+h+"' type=text placeholder=\""+e[h].DES+'"/></div>');else if("date"==k.T){var m=("D"+Math.random()).replace(".","A");g.push("<div class='search_input'><input style='width:43%' id='"+m+"' onclick=\"EWA.UI.Calendar.Pop(this)\" search_tag='"+
h+"' search_type='"+k.T+"' old='' onblur='"+this._ClassName+".checkTextChange(this)' type=text placeholder=\""+e[h].DES+"\"/> <input style='width:43%' id='"+m+"_1' old='' onblur='"+this._ClassName+'.checkTextChange(this)\' onclick="EWA.UI.Calendar.Pop(this)" type=text placeholder="'+e[h].DES+'"/></div>')}}catch(n){console.log(n),console.log(h),console.log(k)}}return[d,g]};this.toolBarClick=function(a){var b=a.className;if(0<b.indexOf("fa-table"))this.last_but!=a&&(this.last_but=a,$(a).parent().find(".aa").show(),
this.load_box_data());else if(0<b.indexOf("fa-list"))this.last_but!=a&&(this.last_but=a,$(a).parent().find(".aa").hide(),a=new EWA_UrlClass,a.SetUrl(this._JSON_URL),a.RemoveParameter("ewa_ajax"),a.AddParameter("ewa_ajax","install"),a.RemoveParameter("ewa_box"),a.RemoveParameter("xmlname"),a.AddParameter("xmlname","|"+this._Cfg.xmlname),(new EWA.C.Ajax).Install(a.GetUrl(),"",this._Cfg.new_parent_id,function(){}));else if(0<b.indexOf("fa-search")){b=this._ClassName+"_search";b=$($X(b));var d=$(a).offset(),
e=d.left;a=d+$(a).height+20;b.css({top:a,left:e,"z-index":1E4}).show()}else 0<b.indexOf("fa-sort")?(b=this._ClassName+"_sort",b=$($X(b)),d=$(a).offset(),e=d.left,a=d+$(a).height+20,b.css({top:a,left:e,"z-index":1E4}).show()):0<b.indexOf("fa-fast-forward")?(this._Cfg.EWA_PAGECUR=this._Cfg._TOTALPAGE,this.load_box_data()):0<b.indexOf("fa-forward")?(a=1*this._Cfg.EWA_PAGECUR+1,a>this._Cfg._TOTALPAGE?$Tip("\u5df2\u7ecf\u5230\u9875\u5c3e\u4e86"):(this._Cfg.EWA_PAGECUR=a,this.load_box_data())):0<b.indexOf("fa-backward")?
(a=1*this._Cfg.EWA_PAGECUR-1,0==a?$Tip("\u5df2\u7ecf\u5230\u9875\u5934\u4e86"):(this._Cfg.EWA_PAGECUR=a,this.load_box_data())):0<b.indexOf("fa-fast-backward")&&(this._Cfg.EWA_PAGECUR=1,this.load_box_data())};this.checkTextChange=function(a){var b=a.getAttribute("old"),d=a.value.trim();b!=d&&(a.setAttribute("old",d),this.do_filter(a.parentNode))};this.do_page=function(a){a=a.value;this._Cfg.EWA_PAGESIZE=a;this.FOS&&(this.FOS._PageSize=a);this._Cfg.EWA_PAGECUR=1;this.load_box_data()};this.do_filter=
function(a){a=$(".sort_items")[0];for(var b=$(a).find("[search_tag]"),d={},e=0;e<b.length;e++){var g=b[e],h=g.getAttribute("search_type");if(""!=g.value||"date"==h)if("date"==h){var k=g.value,l=$X(g.id+"_1").value;if(""!=k||""!=l)h="@!@"+g.getAttribute("search_tag")+"~!~"+h,d[h]||(d[h]=""),d[h]+="~!~"+k+"~!~"+l}else h="@!@"+g.getAttribute("search_tag")+"~!~"+h,d[h]||(d[h]=""),d[h]+="~!~"+g.value}b=[];for(var m in d)b.push(m),b.push(d[m]);this._Cfg.EWA_LF_SEARCH=b.join("");console.log(this.filterExp);
a.style.display="none";a.setAttribute("show","");this._Cfg.EWA_PAGECUR=1;this.load_box_data()};this.enq_op_main_sub_boxs=function(a){var b=$J2MAP(a.CFG,"NAME"),d=a.DATA,e=a.WF,g=this._Cfg,h=this._REF_DATA,k=$X(g.new_parent_id);if(k){k.innerHTML="";if(g.first){var l=this.enq_op_main_sub_tb();k.appendChild(l);var m=$(l.rows[0].cells[0]);m.attr({valign:"",align:"center"});m.append(g.first);$(l).addClass("ewa-box-first")}else this.enq_op_main_sub_box_but(k);k.setAttribute("sys_frame_unid",a.FRAME_UNID);
for(m=0;m<d.length;m++){l=this.enq_op_main_sub_tb();l.id=a.FRAME_UNID+"$"+d[m].EWA_KEY;k.appendChild(l);l=$(l.rows[0].cells[0]);if(g.chk&&g.chk_icons){var n=this.enq_op_main_sub_box_chk(b,d[m],g,h,e,a.FRAME_UNID);l.append(n)}n=this.enq_op_main_sub_title(b,d[m],g,h);l.append(n);n=this.enq_op_main_sub_box(b,d[m],g,h);l.append(n[0]);l.attr("json",JSON.stringify(n[1]));l.attr("json_ref",JSON.stringify(d[m]))}$(k).find(".box_des1").each(function(){this.title=GetInnerText(this)});$(k).append('<div style="clear:both"></div>')}};
this.enq_op_main_sub_box_but=function(a){var b=$(a).parentsUntil("table[id=Test1]").find(".ewa_lf_func_dact"),d=this.enq_op_main_sub_tb();a.appendChild(d);var e=$(d.rows[0].cells[0]),g=e.width()/3-10;e.attr("valign","middle");b.each(function(){var h=document.createElement("div");h.innerHTML=this.innerHTML;h.className="box_but";this.id=this.id||("sdo"+Math.random()).replace(".","P");h.id="K"+this.id;$(h).attr("fid",this.id);$(h).attr("onclick","$X(this.getAttribute('fid')).click()");$(h).css("width",
g);e.append(h)});return d};this.enq_op_main_sub_box_chk=function(a,b,d,e,g,h){var k=document.createElement("div");k.className="status";if(d.chk&&d.chk instanceof Function)try{var l=d.chk(b);var m=d.chk_icons[l];"function"==typeof m&&(m=m())}catch(n){m=n}if(null==m||""==m)m=d.icon;if(null==m||""==m)m="fa fa-gear";d=d.icon_color;"object"==typeof m&&(d=m.color,m=m.icon);0==m.trim().indexOf("fa")?k.innerHTML="<li class='"+m+"' "+(d?" style='color:"+d+"'":"")+"></li>":k.innerHTML=m;a=this.enq_op_main_sub_menu(a,
b,e,g,h);0<a.childNodes.length&&(k.setAttribute("onclick",this._ClassName+".enq_op_main_sub_menu_show(this)"),k.appendChild(a));return k};this.enq_op_main_sub_menu_show=function(a){var b=$(a).find(".box_menus")[0];if(!this.enq_op_main_sub_last_menu){var d=document.createElement("div");d.className="box_menus";d.setAttribute("onselectstart","return false");document.body.appendChild(d);this.enq_op_main_sub_last_menu=$(d);this.enq_op_main_sub_last_menu.css("z-index",1E6)}this.enq_op_main_sub_last_menu.html(b.innerHTML);
this.enq_op_main_sub_last_menu.attr("json_ref",a.parentNode.getAttribute("json_ref"));a=$(a).offset();this.enq_op_main_sub_last_menu.show();b=this.enq_op_main_sub_last_menu.height();d=$("body").height();this.enq_op_main_sub_last_menu.css({left:a.left-110,top:a.top+b>d?a.top-b-10:a.top,width:110})};this.enq_op_main_sub_menu=function(a,b,d,e,g){var h=document.createElement("div");h.className="box_menus";$(h).hide();var k=null;for(p in a){var l=a[p],m=l._ONCLICK||l.EWA_ONCLICK||l.EWA_CLICK;if(null!=
m&&""!=m)if("BUTDELETE"==l.NAME.toUpperCase())k=l;else{var n="BUTMODIFY"==l.NAME.toUpperCase()?"<b class='fa fa-edit'></b>"+l.DES:"BUTADD"==l.NAME.toUpperCase()?"<b class='fa fa-plus'></b>"+l.DES:"<b class='fa'></b>"+l.DES;m=this.replace_parameter(b,m,d);n=this.enq_op_main_sub_menu_item(n,m);n.setAttribute("refid",l.NAME);h.appendChild(n)}}if(k){var p=document.createElement("hr");h.appendChild(p);n="<b class='fa fa-trash-o'></b>&nbsp;"+k.DES;m=this.replace_parameter(b,k._ONCLICK,d);n=this.enq_op_main_sub_menu_item(n,
m);h.appendChild(n)}e&&(m=this.enq_op_main_wf_js(a,b,d,e,g)[0],n=enq_op_main_sub_menu_item("\u6d41\u7a0b\u63a7\u5236/\u5ba1\u6279",m),n.setAttribute("flow",1),n.setAttribute("onclick",this._ClassName+".enq_op_main_close_menu(event,this);eval('window.___wf_json_para='+this.parentNode.parentNode.parentNode.getAttribute('json'))"),h.appendChild(n));a="<b onclick='"+this._ClassName+".enq_op_main_close_menu(event,this)' class='fa fa-power-off close'></b>";h.setAttribute("onselectstart","return false;");
$(h).append(a);return h};this.enq_op_main_wf_js=function(a,b,d,e,g){for(var h=e.P,k=[],l=0;l<e.RID.length;l++)k.push("@"+e.RID[l]);h=h.replace(/\[RID\]/ig,k.join(","));e="EWA.UI.Dialog.OpenReloadClose('"+g+"','"+e.X+"','"+e.I+"',false,'"+(h+"&fjson=___wf_json_para')");e=this.replace_parameter(b,e,d);d=[];for(l=a.length-1;0<=l;l--)g=a[l],h=g.NAME,(h=b[h+"_HTML"]||b[h])&&d.push({DES:g.DES,VAL:h});return[e,d]};this.enq_op_main_sub_menu_item=function(a,b){var d=document.createElement("a");d.innerHTML=
a;d.href="javascript:void(0)";d.setAttribute("onclick",b+";"+this._ClassName+".enq_op_main_close_menu(event,this);");d.setAttribute("box_menu_item","yes");return d};this.enq_op_main_close_menu=function(a,b){a=a||window.event;a.stopPropagation();a.cancelBubble=!0;b.parentNode.style.display="none"};this.enq_op_main_sub_box=function(a,b,d,e){e=["<table  onselectstart='return true' class='box_txt' "+(this._Cfg._Fix?"style='width:"+this._Cfg._Fix.box_txt+"px'":"")+" cellspacing=0 cellpadding=0>"];for(var g=
this._Cfg._Fix?"style='width:"+this._Cfg._Fix.box_des1+"px'":"",h=[],k=0;k<d.txt.length;k++){var l=d.txt[k],m=l.t;l=l.n;if(0==l.indexOf("<hr"))e.push("<tr><td class='box_subject' colspan=2>"),e.push(l),e.push("</td></tr>");else{if((m=this.replace_parameter(b,m))&&0<=m.indexOf("(")&&0<m.indexOf(")"))try{m=eval(m)}catch(p){}var n=a[l]?a[l].DES:l;e.push("<tr class='ewa-box-"+l+"'><td class='box_subject'><div class='box_subject1'><nobr>");e.push(n);e.push("</nobr><i class='fa fa-caret-right' style='color:#ccc'></i></div></td>");
e.push("<td class='box_des'><div class='box_des1' "+g+">");e.push(m+"</div></td></tr>");h.push({DES:n,VAL:m})}}return[e.join(""),h]};this.enq_op_main_sub_tb=function(){var a=document.createElement("table");a.className="box";a.cellSpacing=0;a.cellPadding=0;a.insertRow(-1).insertCell(-1).vAlign="top";a.setAttribute("onselectstart","return false;");this._Cfg._Fix&&$(a).css("width",this._Cfg._Fix.width);this._Cfg.page_color&&$(a).css("background",this._Cfg.page_color);this._Cfg.page_radius&&$(a).css("border-radius",
this._Cfg.page_radius);this._Cfg.page_height&&$(a).css("height",this._Cfg.page_height);return a};this.replace_parameter=function(a,b,d){var e=b,g=[];for(h in a)g["@"+h.toUpperCase()]=a[h];if(d)for(h in d)g[h]||(g[h]=d[h]);if(a=b.match(/@[a-zA-Z0-9\-\._:]*\b/ig))for(b=0;b<a.length;b++){d=a[b];var h=d.toUpperCase();e=e.replace(d,g[h+"_HTML"]||g[h]||"")}return e};this.enq_op_main_sub_title=function(a,b,d,e){if(!d.title)return"";a=[];if(d.img){a.push("<div class='box_img'>");var g="function"==typeof d.img?
d.img(b):b[d.img];var h="",k="_blank",l="";g&&""!=g?h=g.replace("_SMAILL",""):g=EWA.RV_STATIC_PATH+"/EWA_STYLE/images/pic_no.jpg";d.img_click&&(l=this.replace_parameter(b,d.img_click.toString(),e),k="");a.push("<a class='imgtb' style='background-image:url("+g+")' ");l?a.push(" href='javascript:void(0)' onclick=\""+l+'" '):""!=h&&a.push(" target='"+k+"' href=\""+h+'" ');a.push("></a>");a.push("</div>")}d.title&&(e="box_title",g="",d.img&&(e="box_title_img"),this._Cfg._Fix&&(g="width:"+this._Cfg._Fix[e]+
"px; "),d.title_color&&(g+="color:"+d.title_color),a.push("<div class='"+e+"' style='"+g+"'>"),b=this.replace_parameter(b,d.title),a.push(b),a.push("</div>"));return a.join("")};this.add_box_style=function(){}}
var EWA_UI_BoxExt={getFileLen:function(a){return null==a||isNaN(a)?a||"":1073741824<a?Math.round(a/1073741824*100)/100+"G":1048576<a?Math.round(a/1048576*100)/100+"M":1024<a?Math.round(a/1024*100)/100+"K":a+"B"},openInBox:function(a,b,d){if(!$X("EWA_UI_BoxExt_OpenInBox")){var e=[];e.push("#EWA_UI_BoxExt_OpenInBox {left: 10px;right: 10px;bottom: 10px;top: 10px;position: fixed; background-color: rgba(127, 127, 127, 0.7);display: none;padding: 5px;z-index: 1010;}");e.push("#EWA_UI_BoxExt_OpenInBox .title {height: 30px;background-color: #cdcdcd;font-size: 14px;padding: 4px;}");
e.push("#open_box .title b {color: #08c;cursor: pointer;}");var g=document.createElement("style");g.textContent=e.join("\n");document.getElementsByTagName("head")[0].appendChild(g);e=[];e.push("<div id='EWA_UI_BoxExt_OpenInBox'>");e.push("<table width=100% height=100% cellpadding=0 cellspacing=0>");e.push("<tr>");e.push('<td class="title"><b class="fa fa-power-off fa-border"');e.push(" onclick=\"$('#EWA_UI_BoxExt_OpenInBox').hide();isStopMouseWheel = false;\"></b>&nbsp;<span></span></td>");e.push("</tr>");
e.push("<tr>");e.push("<td class=\"cnt\" valign=top><div id='open_box_cnt'");e.push(" style='overflow: auto; width: 100%; height: 100%'></div></td>");e.push("</tr>");e.push("</table>");e.push("</div>");$("body").append(e.join(""))}$("#EWA_UI_BoxExt_OpenInBox").show();$("#EWA_UI_BoxExt_OpenInBox .title span").html(b);a="<iframe width=100% height=100% src='"+a+"' frameborder=0></iframe>";$("#EWA_UI_BoxExt_OpenInBox .cnt").html(a);d&&d()}};
EWA_UI_BoxExt={getFileLen:function(a){return EWA.UI.Ext.FileLen(a)},openInBox:function(a,b,d){if(!$X("EWA_UI_BoxExt_OpenInBox")){var e=[];e.push("#EWA_UI_BoxExt_OpenInBox {left: 10px;right: 10px;bottom: 10px;top: 10px;position: fixed; background-color: rgba(127, 127, 127, 0.7);display: none;padding: 5px;z-index: 1010;}");e.push("#EWA_UI_BoxExt_OpenInBox .title {height: 30px;background-color: #cdcdcd;font-size: 14px;padding: 4px;}");e.push("#open_box .title b {color: #08c;cursor: pointer;}");var g=
document.createElement("style");g.textContent=e.join("\n");document.getElementsByTagName("head")[0].appendChild(g);e=[];e.push("<div id='EWA_UI_BoxExt_OpenInBox'>");e.push("<table width=100% height=100% cellpadding=0 cellspacing=0>");e.push("<tr>");e.push('<td class="title"><b class="fa fa-power-off fa-border"');e.push(" onclick=\"$('#EWA_UI_BoxExt_OpenInBox').hide();isStopMouseWheel = false;\"></b>&nbsp;<span></span></td>");e.push("</tr>");e.push("<tr>");e.push("<td class=\"cnt\" valign=top><div id='open_box_cnt'");
e.push(" style='overflow: auto; width: 100%; height: 100%'></div></td>");e.push("</tr>");e.push("</table>");e.push("</div>");$("body").append(e.join(""))}$("#EWA_UI_BoxExt_OpenInBox").show();$("#EWA_UI_BoxExt_OpenInBox .title span").html(b);a="<iframe width=100% height=100% src='"+a+"' frameborder=0></iframe>";$("#EWA_UI_BoxExt_OpenInBox .cnt").html(a);d&&d()}};
function EWA_UI_LeftClass(){this.searchExp=this.sortExp=this.instanceName=this.objContent=this.objRecords=this.objSearchGrp=this.objSearch=this.parentId=this.lastmd=this.map=this.crm_cfg=null;this.Create=function(a){this.parentId=("EWA_UI_LeftClass"+Math.random()).replace(".","m");EWA.F.FOS[this.parentId]=this;this._Id=this.parentId;this.map=a;this.map.des=this.map.des.split(",");this.map.order=this.map.order.split(",");window!=parent&&$("body").css("background-color","transparent");a=['<link rel="stylesheet" rev="stylesheet" type="text/css" href=\''+
EWA.RV_STATIC_PATH+"/EWA_STYLE/skins/complex.css' />"];a.push("<table cellpadding=0 cellspacing=0 width=100% height=100%>");a.push("<tr>");a.push("<td width=230><div id='div_"+this.parentId+'\' class="items"></div></td>');var b="";this.map["default"]&&(b=' src="'+this.map["default"]+'" ');a.push("<td id=\"cnt\"><iframe frameborder=0 id='a2a2' "+b+' name="a2a2"');a.push("height=100% width=100%></iframe></td>");a.push("</tr>");a.push("</table>");$("body").html(a.join(""));this.instanceName="EWA.F.FOS."+
this.parentId;this.objContent=$X("div_"+this.parentId);a='<div class="search_box" onselectstart="return false">'+this.create_grp()+'<div class=" fa fa-search" style="width:100%"><input class="search" onkeyup="'+this.instanceName+".do_search()\" placeholder=\"search\"  onselectstart=\"return true\"></div></div><div class='search_records'><b class='fa fa-quote-left'></b>&nbsp;\u8bb0\u5f55\u6570\uff1a<i></i><b class='fa fa-chevron-up records-gotop'></b></div>";$("body").append(a);this.objSearch=$(".search")[0];
this.map.grp&&0<this.map.grp.length?this.objSearchGrp=$(".search-grp")[0]:(this.objContent.style.top="31px",$(".search_box").css("height",30));this.objRecords=$(".search_records i")[0];$(".search_records .records-gotop").click(function(){$(".items").first().scrollTop(0)});this.page_size=50;this.page_size=this.map.page_size?this.map.page_size:50;this.load_data();this.current_page=1};this.scroll_check=function(a){a.scrollHeight-a.scrollTop>1.2*a.clientHeight||this.current_page*this.page_size>=this.total_records||
this.is_load_data||this.load_more()};this.load_more=function(){this.current_page?this.current_page++:this.current_page=2;this._load_datas()};this.create_grp=function(){if(!this.map.grp||0==this.map.grp.length)return"";for(var a=["<div ><i class='fa fa-filter'></i><select onchange='"+this.instanceName+".do_grp(this)' class='search-grp'>"],b=0;b<this.map.grp.length;b++){var d=this.map.grp[b];a.push("<option value='"+d[1]+"'>"+d[0]+"</option>")}a.push("</select></div>");return a.join("")};this.create_sort=
function(){if(null!=this.map.order&&0!=this.map.order.length){var a=$J2MAP(this.crm_cfg,"NAME"),b=["<div openbox=1 class='sort' onclick='"+this.instanceName+".show_sort(this.childNodes[0],event)'><i openbox=1 style='line-height:16px' class='fa fa-gear'></i><table cellpadding=1 cellspacing=1 class='sort_items'><tr><td valign=top>"];b.push('<p onclick="'+this.instanceName+'.do_sort(null,this)">\u6e05\u9664\u6392\u5e8f<b class="fa fa-times"></b></p>');for(var d=0;d<this.map.order.length;d++){var e=this.map.order[d];
a[e]&&b.push('<div  class="sort_item" onclick="'+this.instanceName+".do_sort(&quot;"+e+'&quot;,this)"><nobr><i class="fa fa-circle-o"></i>&nbsp;'+a[e].DES+'&nbsp;<b class="fa"></b></nobr></div>')}b.push("</td><td valign=top></td><td valign=top></td></tr></table></div><div onclick='"+this.instanceName+".hide(this)' class='hide_but'><b style='line-height:16px' class='fa fa-caret-left'></b></div>");return b.join("")}};this.hide=function(a){this.objContent.style.display="none";this.objContent.parentNode.style.backgroundColor=
"#f1f1f1";this.objSearch.parentNode.parentNode.style.display="none";this.objRecords.parentNode.style.display="none";var b=this;this.objContent.parentNode.onclick=function(){b.show()};this.objContent.parentNode.appendChild(a);this.hideButton=a;$(this.objContent.parentNode).animate({width:"30px"},300)};this.show=function(){this.objSearch.parentNode.appendChild(this.hideButton);var a=this;$(this.objContent.parentNode).animate({width:"230px"},300,function(){a.objContent.parentNode.style.backgroundColor=
"";a.objContent.style.display="";a.objRecords.parentNode.style.display="";a.objSearch.parentNode.parentNode.style.display=""})};this.do_sort=function(a,b){var d=$(".sort_items")[0];$(d).find(".sort_item i").attr("class","fa fa-circle-o");$(d).find(".sort_item b").attr("class","fa");if(a){var e=$(b).attr("desc");null==e||""==e?(a+=" DESC",$(b).attr("desc","desc"),e="fa fa-caret-down"):($(b).attr("desc",""),e="fa fa-caret-up");$(b).find("i").attr("class","fa fa-dot-circle-o");$(b).find("b").attr("class",
e)}this.sortExp=a;this.current_page=1;this._load_datas();d.style.display="none";d.setAttribute("show","")};this.do_grp=function(a){this.current_page=1;this._load_datas()};this.do_filter=function(a){a=$(".sort_items")[0];for(var b=$(a).find("[search_tag]"),d={},e=0;e<b.length;e++){var g=b[e],h=g.getAttribute("search_type");if(""!=g.value||"date"==h)if("date"==h){var k=g.value,l=$X(g.id+"_1").value;if(""!=k||""!=l)h="@!@"+g.getAttribute("search_tag")+"~!~"+h,d[h]||(d[h]=""),d[h]+="~!~"+k+"~!~"+l}else h=
"@!@"+g.getAttribute("search_tag")+"~!~"+h,d[h]||(d[h]=""),d[h]+="~!~"+g.value}b=[];for(var m in d)b.push(m),b.push(d[m]);this.filterExp=b.join("");a.style.display="none";a.setAttribute("show","");this.current_page=1;this._load_datas()};this.do_search=function(){var a=$(this.objSearch),b=a.val(),d=a.attr("old_val");b!=d&&(a.attr("old_val",b),this.searchExp="@!@"+this.map.search+"~!~text~!~"+b,this.current_page=1,this._load_datas())};this._load_datas=function(){this.is_load_data=!0;var a=$U2(this.map.XMLNAME,
this.map.ITEMNAME,this.map._URL_PARAS,!0);this.sortExp&&""!=this.sortExp&&(a+="&EWA_LF_ORDER="+this.sortExp.toURL());var b="";this.searchExp&&""!=this.searchExp&&(b=this.searchExp);this.filterExp&&""!=this.filterExp&&(b+=this.filterExp);""!=b&&(a+="&EWA_LF_SEARCH="+b.toURL());this.objSearchGrp&&(a+="&"+this.objSearchGrp.value);this.current_page&&(a+="&EWA_PAGECUR="+this.current_page);a+="&EWA_PAGESIZE="+this.page_size;var d=this,e=(new Date).getTime();this._load_datas_post_time=e;$J(a,function(g){e==
d._load_datas_post_time&&(d.total_records=g.RECORDS,d.show_pages(),d.show_data(g.DATA,[!0]),d.is_load_data=!1)})};this.show_sort=function(a,b){b=b||event;1==(b.srcElement||b.target).getAttribute("openbox")&&(a=$(a).next(),null==a.attr("show")||""==a.attr("show")?(a.show(),a.css({top:20,right:4}),a.attr("show",1)):(a.hide(),a.attr("show","")))};this.load_data=function(){if(EWA&&EWA.F&&EWA.F.FOS)for(var a in EWA.F.FOS){var b=EWA.F.FOS[a];if(b.LEFT_CLASS==this){var d=b;break}}b={};if(d){d=d.Url;var e=
new EWA_UrlClass;e.SetUrl(d);for(a in e._Paras)"XMLNAME"!=a&&"ITEMNAME"!=a&&"EWA_LEFT"!=a&&(b[a]=e._Paras[a])}e=new EWA_UrlClass;e.SetUrl(window.location.href);for(a in e._Paras)"XMLNAME"!=a&&"ITEMNAME"!=a&&"EWA_LEFT"!=a&&(b[a]=e._Paras[a]);b.EWA_FRAMESET_NO=1;b.EWA_AJAX="json_ext1";d=[];for(a in b)d.push(a+"="+((b[a]||"")+"").toURL());this.map._URL_PARAS=d.join("&");a=$U2(this.map.XMLNAME,this.map.ITEMNAME,this.map._URL_PARAS,!0);this.objSearchGrp&&(a+="&"+this.objSearchGrp.value);a+="&EWA_PAGESIZE="+
this.page_size;$J(a,this.load_data1,this)};this.create_filter=function(a){var b=[],d=$J2MAP(this.crm_cfg,"NAME"),e=[],g;for(g in a){var h=a[g];if("fix"==h.T){b.push("<select onchange='"+this.instanceName+".do_filter(this)' search_type='"+h.T+"' search_tag='"+g+"'>");b.push("<option value=''>--"+d[g].DES+"--</option>");for(var k=0;k<h.D.length;k++){var l=h.D[k];b.push('<option value="'+l[0]+'">'+l[1]+"</option>")}b.push("</select>")}else"text"==h.T?e.push("<div class='search_input'><input search_type='"+
h.T+"' old='' onblur='"+this.instanceName+".checkTextChange(this)' search_tag='"+g+"' type=text placeholder=\""+d[g].DES+'"/></div>'):"date"==h.T&&(k=("D"+Math.random()).replace(".","A"),e.push("<div class='search_input'><input style='width:43%' id='"+k+"' onclick=\"EWA.UI.Calendar.Pop(this)\" search_tag='"+g+"' search_type='"+h.T+"' old='' onblur='"+this.instanceName+".checkTextChange(this)' type=text placeholder=\""+d[g].DES+"\"/> <input style='width:43%' id='"+k+"_1' old='' onblur='"+this.instanceName+
'.checkTextChange(this)\' onclick="EWA.UI.Calendar.Pop(this)" type=text placeholder="'+d[g].DES+'"/></div>'))}return[b,e]};this.checkTextChange=function(a){var b=a.getAttribute("old"),d=a.value.trim();b!=d&&(a.setAttribute("old",d),this.do_filter(a.parentNode))};this.load_data1=function(a,b){b=b[0];0==a.DATA.length&&b.noDataFunc&&b.noDataFunc();b.crm_cfg=a.CFG;var d=$J2MAP(b.crm_cfg,"NAME");b.CFG_MAP=d;b.WF=a.WF;b.FRAME_UNID=a.FRAME_UNID;b.show_data(a.DATA);b.total_records=a.RECORDS;b.show_pages();
d=b.create_sort();$(b.objSearch).parent().append(d);d=a.FRAME_UNID;EWA_Utils.JsRegister(a.JSFRAME);a=b.create_filter(EWA.F.FOS[d]._SearchJson);d=1;var e=$(b.objSearch).parent().find(".sort_items");if(0<a[0].length){var g='<p on1click="'+this.instanceName+'.do_sort(null,this)">\u7b5b\u9009</p>';e.find("td:eq(1)").css("width",140).append(g+a[0].join(""));d++}else e.find("td:eq(1)").hide();0<a[1].length?(g='<p on1click="'+this.instanceName+'.do_sort(null,this)">\u68c0\u7d22</p>',e.find("td:eq(2)").css("width",
140).html(g+a[1].join("")),d++):e.find("td:eq(2)").hide();e.css("width",144*d);b.init_scroll||(b.init_scroll=!0,b.objContent.setAttribute("onscroll",b.instanceName+".scroll_check(this)"))};this.show_pages=function(){this.objRecords.innerHTML=this.total_records+", "+this.current_page+"/ "+Math.ceil(this.total_records/this.page_size)};this.load_after=function(){};this.show_data=function(a,b){var d=$(this.objContent);1==this.current_page&&null!=b&&0<b.length&&1==b[0]&&d.find(".item").remove();for(b=
0;b<a.length;b++){var e=this.show_data1(a[b],b);d.append(e)}this.load_after&&this.load_after()};this.show_data1=function(a,b){var d=document.createElement("div");d.setAttribute("fid",("ITEM_"+Math.random()).replace(".","k"));d.className="item";var e=document.createElement("h1"),g=this.replace_parameter(a,this.map.title),h=$(this.objSearch).val();h&&""!=h&&(g=g.replace(h,"<span style='color:red'>"+h+"</span>"));h=this.total_records?this.total_records:this.page_size;h=8*((10>h?10:h)+"").split("").length+
2;e.innerHTML="<span class=idx style='width:"+h+"px'>"+(b+1+(this.current_page-1)*this.page_size)+"</span>"+g;e.title=g;$(e).css({"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"});d.appendChild(e);b=document.createElement("ol");for(var k in this.map.des)if(e=this.map.des[k],this.CFG_MAP[e]){g=document.createElement("li");h=this.CFG_MAP[e].NAME;var l=a[h+"_HTML"];if(null==l||""==l)l=a[h];null!=l&&""!=l&&(g.innerHTML=this.CFG_MAP[e].DES+":&nbsp; "+l,b.appendChild(g))}d.appendChild(b);
$(b).css({"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis",margin:4,padding:"4px 18px"});k=this.replace_parameter(a,this.map.key);d.id=k;d.setAttribute("onmousedown",this.instanceName+".md(this)");this.WF&&(a=this.create_item_wf(a),d.appendChild(a));return d};this.create_item_wf=function(a){for(var b=this.WF,d=b.P,e=[],g=0;g<b.RID.length;g++)e.push("@"+b.RID[g]);d=d.replace(/\[RID\]/ig,e.join(","));d="EWA.UI.Dialog.OpenReloadClose('"+this.FRAME_UNID+"','"+b.X+"','"+b.I+"',false,'"+
(d+"&fjson=___wf_json_para')");d=this.replace_parameter(a,d);b=document.createElement("a");b.innerHTML="\u6d41\u7a0b\u63a7\u5236/\u5ba1\u6279";b.setAttribute("flow",1);b.setAttribute("onclick","eval('window.___wf_json_para='+this.getAttribute('json'));"+d);d=[];for(var h in this.crm_cfg)e=this.crm_cfg[h],"span"==e.TAG&&(e={DES:e.DES,VAL:a[e.NAME+"_HTML"]||a[e.NAME]},e.VAL&&d.push(e));b.setAttribute("json",JSON.stringify(d));b.style.display="none";return b};this.md=function(a){this.lastmd&&(this.lastmd.className=
this.lastmd.className.replace(" md",""));a.className+=" md";this.lastmd=a;var b=this.map.u;if(b){0<this.map.u.indexOf("()")&&(b=eval(this.map.u));b=b+(0<b.indexOf("?")?"&":"?")+a.id+"&_fid_="+a.getAttribute("fid");if(this.objSearchGrp){var d=this.objSearchGrp.value;""!=d&&(b+="&"+d)}(d=$U())&&(b+="&"+d);this.AddTab?(a=GetInnerText($(a).find("h1")[0]),this.AddTab(b,a)):window.frames.a2a2.location.href=b}else window.frames[0].document.body.innerHTML='<h1 style="color:Red">json.u\u6ca1\u5b9a\u4e49,\u4e0d\u77e5\u9053\u8981\u5bfc\u822a\u5230\u54ea\u91cc</h1>'};
this.replace_parameter=function(a,b,d){var e=b,g=[];if(!a.____S2){for(var h in a)g["@"+h.toUpperCase()]=a[h];if(d)for(h in d)g[h]||(g[h]=d[h]);a.____S2=g}g=a.____S2;a=b.match(/@[a-zA-Z0-9\-\._:]*\b/ig);for(b=0;b<a.length;b++)d=a[b],h=(h=g[d.toUpperCase()])||"-",e=e.replace(d,h);return e}}
function EWA_ComplexClass(){this.Resources={};this.edit=function(a,b){var d=$X(a);$(d).offset();if(1!=d.getAttribute("is_open"))this.changeEdit(a,!1),b.innerHTML='<i class="fa fa-save"></i>',d.setAttribute("is_open",1),b.setAttribute("_title","enus"==EWA.LANG?"Save":"\u4fdd\u5b58");else{var e=$("#"+a).find("form")[0].id.replace("f_","");if(!EWA.F.FOS[e].DoPostBefore()||!EWA.F.FOS[e].CheckValidAll($("#f_"+e)[0]))return;$(d).find("input[id=butOk]").click();this.changeEdit(a,!0);b.innerHTML='<i class="fa fa-edit"></i>';
d.setAttribute("is_open",0);b.setAttribute("_title","enus"==EWA.LANG?"Edit":"\u7f16\u8f91")}this.focusObject(d)};this.focusObject=function(a,b){var d=$(a).offset();b?$("body").animate({scrollTop:d.top-40},300,b):$("body").animate({scrollTop:d.top-40},300);$(".pop_title").hide();a=$(a).prev().find(".fa-expand");0<a.length&&a.click()};this.goItem=function(a,b){var d=$X(a);if(null==d)alert("EWA_ComplexClass.goItem "+a+" not found");else{var e=$(d).offset();$("body").animate({scrollTop:e.top+30},300);
b?b():window["__timer_"+a]=setInterval(function(){b&&(window.clearInterval(window["__timer_"+a]),b())},111);this.focusObject($(d))}};this.changeEdit=function(a,b){a=$X(a);b&&$(a).hasClass("disabled-true")||($(a).find(".EWA_TD_B").hide(),$(a).find("select").attr("disabled",b),$(a).find("input").attr("disabled",b),$(a).find("textarea").each(function(){var d=$(this).parent();d.hasClass("ewa_redraw_info")&&0==d.find(".textarea-tip").length&&(d.css("position","relative").append("<span class='textarea-tip'>"+
$(this).attr("placeholder")+"</span>"),d.hover(function(){d.find(".textarea-tip").show()},function(){d.find(".textarea-tip").hide()}));if(0==d.find(".hide-textarea-content").length){var e="<div class='hide-textarea-content' style='display:none;overflow:auto;height:"+$(this).height()+"'>"+$(this).val()+"</div>";$(this).after(e)}d.find(".hide-textarea-content").hover(function(){$(this).parent().find(".textarea-tip").show()},function(){$(this).parent().find(".textarea-tip").hide()})}),$(a).find(".EWA_DHTML").each(function(){var d=
$(this).parent();if(d.hasClass("ewa_redraw_info")&&0==d.find(".textarea-tip").length){var e=$("#cpx_tab1 .EWA_TABLE").prop("id").replace("EWA_FRAME_",""),g=EWA.LANG?EWA.LANG.toLowerCase():"zhcn";e=$(EWA.F.FOS[e].ItemList.Items[this.id]).find("DescriptionSet Set[Lang='"+g+"']").attr("Info");d.css("position","relative").append("<span class='textarea-tip'>"+e+"</span>");d.hover(function(){d.find(".textarea-tip").show()},function(){d.find(".textarea-tip").hide()})}0==d.find(".hide-textarea-content").length&&
(e="<div class='hide-textarea-content' style='display:none;overflow:auto;height:"+$(this).height()+"'>"+$(this).find("input").val()+"</div>",$(this).after(e));d.find(".hide-textarea-content").hover(function(){$(this).parent().find(".textarea-tip").show()},function(){$(this).parent().find(".textarea-tip").hide()})}),b?($(a).addClass("disabled-true"),$(a).find("input").css("background-color","#eee"),$(a).find("textarea").hide(),$(a).find(".EWA_DHTML").hide(),$(a).find(".hide-textarea-content").show()):
($(a).removeClass("disabled-true"),$(a).find("input").css("background-color",""),$(a).find('input[ewa_class="droplist"]').css("background-color","lightyellow"),$(a).find("textarea").show(),$(a).find(".EWA_DHTML").show(),$(a).find(".hide-textarea-content").remove()))};this.textareaTip=function(a){var b=$(a).parent();0<b.find(".textarea-tip").length||(b.css("position","relative").append("<span class='textarea-tip' style=''>"+$(a).attr("placeholder")+"</span>"),b.hover(function(){b.find(".textarea-tip").show()},
function(){b.find(".textarea-tip").hide()}))};this._init=function(){this.Xml=new EWA.C.Xml;this.Xml.LoadXml(window["EWA_ITEMS_XML_"+this._Id]);this.Resources=new EWA_FrameResoures;this.Resources.Init(this.Xml);var a=window["_EWA_MENU_"+this._Id];$(".caption-info").attr("onselectstart","return false");this.add_doc_buts(a);this.init_lazy_frames_top();var b=this;addEvent(window,"scroll",function(){b.lazy_load()});this.mark_loc();this.lazy_load();document.body.style.overflow="hidden";EWA.B.MOZILLA?addEvent(window,
"DOMMouseScroll",this.my_mousewheel):addEvent(window,"mousewheel",this.my_mousewheel);a=this.getlocalStorage();for(var d in a)if("id"!=d&&a[d]&&$X(d)){var e=$($X(d)).prev().find(".fa-compress");0<e.length&&this.hide_frame(e[0])}window.open_in_box||(window.open_in_box=this.open_in_box);parent!=window&&(document.body.style.backgroundColor="transparent")};this.add_doc_buts=function(a){parent==window&&$("body").css("background-color","#ccc");if(a&&0!=a.length){for(var b=[],d=0;d<a.length;d++)b[d]=a[d];
b.push({Id:this._Id+"_comress_all",Txt:"enus"==EWA.LANG?"Hide All":"\u9690\u542b\u5168\u90e8",Cmd:"EWA.F.FOS['"+this._Id+"'].compress_all(this)",Img:"fa-compress"});for(d=b.length-1;0<=d;d--)if(a=b[d],null!=a){var e=$X("controls").rows[0].insertCell(1);e.innerHTML="<div id='"+a.Id+"' tag='"+a.Id+"' idx='"+d+"' onmouseover='EWA.F.FOS[\""+this._Id+"\"].show_title(this)' onmouseout=\"$('.pop_title').hide()\" class='but' _title=\""+a.Txt+'" '+(a.paras||"")+"><i class='fa "+a.Img+"'></i></div>";0<=a.Cmd.indexOf("function(")?
(e.childNodes[0].setAttribute("cmd",a.Cmd),e.childNodes[0].onclick=function(){var g=this.getAttribute("cmd");eval("("+g+")")(this)}):e.childNodes[0].setAttribute("onclick",a.Cmd);e.className="tdbut"}b=$("#controls").width();$("#dock").css("width",b).css("left","50%").css("margin-left",-1*b/2)}else $("#dock").hide()};this.init_lazy_frames_top=function(){this.lazy_frames=this.lazy_frames||{};var a=this;$("div[x]").each(function(){var b=$(this).offset().top;a.lazy_frames[this.id]?a.lazy_frames[this.id].top=
b:a.lazy_frames[this.id]={top:b}})};this._getBodyHeight=function(){return"CSS1Compat"==document.compatMode?document.documentElement.clientHeight:document.body.clientHeight};this.lazy_load=function(){var a=("CSS1Compat"==document.compatMode?document.documentElement.scrollTop:document.body.scrollTop)+this._getBodyHeight(),b;for(b in this.lazy_frames)this.lazy_frames[b].top<=a-10&&this.lazy_load_do(b);this.mark_loc()};this._getParas=function(){var a=new EWA_UrlClass(this.Url);a.RemoveEwa();return a.GetParas()};
this.lazy_load_do=function(a){if(!this.lazy_frames[a].ok){this.lazy_frames[a].ok=!0;var b=$("#"+a),d=b.attr("x"),e=this._getParas();e&&(e="&"+e);if(null!=d&&0<d.length){var g=b.attr("i"),h=b.attr("p"),k=b.attr("js");null==k||""==k.trim()?EWA.F.Install(a,d,g,h+e):EWA.F.Install(a,d,g,h+e,function(){if(0<k.indexOf("("))eval(k);else window[k](b,this)})}else{d=b.attr("u")+e+"&NO_NAV=1";var l=("iframe_lazy_"+Math.random()).replace(".","A");e="<iframe id='"+l+"' name='"+l+"' width=100% height=100% frameborder=0 src='"+
d+"'></iframe>";$X(a).innerHTML=e;var m=-1,n=0<d.indexOf("combine.jsp")?!0:!1;setInterval(function(){var p=window.frames[l];if(p&&p.document&&"complete"==p.document.readyState&&p.$){var q=n?$("[id=crm_main_box]:visible").height():p.document.body.offsetHeight;100>Math.abs(m-q)||(m=q,$("#"+l).css("height",q+10),p.document.body.style.overflow="hidden")}},777)}}};this.mark_loc=function(){for(var a=$(".fcaption"),b=$("#nav_left .top"),d=$("#nav_left .bottom"),e=$("#nav_left"),g=this._getBodyHeight(),h=
0;h<a.length;h++){var k=a[h],l=this.mark_loc_ref(k,h);k=$(k);k=k.offset().top-("CSS1Compat"==document.compatMode?document.documentElement.scrollTop:document.body.scrollTop);k>g-d.height()?d.append(l):k<b.height()?b.append(l):(l.css({bottom:"",top:k}),e.append(l))}};this.mark_loc_ref=function(a,b){if(null==a.id||""==a.id)a.id=Math.random();var d=a.id;a=$(a);var e=$X("zzz"+d),g='EWA.F.FOS["'+this._Id+'"].';if(!e){e="c"+b%5;a.attr("class",a.attr("class")+" "+e);a.html("<b onclick='"+g+"max_frame(this)' class='fa fa-thumb-tack '>&nbsp;</b>"+
a.html());var h=a.css("background-color");a.parent().css("border-bottom-color",h);e=document.createElement("div");e.style.backgroundColor=h;e.id="zzz"+d;$("#nav_left").append(e);e.onclick=function(){var k=this.id.replace("zzz","");k=$($X(k)).offset().top;"CSS1Compat"==document.compatMode?$(document.documentElement).animate({scrollTop:k},300):$("body").animate({scrollTop:k},300)};e.title=a.text();e.innerHTML=b+1;e.onmouseover=function(){$(".pop_title_left div").html(this.title);var k=$(this).offset();
$(".pop_title_left").show().css("top",k.top-10).css("right",45)};e.onmouseout=function(){$(".pop_title_left").hide()};a.append('&nbsp;<i class="fa fa-compress" onclick='+g+"hide_frame(this)></i>");a.append('&nbsp;<i class="fa fa-refresh" onclick='+g+"reload_frame(this)></i>")}return $(e)};window.isStopMouseWheel=!1;this.my_mousewheel=function(a){if(!isStopMouseWheel){a=a.wheelDelta||a.detail;var b="CSS1Compat"==document.compatMode?document.documentElement:document.body;b.scrollTop=EWA.B.MOZILLA?b.scrollTop+
3*a:b.scrollTop-a}};this.show_title=function(a){if(""==a.getAttribute("_title")||null==a.getAttribute("_title")){var b=a.title;if(""==b||null==b)return;a.setAttribute("_title",b);a.title=""}$(".pop_title div").html(a.getAttribute("_title"));b=$(a).offset();a=$(a).width();var d=$(".pop_title").height(),e=$(".pop_title").width();$(".pop_title").css("top",b.top-d-8);$(".pop_title").show();$(".pop_title").css("left",b.left-(e-a)/2)};this.compress_all=function(a){a=$(a);if(null==a.attr("compress")||""==
a.attr("compress")){a.attr("compress",1);a.find("i").attr("class","fa fa-expand");var b="fa-compress";a.attr("_title","enus"==EWA.LANG?"Show All":"\u663e\u793a\u5168\u90e8")}else a.attr("compress",""),a.find("i").attr("class","fa fa-compress"),b="fa-expand",a.attr("_title","enus"==EWA.LANG?"Hide All":"\u9690\u542b\u5168\u90e8");var d=this;$(".fcaption ."+b).each(function(){d.hide_frame(this)})};this.getlocalStorage=function(){var a="ROBERT_"+location.pathname;if(0<a.indexOf("/cgi-bin/")){var b=new EWA_UrlClass;
b.SetUrl(window.location.href);var d=b.GetParameter("xmlname");b=b.GetParameter("itemname");d&&b&&(a="EWA_"+d+"GdX"+b)}d={};if(window.localStorage[a])try{d=eval("__json="+window.localStorage[a]+"; __json;")}catch(e){d={}}d.id=a;return d};this.hide_frame=function(a){var b=$(a.parentNode.parentNode);b=b.next();var d=$(a);a=!1;null==d.attr("compress")||""==d.attr("compress")?(d.attr("compress",1),d.attr("class","fa fa-expand"),b.hide(),this.init_lazy_frames_top(),this.lazy_load(),a=!0):(d.attr("compress",
""),d.attr("class","fa fa-compress"),this.init_lazy_frames_top(),b.show());d=this.getlocalStorage();d[b.attr("id")]=a;window.localStorage[d.id]=JSON.stringify(d)};this.max_frame=function(a){a=$(a.parentNode.parentNode);$('<p id="_MAX_FRAME___"></p>').insertBefore(a);var b=a.next();isStopMouseWheel=!0;if(!$X("MAX_FRAME___")){var d=document.createElement("div");d.id="MAX_FRAME___";$(d).css({position:"fixed",left:10,right:10,top:10,bottom:10,"background-color":"rgba(255,255,255,0.9)","z-index":1E7,"padding-top":5,
overflow:"auto","border-radius":5});d.innerHTML='<div style="position:fixed;left:15px;top:15px;font-size:16px;color:#fff;cursor:pointer;width:20px;height:20px;border-radius:10px;text-align:center;background-color:#111;"  onclick=EWA.F.FOS["'+this._Id+'"].remove_max()><b style="line-height:20px" class="fa fa-times"></b></div>';document.body.appendChild(d)}d=$("#MAX_FRAME___");d.append(a);a.find(".fa").hide();d.append(b);b.show();d.show()};this.remove_max=function(){for(var a=$X("MAX_FRAME___"),b=$("#_MAX_FRAME___"),
d=0;1<a.childNodes.length;){var e=a.childNodes[1];$(e).insertBefore(b);$(e).find(".fa").show();d++;if(5<d)break}b.remove();$(a).hide();isStopMouseWheel=!1};this.reload_frame=function(a){a=a.parentNode.parentNode;a=a.nextElementSibling?a.nextElementSibling:a.nextSibling;var b=a.getAttribute("r");null!=b&&""!=b?eval(b):(b=$(a).find(".EWA_TABLE"),0<b.length?(b=b[0].id.replace("EWA_LF_","").replace("EWA_FRAME_",""),EWA.F.FOS[b]instanceof EWA_FrameClass?(b=EWA.F.FOS[b].Url,(new EWA_AjaxClass).Install(b,
"EWA_AJAX=INSTALL",a.id,function(){change_edit("disabled")})):EWA.F.FOS[b].Reload()):"grp_fin_all"==a.id?load_grp_fin_total():(a=a.getElementsByTagName("iframe"),0<a.length&&(a[0].src=a[0].src)))};this.open_in_box=function(a,b){$("#open_box").show();$("#open_box .title span").html(b);a=a.replace(/\|/ig,"%7c");a="<iframe width=100% height=100% src='"+a+"' frameborder=0></iframe>";$("#open_box .cnt").html(a);isStopMouseWheel=!0}}
function focus_object(a,b){var d=$(a).offset();b?$("body").animate({scrollTop:d.top-40},300,b):$("body").animate({scrollTop:d.top-40},300);$(".pop_title").hide();a=$(a).prev().find(".fa-expand");0<a.length&&a.click()}
function EWA_UI_ADListClass(){this._TimeOut=3E3;this._Width=515;this._Height=223;this._List=[];this._Object=null;this._CurIndex=0;this._GotoIndex=-1;this.ClassName=null;this.Timer=-1;this._CssSize="";this.IsAutoPaly=!0;this.SetSize=function(a,b){this._Width=a;this._Height=b;this._CssSize="width:"+this._Width+(isNaN(this._Width)?"":"px")+";height:"+this._Height+(isNaN(this._Height)?"":"px")};this.AddAd=function(a,b,d,e){var g={};g.ImgUrl=a;g.AdUrl=b;g.AdText=d;g.Target=e;this._List.push(g)};this.Change=
function(){window.clearTimeout(this.Timer);var a=this._Object.getElementsByTagName("a"),b=this._Object.getElementsByTagName("table")[0].rows[0];b.cells[1].childNodes[this._CurIndex].style.backgroundColor="#000";b.cells[1].childNodes[this._CurIndex].style.color="#fff";var d=a[this._CurIndex];-1==this._GotoIndex?(this._CurIndex++,this._CurIndex==this._List.length&&(this._CurIndex=0)):(this._CurIndex=this._GotoIndex,this._GotoIndex=-1);a=a[this._CurIndex];b.cells[1].childNodes[this._CurIndex].style.backgroundColor=
"white";b.cells[1].childNodes[this._CurIndex].style.color="#000";EWA.UI.Utils.FadeIn(a,d,10,80,this)};this.ChangeAfter=function(){var a=this._Object.getElementsByTagName("table")[0].rows[0].cells[0].childNodes[0];a.innerHTML=this._List[this._CurIndex].AdText;a.href=this._List[this._CurIndex].AdUrl;a.target=this._List[this._CurIndex].Target;this.IsAutoPaly&&(window.clearTimeout(this.Timer),this.Timer=window.setTimeout(this.ClassName+".Change()",this._TimeOut))};this.CreateByUrl=function(a,b){this._ParentId=
b;EWA.UI.Utils.FADE_AJAX=new EWA.C.Ajax;EWA.UI.Utils.FADE_AJAX.Get(a,eval(this.ClassName+".AjaxCallBack"));EWA.UI.Utils.FADE=this};this.AjaxCallBack=function(){var a=EWA.UI.Utils.FADE_AJAX;4==a._Http.readyState&&(a.HiddenWaitting(),200==a._Http.status?(EWA.UI.Utils.FADE._List=eval(a._Http.responseText),EWA.UI.Utils.FADE.Create()):alert("ERROR:\r\n"+a._Http.statusText),EWA.SHOW_ERROR=!0)};this.Create=function(a){null==a&&(a=this._ParentId);var b=$X(a);if(null==b)alert("ID("+a+") Not Exists!");else{a=
document.createElement("DIV");a.style.width=this._Width+(isNaN(this._Width)?"":"px");a.style.height=this._Height+(isNaN(this._Height)?"":"px");a.style.overflow="hidden";var d=[];d.push('<div style="position: relative;'+this._CssSize+'"><div style="z-index:0;position: absolute;'+this._CssSize+'"></div>');d.push('<div style="position: absolute; height: 20px; width: '+this._Width+"px; left: 0px; top:"+(this._Height-22)+'px; border: 1px black solid; background-color: #000; filter: Alpha(Opacity=20); opacity: 0.2;z-index:1"></div>');
d.push('<table style="z-index:2;position:absolute;height:20px; width:'+this._Width+(isNaN(this._Width)?"":"px")+"; left: 0px;top:"+(this._Height-22)+'px; font-size: 12px;color: white" cellpadding="0" cellspacing="0"><tr><td align="center"><a style="color:white"></a></td><td style="width:'+24*this._List.length+'px;"></td></tr></table>');d.push("</div>");a.innerHTML=d.join("");b.innerHTML="";b.appendChild(a);this._Object=a;this._CreateList();this.ChangeAfter()}};this._CreateList=function(){for(var a=
this._Object.getElementsByTagName("table")[0].rows[0].cells[1],b=0;b<this._List.length;b++){var d=this._List[b],e=document.createElement("div");e.style.cssText="filter:Alpha(Opacity=70);width: 18px; height: 18px; float: left; text-align: center; color: #fff; margin-right: 2px; font-family: arial; cursor: pointer; opacity: 0.7; border-radius: 9px;line-height: 18px; background-color: #000;";e.innerHTML=b+1;a.appendChild(e);e.setAttribute("instancename",this.ClassName);e.onclick=function(){var h=eval("window."+
this.getAttribute("instancename"));window.clearTimeout(h.Timer);h._GotoIndex=1*this.innerHTML-1;h.Change()};e=document.createElement("div");e.style.cssText="background-image:url('"+d.ImgUrl+"');  "+this._CssSize+";background-repeat: no-repeat; background-size: cover;-moz-background-size: cover;-webkit-background-size: cover;background-position: center center;";e.title=d.AdText;var g=document.createElement("a");g.style.cssText=this._CssSize;g.style.position="absolute";g.style.top="0em";g.style.left=
"0em";0<b&&(g.style.display="none");g.style.zIndex=b;g.href=d.AdUrl;g.target=null==d.Target?"_blank":d.Target;g.appendChild(e);this._Object.childNodes[0].childNodes[0].appendChild(g)}}}
function EWA_UI_ADFlagClass(){this._ClassName=null;this._List=[];this._Ads=[];this.AddAd=function(a,b,d,e,g,h,k){var l={};l.IMG_SRC=a;l.URL=b;l.TOP=d;l.LEFT=e;l.IMG_WIDTH=g;l.IMG_HEIGHT=h;l.IS_FROM_CENTER=k;this._List.push(l)};this.Create=function(a){for(var b=0;b<this._List.length;b++)this._CreateObj(this._List[b]);if(a){var d=this;document.onscroll=function(){if("undefined"!=typeof window.pageYOffset)var e=window.pageYOffset;else"undefined"!=typeof document.compatMode&&"BackCompat"!=document.compatMode?
e=document.documentElement.scrollTop:"undefined"!=typeof document.body&&(e=document.body.scrollTop);for(var g=0;g<d._Ads.length;g++)d._Ads[g].style.top=1*d._List[g].TOP+e+"px"}}};this._CreateObj=function(a){var b=1*a.LEFT;a.IS_FROM_CENTER&&(b=window.document.body.offsetWidth/2+b);var d=document.createElement("div");d.style.position="absolute";d.style.left=b+"px";d.style.top=a.TOP+"px";d.style.width=a.IMG_WIDTH+"px";d.style.height=a.IMG_HEIGHT+"px";d.innerHTML="<a href='"+a.URL+"' target='_blank'><img src='"+
a.IMG_SRC+"' border='0' width='"+a.IMG_WIDTH+"px' height='"+a.IMG_HEIGHT+"px' /></a><div style='cursor:pointer;font-size:12px;text-align:right;padding-top:2px' onclick='this.parentNode.style.display=\"none\"'>\u5173\u95ed</div>";document.body.appendChild(d);this._Ads.push(d)}}
function EWA_CombineClass(){this.EWA_COMBINES_HTML=[];this.EWA_COMBINES=[];this.ewa_lf_func_index=this.curCombineIndex=0;this.MEAGER_ITEMS=[];this._init=function(){for(var a=0;a<this.EWA_COMBINES_HTML.length;a++)this.installCfgMoveButton1(this.EWA_COMBINES_HTML[a]);if(0==this.EWA_COMBINES.length){for(a=0;a<this.MEAGER_ITEMS.length;a++)this.meargeItems(this.MEAGER_ITEMS[a]);window.lastDo&&lastDo()}else this.installCfg()};this.installCfgMoveButton1=function(a){var b=$("#"+a).find(".ewa_lf_func");if(0!=
b.length&&(b=b[0],$X(a).getElementsByTagName("table")[0].style.height="",b.style.display="none",b=b.childNodes[1],0<b.getElementsByTagName("div").length))for(b.getElementsByTagName("div")[0].style.display="none";0<b.childNodes.length;)$X("DES_"+a).appendChild(b.childNodes[0])};this.installCfg=function(){if(this.curCombineIndex<this.EWA_COMBINES.length){if(0<this.curCombineIndex){if(!$X("EWA_FRAME_MAIN")){setTimeout(installCfg,51);return}$X("EWA_FRAME_MAIN").id="a"}var a=this.EWA_COMBINES[this.curCombineIndex],
b=this;EWA.F.Install(a.id,a.x,a.i,a.p,function(d,e,g,h){b.installOk(d,e,g,h)});this.curCombineIndex++}else{for(a=0;a<this.MEAGER_ITEMS.length;a++)this.meargeItems(this.MEAGER_ITEMS[a]);window.lastDo&&lastDo()}};this.installOk=function(a,b,d,e){this.installCfgMoveButton1(d);this.installCfg()};this.showFull=function(a){var b=$("#"+a).parent("div"),d=b.find(".left"),e=$("#"+a).find(".show"),g=b.attr("full");if(null!=g&&"1"==g)b.attr("full","0"),$(document.body).css("overflow","auto"),eval("ori="+b.attr("ori")),
b.animate(u,"fast","swing",function(){b[0].style.cssText="";var r=1*b.attr("st");document.body.scrollTop=r;1==$("#crm_left_box").attr("show")&&$("#crm_left_box").show();b.css("display",b.attr("dsp"));0<e.length&&"DES_plugin"!=a?e[0].click():(r=$X(a.replace("DES_","")),r.style.width=r.parentNode.clientWidth-10+"px",r.style.height=u.height-30+"px",d.find('div[id="EWA_FRAME_MAIN"]').css("height",u.height-150))});else{b.attr("full","1");b.attr("st",document.body.scrollTop);b.attr("dsp",b.css("display"));
var h=document.documentElement.clientHeight;g=document.documentElement.clientWidth-10;var k=h-20,l=document.documentElement.clientWidth-30,m=h-20-20-15;h=b.offset();var n=b.position(),p=h.left-n.left,q=b.width(),t=b.height();var u={width:q,height:t,"margin-left":p,left:n.left,top:n.top};b.attr("ori",JSON.stringify(u));b.css({"margin-left":"0px",top:h.top,left:h.left,position:"absolute",display:"",overflow:"auto"});b.animate({width:g,height:k,left:10,top:0},"fast","swing",function(){d.css("width",
l);d.css("height",m);b.find("iframe").css("height",m);b.find('div[id="EWA_FRAME_MAIN"]').css("height",m-30);0<e.length&&"DES_plugin"!=a&&e[0].click()});document.body.scrollTop=0;"none"!=$("#crm_left_box").css("display")&&($("#crm_left_box").hide(),$("#crm_left_box").attr("show",1));$(document.body).css("overflow","hidden")}};this.meargeItems=function(a){a=a.split(",");for(var b,d,e,g=0;g<a.length;g++){var h=a[g].trim();if($X(h)){var k=$X(h.replace("DES_",""));$("#"+h);var l=[];if(0==g){b=$X(h);e=
document.createElement("div");e.id="KK_"+h;e.style.cssText="clear:both;height:25px;border-top:1px solid #cdcdcd";e.setAttribute("but","1");d=k;for(var m=1;m<$X(h).childNodes.length;m++)if(k=$X(h).childNodes[m],1<m)k.id="M"+Math.random(),l.push(k.id);else{var n=k;n.className="ewa_lf_func_caption show";if(null==n.id||""==n.id)n.id="MAx"+Math.random();n.parentNode.setAttribute("lid",n.id)}for(;2<$X(h).childNodes.length;)k=$X(h).childNodes[2],e.appendChild(k)}else for(k.parentNode.style.display="none",
d.parentNode.appendChild(k),k.style.display="none",m=0;1<$X(h).childNodes.length;)k=$X(h).childNodes[1],0<m?(k.style.display="none",k.id="M"+Math.random(),l.push(k.id),e.appendChild(k)):(n=k,b.appendChild(k)),m++;n.setAttribute("ids",l.join(","));n.setAttribute("lst",h);n.setAttribute("menu_id",e.id);var p=this;addEvent(n,"click",function(){p.meargeItems_ck(this)})}else if(0==g)return}0<e.childNodes.length&&(b.appendChild(e),b.style.height="50px")};this.meargeItems_ck=function(a){var b=a.getAttribute("menu_id"),
d=a.parentNode.getAttribute("lid");null!=d&&0<d.length&&($X(d).className="ewa_lf_func_caption hide");a.className="ewa_lf_func_caption show";if(null==a.id||""==a.id)a.id="MAx"+Math.random();a.parentNode.setAttribute("lid",a.id);$("#"+b).children("div").each(function(){$(this).hide()});$(a).parent("div").parent("div").children(".ewa_cb_left").each(function(){$(this).hide()});b=a.getAttribute("ids");if(""!=b)for(b=b.split(","),d=0;d<b.length;d++)"ewa_lf_func_caption"!=$X(b[d]).className&&($X(b[d]).style.display=
"");a=a.getAttribute("lst");a=$X(a.replace("DES_",""));a.style.display="";a.style.width=a.parentNode.clientWidth-20+"px"};this.actIframe=function(a){var b=$("#"+a).find("iframe");if(0==b.length)alert(a+" not iframe");else{var d=b[0].contentWindow,e=d.document.body.scrollHeight,g=d.document.body.scrollWidth;if(d.$){var h=0;0<d.document.body.innerHTML.indexOf("EWA.F.F.C")?(h=d.$("#Test1").height(),g=d.$("#Test1").width()):(d.$(".ewa_table").parent().parent().children().each(function(){h+=$(this).height()}),
g=d.$(".ewa_table").width());e=h}g>$("#"+a).width()&&(e+=40);300>e&&(e=330);$("#"+a).css("height",e);var k=this;"0"!=b.attr("_src")?(b.attr("src",b.attr("_src")),b.attr("_src","0"),setTimeout(function(){k.chkFrameLazyLoaded(a)},199)):(k.setFrameCss(a,d),k.afterFrameLazyLoaded(a))}};this.setFrameCss=function(a,b){if(1!=$("#"+a).attr("lnk")){var d=b.document.createElement("link");d.type="text/css";d.rel="stylesheet";d.rev="stylesheet";d.href="../../css/main.css";b.document.getElementsByTagName("head")[0].appendChild(d);
b.document.body.style.backgroundColor="#fff";$("#"+a).attr("lnk",1)}};this.afterFrameLazyLoaded=function(a){};this.chkFrameLazyLoaded=function(a){var b=$("#"+a).find("iframe")[0].contentWindow;if(b&&b.document&&b.document.body&&b.$&&"complete"==b.document.readyState){var d=[],e=$("#"+a).parent().find("div[but=1]");0<e.length&&(b.$(".ewa_lf_func_dact").each(function(h){var k=document.createElement("div");k.className="ewa_lf_func_dact";k.style.cursor="pointer";k.innerHTML=this.innerHTML;""==this.id&&
(this.id=a+"|"+Math.random());k.id=this.id;e[0].appendChild(k);k.onclick=function(){this.id.split("|");$("#"+a).find("iframe")[0].contentWindow.$X(this.id).click()};d.push(k.id);0==h&&(this.parentNode.parentNode.style.display="none")}),e.parent().find(".show").attr("ids",d.join(",")));this.actIframe(a)}else{var g=this;setTimeout(function(){g.chkFrameLazyLoaded(a)},101)}};this.showInPlugin=function(a,b){if(0<a.indexOf(".jsp"))a='<iframe width=100% height=100% frameborder=0 src="'+a+'"></iframe>',$("#plugin").html(a),
this.showFull("DES_plugin"),document.body.scrollTop=0,$X("subject_plugin").innerHTML=b;else{var d=this;(new EWA.C.Ajax).Install(a+"&EWA_AJAX=install&EWA_FRAMESET_NO=1","_r=1","plugin",function(){d.showFull("DES_plugin");document.body.scrollTop=0;$X("subject_plugin").innerHTML=b})}}}
installCfgMoveButton1=function(a){var b=$("#"+a).find(".ewa_lf_func");if(0!=b.length&&(b=b[0],$X(a).getElementsByTagName("table")[0].style.height="",b.style.display="none",b=b.childNodes[1],0<b.getElementsByTagName("div").length))for(b.getElementsByTagName("div")[0].style.display="none";0<b.childNodes.length;)$X("DES_"+a).appendChild(b.childNodes[0])};
(function(a,b){"object"===typeof module&&"object"===typeof module.exports?module.exports=b():b(a)})("undefined"!==typeof window?window:this,function(a){function b(m){for(var n=[{number:0,scale:1,items:[]}],p=null,q=0;q<m.length;q++){var t=m[q],u=g[t],r=e[t];n[n.length-1].items.push([t,u,r]);if(u)0==q&&u.first?n[n.length-1].number=10:u.stop?(n[n.length-1].scale=u.value||1,n.push({number:0,scale:1,items:[]}),scale=1,p=null):(q==m.length-1&&(console.log(u),n[n.length-1].number.scale=u.value),p=u);else{if(null==
r)throw"\u975e\u6570\u5b57\u6216\u5355\u4f4d\uff1a"+t;t=q==m.length-1?null:m[q+1];var w=q==m.length-1?null:g[t];w&&w.stop&&(w=null);t=n[n.length-1].number;var v=n[n.length-1].items;u=v[v.length-2];v=v[v.length-3];null==w?null==p?(p=!1,u&&0===u[2]?v&&null!=v[1]&&(p=!0):u&&u[1]&&10===u[1].value&&(p=!0),r=p?t+r:10*t+r):r=u&&u[1]&&10===u[1].value&&(null==v||0===v[2]||null!=v[1])?t+r+10:t+r:r=t+r*w.value;n[n.length-1].number=r;p=null}}return n}function d(m){if(!m)return m;if(!isNaN(m.toString()))return 1*
m.toString();var n=m.replace(/\uff0c|,| |\u5143|\u5706/ig,"").replace(/\u70b9|\u3002/ig,".").split(".");if(2<n.length)throw"\u975e\u6570\u5b57\u8868\u8fbe\u5f0f\uff1a"+m;var p=n[0].split("");m=(2==n.length?n[1]:"").split("");n=!1;var q=p[0];h[q]?(n=!0,p=p.splice(1)):k[q]&&(n=!1,p=p.splice(1));q=p[p.length-1];l[q]?p=p.splice(0,p.length-1):1<m.length&&(q=m[m.length-1],l[q]&&(m=m.splice(0,m.length-1)));q=p;for(var t=p=0,u=q.length-1;0<=u;u-=2){var r=q[u];var w=e[q[u-1]];r=w?"\u89d2"==r?1*("0."+w):"\u5206"==
r?1*("0.0"+w):"\u5398"==r?1*("0.00"+w):"\u6beb"==r?1*("0.000"+w):-1:-1;if(-1===r)break;else p+=r,t++}q=q.splice(0,q.length-2*t);q=b(q);t=0;u=1;for(r=q.length-1;0<=r;r--){w=q[r];var v=w.number;u*=w.scale;t+=v*u}p=t+p;if(0<m.length){q=1;t=0;for(u=m.length-1;0<=u;u--){r=g[m[u]];if(!r)break;q*=r.value;t++}m=1==q?m:m.splice(0,m.length-t);t=b(m);u=0;r=1;for(w=t.length-1;0<=w;w--){v=t[w];var y=v.number;r*=v.scale;u+=y*r}m=[1*("0."+u),q,m.length]}else m=0;return 0==m?p*(n?-1:1):((p+m[0])*m[1]).toFixed(0>
m[2]?0:m[2])*(n?-1:1)}var e={"\u96f6":0,0:0,"\uff10":0,o:0,O:0,"\u4e00":1,"\u58f9":1,1:1,"\uff11":1,"\u4e8c":2,"\u8d30":2,2:2,"\uff12":2,"\u4e24":2,"\u4fe9":2,"\u4e09":3,"\u53c1":3,3:3,"\uff13":3,"\u56db":4,"\u8086":4,4:4,"\uff14":4,"\u4e94":5,"\u4f0d":5,5:5,"\uff15":5,"\u516d":6,"\u9646":6,6:6,"\uff16":6,"\u4e03":7,"\u67d2":7,7:7,"\uff17":7,"\u516b":8,"\u634c":8,8:8,"\uff18":8,"\u4e5d":9,"\u7396":9,9:9,"\uff19":9},g={"\u5341":{value:10,first:!0},"\u62fe":{value:10,first:!0},"\u4ec0":{value:10,first:!0},
"\u767e":{value:100},"\u4f70":{value:100},"\u964c":{value:100},"\u5343":{value:1E3},"\u9621":{value:1E3},"\u4edf":{value:1E3},k:{value:1E3,stop:!0},K:{value:1E3,stop:!0},"\u4e07":{value:1E4,stop:!0},"\u842c":{value:1E4,stop:!0},w:{value:1E4,stop:!0},W:{value:1E4,stop:!0},M:{value:1E6,stop:!0},m:{value:1E6,stop:!0},"\u4ebf":{value:1E8,stop:!0},b:{value:1E9,stop:!0},B:{value:1E9,stop:!0}},h={"-":!0,"\u8d1f":!0,"\uff0d":!0},k={"+":!0,"\u6b63":!0},l={"\u6574":!0};if("undefined"!=typeof window&&window.EWA&&
window.EWA_Utils)window.EWA_Utils.chineseToNumber=d;else if(a)a.chineseToNumber=d;else return d});
var EWAC_WfOrg=function(){this.Depts={};this.Posts={};this.Users={};this.GetMaster=function(a){var b=this.Users[a];if(null==b)console.log(("enus"==EWA.LANG?"NONE of ":"\u6ca1\u6709\u554a")+a);else{a=b.Dept;for(var d in a.Users){b=a.Users[d];for(var e in b.Posts)if(b.Posts[e].IsMaster)return b}console.log("enus"==EWA.LANG?"\tNo manager":"\u6ca1\u6709\u7ba1\u7406\u8005")}};this.IsMaster=function(a){var b=this.GetMaster(a);return null==b?!1:b.Id==a};this.InitDepts=function(a,b,d,e,g,h){for(var k=0;k<
a.length;k++){var l=a[k];if(null==this.Depts[l[b]]){var m={};m.Id=l[b];m.Name=l[d];m.Lvl=l[e];m.Ord=l[g];m.Pid=l[h];m.Posts={};m.Users={};m.Children={};this.Depts[m.Id]=m}}for(var n in this.Depts)l=this.Depts[n],this.Depts[l.Pid]?(a=this.Depts[l.Pid],l.Parent=a,a.Children[l.Id]=l):null==this.DeptRoot&&(this.DeptRoot=l)};this.InitPosts=function(a,b,d,e,g){for(var h=0;h<a.length;h++){var k=a[h],l=k[b];if(null==this.Posts[l]){var m={};m.Id=l;m.Name=k[d];m.DeptId=k[g];k=k[e];k=null==k?"":k.trim().toLowerCase();
m.IsMaster="y"==k||"yes"==k||"true"==k||"1"==k?!0:!1;this.Depts[m.DeptId]&&(m.Dept=this.Depts[m.DeptId],null==m.Dept.Posts[m.Id]&&(m.Dept.Posts[m.Id]=m));this.Posts[l]=m}}};this.InitUsers=function(a,b,d,e,g){for(var h=0;h<a.length;h++){var k=a[h],l=k[b];if(null!=this.Users[l])var m=this.Users[l];else m={},m.Id=l,m.Name=k[d],m.DeptId=k[e],m.Posts={},this.Depts[m.DeptId]&&(m.Dept=this.Depts[m.DeptId],null==m.Dept.Users[m.Id]&&(m.Dept.Users[m.Id]=m)),this.Users[l]=m;k=k[g];this.Posts[k]&&(m.Posts[k]=
this.Posts[k])}}};(function(){var a=[];a.push('<table gdx="LINE" style="border-collapse: collapse;width:100%;height:100%;font-size:0px" cellspacing="0" cellpadding="0"><tr>');a.push('<td style="font-size: 1px; width: 50%;" valign="top">&nbsp;</td>');a.push('<td style="font-size: 1px;" valign="top">&nbsp;</td></tr>');a.push('<tr><td style="font-size: 1px" valign="bottom">&nbsp;</td>');a.push('<td style="font-size: 1px;" valign="bottom">&nbsp;</td></tr></table>');EWAC_WF_CNN_TMP=a.join("")})();
function EWAC_WfUnit(a){this.Id=a;this.Type="normal";this.IsSelected=!1;this.tagName="wfunit";this.CnnsFrom={};this.CnnsFromLength=0;this.CnnsTo={};this.CnnsToLength=0;this.IsDelete=!1;this.ChangeType=function(b){var d=$X(this.Id),e="ewa_wf_unit_img";"control"==b?e="ewa_wf_unit_img1":"end"==b&&(e="ewa_wf_unit_img2");d.getElementsByTagName("img")[0].className=e};this.ChangeDes=function(b){var d=$X(this.Id);SetInnerText(d.getElementsByTagName("td")[1].childNodes[0],b)};this.GetDes=function(){return GetInnerText($X(this.Id).getElementsByTagName("span")[0]).trimEx()};
this.Delete=function(){if(!this.IsDelete){for(var b in this.CnnsFrom)this.CnnsFrom[b].Delete();for(b in this.CnnsTo)this.CnnsTo[b].Delete();b=$X(this.Id);b.parentNode.removeChild(b)}this.IsDelete=!0};this.Log=function(b,d,e){var g=null==EWA.RV_STATIC_PATH?EWA.CP:EWA.RV_STATIC_PATH;g+="/EWA_STYLE/";var h=$X(this.Id),k=h.getElementsByTagName("img")[0];k.src=g+"images/workflow/wf_ok.png?a=1";k.style.width="38px";k.style.height="38px";k.className="";g=k.nextSibling;null!=e&&0<e.trim().length&&(h.title=
e);e="";try{e=(new EWA_Utils.Date(d)).FormatDate()}catch(l){}g.innerHTML+='<div style="font-size:9px;color:darkblue">'+b+"<br><nobr>"+e+"</nobr></div>";h.style.backgroundColor="lightyellow"};this.LogCur=function(b){var d=$X(this.Id),e=d.getElementsByTagName("img")[0],g=e.nextSibling,h=null;b&&window.parent&&window.parent.$X(b)&&(h=window.parent.$X(b),h.options.length=0,h.options[h.options.length]=new Option("",""));b=!0;for(var k in this.CnnsFrom){b=!1;var l=this.CnnsFrom[k];l.IsStop||(l.Selected(),
l=EWAC_WfUtil.WF.Units[l.To],l.LogTo(),h&&(h.options[h.options.length]=new Option(l.GetDes(),l.Id)))}e.style.width="38px";e.style.height="38px";e.className="";k=null==EWA.RV_STATIC_PATH?EWA.CP:EWA.RV_STATIC_PATH;k+="/EWA_STYLE/";b?(g.innerHTML="enus"==EWA.LANG?g.innerHTML+"<i><b>Finished</b></i>":g.innerHTML+"<i><b>\u6267\u884c\u7ed3\u675f</b></i>",e.src=k+"images/workflow/wf_no.png?A=1"):(g.innerHTML="enus"==EWA.LANG?g.innerHTML+"<i><b>Current</b></i>":g.innerHTML+"<i><b>\u5f53\u524d\u8282\u70b9</b></i>",
h&&2==h.options.length&&(h.selectedIndex=1),d.style.backgroundColor="lightblue",d.style.color="white",e.src=k+"images/workflow/wf_cur.png?A=1")};this.LogTo=function(){var b=null==EWA.RV_STATIC_PATH?EWA.CP:EWA.RV_STATIC_PATH;b+="/EWA_STYLE/";var d=$X(this.Id);d.style.backgroundColor="lightyellow";d=d.getElementsByTagName("img")[0];d.src=b+"images/workflow/wf_next.png?A=2";d.style.width="38px";d.style.height="38px";d.className=""};this.Create=function(b){var d=EWAC_WfUtil.CUR_OBJ,e=document.createElement("TABLE");
e.id=this.Id;e.className="ewa_wf_box";var g=e.insertRow(-1);g=g.insertCell(-1);g.innerHTML='<img style="cursor:pointer" class="ewa_wf_unit_img" src="'+((null==EWA.RV_STATIC_PATH?EWA.CP:EWA.RV_STATIC_PATH)+'/EWA_STYLE//images/transparent.png" id="Atom_Img_')+a+'"><div a=1></div>';g.align="center";g=e.insertRow(-1);g=g.insertCell(-1);g.align="center";g.innerHTML='<span onselectstart="return true" onkeypress="EWAC_WfUtil.AtomNameKeyPress(this)" onblur="EWAC_WfUtil.AtomChangedName(this)" ondblclick="EWAC_WfUtil.AtomChangeName(this)">\u4e1a\u52a1\u5143'+
b+"</span>";document.body.appendChild(e);e.style.position="absolute";e.style.left=d?d.style.left:120*b+"px";e.style.top=d?d.style.top:"90px";d&&(d.style.position="static")};this.MoveTo=function(b,d){var e=this.GetObj();e.style.left=1*e.style.left.replace("px","")+b+"px";e.style.top=1*e.style.top.replace("px","")+d+"px";for(var g in this.CnnsFrom)this.CnnsFrom[g].IsDelete||(this.CnnsFrom[g].Show(),this.CnnsFrom[g].Disp());for(g in this.CnnsTo)this.CnnsTo[g].IsDelete||(this.CnnsTo[g].Show(),this.CnnsTo[g].Disp())};
this.GetObj=function(){return $X(this.Id)};this.UnSelect=function(){$X(this.Id).getElementsByTagName("img")[0].className="ewa_wf_unit_img";this.IsSelected=!1;EWAC_WfUtil.SELECTED=null};this.Selected=function(){$X(this.Id).getElementsByTagName("img")[0].className="ewa_wf_unit_img1";this.IsSelected=!0;EWAC_WfUtil.SELECTED=this}}
function EWAC_WfCnn(){this.IsSelect=!1;this.To=this.From=this.Type=this.Id=null;this.tagName="wfcnn";this.IsDelete=!1;this.ChangeStyle=function(a,b){a=$X(this.Id).getElementsByTagName("td");for(b=0;b<a.length;b++);};this.Delete=function(){var a=$X(this.Id);this.IsDelete||a.parentNode.removeChild(a);this.IsDelete=!0};this._CreateObject=function(a,b){a=document.createElement("div");a.id=this.Id;a.style.width=10;a.style.height=10;a.style.position="absolute";a.style.zIndex=0;a.innerHTML=EWAC_WF_CNN_TMP;
document.body.appendChild(a)};this.Create=function(a,b){this.Id=a.Id+"G"+b.Id;this.From=a.Id;this.To=b.Id;a.CnnsFrom[this.Id]=this;a.CnnsFromLength++;b.CnnsTo[this.Id]=this;b.CnnsToLength++;this._CreateObject(a,b);this.Show()};this.Show=function(){$X(this.Id);var a=$X(this.From),b=$X(this.To),d=a.offsetLeft,e=d+a.offsetWidth,g=a.offsetTop,h=g+a.offsetHeight,k=b.offsetLeft,l=k+b.offsetWidth,m=b.offsetTop,n=m+b.offsetHeight;a=0;e<k?(b=e,e=k-e,h<m?(d=h,h=m-h,g="0T,1L,3LBA"):h>m&&h<n?(d=g,h=n-g,g="0T,1L,3LBA"):
(g>n?(d=n,h=g-n):(d=m,h-=m),g="2B,3L,1LTA"),g+="\u7b2c\u4e00"):l<d?(b=l,e=d-l,h<m?(d=h,h=m-h,g="1T,0R,2RBA"):h>m&&h<n?(d=g,h=n-g,g="2BA,3L,1LT"):g>n?(d=n,h=g-n,g="0TA,1L,3LB(\u4e09)"):(d=m,h-=m,g="0TA,1L,3LB(\u56db)"),g+="\u7b2c\u4e8c"):d>k&&d<l?(b=l,e=e-l+20,h<m?(d=h,h=m-h,a=20,g="1TR,3RB,2BA(\u5927)"):(d=n,h=g-n,a=20,g="0TA,1TR,3RB(##)")):(b=e,e=l-e+20,h<m?(d=h,h=m-h,a=20,g="0T,1TR,3RBA(\u58eb)"):(d=n,h=g-n,a=20,g="1TRA,3RB,2B(#)"));null==g&&(g="\u672a\u53d1\u73b0");document.title=g;this.Drawline(g,
b,d,e,h,a);this.Disp(1)};this.Drawline=function(a,b,d,e,g,h){var k=$X(this.Id);0>e||0>g||(k.setAttribute("type",a),k.style.left=b+"px",k.style.top=d+"px",k.style.height=g+"px",k.style.width=e+"px",0==e||0>e-h||(a=k.childNodes[0].rows[0].cells[0],k=k.childNodes[0].rows[0].cells[1],0<h?(k.style.width=h+"px",a.style.width=e-h+"px"):(k.style.width="50%",a.style.width="50%")))};this.Disp=function(a,b){var d=$X(this.Id),e=null==a?1:a;a=d.getAttribute("type");var g=d.getAttribute("w");d.childNodes[0].setAttribute("type",
a);d.childNodes[0].setAttribute("w",g);for(g=d.getElementsByTagName("img");0<g.length;)g[0].parentNode.removeChild(g[0]),g=d.getElementsByTagName("img");for(var h=0;h<g.length;h++)g[h].style.display="none";g=d.getElementsByTagName("td");for(h=0;h<g.length;h++)g[h].style.border="0px";b=(null==b?"#000":b)+" "+e+"px solid";for(h=0;h<a.length;h++)if(d=a.substring(h,h+1),""!=d.trim())if(isNaN(d))"T"==d?k.style.borderTop=b:"L"==d?k.style.borderLeft=b:"R"==d?k.style.borderRight=b:"B"==d?k.style.borderBottom=
b:"A"==d&&(3==l?"0px"!=k.style.borderLeftWidth?(d="arraw_t00.gif",k.style.textAlign="right"):(d="arraw_t01.gif",k.style.textAlign="left"):2==l?(d="arraw_t01.gif",k.style.textAlign="left"):1==l?"0px"!=k.style.borderLeftWidth?(d="arraw_t10.gif",k.style.textAlign="right"):(d="arraw_t11.gif",k.style.textAlign="left"):(d="arraw_t11.gif",k.style.textAlign="left"),e=null==EWA.RV_STATIC_PATH?EWA.CP:EWA.RV_STATIC_PATH,e+="/EWA_STYLE/",k.innerHTML='<img src="'+e+"images/workflow/"+d+'" />');else{var k=g[1*
d];var l=d}};this.UnSelect=function(){this.Disp(1);this.IsSelected=!1;EWAC_WfUtil.SELECTED=null};this.Selected=function(){this.Disp(3);this.IsSelected=!0;EWAC_WfUtil.SELECTED=this}}
function EWAC_Wf(){this.Ids=null;this._CurIdx=0;this.Units={};this.Cnns={};this.GetUnid=function(){var a=this.Ids[this._CurIdx];this._CurIdx++;return a};this._LodIds=function(){var a=EWA.CP+"/EWA_DEFINE/cgi-bin/xml/?TYPE=GUNID&NUM=100",b=new EWA_AjaxClass;b.Get(a,function(){b.IsRunEnd()&&eval("c.Ids="+b.GetRst())})};this.ClearSelects=function(){for(var a in this.Units)this.Units[a].UnSelect();EWAC_WfUtil.CUR_OBJ=null;EWAC_WfUtil.TWO=[null,null]};this.GetUnit=function(a){var b;"ewa_wf_box"==a.className?
b=a.id:-1<a.id.indexOf("Atom_Img_")&&(b=a.id.replace("Atom_Img_",""));return b?this.Units[b]:null};this.CreateUnit=function(a){a||(a=this.GetUnid());var b=new EWAC_WfUnit(a);b.Create(this._CurIdx);return this.Units[a]=b};this.CreateCnn=function(){var a=EWAC_WfUtil.TWO[0],b=EWAC_WfUtil.TWO[1];if(null==a||null==b)alert("\u9700\u8981\u4e24\u4e2a\u4e1a\u52a1\u5143");else{var d=new EWAC_WfCnn;d.Create(a,b);this.Cnns[d.Id]=d}};this.GetCnn=function(a){return this.Cnns[a.parentNode.id]}}
var EWAC_WfUtil={CUR_OBJ:null,TWO:[null,null],SELECTED:null,MouseDown:function(a){a=a?a:event;var b=EWA.B.IE?a.srcElement:a.target,d=b.tagName.toUpperCase();if("TD"==d&&"Test1"==b.parentNode.parentNode.parentNode.id)EWAC_WfUtil.WF.ClearSelects();else{var e=EWA.UI.Utils.GetMousePosition(a);EWAC_WfUtil.M_X=e.X;EWAC_WfUtil.M_Y=e.Y;if("IMG"==d)if("TEMP"==b.id)EWAC_WfUtil.CUR_OBJ=b;else{if(b=EWAC_WfUtil.WF.GetUnit(b),EWAC_WfUtil.CUR_OBJ=b)EWA.UI.Utils.GetMousePosition(a),EWAC_WfUtil.objSelectedDown(b),
EWAC_WfUtil.ShowUnitPara(b)}else"TD"==d&&(a=b.parentNode.parentNode.parentNode,"LINE"==a.getAttribute("gdx")&&(a=EWAC_WfUtil.WF.GetCnn(a),a.IsSelected?a.UnSelect():a.Selected()))}},MouseUp:function(a){a=EWAC_WfUtil.CUR_OBJ;null!=a&&("TEMP"==a.id&&EWAC_WfUtil.WF.CreateUnit(),EWAC_WfUtil.CUR_OBJ=null)},MouseMove:function(a){var b=EWAC_WfUtil.CUR_OBJ;if(null!=b){a=EWA.UI.Utils.GetMousePosition(a?a:event);var d=a.X-EWAC_WfUtil.M_X,e=a.Y-EWAC_WfUtil.M_Y;EWAC_WfUtil.M_X=a.X;EWAC_WfUtil.M_Y=a.Y;"IMG"==b.tagName?
(b.style.position="absolute",b.style.left=a.X+"px",b.style.top=a.Y+"px"):"wfunit"==b.tagName&&b.MoveTo(d,e)}},Delete:function(){var a=EWAC_WfUtil.SELECTED;null!=a&&(0==a.tagName.indexOf("wf")&&(a.Delete(),EWAC_WfUtil.TWO=[null,null],EWAC_WfUtil.SELECTED=null),EWAC_WfUtil.CUR_OBJ=null)},objSelectedDown:function(a){a.IsSelected?(a.UnSelect(),EWAC_WfUtil.TWO[0]==a&&(EWAC_WfUtil.TWO[0]=EWAC_WfUtil.TWO[1]),EWAC_WfUtil.TWO[1]=null):null==EWAC_WfUtil.TWO[1]&&(a.Selected(),null==EWAC_WfUtil.TWO[0]?EWAC_WfUtil.TWO[0]=
a:EWAC_WfUtil.TWO[1]=a)},AtomChangeName:function(a){a.contentEditable=!0;a.style.border="1px solid black"},AtomChangedName:function(a){a.contentEditable=!1;a.style.border=""},AtomNameKeyPress:function(a){13==event.keyCode&&AtomChangedName(a)},ShowUnitPara:function(a){}};function Init(){EWAC_WfUtil.WF=new EWAC_Wf;EWAC_WfUtil.WF._LodIds()}
function loadWfShow(a,b,d,e,g,h,k,l,m,n){_EWA_WF&&_EWA_WF.EN&&(_EWA_WF.EN1=$J2MAP(_EWA_WF.EN,"WF_UNIT_ID"));e=document.createElement("div");e.style.position="absolute";e.style.zIndex=123;e.innerHTML="ver: "+_EWA_WF.WF_DLV_VER;document.body.appendChild(e);var p=EWAC_WfUtil.WF,q=1000012,t=1000011;for(e=0;e<a.length;e++){var u=a[e],r=u.WF_UNIT_X,w=u.WF_UNIT_Y;null!=r&&1*r<q&&(q=1*r);null!=w&&1*w<t&&(t=1*w)}1000012==q&&(q=0);1000011==t&&(t=0);q-=10;t-=10;n={};var v;for(e=0;e<a.length;e++)u=a[e],p.Ids[e]=
u.WF_UNIT_ID,r=p.CreateUnit(),n[u.WF_UNIT_ID]=r,w=u.WF_UNIT_NAME,"enus"==EWA.LANG&&_EWA_WF.EN1&&_EWA_WF.EN1[u.WF_UNIT_ID]&&_EWA_WF.EN1[u.WF_UNIT_ID].WF_UNIT_NAME_EN&&(w=_EWA_WF.EN1[u.WF_UNIT_ID].WF_UNIT_NAME_EN),r.ChangeDes(w),r.ChangeType(u.WF_UNIT_TYPE),r.WF_UNIT_ADM=u.WF_UNIT_ADM,r.WF_UNIT_ADM_LST=u.WF_UNIT_ADM_LST,r=u.WF_UNIT_X,w=u.WF_UNIT_Y,u=$X(u.WF_UNIT_ID),null!=r&&(u.style.left=r-q+"px"),null!=w&&(u.style.top=w-t+"px");a={};for(e=0;e<b.length;e++)u=b[e],r=u.WF_UNIT_FROM,a[r]||(a[r]=[]),a[r].push(u);
for(e=0;e<b.length;e++)u=b[e],a=u.WF_UNIT_TO,r=u.WF_UNIT_FROM,r=p.Units[r],a=p.Units[a],q=new EWAC_WfCnn,q.Create(r,a),p.Cnns[q.Id]=q,u.IsHaveLogic&&!u.IsLogicOk&&(q.IsStop=!0);for(var y in p.Units)e=p.Units[y],null==v&&0==e.CnnsToLength&&(v=e);if(null==v)e="enus"==EWA.LANG?"No startup node was found, process definition error":"\u672a\u53d1\u73b0\u542f\u52a8\u8282\u70b9,\u6d41\u7a0b\u5b9a\u4e49\u9519\u8bef",alert(e);else{0==d.length&&(p.CurUnit=v);var x=[];y={};for(e=0;e<d.length;e++)b=d[e],p=b.SYS_STA_TAG,
r=n[p],null!=r&&(u=b.ADM_NAME,"enus"==EWA.LANG&&b.ADM_NAME_EN&&(u=b.ADM_NAME_EN),r.Log(u,b.SYS_STA_CDATE,b.SYS_STA_MEMO),y[p]||(y[p]=1,x.push({ID:p,DES:r.GetDes()})),p=b.SYS_STA_TAG+"G"+b.SYS_STA_VAL,EWAC_WfUtil.WF.Cnns[p]&&(EWAC_WfUtil.WF.Cnns[p].Disp(3,"blue"),r==v&&(r.ADM_ID=b.ADM_ID),e==d.length-1&&(r=n[b.SYS_STA_VAL],r.WF_UNIT_ADM_LST=b.ROLE_IDS,r.WF_UNIT_ADM=b.ROLE_TYPE,EWAC_WfUtil.WF.CurUnit=r)));null!=m&&0<m.length&&n[m]&&(EWAC_WfUtil.WF.CurUnit=n[m]);EWAC_WfUtil.WF.CurUnit.LogCur(g);m=!1;
r=EWAC_WfUtil.WF.CurUnit;d=[];if(v==r)m=!0;else if("WF_ADM_ADM"==r.WF_UNIT_ADM)if(v=","+r.WF_UNIT_ADM_LST+",",0<=v.indexOf(","+h+","))m=!0;else for(e in h=$J2MAP1(top.org,"ADM_ID"),k=r.WF_UNIT_ADM_LST.split(","),k){l=h[k[e]];for(var z in l)d.push(l[z].ADM_NAME)}else if("WF_ADM_DEPT"==r.WF_UNIT_ADM)if(v=","+r.WF_UNIT_ADM_LST+",",0<=v.indexOf(","+k+","))m=!0;else for(e in h=$J2MAP1(top.org,"DEP_ID"),k=r.WF_UNIT_ADM_LST.split(","),k)for(z in l=h[k[e]],l)d.push(l[z].ADM_NAME);else if("WF_ADM_POST"==r.WF_UNIT_ADM){v=
","+r.WF_UNIT_ADM_LST+",";h=l.split(",");for(k=0;k<h.length;k++)if(0<=v.indexOf(","+h[k]+",")){m=!0;break}if(!m)for(e in h=$J2MAP1(top.org,"DEP_POS_ID"),k=r.WF_UNIT_ADM_LST.split(","),v={},k)for(z in l=h[k[e]],l)n=l[z],v[n]||(v[n]=!0,d.push(l[z].ADM_NAME))}else if("WF_ADM_START"==r.WF_UNIT_ADM){if(v==r||h==v.ADM_ID)m=!0}else"WF_ADM_MANAGER"==r.WF_UNIT_ADM&&(z=v.ADM_ID,top||top.ORG||(e="enus"==EWA.LANG?"No organization":"\u6ca1\u6709\u7ec4\u7ec7\u673a\u6784",alert(e),m=!1),m=top.ORG.GetMaster(z).Id==
h?!0:!1);g&&window.parent&&window.parent.$X(g)&&(z=window.parent.$X(g).parentNode.parentNode.parentNode,m?0<x.length&&(e=z.rows[z.rows.length-1].cells[0],h=window.parent.document.createElement("input"),h.type="button",h.value="enus"==EWA.LANG?"Back":"\u6253\u56de",h.onclick=function(){var A=window.parent.$X(g);A.options.length=1;for(var B=0;B<x.length;B++){var D=x[B];A.options[A.length]=new Option(D.DES,D.ID);this.style.display="none"}A.parentNode.parentNode.cells[0].innerHTML="enus"==EWA.LANG?'<div style="color:red">Back steps</div>':
'<div style="color:red">\u8fd4\u56de\u6b65\u9aa4</div>'},e.insertBefore(h,e.getElementsByTagName("input")[1])):(0==d.length?(e="enus"==EWA.LANG?"Only view":"\u60a8\u53ea\u80fd\u67e5\u770b",window.parent.$X(g).parentNode.innerHTML="<b>"+e+"</b>"):(e="enus"==EWA.LANG?"Waitting":"\u7b49\u5f85",h="enus"==EWA.LANG?"or":"\u6216",window.parent.$X(g).parentNode.innerHTML="<b>"+e+':<span style="color:blue">'+d.join("</span> "+h+' <span style="color:blue">')+"</span></b>"),window.parent.$X("butOk").style.display=
"none"),(e=_EWA_WF.WF_SHOW)&&showControls(z,e))}}function showControls(a,b){for(var d=a.rows.length-5;0<=d;d--)0!=a.rows[d].id.indexOf("_ewa_tr$EWA_WF_")&&(a.rows[d].style.display="none");var e={},g=!1;for(d=0;d<b.length;d++)for(var h=b[d].XITEMS.split(","),k=0;k<h.length;k++){var l=h[k].trim();""==l||e[l]||(e[l]=1,g=!0)}if(g)for(var m in e)if(b=a.ownerDocument.getElementById("_ewa_tr$"+m))b.style.display=""}
function loadWf(a,b){for(var d=EWAC_WfUtil.WF,e=1000012,g=1000011,h=0;h<a.length;h++){var k=a[h],l=k.WF_UNIT_X,m=k.WF_UNIT_Y;l<e&&(e=l);m<g&&(g=m)}for(h=0;h<a.length;h++)k=a[h],d.Ids[h]=k.WF_UNIT_ID,l=d.CreateUnit(),l.ChangeDes(k.WF_UNIT_NAME),l.ChangeType(k.WF_UNIT_TYPE),l=k.WF_UNIT_X,m=k.WF_UNIT_Y,k=$X(k.WF_UNIT_ID),null!=l&&(k.style.left=l+"px"),null!=m&&(k.style.top=m+"px");for(h=0;h<b.length;h++){k=b[h];a=d.Units[k.WF_UNIT_FROM];k=d.Units[k.WF_UNIT_TO];l=new EWAC_WfCnn;try{l.Create(a,k),d.Cnns[l.Id]=
l}catch(n){alert(n)}}}
function loadByDefined(){for(var a=window.parent._EWAC_User.WorkflowTableSet,b=EWAC_WfUtil.WF,d=0;d<a.Count();d++){var e=a.GetItem(d);b.Ids[d]=e.Name;var g=b.CreateUnit(),h=e.Tables.GetItem("descriptionset").SearchValue("lang=zhcn","info");g.ChangeDes(h);e=e.Tables.GetItem("WfType").GetSingleValue();g.ChangeType(e)}for(d=0;d<a.Count();d++)g=a.GetItem(d),e=g.Tables.GetItem("WfType").GetSingleValue(),"end"!=e&&(EWAC_WfUtil.TWO[0]=b.Units[g.Name],g=g.Tables.GetItem("WfAction"),e=g.GetValue("WFANextYes"),
null==e||""==e?(e=a.GetItem(d+1),EWAC_WfUtil.TWO[1]=b.Units[e.Name]):(alert(e),EWAC_WfUtil.TWO[1]=b.Units[e]),b.CreateCnn(),e=g.GetValue("WFANextNo"),null!=e&&""!=e&&(alert(e),EWAC_WfUtil.TWO[1]=b.Units[e]),b.CreateCnn());EWAC_WfUtil.TWO[0]=EWAC_WfUtil.TWO[1]=null}
function CreateExp(){var a=new EWA_XmlClass;a.LoadXml("<EwaWf><Units /><Cnns /><Draw /></EwaWf>");for(var b=a.GetElement("Units"),d=a.GetElement("Cnns"),e=document.getElementsByTagName("TABLE"),g=[],h=0;h<e.length;h++){var k=e[h];if(0==k.id.indexOf("Atom_Table_")||"none"==k.style.display){var l=a.NewChild("Unit",b);l.setAttribute("Unid",k.getAttribute("sid"));l.setAttribute("Type",k.getAttribute("type"));l.setAttribute("Des",GetInnerText(k).trim());g.push(GetOuterHTML(k))}}b=document.getElementsByTagName("DIV");
for(h=0;h<b.length;h++)if(e=b[h],0==e.id.indexOf("Atom_Table_")){l=e.id.split("G");k=l[0].replace("Atom_Table_","");var m=l[1].replace("Atom_Table_","");l=a.NewChild("Cnn",d);l.setAttribute("Unid",e.id);l.setAttribute("From",k);l.setAttribute("To",m);l.setAttribute("Logic","");g.push(GetOuterHTML(e))}d=a.GetElement("Draw");a.SetCData(g.join("\r\n"),d);alert(a.GetXml())}
function SetAtomName(a){""!=CurSelectedID&&(window.arrayAtoms[CurSelectedID][2]=a,$X("Atom_Table_"+CurSelectedID).rows[1].cells[0].innerText=a)}function SetAtomType(a){if(""!=CurSelectedID){var b=null==EWA.RV_STATIC_PATH?EWA.CP:EWA.RV_STATIC_PATH;b+="/EWA_STYLE/";window.arrayAtoms[CurSelectedID][1]=a;var d=$X("Atom_Table_"+CurSelectedID);d.type=a;d.rows[0].cells[0].childNodes[0].src=0==a?b+"images/workflow/nulla.gif":b+"images/workflow/nullaico.gif"}}
function loadParentInfoJson(a,b,d){a=a[b];for(var e in a){var g=d.insertRow(0);b=g.insertCell(-1);b.className="EWA_TD_L";g=g.insertCell(-1);g.className="EWA_TD_M";var h=a[e].VAL;b.innerHTML='<span style="color:111"><i>'+a[e].DES+"</i></span>";g.innerHTML=h}}
function loadParentInfo(){EWA.OW.Load();if(EWA.OW.PWin){for(var a,b=document.getElementsByTagName("table"),d=0;d<b.length;d++){var e=b[d];if(0==e.id.indexOf("EWA_FRAME_")){a=e;break}}if(null!=a)if(d=a.parentNode.parentNode.offsetHeight,b=a.offsetHeight,e=document.createElement("div"),e.style.height=d-b+"px",e.style.overflow="auto",e.innerHTML="<table broder=0 cellpadding=1 cellspacing=1 class=EWA_TABLE></table>",a.parentNode.insertBefore(e,a),a=e.childNodes[0],d=EWA.OW.PWin,b=new EWA_UrlClass,b.SetUrl(window.location.href),
e=b.GetParameter("fjson"),null!=e)loadParentInfoJson(d,e,a);else{b._Paras.COMBINE_ID&&d.$("#"+b._Paras.COMBINE_ID).find("li").each(function(n){0==n%2&&(k=a.insertRow(0),l=k.insertCell(-1),l.className="EWA_TD_L",l.innerHTML='<span style="color:111"><i>'+$(this).text()+"</i></span>");1==n%2&&(n=k.insertCell(-1),n.className="EWA_TD_M",n.innerHTML=$(this).text())});for(h in d.EWA.F.FOS)if(h==b.GetParameter("EWA_PARENT_FRAME")){var g=d.EWA.F.FOS[h];break}if(g&&(g=g.SelectCheckedRows(),0!=g.length)){g=
g[0];var h=g.parentNode.rows[0];for(d=g.cells.length-1;0<=d;d--)if(!(0<g.cells[d].getElementsByTagName("input"))&&(b=GetInnerText(h.cells[d]),e=GetInnerText(g.cells[d]),null!=b&&""!=b.trim()&&null!=e&&""!=e.trim()&&(b=b.replace("?","").trim(),b.trim()!=e.trim()))){var k=a.insertRow(0),l=k.insertCell(-1);l.className="EWA_TD_L";var m=k.insertCell(-1);m.className="EWA_TD_M";l.innerHTML='<span style="color:111"><i>'+b+"</i></span>";m.innerHTML=e}}}}else window.setTimeout(loadParentInfo,300)}
function getSpJson(){for(var a=null,b=document.getElementsByTagName("table"),d=0;d<b.length;d++)if(0==b[d].id.indexOf("EWA_FRAME_")){a=b[d];break}d="EWA_ITEMS_XML_"+a.id.replace("EWA_FRAME_","");a=[];a.push("[");b=new EWA_XmlClass;b.LoadXml(window[d]);b=b.XmlDoc.getElementsByTagName("XItem");for(d=0;d<b.length;d++){0<d&&a.push(",");var e=getSpItem(b[d]);eval("o="+e);if("select"==(void 0).TAG){for(var g=$X((void 0).NAME),h=[],k=0;k<g.options.length;k++){var l=g.options[k];h.push(l.text+"gdx|z"+l.value.replace(/"/ig,
""))}e=e.replace('"} ','"A":"'+h.join("!@1`")+"}");$X("EWA_WF_UMSG").value=e}a.push(e)}a.push("]");alert(a.join(""))}
function getSpItem(a){var b=a.getElementsByTagName("Tag")[0].getElementsByTagName("Set")[0].getAttribute("Tag"),d=a.getElementsByTagName("Name")[0].getElementsByTagName("Set")[0].getAttribute("Name");a=a.getElementsByTagName("DescriptionSet")[0].getElementsByTagName("Set")[0].getAttribute("Info");return'{"TAG":"'+b+'", "NAME":"'+d.replace(/"/ig,"")+'", "DES":"'+a.replace(/"/ig,"")+'"} '}
function EWA_DocWordClass(){this.docks=[];this.pics=[];this.liNum=0;this.defaultFontEnglish="Century Gothic";this.defaultFontChinese="Microsoft YaHei";this.walker=function(a,b){3==a.nodeType?this.walkerTxt(a):1==a.nodeType&&this.walkerEle(a)};this.walkerEle=function(a){if("none"!=a.style.display){var b=a.tagName,d=!1;if("LI"==b){var e=this.createP(a);var g=this.getDockTable();g.appendChild(e);this.docks.push(e);d=!0;this.createLi(a)}else if("BR"==b){e=this.createBr(a);g=this.getDock();if("w:p"!=g.tagName){var h=
this.createP(a.parentNode),k=this.createSpan(a.parentNode);h.appendChild(k);h.appendChild(e);g.appendChild(h);this.docks.push(h)}else g.appendChild(e);this.lastWR=null}else if("IMG"==b)g=this.getDock(),e=this.createPic(a),"w:p"!=g.tagName?(h=this.createP(a.parentNode),k=this.createSpan(a.parentNode),h.appendChild(k),h.appendChild(e),g.appendChild(h),this.docks.push(h),d=!0,e=h):g.appendChild(e),this.lastWR=null;else if("TABLE"==b)k=this.getDockTable(),e=a.previousElementSibling,null!=e&&"TABLE"==
e.tagName&&(g=this.createPVanish(),k.appendChild(g[0])),e=this.createTable(a),null!=e&&(d=!0,k.appendChild(e),this.docks.push(e));else if("TBODY"==b)e=this.createTbody(a),this.getDock().appendChild(e);else if("TR"==b)e=this.createTr(a),this.getDock().appendChild(e),this.docks.push(e),d=!0;else if("TD"==b)e=this.createTd(a),this.getDock().appendChild(e),this.docks.push(e),d=!0;else if("HR"==b)g=this.getDockTable(),e=this.createP(a),k=this.createSpan(a),e.appendChild(k),h=this.createHr(),k.appendChild(h),
this.lastWR=null,g.appendChild(e);else if("LI"==a.parentNode.tagName||"H1"!=b&&"H2"!=b&&"H3"!=b&&"P"!=b&&"CENTER"!=b&&"DIV"!=b){if("SCRIPT"==b)return;"BODY"!=b&&"OL"!=b&&"UL"!=b&&(g=this.getDock(),e=this.createSpan(a),"w:p"!=g.tagName?(h=this.createP(a.parentNode),h.appendChild(e),g.appendChild(h),this.docks.push(h)):g.appendChild(e))}else g=this.getDockTable(),e=this.createP(a),g.appendChild(e),this.docks.push(e),d=!0;for(g=0;g<a.childNodes.length;g++)this.walker(a.childNodes[g]);d&&(this.docksPop(e),
this.lastWR=null);"TD"==b&&1==e.childNodes.length?(h=this.createEle("w:p"),e.appendChild(h)):"TABLE"==b&&null==e.nextSibling&&"w:tc"==e.parentNode.tagName&&(h=this.createEle("w:p"),e.parentNode.appendChild(h))}};this.walkerTxt=function(a){if(""!=a.nodeValue.trimEx()){var b=this.createText(a),d=this.getDock();if("w:p"!=d.tagName){var e=this.createP(a.parentNode);a=this.createSpan(a.parentNode);e.appendChild(a);a.appendChild(b);d.appendChild(e);this.docks.push(e)}else this.lastWR||(a=this.createSpan(a.parentNode),
d.appendChild(a)),this.lastWR.parentNode.appendChild(b)}this.lastWR=null};this.createEle=function(a){return this.doc.XmlDoc.createElement(a)};this.createEles=function(a){a=a.split(",");for(var b=[],d=0;d<a.length;d++){var e=this.createEle(a[d].trim());b.push(e);0<d&&b[0].appendChild(e)}return b};this.createElesLvl=function(a){a=a.split(",");for(var b=[],d=0;d<a.length;d++){var e=this.createEle(a[d].trim());b.push(e);0<d&&b[d-1].appendChild(e)}return b};this.createElesSameLvl=function(a,b){a=a.split(",");
for(var d=[],e=0;e<a.length;e++){var g=this.createEle(a[e].trim());d.push(g);b.appendChild(g)}return d};this.createText=function(a){if(""!=a.nodeValue.trim()){var b=this.createEle("w:t");EWA.B.IE?b.text=a.nodeValue:b.textContent=a.nodeValue;return b}};this.createHr=function(){var a=this.createElesLvl("w:pict,v:rect");a[0].setAttribute("w14:anchorId",this.getParaId());this.setAtts(a[1],{style:"width:.05pt;height:1pt","o:hralign":"center","o:hrstd":"t","o:hrnoshade":"t","o:hr":"t",fillcolor:"black [3213]",
stroked:"f"});return a[0]};this.createLi=function(a){var b=this.createEles("w:numPr,w:ilvl,w:numId");"OL"==a.parentNode.tagName?(a==a.parentNode.getElementsByTagName("li")[0]&&this.liNum++,b[1].setAttribute("w:val",0),b[2].setAttribute("w:val",this.liNum)):(b[1].setAttribute("w:val",0),b[2].setAttribute("w:val",22));a=this.createEle("w:spacing");a.setAttribute("w:line",270);a.setAttribute("w:lineRule","atLeast");var d=this.getDock();d.getElementsByTagName("w:pPr")[0].appendChild(b[0]);d.getElementsByTagName("w:pPr")[0].appendChild(a)};
this.createSpan=function(a){var b=this.createEle("w:r");a=$(a);var d=this.createEle("w:rPr");this.lastWR=d;b.appendChild(d);if(""!=a.css("color")){var e=this.createEle("w:color"),g=this.rgb1(a.css("color"));e.setAttribute("w:val",g);d.appendChild(e)}if(""!=a.css("font-family")){a.css("font-family").replace(/'/ig,"").split(",");e=this.createEle("w:rFonts");var h=/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/gi.test(a.text())?this.defaultFontChinese:this.defaultFontEnglish;this.setAtts(e,{"w:ascii":h,"w:eastAsia":h,
"w:hAnsi":h,"w:hint":"eastAsia","w:cs":this.defaultFontEnglish});d.appendChild(e)}""!=a.css("font-size")&&(e=a.css("font-size"),h=this.fontSize(e),null!=h&&(e=this.createEle("w:sz"),e.setAttribute("w:val",2*h),d.appendChild(e),g=this.createEle("w:szCs"),g.setAttribute("w:val",2*h),d.appendChild(g)));e=a.css("font-weight");if("B"==a.tagName||""!=e&&"normal"!=e&&"400"!=e)e=this.createEle("w:b"),d.appendChild(e);"I"==a.tagName&&(e=this.createEle("w:i"),d.appendChild(e));return b};this.createBr=function(a){a=
this.createEle("w:r");var b=this.createEle("w:br");a.appendChild(b);return a};this.createTable=function(a){var b=this.createEle("w:tbl"),d=this.createEle("w:tblPr"),e=this.createEle("w:tblStyle");e.setAttribute("w:val","a4");d.appendChild(e);e=this.createWidth(a,"tblW");d.appendChild(e);a.setAttribute("ww",e.getAttribute("w:w"));b.appendChild(d);return b};this.createTbody=function(){return this.createEle("w:tblGrid")};this.createTr=function(a){var b=this.createElesLvl("w:tr,w:trPr");this.setAtts(b[0],
{"w:rsidR":"003D2D54","w14:textId":"77777777","w14:paraId":this.getParaId()});a=this.createHeight(a,"trHeight");b[1].appendChild(a);return b[0]};this.paraId=0;this.getParaId=function(){var a="0000"+this.paraId;a=a.substring(a.length-4);this.paraId++;return"F0C0"+a};this.createTd=function(a){thisTr=a.parentNode;var b=thisTr.parentNode.parentNode,d=a.getAttribute("vmerge"),e=0;if(null!=d&&""!=d){var g=this.createEle("w:tc"),h=this.createEle("w:tcPr"),k=this.createEle("w:vMerge");h.appendChild(k);g.appendChild(h);
this.getDock().appendChild(g);e=this.createEle("w:p");g.appendChild(e);g=d.split(",");g=b.rows[g[0]].cells[g[1]];h.appendChild(this.createTdBorders(g));e=1*g.getAttribute("wwtd")}g=this.createEle("w:tc");h=this.createEle("w:tcPr");g.appendChild(h);if(1<a.rowSpan)for(k=this.createEle("w:vMerge"),k.setAttribute("w:val","restart"),h.appendChild(k),k=0;k<a.rowSpan-1;k++)(d=b.rows[k+1+thisTr.rowIndex])&&(d=d.cells[a.cellIndex])&&d.setAttribute("vmerge",thisTr.rowIndex+","+a.cellIndex);1<a.colSpan&&(b=
this.createEle("w:gridSpan"),b.setAttribute("w:val",a.colSpan),h.appendChild(b));h.appendChild(this.createTdBorders(a));k=this.createWidth(a,"tcW");d=a.parentNode;b=d.getAttribute("wwtr");if(null==b||""==b)b=d.parentNode.parentNode,b=b.getAttribute("ww");var l=k.getAttribute("w:w");a!=a.parentNode.cells[a.parentNode.cells.length-1]?(a.setAttribute("wwtd",l),d.setAttribute("wwtr",1*b-1*l-e)):(k.setAttribute("w:w",0),k.setAttribute("w:type","auto"));h.appendChild(k);a=$(a).css("vertical-align");"middle"==
a?(a=this.createEle("w:vAlign"),a.setAttribute("w:val","center"),h.appendChild(a)):"bottom"==a&&(a=this.createEle("w:vAlign"),a.setAttribute("w:val","bottom"),h.appendChild(a));return g};this.createWidth=function(a,b){b=this.createEle("w:"+b);a=15*$(a).width();b.setAttribute("w:w",a);b.setAttribute("w:type","dxa");return b};this.createHeight=function(a,b){b=this.createEle("w:"+b);a=15*$(a).height();b.setAttribute("w:val",a);return b};this.createTdBorders=function(a){for(var b=this.createEle("w:tcBorders"),
d=0;d<this.EWA_DocTmp.borders.length;d++){var e=this.createBorder(a,this.EWA_DocTmp.borders[d]);b.appendChild(e)}return b};this.createBorder=function(a,b){var d=$(a).css("border-"+b+"-width"),e=this.createEle("w:"+b);"0px"==d?e.setAttribute("w:val","nil"):(e.setAttribute("w:val","single"),a=$(a).css("border-"+b+"-color"),a=this.rgb1(a),e.setAttribute("w:color",a),e.setAttribute("w:sz",6));return e};this.createPVanish=function(){return this.createElesLvl("w:p,w:pPr,w:rPr,w:vanish")};this.createP=function(a){var b=
this.createEle("w:p"),d=this.createEle("w:pPr");b.appendChild(d);d=this.createElesSameLvl("w:pStyle,w:jc",d);var e=d[1],g=$(a).css("text-align");g=null==g?"":g;0<=g.indexOf("center")?e.setAttribute("w:val","center"):0<=g.indexOf("right")?e.setAttribute("w:val","right"):e.setAttribute("w:val","left");e=d[0];e.setAttribute("w:val","a");0==a.tagName.indexOf("H")&&e.setAttribute("w:val",a.tagName.replace("H",""));this.createElesLvl("w:rFonts",d[2])[0].setAttribute("w:hint","eastAsia");this.lastWR=null;
this.setAtts(b,{"w:rsidR":"003D2D54","w14:textId":"77777777","w14:paraId":this.getParaId(),"w:rsidRDefault":"0057281A"});return b};this.createPic=function(a){var b=$(a),d=a.src;this.pics.push(a.src);a=d.lastIndexOf("/");d=d.substring(a+1);a=this.px2emu(b.width());b=this.px2emu(b.height());var e=this.createElesLvl("w:r,w:rPr,w:noProof")[0],g=this.createElesLvl("w:drawing,wp:inline,wp:extent");e.appendChild(g[0]);wExtent=g[2];this.setAtts(wExtent,{cx:a,cy:b});g=g[1];this.setAtts(g,{distT:"0",distB:"0",
distL:"0",distR:"0"});var h=this.createElesSameLvl("wp:effectExtent,wp:docPr,wp:cNvGraphicFramePr",g);this.setAtts(h[0],{l:"0",t:"0",r:"0",b:"0"});this.setAtts(h[1],{id:"0",name:d});var k=this.createEleNs("a:graphicFrameLocks","http://schemas.openxmlformats.org/drawingml/2006/main");h[2].appendChild(k);this.setAtts(k,{noChangeAspect:1});h=this.createEleNs("a:graphic","http://schemas.openxmlformats.org/drawingml/2006/main");k=this.createEle("a:graphicData");k.setAttribute("uri","http://schemas.openxmlformats.org/drawingml/2006/picture");
var l=this.createEleNs("pic:pic","http://schemas.openxmlformats.org/drawingml/2006/picture");h.appendChild(k);k.appendChild(l);g.appendChild(h);g=this.createElesSameLvl("pic:nvPicPr,pic:blipFill,pic:spPr",l);this.setAtts(g[1],{rotWithShape:"1"});this.setAtts(g[2],{bwMode:"auto"});h=this.createElesSameLvl("pic:cNvPr,pic:cNvPicPr",g[0]);this.setAtts(h[0],{id:"0",name:d});h=this.createElesSameLvl("a:blip,a:srcRect,a:stretch",g[1]);this.setAtts(h[0],{"r:embed":"pic"+(this.pics.length-1)});this.setAtts(h[1],
{l:"0",t:"0",r:"0",b:"0"});d=this.createEles("a:extLst,a:ext");h[0].appendChild(d[0]);d[1].setAttribute("uri","{28A0092B-C50C-407E-A947-70E740481C1C}");h=this.createEleNs("a14:useLocalDpi","http://schemas.microsoft.com/office/drawing/2010/main");h.setAttribute("val",0);d[1].appendChild(h);d=this.createElesSameLvl("a:xfrm,a:prstGeom,a:ln,a:extLst",g[2]);this.setAtts(d[1],{prst:"rect"});g=this.createElesSameLvl("a:off,a:ext",d[0]);this.setAtts(g[0],{x:0,y:0});this.setAtts(g[1],{cx:a,cy:b});this.createElesSameLvl("a:avLst",
d[1]);this.createElesSameLvl("a:noFill",d[2]);return e};this.createEleNs=function(a,b){return this.doc.XmlDoc.createElementNS(b,a)};this.setAtts=function(a,b){for(var d in b)a.setAttribute(d,b[d])};this.fontSize=function(a){0<a.indexOf("px")&&(a=this.EWA_DocTmp.f[a],a=null==a?"9pt":a);return a.replace("pt","")};this.rgb1=function(a){a=a.replace("rgb(","").replace(")","").split(",");return this.rgb(1*a[0],1*a[1],1*a[2]).toUpperCase()};this.rgb=function(a,b,d){a=a.toString(16);b=b.toString(16);d=d.toString(16);
return(2>a.length?"0":"")+a+(2>b.length?"0":"")+b+(2>d.length?"0":"")+d};this.init=function(){this.doc=new EWA_XmlClass;this.doc.LoadXml(this.EWA_DocTmp.document);EWA.B.IE?this.docks.push(this.doc.XmlDoc.getElementsByTagName("w:body")[0]):this.docks.push(this.doc.XmlDoc.childNodes[0].childNodes[0])};this.getDock=function(){return this.docks[this.docks.length-1]};this.idx=0;this.docksPop=function(a){for(;1!=this.docks.length&&this.docks.pop()!=a;);};this.getDockTable=function(){for(var a=this.docks.length-
1;0<=a;a--){var b=this.docks[a];if("w:body"==b.tagName||"w:tc"==b.tagName)return b}};this.px2emu=function(a){return parseInt(a/96*914400)};this.EWA_DocTmp={document:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><w:document\t\t\t\txmlns:wpc="http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas"\t\t\t\txmlns:mo="http://schemas.microsoft.com/office/mac/office/2008/main"\t\t\t\txmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"\t\t\t\txmlns:mv="urn:schemas-microsoft-com:mac:vml" xmlns:o="urn:schemas-microsoft-com:office:office"\t\t\t\txmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"\t\t\t\txmlns:m="http://schemas.openxmlformats.org/officeDocument/2006/math"\t\t\t\txmlns:v="urn:schemas-microsoft-com:vml"\t\t\t\txmlns:wp14="http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing"\t\t\t\txmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"\t\t\t\txmlns:w10="urn:schemas-microsoft-com:office:word"\t\t\t\txmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main"\t\t\t\txmlns:w14="http://schemas.microsoft.com/office/word/2010/wordml"\t\t\t\txmlns:wpg="http://schemas.microsoft.com/office/word/2010/wordprocessingGroup"\t\t\t\txmlns:wpi="http://schemas.microsoft.com/office/word/2010/wordprocessingInk"\t\t\t\txmlns:wne="http://schemas.microsoft.com/office/word/2006/wordml"\t\t\t\txmlns:wps="http://schemas.microsoft.com/office/word/2010/wordprocessingShape"\t\t\t\tmc:Ignorable="w14 wp14"><w:body></w:body></w:document>',
r:'<w:r w:rsidR="00A0061C" w:rsidRPr="00A0061C"><w:rPr><w:rFonts w:ascii="[FONT]" w:eastAsia="[FONT]" w:hAnsi="[FONT]" w:hint="eastAsia" /><w:b /><w:i /><w:color w:val="FF0000" /><w:sz w:val="36" /><w:szCs w:val="36" /><w:u w:val="single" /></w:rPr><w:t>\u770b\u770b</w:t></w:r>',f:{"9px":"7pt","10px":"7.5pt","11px":"8.5pt","12px":"9pt","13px":"10pt","14px":"10.5pt","15px":"11.5pt","16px":"12pt","17px":"13pt","18px":"13.5pt","19px":"14.5pt","20px":"15pt","21px":"16pt","22px":"16.5pt","23px":"17.5pt",
"24px":"18pt","25px":"19pt","26px":"19.5pt","27px":"20.5pt","28px":"21pt","29px":"22pt","30px":"22.5pt","31px":"23.5pt","32px":"24pt","33px":"25pt","34px":"25.5pt","35px":"26.5pt","36px":"27pt","37px":"28pt","38px":"28.5pt","39px":"29.5pt","40px":"30pt","41px":"31pt","42px":"31.5pt","43px":"32.5pt","44px":"33pt","45px":"34pt","46px":"34.5pt","47px":"35.5pt","48px":"36pt","49px":"37pt","50px":"37.5pt","51px":"38.5pt","52px":"39pt","53px":"40pt","54px":"40.5pt","55px":"41.5pt","56px":"42pt","57px":"43pt",
"58px":"43.5pt","59px":"44.5pt","60px":"45pt","61px":"46pt","62px":"46.5pt","63px":"47.5pt","64px":"48pt","65px":"49pt","66px":"49.5pt","67px":"50.5pt","68px":"51pt","69px":"52pt","70px":"52.5pt","71px":"53.5pt","72px":"54pt","73px":"55pt","74px":"55.5pt","75px":"56.5pt","76px":"57pt","77px":"58pt","78px":"58.5pt","79px":"59.5pt","80px":"60pt","81px":"61pt","82px":"61.5pt","83px":"62.5pt","84px":"63pt","85px":"64pt","86px":"64.5pt","87px":"65.5pt","88px":"66pt","89px":"67pt","90px":"67.5pt","91px":"68.5pt",
"92px":"69pt","93px":"70pt","94px":"70.5pt","95px":"71.5pt","96px":"72pt","97px":"73pt","98px":"73.5pt","99px":"74.5pt"},borders:["top","bottom","right","left"]};this.postData=function(){return{xml:this.xml(),pics:this.pics.join(","),ols:this.liNum}};this.init();this.xml=function(){return this.doc.GetXml()}}
function EWA_OdtDocWordClass(){this.docks=[];this.pics=[];this.liNum=0;this.start=!1;this.defaultFontEnglish="Century Gothic";this.defaultFontChinese="Microsoft YaHei";this.walker=function(a){this.fixTable();this.walker1(a);this.unFixTable()};this.walker1=function(a){3==a.nodeType?this.walkerTxt(a):1==a.nodeType&&this.walkerEle(a)};this.walkerEle=function(a){if("none"!=a.style.display)if("pp"==a.id&&"CENTER"==a.tagName)console.log("skip->",a.outerHTML);else{var b=a.tagName,d=!1;if("DIV"==b&&(0<=a.className.indexOf("page-next-before")||
0<=a.className.indexOf("page-next-after"))){var e=this.createBreak();b=this.docks[0];console.log("break",e);b.appendChild(e);d=!0}else if("UL"==b||"OL"==b)e=this.createUl(a),b=this.getDockTable(),b.appendChild(e),this.docks.push(e),d=!0;else if("LI"==b)e=this.createLi(a),b=this.getDock(),b.appendChild(e),this.docks.push(e),d=!0;else if("BR"==b){e=this.createBr(a);b=this.getDock();if("text:p"!=b.tagName){var g=this.createP(a.parentNode);this.docks.push(g);g.appendChild(e)}else b.appendChild(e);this.lastWR=
null}else if("IMG"==b)b=this.getDock(),console.log(b),e=this.createPic(a),"text:p"!=b.tagName?(g=this.createP(a.parentNode),g.appendChild(e),b.appendChild(g),this.docks.push(g),d=!0,e=g):b.appendChild(e),this.lastWR=null;else if("TABLE"==b)b=this.getDockTable(),e=this.createTable(a),d=!0,b.appendChild(e),this.docks.push(e);else if("TBODY"!=b)if("TR"==b)e=this.createTr(a),this.getDock().appendChild(e),this.docks.push(e),d=!0;else if("TD"==b){e=this.createTd(a);this.getDock().appendChild(e);if("table:covered-table-cell"==
e.tagName)return;this.docks.push(e);d=!0}else if("HR"==b){b=this.getDockTable();e=this.createP(a);g=this.createSpan(a);e.appendChild(g);var h=this.createHr();g.appendChild(h);this.lastWR=null;b.appendChild(e)}else if("H1"==b||"H2"==b||"H3"==b||"P"==b||"CENTER"==b||"DIV"==b)b=this.getDockTable(),e=this.createP(a),b.appendChild(e),this.docks.push(e),d=!0;else if("SCRIPT"==b)return;for(b=0;b<a.childNodes.length;b++)this.walker1(a.childNodes[b]);d&&(this.docksPop(e),this.lastWR=null)}};this.walkerTxt=
function(a){if(""==a.nodeValue.trimEx())this.lastWR=null;else{var b=this.createSpan(a.parentNode),d=a.nodeValue.replace(/\u00a0/ig," ");if("TD"==a.parentNode.tagName||"P"==a.parentNode.tagName)d=d.trim();EWA.B.IE?b.text=d:b.textContent=d;d=this.getDock();"text:p"!=d.tagName?(a=this.createP(a.parentNode),a.appendChild(b),d.appendChild(a),this.docks.push(a)):d.appendChild(b)}};this.fixTable=function(){for(var a=$("td[colspan]").toArray(),b=0;b<a.length;b++){var d=a[b],e=d.parentNode,g=d.colSpan;d.setAttribute("m_colspan",
g);for(var h=0;h<g-1;h++){var k=e.insertCell(d.cellIndex+h+1);k.innerHTML=h;k.bgColor="blue";k.className="colspan";k.setAttribute("fixed","1");k.style.display="none"}}$("td[rowspan]").each(function(){for(var l=this.rowSpan,m=this.parentNode,n=m.parentNode.parentNode,p=0;p<l-1;p++){var q=n.rows[m.rowIndex+p+1].insertCell(this.cellIndex);q.innerHTML=p;q.bgColor="green";q.className="rowspan";q.setAttribute("fixed","1")}$(this).attr("m_rowspan",l);this.rowSpan=""})};this.unFixTable=function(){$("td[fixed]").each(function(){this.parentNode.removeChild(this)});
$("td[m_colspan]").each(function(){this.colSpan=this.getAttribute("m_colspan")});$("td[m_rowspan]").each(function(){this.rowSpan=this.getAttribute("m_rowspan")})};this.createEle=function(a){return this.doc.XmlDoc.createElement(a)};this.createEles=function(a){a=a.split(",");for(var b=[],d=0;d<a.length;d++){var e=this.createEle(a[d].trim());b.push(e);0<d&&b[0].appendChild(e)}return b};this.createElesLvl=function(a){a=a.split(",");for(var b=[],d=0;d<a.length;d++){var e=this.createEle(a[d].trim());b.push(e);
0<d&&b[d-1].appendChild(e)}return b};this.createElesSameLvl=function(a,b){a=a.split(",");for(var d=[],e=0;e<a.length;e++){var g=this.createEle(a[e].trim());d.push(g);b.appendChild(g)}return d};this.createHr=function(){var a=this.createElesLvl("w:pict,v:rect");a[0].setAttribute("w14:anchorId",this.getParaId());this.setAtts(a[1],{style:"width:.05pt;height:1pt","o:hralign":"center","o:hrstd":"t","o:hrnoshade":"t","o:hr":"t",fillcolor:"black [3213]",stroked:"f"});return a[0]};this.createUl=function(a){var b=
this.createEle("text:list");b.setAttribute("text:style-name","OL"==a.tagName?"L1":"L2");return b};this.createLi=function(a){return this.createEle("text:list-item")};this.createStyle=function(a){var b=this.createEle("style:style");b.setAttribute("style:family","text");a=$(a);var d=this.createEle("style:text-properties");b.appendChild(d);if(""!=a.css("font-family")){a.css("font-family").replace(/'/ig,"").split(",");var e=this.defaultFontEnglish,g=this.defaultFontChinese,h=this.fontSize(a.css("font-size"));
this.setAtts(d,{"style:font-name":e,"style:font-name-asian":g,"fo:font-size":h,"style:font-size-complex":h,"style:font-size-asian":h})}""!=a.css("color")&&(e="#"+this.rgb1(a.css("color")).toLowerCase(),d.setAttribute("fo:color",e));e=a.css("font-weight");if("B"==a.tagName||""!=e&&"normal"!=e&&"400"!=e)d.setAttribute("fo:font-weight","bold"),d.setAttribute("style:font-weight-complex","bold"),d.setAttribute("style:font-weight-asian","bold");"I"==a.tagName&&(d.setAttribute("fo:font-style","italic"),
d.setAttribute("style:font-style-complex","italic"),d.setAttribute("style:font-style-asian","italic"));return this.checkExistsStyle(b)};this.createStyleBreak=function(){var a=this.createEle("style:style");a.setAttribute("style:family","paragraph");var b=this.createEle("style:paragraph-properties");a.appendChild(b);this.setAtts(b,{"fo:break-before":"page"});return this.checkExistsStyle(a)};this.createStyleP=function(a){var b=this.createEle("style:style");b.setAttribute("style:family","paragraph");
var d=this.createEle("style:paragraph-properties");b.appendChild(d);a=$(a);var e=a.css("text-align");e=null==e?"":e;e=0<=e.indexOf("center")?"center":0<=e.indexOf("right")?"end":"";""!=e&&this.setAtts(d,{"fo:text-align":e});e=a.css("margin-left").replace("px","");a=a.css("margin-right").replace("px","");e=this.px2cm(e)+"cm";a=this.px2cm(a)+"cm";this.setAtts(d,{"fo:margin-left":e,"fo:margin-right":a,"fo:text-indent":"0cm","style:justify-single-word":"false"});return this.checkExistsStyle(b)};this.checkExistsStyle=
function(a){var b=a.outerHTML;if(this.fontMap[b])return this.fontMap[b];var d=this.getStyleName();this.setAtts(a,{"style:name":d});this.fontMap[b]=d;b=this.doc.XmlDoc.getElementsByTagName("automatic-styles");0==b.length&&(b=this.doc.XmlDoc.getElementsByTagName("office:automatic-styles"));b[0].appendChild(a);return d};this.createStyleTd=function(a){var b=this.createEle("style:style");this.setAtts(b,{"style:family":"table-cell","style:data-style-name":"NO"});var d=this.createEle("style:table-cell-properties");
b.appendChild(d);this.setAtts(d,{"fo:background-color":"transparent","fo:padding":"0.097cm"});for(var e=0;e<this.EWA_DocTmp.borders.length;e++){var g=this.EWA_DocTmp.borders[e],h=this.createBorder(a,g);d.setAttribute("fo:border-"+g,h)}a=$(a).css("vertical-align");"middle"==a?d.setAttribute("style:vertical-align","middle"):"bottom"==a&&d.setAttribute("style:vertical-align","bottom");return this.checkExistsStyle(b)};this.createStyleCol=function(a){var b=this.createEle("style:style");this.setAtts(b,
{"style:family":"table-column"});var d=this.createEle("style:table-column-properties");b.appendChild(d);a=$(a).width();a=this.px2cm(a);d.setAttribute("style:column-width",a+"cm");return this.checkExistsStyle(b)};this.createStyleTable=function(a){var b=this.createEle("style:style");this.setAtts(b,{"style:family":"table"});var d=this.createEle("style:table-properties");b.appendChild(d);a=$(a).width();a=this.px2cm(a);d.setAttribute("style:width",a+"cm");d.setAttribute("style:shadow","none");return this.checkExistsStyle(b)};
this.getStyleName=function(){this.fontIndex++;return"ST"+this.fontIndex};this.fontIndex=0;this.fontMap={};this.createSpan=function(a){var b=this.createEle("text:span");a=this.createStyle(a);b.setAttribute("text:style-name",a);return b};this.createBr=function(a){return this.createEle("text:line-break")};this.createTable=function(a){var b=this.createEle("table:table");b.setAttribute("table:name","gdx"+Math.random());for(var d=null,e=-1,g=0;g<a.rows.length;g++){for(var h=a.rows[g],k=0,l=0;l<h.cells.length;l++)h.cells[l].getAttribute("fixed")||
k++;k>e&&(e=k,d=h)}if(d)for(g=0;g<d.cells.length;g++)e=this.createEle("table:table-column"),h=this.createStyleCol(d.cells[g]),e.setAttribute("table:style-name",h),b.appendChild(e);a=this.createStyleTable(a);b.setAttribute("table:style-name",a);return b};this.createTr=function(a){return this.createEle("table:table-row")};this.paraId=0;this.getParaId=function(){var a="0000"+this.paraId;a=a.substring(a.length-4);this.paraId++;return"F0C0"+a};this.createTd=function(a){if("rowspan"==a.className||"colspan"==
a.className)return this.createEle("table:covered-table-cell");var b=this.createEle("table:table-cell");1<a.getAttribute("m_rowspan")&&b.setAttribute("table:number-rows-spanned",a.getAttribute("m_rowspan"));1<a.getAttribute("m_colspan")&&b.setAttribute("table:number-columns-spanned",a.getAttribute("m_colspan"));b.setAttribute("office:value-type","string");a=this.createStyleTd(a);b.setAttribute("table:style-name",a);return b};this.createWidth=function(a,b){b=this.createEle("w:"+b);a=15*$(a).width();
b.setAttribute("w:w",a);b.setAttribute("w:type","dxa");return b};this.createHeight=function(a,b){b=this.createEle("w:"+b);a=15*$(a).height();b.setAttribute("w:val",a);return b};this.createBorder=function(a,b){var d=$(a).css("border-"+b+"-width");this.createEle("w:"+b);"0px"==d?d="none":(d="0.002cm "+$(a).css("border-"+b+"-style"),a=$(a).css("border-"+b+"-color"),a=this.rgb1(a).toLowerCase(),d+=" #"+a);return d};this.createPVanish=function(){return this.createElesLvl("w:p,w:pPr,w:rPr,w:vanish")};this.createP=
function(a){var b=this.createEle("text:p");a=this.createStyleP(a);b.setAttribute("text:style-name",a);return b};this.createBreak=function(){var a=this.createEle("text:p"),b=this.createStyleBreak();a.setAttribute("text:style-name",b);return a};this.createPic=function(a){var b=$(a),d=a.src;this.pics.push(a.src);a=d.lastIndexOf("/");d.substring(a+1);d=this.px2cm(b.width());b=this.px2cm(b.height());a=this.createElesLvl("draw:frame,draw:image");this.setAtts(a[0],{"svg:width":d+"cm","svg:height":b+"cm",
"draw:z-index":"0","draw:style-name":"fr1","text:anchor-type":"as-char"});this.setAtts(a[1],{"xlink:type":"simple","xlink:show":"embed","xlink:actuate":"onLoad","xlink:href":"{[PIC"+(this.pics.length-1)+"]}"});return a[0]};this.createEleNs=function(a,b){return this.doc.XmlDoc.createElementNS(b,a)};this.setAtts=function(a,b){for(var d in b)a.setAttribute(d,b[d])};this.fontSize=function(a){0<a.indexOf("px")&&(a=this.EWA_DocTmp.f[a],a=null==a?"9pt":a);return a.replace("pt","")};this.rgb1=function(a){a=
a.replace("rgb(","").replace(")","").split(",");return this.rgb(1*a[0],1*a[1],1*a[2]).toUpperCase()};this.rgb=function(a,b,d){a=a.toString(16);b=b.toString(16);d=d.toString(16);return(2>a.length?"0":"")+a+(2>b.length?"0":"")+b+(2>d.length?"0":"")+d};this.init=function(){this.doc=new EWA_XmlClass;this.doc.LoadXml(this.EWA_DocTmp.document);var a=this.doc.XmlDoc.getElementsByTagName("text");0==a.length&&(a=this.doc.XmlDoc.getElementsByTagName("office:text"));this.docks.push(a[0])};this.getDock=function(){return this.docks[this.docks.length-
1]};this.idx=0;this.docksPop=function(a){for(;1!=this.docks.length&&this.docks.pop()!=a;);};this.getDockTable=function(){for(var a=this.docks.length-1;0<=a;a--){var b=this.docks[a];if(b&&("office:text"==b.tagName||"table:table-cell"==b.tagName||"text:list-item"==b.tagName))return b}};this.px2cm=function(a){return null==a||""==a?0:a/96*2.539999918};this.EWA_DocTmp={document:'<?xml version="1.0" encoding="UTF-8"?><office:document-content xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0"   xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0"   xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0"  xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0"   xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"  xmlns:math="http://www.w3.org/1998/Math/MathML" xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0"  xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" xmlns:ooo="http://openoffice.org/2004/office" xmlns:ooow="http://openoffice.org/2004/writer" xmlns:oooc="http://openoffice.org/2004/calc" xmlns:dom="http://www.w3.org/2001/xml-events" xmlns:xforms="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:rpt="http://openoffice.org/2005/report" xmlns:of="urn:oasis:names:tc:opendocument:xmlns:of:1.2" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:grddl="http://www.w3.org/2003/g/data-view#" xmlns:tableooo="http://openoffice.org/2009/table" xmlns:field="urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0" office:version="1.2"><office:scripts/> <office:font-face-decls><style:font-face style:name="OpenSymbol" svg:font-family="OpenSymbol"/><style:font-face style:name="\u5fae\u8f6f\u96c5\u9ed1" svg:font-family="\u5fae\u8f6f\u96c5\u9ed1"/><style:font-face style:name="Lucida Sans1" svg:font-family="&apos;Lucida Sans&apos;" style:font-family-generic="swiss"/><style:font-face style:name="\u5b8b\u4f53" svg:font-family="\u5b8b\u4f53" style:font-pitch="variable"/><style:font-face style:name="\u9ed1\u4f53" svg:font-family="\u9ed1\u4f53" style:font-pitch="variable"/><style:font-face style:name="Times New Roman" svg:font-family="&apos;Times New Roman&apos;"  style:font-family-generic="roman" style:font-pitch="variable"/><style:font-face style:name="Century Gothic" svg:font-family="Century Gothic" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Lucida Sans" svg:font-family="&apos;Lucida Sans&apos;" style:font-family-generic="system" style:font-pitch="variable"/><style:font-face style:name="\u5fae\u8f6f\u96c5\u9ed11" svg:font-family="\u5fae\u8f6f\u96c5\u9ed1" style:font-family-generic="system" style:font-pitch="variable"/></office:font-face-decls><office:automatic-styles><style:style style:name="fr1" style:family="graphic" style:parent-style-name="Graphics"><style:graphic-properties style:vertical-pos="top" style:vertical-rel="baseline" style:horizontal-pos="center" style:horizontal-rel="paragraph" style:shadow="none" style:mirror="none" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:luminance="0%" draw:contrast="0%" draw:red="0%" draw:green="0%" draw:blue="0%" draw:gamma="100%" draw:color-inversion="false" draw:image-opacity="100%" draw:color-mode="standard"/></style:style><text:list-style style:name="L1"><text:list-level-style-number text:level="1" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1"><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="1.27cm" fo:text-indent="-0.635cm" fo:margin-left="1.27cm"/></style:list-level-properties></text:list-level-style-number><text:list-level-style-number text:level="2" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1"><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"> <style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="1.905cm" fo:text-indent="-0.635cm" fo:margin-left="1.905cm"/></style:list-level-properties></text:list-level-style-number><text:list-level-style-number text:level="3" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1"> <style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="2.54cm" fo:text-indent="-0.635cm" fo:margin-left="2.54cm"/></style:list-level-properties></text:list-level-style-number><text:list-level-style-number text:level="4" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1"><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="3.175cm" fo:text-indent="-0.635cm"  fo:margin-left="3.175cm"/></style:list-level-properties></text:list-level-style-number><text:list-level-style-number text:level="5" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1"><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"> <style:list-level-label-alignment text:label-followed-by="listtab"  text:list-tab-stop-position="3.81cm" fo:text-indent="-0.635cm" fo:margin-left="3.81cm"/></style:list-level-properties></text:list-level-style-number><text:list-level-style-number text:level="6" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1"> <style:list-level-properties text:list-level-position-and-space-mode="label-alignment"> <style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="4.445cm" fo:text-indent="-0.635cm" fo:margin-left="4.445cm"/> </style:list-level-properties></text:list-level-style-number><text:list-level-style-number text:level="7" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1"><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="5.08cm" fo:text-indent="-0.635cm"  fo:margin-left="5.08cm"/> </style:list-level-properties></text:list-level-style-number><text:list-level-style-number text:level="8" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1"><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="5.715cm" fo:text-indent="-0.635cm" fo:margin-left="5.715cm"/> </style:list-level-properties></text:list-level-style-number><text:list-level-style-number text:level="9" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1"> <style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="6.35cm" fo:text-indent="-0.635cm" fo:margin-left="6.35cm"/> </style:list-level-properties></text:list-level-style-number><text:list-level-style-number text:level="10" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1"><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="6.985cm" fo:text-indent="-0.635cm" fo:margin-left="6.985cm"/></style:list-level-properties></text:list-level-style-number></text:list-style><text:list-style style:name="L2"><text:list-level-style-bullet text:level="1" text:style-name="Bullet_20_Symbols" text:bullet-char="\u2022"><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="1.27cm" fo:text-indent="-0.635cm" fo:margin-left="1.27cm"/></style:list-level-properties></text:list-level-style-bullet> <text:list-level-style-bullet text:level="2" text:style-name="Bullet_20_Symbols" text:bullet-char="\u25e6">     <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">         <style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="1.905cm" fo:text-indent="-0.635cm" fo:margin-left="1.905cm"/>     </style:list-level-properties> </text:list-level-style-bullet> <text:list-level-style-bullet text:level="3" text:style-name="Bullet_20_Symbols" text:bullet-char="\u25aa">     <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">         <style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="2.54cm" fo:text-indent="-0.635cm" fo:margin-left="2.54cm"/>     </style:list-level-properties> </text:list-level-style-bullet> <text:list-level-style-bullet text:level="4" text:style-name="Bullet_20_Symbols" text:bullet-char="\u2022">     <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">         <style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="3.175cm" fo:text-indent="-0.635cm" fo:margin-left="3.175cm"/>     </style:list-level-properties> </text:list-level-style-bullet> <text:list-level-style-bullet text:level="5" text:style-name="Bullet_20_Symbols" text:bullet-char="\u25e6">     <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">         <style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="3.81cm" fo:text-indent="-0.635cm" fo:margin-left="3.81cm"/>     </style:list-level-properties> </text:list-level-style-bullet> <text:list-level-style-bullet text:level="6" text:style-name="Bullet_20_Symbols" text:bullet-char="\u25aa">     <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">         <style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="4.445cm" fo:text-indent="-0.635cm" fo:margin-left="4.445cm"/>     </style:list-level-properties> </text:list-level-style-bullet> <text:list-level-style-bullet text:level="7" text:style-name="Bullet_20_Symbols" text:bullet-char="\u2022">     <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">         <style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="5.08cm" fo:text-indent="-0.635cm" fo:margin-left="5.08cm"/>     </style:list-level-properties> </text:list-level-style-bullet> <text:list-level-style-bullet text:level="8" text:style-name="Bullet_20_Symbols" text:bullet-char="\u25e6">     <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">         <style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="5.715cm" fo:text-indent="-0.635cm" fo:margin-left="5.715cm"/>     </style:list-level-properties> </text:list-level-style-bullet> <text:list-level-style-bullet text:level="9" text:style-name="Bullet_20_Symbols" text:bullet-char="\u25aa">     <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">         <style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="6.35cm" fo:text-indent="-0.635cm" fo:margin-left="6.35cm"/>     </style:list-level-properties> </text:list-level-style-bullet> <text:list-level-style-bullet text:level="10" text:style-name="Bullet_20_Symbols" text:bullet-char="\u2022">     <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">         <style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="6.985cm" fo:text-indent="-0.635cm" fo:margin-left="6.985cm"/>     </style:list-level-properties> </text:list-level-style-bullet>        </text:list-style><number:number-style style:name="N0"> <number:number number:min-integer-digits="1"/></number:number-style></office:automatic-styles><office:body><office:text /></office:body></office:document-content>',
f:{"9px":"7pt","10px":"7.5pt","11px":"8.5pt","12px":"9pt","13px":"10pt","14px":"10.5pt","14.8px":"10.5pt","15px":"11.5pt","16px":"12pt","17px":"13pt","18px":"13.5pt","19px":"14.5pt","20px":"15pt","21px":"16pt","22px":"16.5pt","23px":"17.5pt","24px":"18pt","25px":"19pt","26px":"19.5pt","27px":"20.5pt","28px":"21pt","29px":"22pt","30px":"22.5pt","31px":"23.5pt","32px":"24pt","33px":"25pt","34px":"25.5pt","35px":"26.5pt","36px":"27pt","37px":"28pt","38px":"28.5pt","39px":"29.5pt","40px":"30pt","41px":"31pt",
"42px":"31.5pt","43px":"32.5pt","44px":"33pt","45px":"34pt","46px":"34.5pt","47px":"35.5pt","48px":"36pt","49px":"37pt","50px":"37.5pt","51px":"38.5pt","52px":"39pt","53px":"40pt","54px":"40.5pt","55px":"41.5pt","56px":"42pt","57px":"43pt","58px":"43.5pt","59px":"44.5pt","60px":"45pt","61px":"46pt","62px":"46.5pt","63px":"47.5pt","64px":"48pt","65px":"49pt","66px":"49.5pt","67px":"50.5pt","68px":"51pt","69px":"52pt","70px":"52.5pt","71px":"53.5pt","72px":"54pt","73px":"55pt","74px":"55.5pt","75px":"56.5pt",
"76px":"57pt","77px":"58pt","78px":"58.5pt","79px":"59.5pt","80px":"60pt","81px":"61pt","82px":"61.5pt","83px":"62.5pt","84px":"63pt","85px":"64pt","86px":"64.5pt","87px":"65.5pt","88px":"66pt","89px":"67pt","90px":"67.5pt","91px":"68.5pt","92px":"69pt","93px":"70pt","94px":"70.5pt","95px":"71.5pt","96px":"72pt","97px":"73pt","98px":"73.5pt","99px":"74.5pt"},borders:["top","bottom","right","left"]};this.postData=function(){return{xml:this.xml(),pics:this.pics.join(","),ols:this.liNum}};this.init();
this.xml=function(){return this.doc.GetXml()}};
//# sourceMappingURL=ewa.min.map

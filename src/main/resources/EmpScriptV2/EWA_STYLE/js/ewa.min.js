/*
 Easy Web Application js lib
 guolei 
 https://gdxsoft.com/
 https://github.com/gdx1231/emp-script-static
*/
window.EWA=window.EWA||{VERSION:"1.1.8",LANG:"zhcn",SHOW_ERROR:!0};if(!EWA.CP){EWA.__p=window.location.pathname;for(EWA.__inc=0;EWA.__p.indexOf("//")==0&&!(EWA.__p=EWA.__p.replace("//","/"),EWA.__inc++,EWA.__inc>100););EWA.CP="/"+EWA.__p.split("/")[1]+"/"}var userAgent=window.navigator.userAgent.toLowerCase();
EWA.B={VERSION:(userAgent.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],SAFAIR:/webkit/.test(userAgent),OPERA:/opera/.test(userAgent),IE:(/msie/.test(userAgent)||/traaaaaident/.test(userAgent))&&!/opera/.test(userAgent),MOZILLA:/mozilla/.test(userAgent)&&!/(compatible|webkit)/.test(userAgent),GOOGLE:/chrome/.test(userAgent),PAD:/ipad|iphone|android|mobile/.test(userAgent),IS_ANDROID:/android/.test(userAgent)};var EWA_Utils={};EWA.C={Utils:EWA_Utils,Ajax:EWA_AjaxClass,Xml:EWA_XmlClass,Url:EWA_UrlClass};
EWA_Utils.ShowPic=function(a){a=a.src;if(!(a.indexOf("pic_no.jpg")>0)){if(a.indexOf("$resized/")>0){var b=a.indexOf("$resized/");a=a.substring(0,b)}else a=a.replace("_SMAILL.","."),a=a.replace("small","a");window.open(a)}};
EWA_Utils.ShowBgPic=function(a){if(a=$(a).css("background-image")){a=a.slice(4,a.length-1);if(a.startsWith('"')||a.startsWith("'"))a=a.slice(1,a.length-1);a.indexOf("pic_no.jpg")>0||a.indexOf("transparent.png")>0||(a=a.replace("_SMAILL.",".").split("$resized")[0],a=a.replace("small","a"),window.open(a))}};EWA_Utils.RunCmd=function(a,b){typeof a=="string"?(b=a,EWA.LastMenuMsg=""):(b=a.getAttribute("EWA_CMD"),EWA.LastMenuMsg=GetInnerText(a).trimEx());b!=null&&b.trim().length>0&&eval(b)};
EWA_Utils.ReloadValidCodeImage=function(){for(var a=document.getElementsByTagName("IMG"),b=0;b<a.length;b+=1){var c=a[b];c.src.indexOf("/cgi-bin/_co_/")>0&&(c.src=c.src)}alert(_EWA_EVENT_MSG.ValidCodeError)};
EWA_Utils.JsRegisters=function(a){var b=/addEvent\([^\)]+\){1}/ig;a=a.match(/<[\s]*?script[^>]*?>[\s\S]*?<[\s]*?\/[\s]*?script[\s]*?>/ig);if(a!=null){for(var c=[],d=0;d<a.length;d++){var e=a[d];e=e.replace(/<[\s]*?script[^>]*?>/ig,"");e=e.replace(/<[\s]*?\/[\s]*?script[\s]*?>/ig,"");e=e.trim();if(e.length>0){try{EWA.C.Utils.JsRegister(e)}catch(m){alert(m)}try{var g=e.match(b);if(g)for(var h=0;h<g.length;h++){var k=g[h].split(",");if(k.length==3){var l=k[2].replace(")","");c.push(l)}}}catch(m){console.log(e)}}else e=
document.createElement("div"),e.innerHTML=a[d],e=e.getElementsByTagName("script")[0].src,EWA_Utils.JsRegisterSrc(e,!1)}for(d=0;d<c.length;d++)if(!(c[d].indexOf("function")>=0))try{eval(c[d]+"()")}catch(m){console.log(m)}}};EWA_Utils.JsRegisterSrc=function(a,b){var c="ewa_js_register_"+a.hashCode();if(!b||!$X(c)){b=document.getElementsByTagName("head")[0];var d=document.createElement("script");d.type="text/javascript";d.language="javascript";d.id=c;try{d.src=a,b.appendChild(d)}catch(e){alert(e)}}};
EWA_Utils.JsRegister=function(a){var b=document.getElementsByTagName("head")[0],c=document.createElement("script");c.type="text/javascript";c.language="javascript";try{c.text=a,b.appendChild(c)}catch(d){alert(d)}};EWA_Utils.LazyBackgroundLoad=function(a,b){var c=b||$(window).height()+$(window).scrollTop()+50;(a||$(".EWA_GRID_BG_IMG[is_lazy_load=true]")).each(function(){var d=$(this);if(d.offset().top<c){d.removeAttr("is_lazy_load");var e=d.attr("ori_src");d.css("background-image",'url("'+e+'")')}})};
EWA_Utils.ImageAdjust=function(a,b,c){if(b!=null&&c!=null&&(b=parseInt(b.replace("px","")),c=parseInt(c.replace("px","")),!(a==null||b<=0||c<=0||isNaN(b)&&isNaN(c))))if(isNaN(b))a.height=c;else if(isNaN(c))a.width=b;else{var d=a.width,e=a.height;d!=0&&e!=0&&(b/=d,c/=e,b>c?(d*=c,e*=c):(d*=b,e*=b),d>0&&e>0&&(a.width=d,a.height=e))}};
EWA_Utils.tempId=function(a){this.__TMPIDS||(this.__TMPIDS={});for(var b=a||"__ewatmpid__",c=0;c<1E3;c++)if(a=b+Math.random(),a=a.replace(".","GdX"),!this.__TMPIDS[a])return this.__TMPIDS[a]=1,a;a=b+"\u6267\u884c1000\u6b21\u91cd\u590d\u7684\u7f16\u53f7";console.log("\u6267\u884c1000\u6b21\u91cd\u590d\u7684\u7f16\u53f7");return a};
function $F(a,b,c,d){a=a.getElementsByTagName(b);b=[];d=d.toUpperCase().trim().split(",");for(var e=0;e<a.length;e++){var g=a[e],h=g.getAttribute(c);if(h!=null&&h!=""){h=h.toUpperCase();for(var k=0;k<d.length;k++)h==d[k]&&b.push(g)}}return b}function $J2MAP(a,b,c){b=b.split(",");var d={};c=c==null?",":c;for(var e=0;e<a.length;e++){var g=a[e];if(g){for(var h=[],k=0;k<b.length;k++)h.push(g[b[k]]);d[h.join(c)]=g}}return d}
function $J2MAP1(a,b,c){b=b.split(",");var d={};c=c==null?",":c;for(var e=0;e<a.length;e++){var g=a[e];if(g){for(var h=[],k=0;k<b.length;k++){var l=b[k];h.push(g[l])}l=h.join(c);d[l]||(d[l]=[]);d[l].push(g)}}return d}
function GetOuterHTML(a){if(a.outerHTML)return a.outerHTML;var b=a.attributes,c=[];c.push("<"+a.tagName.toLowerCase());for(var d=0;d<b.length;d++){var e=b[d];if(e.specified){var g=e.value.replace(/"/ig,"&quot;");c.push(" "+e.name+'="'+g+'"')}}e=a.innerHTML;e==null&&(e="");c.push(">"+e+"</"+a.tagName.toLowerCase()+">");return c.join("")}function GetInnerText(a){return a.innerText||a.textContent||""}function SetInnerText(a,b){EWA.B.IE?a.innerText=b:a.textContent=b}
typeof document.readyState=="undefined"&&(EWA.B._T=window.setInterval(function(){EWA.CP&&(window.clearInterval(EWA.B._T),document.readyState="complete")},10));function UrlParas(){var a=GetUrlParas(),b=[],c;for(c in a){var d=c.toUpperCase();d=="XMLNAME"||d=="ITEMNAME"||d.indexOf("EWA")>=0||b.push(c+"="+a[c])}return b.join("&")}var $U=UrlParas;
function $U2(a,b,c,d){if(!a||!b)return alert("xmlname and itemname not blank"),"xmlname and itemname not blank";a=EWA.CP+"/EWA_STYLE/cgi-bin/?xmlname="+a+"&itemname="+b;c&&(a=c.indexOf("&")==0?a+c:a+("&"+c));d&&(a+="&"+$U());return a}function GetUrlParas(a){var b={},c=window.location.href.split("?");if(c.length==1)return b;c=c[1].split("&");for(var d=0;d<c.length;d++){var e=c[d].split("=");if(e.length!=1){var g=e[0];a&&(g=g.toUpperCase());b[g]=e[1]}}return b}
function GetTopWin(){for(var a=window,b=0;a!=a.parent;){a=a.parent;if(b>20)return null;b++}return a}function addEvent(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener(b,c,!1)}function AddEvent(a,b,c){addEvent(a,b,c)}String.prototype.lTrim=function(){return this.replace(/(^\s*)/g,"")};String.prototype.rTrim=function(){return this.replace(/(\s*$)/g,"")};String.prototype.trimEx=function(){return this.trim().replace(/(^\u3000*)|(\u3000*$)/g,"")};
String.prototype.startsWith||(String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")},String.prototype.startsWith=function(a){return a==null||this.length<a.length?!1:this==a||this.substring(0,a.length)==a?!0:!1},String.prototype.endsWith=function(a){return a==null||this.length<a.length?!1:this==a||this.substring(this.length-a.length)==a?!0:!1});String.prototype.toURL=function(){return encodeURIComponent(this)};
String.prototype.toInputValue=function(){return this==null||this==""?this:this.replace(/</ig,"&lt;").replace(/>/ig,"&gt;").replace(/"/ig,"&quot;")};String.prototype.unURL=function(){return decodeURIComponent(this)};
String.prototype.toMoney=function(){if(this==null||this=="")return this;var a=this*1;if(isNaN(a))return a;var b=(this+"").split(".");a=b[0];if(a*1<=999)return this;b=b.length==2?"."+b[1]:"";for(var c=a.length/3,d=0;d<c;d++){var e=a.substring(a.length-3);d>0&&(b=","+b);b=e+b;a=a.substring(0,a.length-3)}a.length>0&&(b=a+","+b);return b};String.prototype.hashCode=function(){for(var a=0,b=this.length,c=0;c<b;c++)a=31*a+this.charCodeAt(c),a>2147483647&&(a%=2147483648);return a};
Number.prototype.fm=function(a,b,c,d){a=isNaN(a=Math.abs(a))?2:a;b=b!==void 0?b:"";c=c||",";d=d||".";var e=this,g=e<0?"-":"",h=parseInt(e=Math.abs(+e||0).toFixed(a),10)+"",k=(k=h.length)>3?k%3:0;return b+g+(k?h.substr(0,k)+c:"")+h.substr(k).replace(/(\d{3})(?=\d)/g,"$1"+c)+(a?d+Math.abs(e-h).toFixed(a).slice(2):"")};function $X(a){return document.getElementById(a)}
function $XUC(a,b){if(b){c=$('input[ucid="'+a+'"][ucuid="'+b+'"]');if(c.length>0)return c[0];c=$('select[ucid="'+a+'"][ucuid="'+b+'"]')}else{var c=$('input[ucid="'+a+'"]');if(c.length>0)return c[0];c=$('select[ucid="'+a+'"]')}return c.length>0?c[0]:document.getElementById(a)}function $N(a){return document.getElementsByName(a)}function $T(a,b){b==null&&(b=document);return b.getElementsByTagName(a)}function T$(a,b){return $T(a,b)}
function $GMap(a){a!=null&&a instanceof Function?window.google?a():(EWA._____set_google_map||(setTimeout(function(){var b=document.createElement("script");b.src=EWA.RV_STATIC_PATH?EWA.RV_STATIC_PATH+"/EWA_STYLE/js/js_jquery/EWA_GOOGLE_MAP.js":"/EmpScriptV2/EWA_STYLE/js/js_jquery/EWA_GOOGLE_MAP.js";document.body.appendChild(b)},123),EWA._____set_google_map=!0),setTimeout(function(){$GMap(a)},100)):alert("\u9700\u8981\u4f20\u7edf\u52a0\u8f7d\u5b8c\u6210\u8c03\u7528\u65b9\u6cd5")}
function $JS_RUN_CHANGE(a){if(a&&a.onchange){var b=a.onchange.toString(),c=b.indexOf("{"),d=b.lastIndexOf("}");b=b.substring(c+1,d);c="OBJ_"+Math.random();c=c.replace(".","GdX");window[c]=a;b=b.replace(/this/ig,c);try{eval(b)}catch(e){console.log(b),document.title=e}window[c]=null;delete window[c]}}
function EWA_AjaxClass(a){this.ResutValue=this._Http=null;this._WaittingId="EWA_AJAX_WAITING";this.LoadingType="text";this._Parameters={};this._ParentId=null;this.IsShowWaitting=!0;this._RunEndTime=null;this._IsAsync=a;this.responseStatus=0;this._IsAsync=this._IsAsync?!0:!1;this._ShowWaitting=function(){if(this.IsShowWaitting){var b=document.getElementById(this._WaittingId);b==null?(this.LoadingType.trim().toLowerCase()=="text"&&this._CreateWaittingText(),this.LoadingType.trim().toLowerCase()=="image"&&
this._CreateWaittingImg()):b.style.display=""}};this._CreateWaittingText=function(){var b=document.createElement("DIV");b.id=this._WaittingId;b.innerHTML="Waiting...";document.body.appendChild(b);b.className="ewa-wait-txt"};this._CreateWaittingImg=function(){var b=document.createElement("TABLE");b.id=this._WaittingId;var c=b.insertRow(-1).insertCell(-1);c.align="center";c.innerHTML="<img src='"+this._getLoaddingImg()+"'>";document.body.appendChild(b);b.className="ewa-wait-img"};this.HiddenWaitting=
function(){var b=document.getElementById(this._WaittingId);b!=null&&(b.style.display="none")};this._InitHttp=function(){this._Http=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");if(window._EWA_AJAX_LIST==null||window._EWA_AJAX_LIST.length>200)window._EWA_AJAX_LIST=[];window._EWA_AJAX_LIST.push(this)};this.Get=function(b,c){b==null?console.log("ajax url not null"):(b.GetUrl?b=b.GetUrl():b.getUrl?b=b.getUrl():b.href&&(b=b.href),b.indexOf("|")>=0&&(b=b.replace(/\|/ig,
"%7c")),this._Http.onreadystatechange=c,b.endsWith(".txt")||b.endsWith(".TXT")||(b=b.indexOf("?")>0?b+"&___R="+Math.random():b+"?___R="+Math.random()),b=b.replace("&&","&"),b=b.replace("?&","?"),EWA.B.IE==0?(this._Http.open("GET",b,!this._IsAsync),this._Http.send(null)):(this._Http.open("GET",b,!this._IsAsync),this._Http.send()),this._IsAsync||this._ShowWaitting())};this.Post=function(b,c,d){b==null?console.log("ajax url not null"):(b.GetUrl?b=b.GetUrl():b.getUrl?b=b.getUrl():b.href&&(b=b.href),b.indexOf("|")>=
0&&(b=b.replace(/\|/ig,"%7c")),this._ShowWaitting(),d!=null&&(this._Http.onreadystatechange=d),b=b.replace("&&","&"),b=b.replace("?&","?"),this._Http.open("POST",b,!this._IsAsync),this._Http.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this._Http.send(c),this._IsAsync||this._ShowWaitting())};this.PostNew=function(b,c){var d=[],e;for(e in this._Parameters){var g=this._Parameters[e];g!=null&&d.push(e+"="+g)}this.Post(b,d.join("&"),c)};this.GetReturnValue=function(){return this._Http.responseText};
this.AddParameter=function(b,c,d){this._Parameters[b]=d?c:encodeURIComponent(c)};this._InitHttp();this._getLoaddingImg=function(){return(EWA.RV_STATIC_PATH||"/EmpScriptV2")+"/EWA_STYLE/images/loading4.gif"};this.Install=function(b,c,d,e,g){var h=this,k=typeof d=="string"?document.getElementById(d):d;if(k==null)alert("Object ["+d+"] not found");else{var l=$(k),m=null;g||(m=l.css("position"),"static"==m&&l.css("position","relative"),l.append("<div class='ewa-ajax-install-waitting'></div>"));this.Post(b,
c,function(){if(h.IsRunEnd()){"static"==m&&l.css("position",m);var n=h.GetRst();if(h.IsError())$(k)[0].innerHTML=n;else{$(k)[0].innerHTML=n;try{EWA.C.Utils.JsRegisters(n)}catch(p){console.log(p)}}e!=null&&e(b,c,d,n)}});this.HiddenWaitting()}};this.IsRunEnd=function(){this.responseStatus=this._Http.status;this.responseReadyState=this._Http.readyState;if(this._Http.readyState!=4)return!1;this.HiddenWaitting();this._RunEndTime||(this._RunEndTime=(new Date).getTime());window.setTimeout(function(){for(var b=
window._EWA_AJAX_LIST.length-1;b>=0;b--){var c=window._EWA_AJAX_LIST[b];if(c!=null&&c.GetEndPastTime()>1231){try{c.Dispose()}catch(d){}window._EWA_AJAX_LIST[b]=null}}},1);return!0};this.Dispose=function(){this._Http=null};this.GetEndPastTime=function(){return this._RunEndTime?(new Date).getTime()-this._RunEndTime:-1};this.IsError=function(){this.responseStatus=this._Http.status;return this._Http.status==200?!1:!0};this.GetRst=function(){return this.IsRunEnd()?this.IsError()?this._Http.statusText:
this._Http.responseText:null}}function $JA(a,b){for(var c=new EWA_AjaxClass(!0),d=[],e=2;e<arguments.length;e++)d.push(arguments[e]);c.Get(a,function(){_$J_HandleRst(c,b,d,!0)});return c}function $J2A(a,b){for(var c=new EWA_AjaxClass(!0),d=[],e=2;e<arguments.length;e++)d.push(arguments[e]);c.Get(a,function(){_$J_HandleRst(c,b,d,!1)});return c}
function $JPA(a,b,c){for(var d=new EWA_AjaxClass(!0),e=[],g=3;g<arguments.length;g++)e.push(arguments[g]);if(b)for(var h in b)d.AddParameter(h,b[h]);d.PostNew(a,function(){_$J_HandleRst(d,c,e,!0)});return d}function $J(a,b){for(var c=[],d=2;d<arguments.length;d++)c.push(arguments[d]);return __$J(!1,a,b,c,!0)}function $J1(a,b){for(var c=[],d=2;d<arguments.length;d++)c.push(arguments[d]);return __$J(!1,a,b,c,!0,!0)}
function $J2(a,b){for(var c=[],d=2;d<arguments.length;d++)c.push(arguments[d]);return __$J(!1,a,b,c,!1,!1)}function $J3(a,b){for(var c=[],d=2;d<arguments.length;d++)c.push(arguments[d]);return __$J(!1,a,b,c,!1,!0)}function $JP1(a,b,c,d,e,g,h,k,l){$JP(a,b,c,d,e,g,h,k,l).HiddenWaitting()}function $JP(a,b,c){for(var d=new EWA_AjaxClass,e=[],g=3;g<arguments.length;g++)e.push(arguments[g]);if(b)for(var h in b)d.AddParameter(h,b[h]);d.PostNew(a,function(){_$J_HandleRst(d,c,e,!0)});return d}
function $JP2(a,b,c){for(var d=new EWA_AjaxClass,e=[],g=2;g<arguments.length;g++)e.push(arguments[g]);if(b)for(var h in b)d.AddParameter(h,b[h]);d.PostNew(a,function(){_$J_HandleRst(d,c,e,!1)});return d}function __$J(a,b,c,d,e,g){var h=new EWA_AjaxClass(a);h.Get(b,function(){_$J_HandleRst(h,c,d,e)});g&&h.HiddenWaitting();return h}
function _$J_HandleRst(a,b,c,d){if(a.IsRunEnd())if(a.IsError())if(a.onError)a.onError(a.responseStatus);else window.EWA_AjaxErr?window.EWA_AjaxErr(a):(alert("ERROR: "+a.responseStatus),console.error(a._Http));else{a=a.GetRst();if(d)try{a=JSON.parse(a)}catch(l){console.error("_$J_HandleRst-JSON"+l);return}if(b==null)alert("\u5bf9\u8c61\u6ca1\u6709\u53d1\u73b0");else if(b instanceof Function||typeof b=="function")b(a,c);else if(typeof b=="string")$X(b);else if(b.tagName=="SELECT")if(d)if(c.length<2)alert("\u53c2\u6570\u4e0d\u8db3\uff0c\u9700\u8981textName,valueName\u7684\u5b9a\u4e49");
else{d=c[0];var e=c[1],g=!0;c.length>2&&(g=c[2]);var h="";c.length>3&&(h=c[3]);var k=null;c.length>4&&(k=c[4]);_$J_SELECT(a,b,d,e,g,h,k)}else alert("SELECT\u9700\u8981\u6620\u5c04\u4e3aJSON");else console.log("not define callback")}}
function _$J_SELECT(a,b,c,d,e,g,h,k){function l(v,u){if(!u)return"not defined textName";if(u instanceof Function)return u[v];if(u.indexOf("@@")==-1)return v[u];let w=u.match(/@@[a-zA-Z0-9\-\._:]*\b/ig);for(let x=0;x<w.length;x++){let y=w[x],z=y.replace("@@","");u=u.replace(y,v[z]||"")}return u}function m(v,u){var w=l(v,c),x=b.options[b.options.length]=new Option(w,v[d]);if(u){for(var y=[],z=0;z<u;z++)y.push("");y.push(w);y.join("\u3000")}for(var A in v)v[A]&&x.setAttribute("para_"+A.toLowerCase(),
v[A]);x.setAttribute("json",JSON.stringify(v));return x}b.options.length=0;e&&(b.options[0]=new Option("",""),e instanceof Array&&(b.options[0].text=e[0],b.options[0].value=e[1]));if(k){var n={___ROOT___:[]};e={___ROOT___:{}};for(var p,r,q,t=0;t<a.length;t++){q=a[t];p=q[k];r=q[d];if(p===null||p===""||p==="0")p="___ROOT___";n[p]||(n[p]=[]);n[p].push(q);e[r]=q;e[p]&&(e[p]._children||(e[p]._children=[]),e[p]._children.push(q))}function v(u,w){if((u=n[u])&&u._children&&u._children.length!=0)for(var x,
y=0;y<u._children.length;y++)x=u._children[y],m(x,w),v(x[d],w+1)}v("___ROOT___",0)}else for(t=0;t<a.length;t++)q=a[t],m(q);g&&(b.value=g);$(b).trigger("change");h&&h(b)}$Install=function(a,b,c,d){a.GetUrl?a=a.GetUrl():a.getUrl?a=a.getUrl():a.href&&(a=a.href);var e=new EWA_UrlClass;e.SetUrl(a);e.GetParameter("EWA_AJAX")||e.AddParameter("EWA_AJAX","INSTALL");(new EWA_AjaxClass).Install(e.GetUrl(),"",b,c,d)};
function EWA_JSONXmlClass(){this._JSon=new EWA_JSONClass;this.toJSON=function(a){return this.createNode(a)};this.createNode=function(a){var b=[];b.push(this._JSon.ToJSONString(a.tagName));b.push(": {");for(var c=0;c<a.attributes.length;c++){var d=this.createAttribute(a.attributes[c]);c>0&&b.push(",");b.push(d)}for(c=0;c<a.childNodes.length;c++)(c>0||a.attributes.length>0)&&b.push(",\r\n"),b.push(this.createNode(a.childNodes[c]));b.push("}");return b.join(" ")};this.createAttribute=function(a){var b=
[];b.push(this._JSon.ToJSONString(a.name));b.push(":");b.push(this._JSon.ToJSONString(a.value));return b.join(" ")}}
function EWA_JSONClass(){this._Escapeable=/["\\\x00-\x1f\x7f-\x9f]/g;this._Meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};this.ToJSONDate=function(a){return a==null?"null":a.getUTCFullYear()+"-"+f(a.getUTCMonth()+1)+"-"+f(a.getUTCDate())+"T"+f(a.getUTCHours())+":"+f(a.getUTCMinutes())+":"+f(a.getUTCSeconds())+"Z"};this.ToJSONString=function(a){return'"'+(this._Escapeable.test(a)?a.replace(escapeable,function(b){var c=meta[b];if(typeof c==="string")return c;c=b.charCodeAt();
return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)}):a)+'"'};this.ToJSONArray=function(a){for(var b=a.length,c=[],d=0;d<b;d+=1)c[d]=this.ToJSON(a[d]);return c.length===0?"[]":"["+c.join(", ")+"]"};this.ToJSONObject=function(a){var b,c=[];for(b in a){var d=a[b];if(!(b=="parent"||b.substring(0,1)=="_"||d==null||d instanceof Function)){var e=this.ToJSONString(b)+": ",g=typeof d;g==="string"||g==="number"||g==="boolean"||d instanceof Date?c.push(e+this.ToJSON(d)):g==="object"&&c.push(e+this.ToJSON(d))}}return c.length===
0?"{}":"{"+c.join(", ")+"}"};this.ToJSON=function(a){var b=typeof a;if(a instanceof Date)return this.ToJSONDate(a);if(b==="string")return this.ToJSONString(a);if(b==="number")return isFinite(a)?String(a):"null";if(b==="boolean"||b==="null")return String(a);if(b==="object")return typeof a.length!=="number"||a.propertyIsEnumerable("length")?this.ToJSONObject(a):this.ToJSONArray(a)};this.Parse=function(a){return eval("("+a+")")}}
JSON=window.JSON||function(){function a(l){return l<10?"0"+l:l}function b(l){return d.test(l)?'"'+l.replace(d,function(m){var n=h[m];if(typeof n==="string")return n;n=m.charCodeAt();return"\\u00"+Math.floor(n/16).toString(16)+(n%16).toString(16)})+'"':'"'+l+'"'}function c(l,m){var n=e;(m=m[l])&&typeof m==="object"&&typeof m.toJSON==="function"&&(m=m.toJSON(l));switch(typeof m){case "string":return b(m);case "number":return isFinite(m)?String(m):"null";case "boolean":case "null":return String(m);case "object":if(!m)return"null";
e+=g;var p=[];if(typeof m.length==="number"&&!m.propertyIsEnumerable("length")){var r=m.length;for(l=0;l<r;l+=1)p[l]=c(l,m)||"null";var q=p.length===0?"[]":e?"[\n"+e+p.join(",\n"+e)+"\n"+n+"]":"["+p.join(",")+"]";e=n;return q}if(typeof k==="object")for(r=k.length,l=0;l<r;l+=1){var t=k[l];typeof t==="string"&&(q=c(t,m,k))&&p.push(b(t)+(e?": ":":")+q)}else for(t in m)(q=c(t,m,k))&&p.push(b(t)+(e?": ":":")+q);q=p.length===0?"{}":e?"{\n"+e+p.join(",\n"+e)+"\n"+n+"}":"{"+p.join(",")+"}";e=n;return q}}
Date.prototype.toJSON=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z"};var d=/["\\\x00-\x1f\x7f-\x9f]/g,e,g,h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k;return{stringify:function(l,m,n){var p;g=e="";if(n)if(typeof n==="number")for(p=0;p<n;p+=1)g+=" ";else typeof n==="string"&&(g=n);if(m)if(typeof m==="function"||typeof m==="object"&&
typeof m.length==="number")k=m;else throw Error("JSON.stringify");else k=function(r,q){if(Object.hasOwnProperty.call(this,r))return q};return c("",{"":l})},parse:function(l,m){function n(p,r){var q,t=p[r];if(t&&typeof t==="object")for(q in t)if(Object.hasOwnProperty.call(t,q)){var v=n(t,q);v!==void 0?t[q]=v:delete t[q]}return m.call(p,r,t)}if(/^[\],:{}\s]*$/.test(l.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,
"")))return l=eval("("+l+")"),typeof m==="function"?n({"":l},""):l;throw new SyntaxError("JSON.parse");},quote:b}}();EWA.JSON=JSON;
function EWA_DateClass(a){this._Date=a?a instanceof Date?a:EWA_Utils.Date(a)._Date:new Date;this._Days=[31,28,31,30,31,30,31,31,30,31,30,31];this.PastMilliseconds=function(b){return b._Date-this._Date};this.PastSeconds=function(b){return this.PastMilliseconds(b)/1E3};this.GetYear=function(){return this._Date.getFullYear()};this.GetMonth=function(){return this._Date.getMonth()+1};this.GetDay=function(){return this._Date.getDate()};this.GetBenYear=function(){var b=this.GetYear();return[b+"-01-01",b+
"-12-31"]};this.GetBenMonth=function(){var b=this.GetYear(),c=this.GetMonth(),d=this._Days[c-1];c==2&&((b-1992)%4==0&&(b-1900)%100!=0||(b-2E3)%400==0)&&(d=29);c<10&&(c="0"+c);d<10&&(d="0"+d);return[b+"-"+c+"-01",b+"-"+c+"-"+d]};this.GetBenWeek=function(b){var c=this._Date.getDay(),d=this.GetDay();b?(b=c,c=6-c):(b=c-1,c=7-c);var e=this.Clone();e.setDate(d-b);b=this.Clone();b.setDate(d+c);return[this.GetDateString(e),this.GetDateString(b)]};this.GetBenQ=function(){var b=this.GetMonth();if(b<=3){var c=
1;b=3}else b<=6?(c=4,b=6):b<=9?(c=7,b=9):(c=10,b=12);var d=this.GetYear();c=this.CreateDate(d,c,1);b=this.CreateDate(d,b,this._Days[b-1]);return[this.GetDateString(c),this.GetDateString(b)]};this.GetDateString=function(b){return this.FormatDateTime(null,b)};this.GetDateTimeString=function(b){return this.FormatDate(null,b)};this.Clone=function(){return this.CreateDate(this.GetYear(),this.GetMonth(),this.GetDay())};this.AddDays=function(b){var c=this._Date.getDate();this._Date.setDate(c+b*1);return this.GetDateString()};
this.AddDaysFt=function(b,c){var d=this._Date.getDate();this._Date.setDate(d+b*1);return this.FormatDate(c)};this.CreateDate=function(b,c,d,e,g,h){var k=new Date;e==null&&(e=0);g==null&&(g=0);h==null&&(h=0);k.setDate(1);k.setFullYear(b);k.setMonth(c-1);k.setDate(d);k.setHours(e);k.setMinutes(g);k.setSeconds(h);k.setMilliseconds(0);return k};this.SetDate=function(b,c,d,e,g,h){this._Date=c==null?EWA_Utils.Date(b)._Date:this.CreateDate(b,c,d,e,g,h)};this.GetWeekName=function(){return _EWA_G_SETTINGS.WEEKS.split(",")[this._Date.getDay()]};
this.FormatDate=function(b,c){!b&&_EWA_G_SETTINGS&&_EWA_G_SETTINGS.DATE&&(b=_EWA_G_SETTINGS.DATE);b||(b="yyyy-MM-dd");var d=c||this._Date,e=c=d.getMonth()+1,g=d.getDate();e<10&&(e="0"+c);g<10&&(g="0"+g);d=d.getFullYear();var h,k="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");b=="MM/dd/yyyy"?h=e+"/"+g+"/"+d:b=="dd/MM/yyyy"?h=g+"/"+e+"/"+d:b=="yyyy-MM-dd"?h=d+"-"+e+"-"+g:b=="MM/dd"?h=e+"/"+g+"/"+d:b=="dd/MM"?h=g+"/"+e+"/"+d:b=="MM-dd"?h=e+"-"+g:b=="MMM dd"?h=k[c-1]+" "+g:b=="dd-MMM"?h=
g+"-"+k[c-1]:b=="ddMMM"?h=g+k[c-1]:b=="MMMdd"?h=k[c-1]+g:b=="MM\u6708dd\u65e5"?h=c+g+"\u65e5":b=="yyyyMMdd"&&(h=d+""+e+g);return h};this.FormatDateTime=function(b,c){return this.FormatDate(b,c)+" "+this.GetTimeStr(c)};this.GetTimeStr=function(b){var c=b||this._Date;b=c.getHours();var d=c.getMinutes();c=c.getSeconds();return(b<10?"0":"")+b+":"+(d<10?"0":"")+d+":"+(c<10?"0":"")+c};this.GetDateDiff=function(b){var c=this._Date;b=b?b instanceof Date?b:b instanceof EWA_DateClass?b._Date:EWA_Utils.Date(b)._Date:
new Date;c=c.getTime();b=b.getTime();return((c-b)/864E5).toFixed(0)}}
EWA_Utils.Date=function(a){if(!a)return new EWA_DateClass;var b=a,c="";if(a.indexOf(" ")>0){var d=a.split(" ");b=d[0];c=d[1]}if(a.length==8)b=a.substring(0,4),d=a.substring(4,6),a=a.substring(6,8);else{if(b.indexOf("/")>0){var e=b.split("/");b=e[2];_EWA_G_SETTINGS&&_EWA_G_SETTINGS.DATE=="MM/dd/yyyy"?(d=e[0],a=e[1]):(d=e[1],a=e[0])}else e=b.split("-"),b=e[0],d=e[1],a=e[2];var g=e=0,h=0;c.length>0&&(c=c.split(":"),g=c[0],e=c[1],c.length>2&&(h=c[2]))}c=new EWA_DateClass;c.SetDate(b,d,a,g,e,h);return c};
function EWA_XmlClass(){this.XmlDoc=null;this.LoadXmlFile=function(a){this._InitXmlDoc();this.XmlDoc.load(a)};this.LoadXml=function(a){EWA.B.IE&&!EWA.B.MOZILLA?(this._InitXmlDoc(),this.XmlDoc?this.XmlDoc.loadXML(a):alert("xml is null")):(this.XmlDoc=null,this.XmlDoc=(new DOMParser).parseFromString(a,"text/xml"))};this.GetXml=function(a){a==null&&(a=this.XmlDoc);return EWA.B.IE?a.xml:(new XMLSerializer).serializeToString(a)};this.GetAttributeValue=function(a,b,c){return this.GetElement(a,c).getAttribute(b)};
this.GetElementText=function(a){if(a!=null&&a.childNodes.length>0){for(var b="",c=0;c<a.childNodes.length;c++)b+=a.childNodes[c].nodeValue;return b}return null};this.GetElementAttribute=function(a,b){return a.getAttribute(b)};this.GetText=function(a,b){a=this.GetElement(a,b);return this.GetElementText(a)};this.GetElements=function(a,b){a=a.split("/");var c=b==null?this.XmlDoc:b;for(b=0;b<a.length-1;b+=1){c=c.getElementsByTagName(a[b]);if(c==null||c.length==0)return null;c=c[0]}return c==null||c.length==
0?null:c.getElementsByTagName(a[a.length-1])};this.GetElement=function(a,b){a=this.GetElements(a,b);return a==null?null:a[0]};this.SetAttribute=function(a,b,c){b==null?c.setAttribute(a,""):c.setAttribute(a,b)};this.GetOrCreateElement=function(a,b){a=a.split("/");b=b==null?this.XmlDoc:b;for(var c=0;c<a.length;c+=1){var d=b.getElementsByTagName(a[c]);b=d==null||d.length==0?this.NewChild(a[c],b):d[0]}return b};this.NewChild=function(a,b){a=this.XmlDoc.createElement(a);b.appendChild(a);return a};this.NewChilds=
function(a,b){a=a.split("/");for(var c=0;c<a.length;c++)b=this.NewChild(a[c].trim(),b);return b};this.SetText=function(a,b){b.text=a};this.AppendText=function(a,b){a=this.XmlDoc.createTextNode(a);b.appendChild(a)};this.SetCData=function(a,b){a!=null&&(a=this.XmlDoc.createCDATASection(a),b.appendChild(a))};this._InitXmlDoc=function(){if(!this.XmlDoc){if(EWA.B.IE)for(var a=["MSXML4.DOMDocument","MSXML3.DOMDocument","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XmlDom"],b=0;b<a.length;b++){try{this.XmlDoc=
new ActiveXObject(a[b])}catch(c){this.XmlDoc=null}if(this.XmlDoc!=null)break}if(!this.XmlDoc)try{this.XmlDoc=document.implementation.createDocument("","doc",null)}catch(c){}if(this.XmlDoc)try{this.XmlDoc.async=!1}catch(c){}else alert("XML init failed")}};this._InitXmlDoc()}
function EWA_UrlClass(a){this._URL="";this._Paras={};this._Root="";this.SetUrl=function(b){this._URL=b=b==null?window.location.href:b.href?b.href:b.toString();this._Paras={};this._Root=b.split("?")[0];if(!(b.indexOf("?")<0)){b=b.split("?")[1].split("&");for(var c=0;c<b.length;c++){var d=b[c].split("=");d.length==2?this._Paras[d[0].toUpperCase()]=d[1]:this._Paras[d[0].toUpperCase()]=""}}};this.RemoveEwa=function(){for(var b in this._Paras){var c=b.toLowerCase();if(c=="xmlname"||c=="itemname"||c.indexOf("ewa_")==
0)this._Paras[b]=null}return this.GetUrl()};this.GetParameter=function(b){return this._Paras[b.toUpperCase().trim()]};this.GetParas=function(b){var c=[],d;for(d in this._Paras){var e=this._Paras[d];b&&(d=d.toLowerCase());d&&e!=null&&c.push(d+"="+e)}return c.join("&")};this.SetRoot=function(b){this._Root=b};this.GetUrl=function(b){b=this.GetParas(b);var c="";b.length>0&&(c=this._Root.indexOf("?")>=0?"&":"?");return this._Root+c+b};this.AddParameter=function(b,c,d){b=b.toUpperCase().trim();this._Paras[b]=
d?c:encodeURIComponent(c);return this.GetUrl()};this.RemoveParameter=function(b){b=b.toUpperCase().trim();this._Paras[b]=null;return this.GetUrl()};this.SetUrl(a||window.location.href)}
function EWA_TanslatorCalss(){this.SKIP_EXISTS=!0;this.transAll=function(a,b,c,d){this.idx_ok=this.idx=0;a==null?alert("enus"==EWA.LANG?"Object objs_ch cannot be empty":"\u5bf9\u8c61objs_ch\u4e0d\u80fd\u4e3a\u7a7a"):(this._objs_ch=a,this._objs_en=b,this._transCompleteCallback=d,this._transCompleteItemCallBack=c,this.start_trans("en"),$Tip("enus"==EWA.LANG?"Translate started":"\u7ffb\u8bd1\u5f00\u59cb",()=>this.check_complete()))};this.transAllToCn=function(a,b,c,d){this.idx_ok=this.idx=0;a==null?
alert("enus"==EWA.LANG?"Object objs_ch cannot be empty":"\u5bf9\u8c61objs_ch\u4e0d\u80fd\u4e3a\u7a7a"):(this._objs_ch=a,this._objs_en=b,this._transCompleteCallback=d,this._transCompleteItemCallBack=c,this.start_trans("cn"),$Tip("enus"==EWA.LANG?"Translate started":"\u7ffb\u8bd1\u5f00\u59cb",()=>this.check_complete()))};this.start_trans=function(a){if(this.idx<=this._objs_ch.length-1){var b=this.idx;this.idx++;const e=this._objs_ch[b];if(this.get_text(e)){b=this._objs_en?this._objs_en[b]:null;var c=
this.get_text(b);if(this.SKIP_EXISTS&&c)this.idx_ok++,this.start_trans(a);else{this.trans_item(e,b,a);var d=this;setTimeout(function(){d.start_trans(a)},123)}}else this.idx_ok++,this.start_trans(a)}};this.trans_item=function(a,b,c){let d=this;this.trans==null&&(this.trans=new EWA_TransClass,this.trans.transAfter=function(e,g){d.idx_ok++;d.call_item_callback(g,e)});c=="cn"?this.trans.TransToCn(this.get_text(a),b):this.trans.TransToEn(this.get_text(a),b)};this.get_text=function(a){if(!a==null||a==void 0)return null;
if(typeof a=="string")var b=a;else{var c=a.tagName;c==null&&(c="");c=c.toUpperCase();c=="SELECT"||c=="INPUT"||c=="TEXTAREA"?b=a.value:c!=""?b=a.innerHTML:(console.log("trans_err"),console.log(a))}return b||""};this.call_item_callback=function(a,b){this._transCompleteItemCallBack&&this._transCompleteItemCallBack(a,b)};this.check_complete=function(){return this._objs_ch.length==this.idx_ok?($Tip("enus"==EWA.LANG?"Translate completed":"\u7ffb\u8bd1\u5b8c\u6210"),this._transCompleteCallback&&this._transCompleteCallback(),
!0):!1}}
function EWA_TransClass(){this._Id=("EWA_UT_TRANS"+Math.random()).replace(".","_");window[this._Id]=this;this._IDX=0;this.IsRun=!1;this.TransToEn=function(a,b){this.transToEn(a,b)};this.transToEn=function(a,b){a==null||a.trim()==""?b instanceof Function&&b(null):(this.IsRun=!0,this.transProvider=="azure"?this._trans_azure(a,b,!0):this.transProvider=="bing"?this._trans_bing(a,b,!0):this.transProvider=="youdao"?this._trans_youdao(a,b):console.log("\u6ca1\u6709\u6307\u5b9a\u7ffb\u8bd1\u5f15\u64ce"))};this.TransToCn=
function(a,b){this.transToCn(a,b)};this.transToCn=function(a,b){a==null||a.trim()==""?b instanceof Function&&b(null):(this.IsRun=!0,this.transProvider=="azure"?this._trans_azure(a,b,!1):this.transProvider=="bing"?this._trans_bing(a,b,!1):this.transProvider=="youdao"?this._trans_youdao(a,b):console.log("\u6ca1\u6709\u6307\u5b9a\u7ffb\u8bd1\u5f15\u64ce"))};this._trans_azure=function(a,b,c){let d=this;a={url:this.azureTansCfg.url+(c?"&from=zh-Hans&to=en":"&from=en&to=zh-Hans"),headers:{"Content-Type":"application/json;charset=utf8",
"Ocp-Apim-Subscription-Key":this.azureTansCfg.key,"Ocp-Apim-Subscription-Region":this.azureTansCfg.location},data:JSON.stringify([{text:a}]),type:"POST",success:function(e){e.length==0?$Tip("No result"):d.transBackCallCommon(e[0].translations[0].text,b)},error:function(e){d.IsRun=!1;$Tip(e.responseText)}};$.ajax(a)};this._trans_youdao=function(a,b){var c=this._get_func_name(),d=c+"AAAAA",e=this.transback_youdao_tmp.toString().replace("transback_youdao_tmp",""),g=this._get_user_func_str(c,d);e=e.replace("{",
"{"+g);eval("window."+c+"="+e);window[d]=b;b=document.createElement("script");a=a.replace(/\n/ig,"[GDX]").replace(/\r/ig,"");a=this.youdaoTrans+"&callback="+c+"&q="+a.toURL();b.src=a;document.getElementsByTagName("head")[0].appendChild(b)};this._trans_bing=function(a,b,c){var d=this._get_func_name(),e=d+"AAAAA",g=this.transback_bing_tmp.toString().replace("trans_en_back_bing_tmp",""),h=this._get_user_func_str(d,e);g=g.replace("{","{"+h);eval("window."+d+"="+g);window[e]=b;b=document.createElement("script");
d=this.bingTrans+"&oncomplete="+d;d=c?d+("&from=zh-CHS&to=en&text="+a.toURL()):d+("&from=en&to=zh-CHS&text="+a.toURL());b.src=d;document.getElementsByTagName("head")[0].appendChild(b)};this._get_user_func_str=function(a,b){return"var fromClass=window['"+this._Id+"'];\n var func=window['"+b+"']; \n var _fname='"+a+"'; \n var _fname1='"+b+"'; \n "};this._get_func_name=function(){this._IDX++;return"___GDX_T_"+this._IDX};this.transback_bing_tmp=function(a){try{fromClass.transBackCallCommon(a,func)}catch(b){console.log(b)}delete window[_fname1];
delete window[_fname]};this.transback_youdao_tmp=function(a){try{if(a&&a.errorCode){console.log(a);func instanceof Function&&func("\u7ffb\u8bd1\u5f15\u64ce\u9519\u8bef");return}if(a&&a.translation&&a.translation.length>0)a=a.translation[0];else{func instanceof Function&&func(a);console.log(a);return}fromClass.transBackCallCommon(a,func)}catch(b){console.log(b)}delete window[_fname1];delete window[_fname]};this.transBackCallCommon=function(a,b){this.IsRun=!1;if(b==null)console.log(a);else if(b instanceof
Function)b(a);else{typeof b=="string"&&(b=document.getElementById(b));var c=b.tagName;c==null&&(c="");c=c.toUpperCase();if(c=="SELECT"||c=="INPUT"||c=="TEXTAREA"){b.value=a;b.setAttribute("ewa_trans_end","ok");if(b.onblur!=null)b.onblur();c=="TEXTAREA"&&window.autosize&&autosize.update&&autosize.update(b)}else c=="DIV"||c=="SPAN"||c=="A"||c=="P"||c=="TD"||c=="TH"||c=="PRE"||c=="LI"||c=="BUTTON"?c=="DIV"&&$(b).attr("EWA_DHTML")?($(b).find("iframe")[0].contentWindow.frames[0].document.body.innerHTML=
a,$(b).find("input[type=hidden]")[0].value=a):(b.setAttribute("ewa_trans_end","ok"),b.innerHTML=a):console.log(a)}this.transAfter&&this.transAfter(a,b,this)}}window.EWA_UT_TRANS=EWA_TransClass;EWA_TransClass.prototype.transProvider="azure";EWA_TransClass.prototype.azureTansCfg={url:"https://api.cognitive.microsofttranslator.com/translate?api-version=3.0",key:"f436c44286474b5eaa928d8b3f251972",location:"EastAsia"};EWA_TransClass.prototype.bingTrans="//api.microsofttranslator.com/V2/Ajax.svc/Translate?appid=50F7C8D4BC00A6E047C046D012F334DEC61FA003";
EWA_TransClass.prototype.youdaoTrans="//fanyi.youdao.com/openapi.do?keyfrom=wwwoneworldcc&key=1597375709&type=data&doctype=jsonp&version=1.1";
EWA_ImageCalss={defaultRatio:.7,resize:function(a,b,c,d,e){b=a.naturalWidth/b;c=a.naturalHeight/c;c=b>c?b:c;b=a.naturalWidth/c;c=a.naturalHeight/c;d=d?d:"image/jpeg";e=e||this.defaultRatio;if(isNaN(e)||e>1)e=this.defaultRatio;var g=document.createElement("canvas");g.width=b;g.height=c;ctx1=g.getContext("2d");ctx1.drawImage(a,0,0,a.naturalWidth,a.naturalHeight,0,0,g.width,g.height);return g.toDataURL(d,e)},dataURItoBlob:function(a){var b=a.split(",");a=b[0].match(/:(.*?);/)[1];b=window.atob(b[1]);
for(var c=new Uint8Array(b.length),d=0;d<b.length;d++)c[d]=b.charCodeAt(d);return new Blob([c],{type:a})},resizeAsBlob:function(a,b,c,d,e){a=this.resize(a,b,c,d,e);return this.dataURItoBlob(a)}};
function EWA_WebSocketClass(a){this.connected=this.inited=!1;this.socket=null;this.cbs={};this.cbs_length=0;this.handleBroadMsgs={};this.handleOnReconnected={};this.handleOnOffline={};this.url=a;this.init=function(b,c){this.inited=!0;this.open(b);this.debug=c};this.registerHandleBroadMsg=function(b,c){this.handleBroadMsgs[b]=c};this.unRegisterHandleBroadMsg=function(b){this.handleBroadMsgs[b]=null};this.registerOnReconnected=function(b,c){this.handleOnReconnected[b]=c};this.unRegisterOnReconnected=
function(b){this.handleOnReconnected[b]=null};this.registerOnOffline=function(b,c){this.handleOnOffline[b]=c};this.unRegisterOnOffline=function(b){this.handleOnOffline[b]=null};this.send=function(b,c){if(!this.connected)return console.log("\u672a\u8fde\u63a5"),!1;this.debug&&console.debug(b,c);this.socket.send(JSON.stringify(b));c&&(this.cbs[b.ID]=c,this.cbs_length++);return!0};this.closeWebSocket=function(){this.socket.close()};this.tryClearCbs=function(){if(this.cbs_length>200)this.cbs={},this.cbs_length=
0,this.debug&&console.debug("tryClearCbs\uff1a\u8d85\u8fc7200\uff0c\u5f3a\u5236\u6e05\u7a7a");else{for(var b in this.cbs)if(this.cbs[b]!=null)return;this.debug&&console.debug("tryClearCbs\uff1a\u6e05\u7a7a"+this.cbs_length);this.cbs={};this.cbs_length=0}};this.onMessage=function(b){try{var c=JSON.parse(b.data);if(c.ID&&this.cbs[c.ID]){var d=this.cbs[c.ID];if(d){this.debug&&(console.debug("\u6267\u884c\u56de\u8c03\u65b9\u6cd5"),console.debug(c.ID,d));try{d(c,b)}catch(e){console.log(b),console.log(d),
console.log(e)}this.cbs[c.ID]=null;this.cbs_length>10&&this.tryClearCbs()}}else if(c.BROADCAST_ID&&this.handleBroadMsgs[c.BROADCAST_ID]&&(d=this.handleBroadMsgs[c.BROADCAST_ID])){this.debug&&(console.debug("\u6267\u884c\u5e7f\u64ad\u6d88\u606f\u56de\u8c03\u7684\u65b9\u6cd5"),console.debug(d));try{d(c,b)}catch(e){console.log(b),console.log(d),console.log(e)}}}catch(e){console.log(b),console.log(e)}};this.onOpen=function(b,c){var d=this;d.connected=!0;if(c)c();else for(var e in d.handleOnReconnected){b=
d.handleOnReconnected[e];d.debug&&console.debug(e,b);try{b&&b(this,event)}catch(g){console.error(e),console.error(b),console.error(g)}}window.onbeforeunload=function(){d.CLOSED_ON_QUIT=!0;d.socket.close()};d._Attempts=0;d._maxTimeout=0};this.onError=function(b){};this.onClose=function(b){var c=this;if(c.connected)for(var d in c.handleOnOffline){var e=c.handleOnOffline[d];try{e&&e(this,b)}catch(g){console.error(d),console.error(e),console.error(g)}}c.connected=!1;c.CLOSED_ON_QUIT?console.log("closed"):
(c._Attempts?c._Attempts++:c._Attempts=0,c._maxTimeout==0?(b=555*Math.pow(1.1,c._Attempts),b>3E3&&(b=3210,c._maxTimeout=b)):b=c._maxTimeout,setTimeout(function(){c.open()},b))};this.open=function(b){var c=new WebSocket(this.url),d=this;c.onerror=function(e){d.debug&&console.debug(e);d.onError(e)};c.onopen=function(e){d.debug&&console.debug(e);d.onOpen(e,b)};c.onmessage=function(e){d.debug&&console.debug(e);d.onMessage(e)};c.onclose=function(e){d.debug&&console.debug(e);d.onClose(e)};this.socket=c}}
function EWA_AddEvent(a,b){if(!top.EWA||!top.EWA.MQE){var c=new EWA_MqeListenerClass;c.CheckId=a;c.FuncName=b;top.EWA.MQE.AddListener(c)}}function EWA_MqeClass(){this.Data=this.Type=this.FromId=null;this.Paras=GetUrlParas(!0);this.IsServer=!1}function EWA_MqeListenerClass(){this.Win=window;this.FuncName=this.CheckId=null;this.Paras=GetUrlParas(!0);this.LastMsg=null;this.LastResult=!1}
function EWA_MqeManagerClass(){this._Listeners=[];this.UrlServer=null;this.LastTimer=-1;this.Stop=!1;this.AddListener=function(a){this._Listeners.push(a)};this.AddMqe=function(a){window.status=a.FromId+","+a.Type;for(var b=0;b<this._Listeners.length;b++){var c=this._Listeners[b];if(c!=null)for(var d=c.CheckId.split(","),e=0;e<d.length;e++)if(a.FromId==d[e]){var g=this._DoEvent(c,a);g===!0?this._Listeners[b].LastResult=!0:g===null?this._Listeners[b]=null:(this._Listeners[b].LastMsg=g,this._Listeners[b].LastResult=
!1)}}};this._DoEvent=function(a,b){try{var c=eval("w."+a.FuncName);c(b.Type,b.Paras,b.IsServer);return!0}catch(d){return d}};this.CreateServer=function(a,b){var c=new EWA_UrlClass;c.SetUrl(a);c.AddParameter("UNID",b);this.UrlServer=c.GetUrl()};this._GetEvents=function(){var a=new EWA_AjaxClass,b=EWA.MQE,c=b.UrlServer+"&T="+b.LastTimer;a.IsShowWaitting=!1;a.Get(c,function(){if(a.IsRunEnd()){var d=a.GetRst();a.IsError()?window.EWA_AjaxErr&&window.EWA_AjaxErr(d):(d=d.trim(),b.ParseMsg(d),b.Mon())}})};
this.Mon=function(){if(!(userAgent.indexOf("ipad")>0||userAgent.indexOf("iphone")>0)){var a=EWA.MQE;a.RunStopParaName!=void 0&&(a.Stop=!eval("window."+a.RunStopParaName));a.Stop?window.setTimeout(a.Mon,1250):window.setTimeout(a._GetEvents,1250)}};this.ParseMsg=function(a){try{eval("evts="+a)}catch(d){this.Stop=!0;return}if(!(void 0).E)this.Stop=!0;else if(!((void 0).T<this.LastTimer)&&(this.LastTimer=(void 0).T,(void 0).V.length!=0)){var b={};for(a=(void 0).V.length-1;a>=0;a--){var c=(void 0).V[a];
c=c.ID+"--GDX--"+c.TP+"---GDX---"+c.V;b[c]||(b[c]=!0)}for(a=0;a<(void 0).V.length;a++)c=(void 0).V[a],c!=null&&(eval("m1="+c.V),b=new EWA_MqeClass,b.FromId=c.ID,b.Type=c.TP,b.Paras=void 0,b.IsServer=!0,this.AddMqe(b))}}}function EWA_MqeCreate(a,b,c){b==null||b.trim().length==0?alert("unid is blank"):(EWA.MQE=new EWA_MqeManagerClass,EWA.MQE.CreateServer(a,b),c!=void 0&&(EWA.MQE.RunStopParaName=c),EWA.MQE.Mon())}typeof EWA=="undefined"&&(EWA={});EWA.UI=EWA.UI||{};
EWA.UI.findScrollParent=function(a){if(!a||a===document.body)return document.body;const b=window.getComputedStyle(a);return(b.overflowY==="auto"||b.overflowY==="scroll")&&a.scrollHeight>a.clientHeight||(b.overflowX==="auto"||b.overflowX==="scroll")&&a.scrollWidth>a.clientWidth?a:this.findScrollParent(a.parentElement)};
EWA.UI.Postion=function(a){if(a==null)return null;var b=a,c;var d=c=0;do d+=b.offsetLeft*1,c+=b.offsetTop*1,b.tagName=="DIV"&&(d-=b.scrollLeft,c-=b.scrollTop),b=b.offsetParent;while(b!=null&&b.tagName!="BODY"&&b.tagName!="HTML");b=c+a.offsetHeight*1;return{X:d,Y:b,Left:d,Top:c,Width:a.offsetWidth,Height:a.offsetHeight,Right:d+a.offsetWidth,Bottom:b}};
var EWA$UI$COMMON$Move={OnMouseDown:function(a,b,c,d,e){a.setAttribute("D",1);b=EWA$UI$COMMON.Move._Event(a,b);c=EWA$UI$COMMON.Move._EventXY(b);if(d==null||d)a.setAttribute("X",c.X),a.setAttribute("SX",c.X);if(e==null||e)a.setAttribute("Y",c.Y),a.setAttribute("SY",c.Y);typeof b.preventDefault!="undefined"&&b.preventDefault();typeof b.stopPropagation!="undefined"?b.stopPropagation():b.cancelBubble=!0},OnMouseUp:function(a){a.setAttribute("D",0)},OnMouseOut:function(a){a.getAttribute("D")=="1"&&a.setAttribute("D",
0)},OnMouseMove:function(a,b){if(a.getAttribute("D")=="1"){b=EWA$UI$COMMON.Move._Event(a,b);var c=EWA$UI$COMMON.Move._EventXY(b);if(a.getAttribute("X")!=null){var d=a.getAttribute("X")*1;d=c.X-d;a.style.left=a.style.left.replace("px","")*1+d+"px";a.setAttribute("X",c.X)}a.getAttribute("Y")!=null&&(d=a.getAttribute("Y")*1,d=c.Y-d,a.style.top=a.style.top.replace("px","")*1+d+"px",a.setAttribute("Y",c.Y));typeof b.preventDefault!="undefined"&&b.preventDefault();typeof b.stopPropagation!="undefined"?
b.stopPropagation():b.cancelBubble=!0}},_Event:function(a,b){return b?b:a.ownerDocument.parentWindow.event},_EventXY:function(a){return EWA.B.IE?{X:a.x,Y:a.y}:{X:a.pageX,Y:a.pageY}}},EWA$UI$COMMON={Move:EWA$UI$COMMON$Move,GetMousePosition:function(a){a==null&&(a=event);return EWA.B.IE?{X:a.x,Y:a.y}:{X:a.pageX,Y:a.pageY}},CreateObject:function(a,b,c,d){a=a.document.createElement(b);c!=null&&c.trim().length>0&&(EWA.B.IE?a.style.cssText=c:a.setAttribute("style",c));d!=null&&d.appendChild(a);return a},
SetStyle:function(a,b){EWA.B.IE?a.style.cssText=b:a.setAttribute("style",b)},GetPosition:function(a){var b=a,c;var d=c=0;do d+=b.offsetLeft*1,c+=b.offsetTop*1,b.tagName=="DIV"&&(d-=b.scrollLeft,c-=b.scrollTop),b=b.offsetParent;while(b!=null&&b.tagName!="BODY"&&b.tagName!="HTML");c+=a.offsetHeight*1;return{X:d,Y:c}},Dispose:function(a){if(EWA.B.IE){if(a.attributes!=null)for(var b=0;b<a.attributes.length;b+=1)a.attributes[b]!=null&&typeof a.attributes[b]=="function"&&(a.attributes[b]=null);for(b=0;b<
a.childNodes.length;b+=1)EWA$UI$COMMON.Dispose(a.childNodes[b])}},Drop:function(a){EWA$UI$COMMON.Dispose(a);a.parentNode.removeChild(a)},AniExpand:function(a,b,c,d,e){if(d==null||d<=0)d=10;var g=0,h=b/(d*1),k=c/(d*1),l=a.clientWidth+b,m=a.clientHeight+c,n=window.setInterval(function(){var p=EWA$UI$COMMON.GetObjSize(a);if(g<d-1){var r=p.H+k,q=p.W+h;r>m&&(r=m);q>l&&(q=l);EWA$UI$COMMON.SetSize(a,q,r)}else EWA$UI$COMMON.SetSize(a,l,m);q=EWA$UI$COMMON.GetObjSize(a);r=q.W-p.W;q=q.H-p.H;p=EWA$UI$COMMON.GetPosition(a);
p.Y=p.Y-a.clientHeight-a.style.borderTopWidth.replace("px","")*1-a.style.borderBottomWidth.replace("px","")*1;e!="LEFT_TOP"&&(e=="LEFT_BOTTOM"?(q=p.Y-q,r=p.X,EWA$UI$COMMON.MoveTo(a,r,q)):e=="RIGHT_TOP"?(q=p.Y,r=p.X-r,EWA$UI$COMMON.MoveTo(a,r,q)):e=="RIGHT_BOTTOM"?(q=p.Y-q,r=p.X-r,EWA$UI$COMMON.MoveTo(a,r,q)):(q=p.Y*1-q/2,r=p.X*1-r/2,EWA$UI$COMMON.MoveTo(a,r,q),EWA._TmpAniObj=a));g++;g>=d&&(window.clearInterval(n),EWA.UI.Utils.AniExpandCompleateFunction&&(EWA.UI.Utils.AniExpandCompleateFunction(),
EWA.UI.Utils.AniExpandCompleateFunction=null))},12)},AniExpandTo:function(a,b,c,d,e){if(d==null||d<=0)d=10;var g=EWA$UI$COMMON.GetObjSize(a);this.AniExpand(a,b-g.W,c-g.H,d,e)},SetSize:function(a,b,c){a.style.width=b+"px";a.style.height=c+"px"},MoveTo:function(a,b,c){a.style.left=b+"px";a.style.top=c+"px"},MoveCenter:function(a){var b=this._GetOwnerWindow(a),c=this.GetObjSize(a);b=this.GetDocSize(b);this.MoveTo(a,(b.W-c.W)/2,(b.H-c.H)/2)},GetObjSize:function(a){return{H:a.clientHeight,W:a.clientWidth}},
GetDocSize:function(a){a==null&&(a=window);var b=a.document;return{W:b.body.clientWidth,H:b.compatMode=="CSS1Compat"?b.documentElement.clientHeight:b.body.clientHeight,SH:a.document.body.scrollTop,SW:a.document.body.scrollLeft}},_GetOwnerWindow:function(a){return EWA.B.IE?a.ownerDocument.parentWindow:a.ownerDocument.defaultView}};EWA.UI.Utils=EWA$UI$COMMON;EWA.UI.ImgResize=function(a,b,c){};
function EWA_ChkIframeOk(a,b){var c=a.contentWindow;c.location&&c.location.href!="about:blank"&&c.document&&c.document.readyState=="complete"?b&&b(c,a):setTimeout(function(){EWA_ChkIframeOk(a,b)},111)}
EWA.UI.Utils.FadeIn=function(a,b,c,d,e){a!=b&&(b.setAttribute("alpha",100),a.style.display="",a.style.zIndex=-1E3,a.style.filter="Alpha(Opacity=100)",a.style.opacity=1,b.style.zIndex=1E3,b.style.display="",b.style.filter="Alpha(Opacity=100)",b.style.opacity=1,EWA.UI.Utils.FADE_IN_OBJ=a,EWA.UI.Utils.FADE_OUT_OBJ=b,EWA.UI.Utils.FADE_STEP=c,EWA.UI.Utils.FADE_TIME_SPAN=d,EWA.UI.Utils.FADE_AFTER=e,window.setTimeout(EWA.UI.Utils.FadeInTimer,EWA.UI.Utils.FADE_TIME_SPAN))};
EWA.UI.Utils.FadeInTimer=function(){try{var a=EWA.UI.Utils.FADE_OUT_OBJ.getAttribute("alpha")*1-EWA.UI.Utils.FADE_STEP;EWA.UI.Utils.FADE_OUT_OBJ.setAttribute("alpha",a);if(a<=0){EWA.UI.Utils.FADE_OUT_OBJ.style.display="none";EWA.UI.Utils.FADE_OUT_OBJ.setAttribute("alpha",0);EWA.UI.Utils.FADE_OUT_OBJ.style.filter="Alpha(Opacity=100)";EWA.UI.Utils.FADE_OUT_OBJ.style.opacity=1;EWA.UI.Utils.FADE_AFTER.ChangeAfter();EWA.UI.Utils.FADE_IN_OBJ=null;EWA.UI.Utils.FADE_OUT_OBJ=null;EWA.UI.Utils.FADE_STEP=null;
EWA.UI.Utils.FADE_TIME_SPAN=null;EWA.UI.Utils.FADE_AFTER=null;return}EWA.UI.Utils.FADE_OUT_OBJ.style.filter="Alpha(Opacity="+a+")";EWA.UI.Utils.FADE_OUT_OBJ.style.opacity=a*1/100}catch(b){}window.setTimeout(EWA.UI.Utils.FadeInTimer,EWA.UI.Utils.FADE_TIME_SPAN)};
function EWA_UI_ExcelClass(){this._Tb=null;this._HeaderRowSize=1;this._ClassName="";this._LeftColSize=1;this._ScrollParent=this._LeftHeader=this._DivLeft=this._DivTop=this._Height=this._Left=this._Top=null;this.Init=function(a,b,c,d,e){this._Tb=a;var g=$(a).offset();this._Top=g.top;this._Left=g.left;this._Height=$(a).parent()[0].clientHeight;this._HeaderRowSize=b;this._LeftColSize=c;this._ClassName=d;this._ScrollParent=e||document.body;this._Create()};this._Create=function(){var a=this._Tb,b=a.cloneNode(!0);
b.removeAttribute("onmouseout");b.removeAttribute("onmousedown");b.removeAttribute("onmouseover");$(b).css("width",$(a).width());for(var c=b.rows.length-1;c>=this._HeaderRowSize;c--)b.deleteRow(c);for(var d=0;d<this._HeaderRowSize;d++){var e=b.rows[d],g=a.rows[d];for(c=0;c<e.cells.length;c++){var h=g.cells[c];$(e.cells[c]).css("width",$(h).width())}}this._DivTop=document.createElement("div");this._DivTop.id="tb_header_con"+this._ClassName;c={position:"fixed",display:"none",top:0,left:this._Left+0,
overflow:"hidden"};$(this._DivTop).css(c);$(this._DivTop).append(b);$(this._Tb).parent().append(this._DivTop);this._LeftHeader=this._Left+0;b=a.cloneNode(!0);b.removeAttribute("onmouseout");b.removeAttribute("onmousedown");b.removeAttribute("onmouseover");$(b).find("td").attr("id",null);a=a.rows[0].cells[0].offsetWidth+2;this._DivLeft=document.createElement("div");this._DivLeft.id="tb_sidebar_con"+this._ClassName;this._DivLeft.appendChild(b);this._DivLeft.style.position="fixed";this._DivLeft.style.top=
this._Top+"px";this._DivLeft.style.left=this._Left+"px";this._DivLeft.style.overflow="hidden";this._DivLeft.style.width=a+"px";this._DivLeft.style.height=this._Height+"px";$(this._Tb).parent().append(this._DivLeft);var k=this;try{this._ScrollParent.onscroll=function(){try{k.OnScroll()}catch(l){console.log(l)}}}catch(l){console.log(l)}console.log(this._ScrollParent.onscroll)};this.OnScroll=function(){this._ScrollParent.scrollTop>this._Top&&(this._ScrollParent.scrollTop<this._Top+this._Height||this._ScrollParent!=
document.body)?(this._DivTop.style.display="",$(this._DivTop).css({left:this._LeftHeader-this._ScrollParent.scrollLeft})):this._DivTop.style.display="none";$(this._DivLeft).css({top:this._Top-this._ScrollParent.scrollTop,height:this._Height+this._ScrollParent.scrollTop})}}
EWA.UI.Move=function(){this._BackgroundObjectList=[];this._MoveObjectList=[];this._MaxIndex=199999;this.IsMoveY=this.IsMoveX=!0;this.MoveStep=1;this.Init=function(a){addEvent(document.body,"mousedown",function(b){a.OnMouseDown(b)});addEvent(document.body,"mousemove",function(b){a.OnMouseMove(b)});addEvent(document.body,"mouseup",function(b){a.OnMouseUp(b)});EWA_COMMON_MV_OBJECT=null};this.AddBackgroundObjs=function(a){for(var b=0;b<a.length;b++)this.AddBackgroundObj(a[b])};this.ReCalcBackgroundObjs=
function(){for(var a=0;a<this._BackgroundObjectList.length;a++){var b=this._BackgroundObjectList[a],c=EWA.UI.Utils.GetPosition(b.obj),d=EWA.UI.Utils.GetObjSize(b.obj);b.x0=c.X;b.x1=c.X+d.W;b.y0=c.Y-d.H;b.y1=c.Y}};this.AddBackgroundObj=function(a){var b=EWA.UI.Utils.GetPosition(a),c=EWA.UI.Utils.GetObjSize(a);this._BackgroundObjectList.push({x0:b.X,x1:b.X+c.W,y0:b.Y-c.H,y1:b.Y,obj:a})};this.CheckBackgroundObj=function(a,b){for(var c in this._BackgroundObjectList){var d=this._BackgroundObjectList[c];
if(d.x0<=a&&d.x1>=a&&d.y0<=b&&d.y1>=b)return d}};this.ClearLastBackgroundObj=function(){this.LastCheckedBackground&&(this.LastCheckedBackground.obj.style.backgroundColor=this.LastCheckedBackground.obj.getAttribute("_mv_last_bc"),this.LastCheckedBackground=null)};this.ClearAll=function(){for(var a=0;a<this._MoveObjectList.length;a++){var b=this._MoveObjectList[a];b.B.parentNode&&b.B.parentNode.removeChild(b.B)}this._MoveObjectList=[]};this.AddMoveObject=function(a,b,c,d,e,g){a.setAttribute("ewa_move",
1);a.setAttribute("ewa_move_type","MOVE");d=d==null?null:EWA.UI.Postion(d);this._MoveObjectList.push({A:a,B:b,JS:c,T:"MOVE",MOVE_X:!0,MOVE_Y:!0,L:d,JSM:e,JS_MOUSE_DOWN:g})};this.AddMoveObjectX=function(a,b,c,d,e,g){a.setAttribute("ewa_move",1);a.setAttribute("ewa_move_type","MOVE");d=d==null?null:EWA.UI.Postion(d);this._MoveObjectList.push({A:a,B:b,JS:c,T:"MOVE",MOVE_X:!0,MOVE_Y:!1,L:d,JSM:e,JS_MOUSE_DOWN:g})};this.AddMoveObjectY=function(a,b,c,d,e,g){a.setAttribute("ewa_move",1);a.setAttribute("ewa_move_type",
"MOVE");d=d==null?null:EWA.UI.Postion(d);this._MoveObjectList.push({A:a,B:b,JS:c,T:"MOVE",MOVE_X:!1,MOVE_Y:!0,L:d,JSM:e,JS_MOUSE_DOWN:g})};this.AddSizeObject=function(a,b,c,d,e,g,h){a.setAttribute("ewa_move",1);a.setAttribute("ewa_move_type","SIZE");b.style.width=b.clientWidth+"px";d=d==null?null:EWA.UI.Postion(d);e=e?EWA.UI.Postion(b):null;this._MoveObjectList.push({A:a,B:b,JS:c,T:"SIZE",L:d,M:e,JSM:g,JS_MOUSE_DOWN:h})};this.OnMouseDown=function(a){var b=this._GetEventTarget(a);b!=null&&(b=this._GetObject(b),
b!=null&&b.A.getAttribute("ewa_move")=="1"&&(a=this._GetEventXY(a),this._MaxIndex++,b.B.style.zIndex=this._MaxIndex,b.B.setAttribute("_EWA_MOUSE_DOWN",1),b.B.setAttribute("_EWA_MOUSE_X",a.X),b.B.setAttribute("_EWA_MOUSE_Y",a.Y),$(b.B).css("position")!="absolute"&&(a=$(b.B).position(),b.B.style.position="absolute",b.B.style.left=a.left+"px",b.B.style.top=a.top+"px"),EWA_COMMON_MV_OBJECT=b,this.ReCalcBackgroundObjs(),b.JS_MOUSE_DOWN&&b.JS_MOUSE_DOWN(b)))};this.OnMouseMove=function(a){if(EWA_COMMON_MV_OBJECT!=
null){var b=EWA_COMMON_MV_OBJECT,c=b.B;if(c.getAttribute("_EWA_MOUSE_DOWN")=="1"){a=this._GetEventXY(a);var d=c.getAttribute("_EWA_MOUSE_X")*1,e=c.getAttribute("_EWA_MOUSE_Y")*1,g=a.X-d,h=a.Y-e;if(!(Math.abs(g)<this.MoveStep&&Math.abs(h)<this.MoveStep)){e=b.L;d=$(c).css("left").replace("px","")*1+g;var k=$(c).css("top").replace("px","")*1+h;if(b.T=="MOVE")e==null?(d<0&&(d=0),k<0&&(k=0)):(g=c.offsetWidth,h=c.offsetHeight,d<e.Left?d=e.Left:d+g>e.Right&&(d=e.Right-g),g=e.Right-(d+g),k<e.Top?k=e.Top:
k+h>e.Bottom&&(k=e.Bottom-h),e=e.Bottom-(k+h),c.setAttribute("ewa_mv_left",d.fm(0)),c.setAttribute("ewa_mv_top",k.fm(0)),c.setAttribute("ewa_mv_bottom",e.fm(0)),c.setAttribute("ewa_mv_right",g.fm(0))),this.IsMoveX&&b.MOVE_X&&(c.style.left=d+"px"),this.IsMoveY&&b.MOVE_Y&&(c.style.top=k+"px");else{var l=c.style.width.replace("px","")*1+g,m=c.style.height.replace("px","")*1+h;l<10&&(l=10);m<10&&(m=10);if(e!=null)if(b.M!=null){var n=b.M.Width*1/b.M.Height;if(n==1){c.style.width.replace("px","");a=Math.sqrt(g*
g+h*h);if(h>0||g<0)a*=-1;a={left:$(c).position().left-a/4,top:$(c).position().top-a/4,width:$(c).width()+a/2,height:$(c).height()+a/2};if(a.height+a.top>e.Bottom||a.top<e.Top||a.left+a.width>e.Right||a.left<e.Left||a.width<50)return;$(c).css(a);b.JSM&&b.JSM(b.B,b.A);return}g=l/m;g>n?m=l/n:g<n&&(l=m*n);d+l>e.Right&&(l=e.Right-d,m=l/n);k+m>e.Bottom&&(m=e.Bottom-k,l=m*n)}else d+l>e.Right&&(l=e.Right-d),k+m>e.Bottom&&(m=e.Bottom-k);this.IsMoveX&&(c.style.width=l+"px");this.IsMoveY&&(c.style.height=m+
"px")}c.setAttribute("_EWA_MOUSE_X",a.X);c.setAttribute("_EWA_MOUSE_Y",a.Y);b.JSM&&b.JSM(b.B,b.A);(b=this.CheckBackgroundObj(a.X,a.Y))?b!=this.LastCheckedBackground&&(this.LastCheckedBackground&&(this.LastCheckedBackground.obj.style.backgroundColor=this.LastCheckedBackground.obj.getAttribute("_mv_last_bc")),this.LastCheckedBackground=b,b.obj.setAttribute("_mv_last_bc",b.obj.style.backgroundColor),b.obj.style.backgroundColor="lightyellow"):this.LastCheckedBackground&&(this.LastCheckedBackground.obj.style.backgroundColor=
this.LastCheckedBackground.obj.getAttribute("_mv_last_bc"))}}}};this.OnMouseUp=function(a){a=EWA_COMMON_MV_OBJECT;if(a!=null){for(var b=0;b<this._MoveObjectList.length;b++)this._MoveObjectList[b].B.setAttribute("_EWA_MOUSE_DOWN",0);a.JS!=null&&a.JS(a.B,a.A);EWA_COMMON_MV_OBJECT=null}};this._GetObject=function(a){for(var b=0;b<this._MoveObjectList.length;b++){var c=this._MoveObjectList[b].A;if(c==a)return this._MoveObjectList[b]}for(b=0;b<this._MoveObjectList.length;b++){c=this._MoveObjectList[b].A;
c=c.getElementsByTagName(a.tagName);for(var d=0;d<c.length;d++){var e=this._MoveObjectList[b];if(c[d]==a)return e}}return null};this._GetEventTarget=function(a){return EWA.B.IE?event.srcElement:a.target};this._GetEventXY=function(a){return EWA.B.IE?{X:a.x,Y:a.y}:{X:a.pageX,Y:a.pageY}}};function EWA_UI_MenuItemClass(){this.Group=this.Cmd=this.Txt=this.Img=null}
function EWA_UI_MenuClass(a){this.ClassName=a;this.MenuShowType="";this.Dialog=null;this.Dialogs=[];this.clickedItem=this._ItemsDiv=this._LastObj=null;this.Click=function(b,c){this.clickBeforeEvent&&this.clickBeforeEvent(b,c);this.MenuShowType!="LEFT"&&(this._LastObj!=null&&(this._LastObj.className=this._LastObj.className.replace("_mv1","")),this._LastObj=null,typeof b.stopPropagation!="undefined"?b.stopPropagation():b.cancelBubble=!0,this._HiddenDialogs());EWA.C.Utils.RunCmd(c);this.clickAfterEvent&&
this.clickAfterEvent(b,c)};this.OnClick=function(b,c){this.clickedItem=c;if(this.MenuShowType=="LEFT"){var d=c.parentNode.parentNode,e=c.parentNode,g=c.parentNode.parentNode.childNodes[1];if(g==null)return;g.childNodes.length==0?(this._LastCkObj&&(this._LastCkObj.style.backgroundColor=""),e.style.backgroundColor="#ccc",this._LastCkObj=e):(g.style.display=="none"?(g.style.display="",$(d).addClass("ewa-lmenu-show")):($(d).removeClass("ewa-lmenu-show"),g.style.display="none"),window.event?b.cancelBubble=
!0:b.stopPropagation())}else if(c.getAttribute("EWA_MF_PID")==""&&(this._HiddenDialogs(),this.Dialogs.length<=0&&this.Dialogs.push(this._CreateDialog()),this._ShowPullDownMenu(c,this.Dialogs[0])>0)){this.ShowByObject(c,this.Dialogs[0],0);return}this.Click(b,c)};this._CalcLevel=function(b){for(var c=0;b.getAttribute("EWA_MF_PID")!="";)if(c+=1,b=document.getElementById(b.getAttribute("EWA_MF_PID")),b==null)return null;return c};this._ShowPullDownMenu=function(b,c){for(var d=$X(c.FrameContent).childNodes[0].rows[0].cells[0];d.childNodes.length>
0;)this._ItemsDiv.appendChild(d.childNodes[0]);for(var e=[],g=0;g<this._ItemsDiv.childNodes.length;g++){var h=this._ItemsDiv.childNodes[g];h.innerHTML.toUpperCase().indexOf("<HR")>0||(h.style.paddingRight="10px");h.getAttribute("EWA_MF_PID")==b.id&&e.push(h)}b=e.length;for(g=0;g<e.length;g++){d.appendChild(e[g]);if(this._CheckChildren(e[g].id)){h=e[g].childNodes[0].rows[0].cells[2];if(h.getAttribute("gdx")==null||h.getAttribute("gdx")=="")h.innerHTML+=" +",h.setAttribute("gdx","gdx");e[g].setAttribute("EWA_MF_CHILD",
"1")}else e[g].setAttribute("EWA_MF_CHILD","0");e[g]=null}e.length=0;$X(c.FrameContent).childNodes[0].style.height="auto";return b};this._CheckChildren=function(b){for(var c=0;c<this._ItemsDiv.childNodes.length;c++)if(this._ItemsDiv.childNodes[c].getAttribute("EWA_MF_PID")==b)return!0;return!1};this.InstallMenus=function(b,c,d){if(d=="METRO"){var e=[],g={};$(".ewa_menu_m").each(function(){var m=$(this),n={};n.id=m.attr("id");n.pid=m.attr("EWA_MF_PID");n.url=m.attr("EWA_CMD");n.icon=m.find(".ewa_menu_m0").attr("class");
n.title=m.text().trim();n.icon&&(n.icon=n.icon.replace("ewa_menu_m0","").trim());n.pid==""?(n.pid="0",n.subs=[],g[n.id]=n,e.push(n)):g[n.pid].subs.push(n)});EWA_UI_Metro.menus=e;EWA_UI_Metro.add_menus(e,"EWA_FRAME_MAIN","item",null,null,!0)}else{this.MenuShowType=d;d=$X(b);var h=$X(c);if(h==null)alert("MenuShow defined error ("+c+")");else{this._ItemsDiv=d;c=[];h.innerHTML="<table onselectstart='return false' style='cursor:pointer;-moz-user-select:none;' border=0 cellspacing=0 cellpadding=0></table>";
h=h.childNodes[0];for(var k=0;k<d.childNodes.length;k++){var l=d.childNodes[k];l.tagName=="DIV"&&l.getAttribute("EWA_MF_PID")==""&&c.push(l)}if(this.MenuShowType==""||this.MenuShowType=="TOP")for(h.insertRow(-1),k=0;k<c.length;k++)h.rows[0].insertCell(-1).appendChild(c[k]);else h.style.width="100%",this._InstallMenusLeft(h,d,c,b);c.length=0;c=null}}};this._InstallMenusLeft=function(b,c,d,e){$(b).addClass("ewa-lmenu");for(var g=0;g<d.length;g++){var h=b.insertRow(-1).insertCell(-1);e=document.createElement("div");
e.innerHTML='<div class="ewa_lmenu_bar" des="rq1"></div><div  des="rq2"></div>';e.childNodes[1].style.paddingLeft="5px";h.appendChild(e);d[g].style.height="100%";e.childNodes[0].appendChild(d[g]);g==0?$(e).addClass("ewa-lmenu-show"):e.childNodes[1].style.display="none"}for(b=c.childNodes;c.childNodes.length>0;)d=b[0],g=d.getAttribute("EWA_MF_PID"),e=document.createElement("div"),e.innerHTML='<div class="ewa_lmenu_bar1"></div><div style="padding-left:4px;display:none"></div>',$X(g)?(g=$X(g).parentNode.parentNode,
$(g).addClass("ewa-lmenu-children"),g.childNodes[1].appendChild(e),e.childNodes[0].appendChild(d)):(console.warn("not found pid",g,d),$(d).remove())};this._CreateDialog=function(){var b=new EWA_UI_DialogClass;b.Create();b.SetHtml("<table class='ewa_menu_down' border=0 width=100 cellspacing=0 cellpadding=0 onmousemove='window."+this.ClassName+".IsOut=false;' onmouseout='window."+this.ClassName+".IsOut=true; window.setTimeout(function(){var a=window."+this.ClassName+";a.AutoHidden();},1410);' onselectstart='return false' style='cursor:pointer;-moz-user-select:none;' ><tr><td></td></tr></table>");
return b};this.AutoHidden=function(){this.IsOut&&this._HiddenDialogs()};this.Create=function(b){if(b!=null&&b.length!=0){this.Dialog=new EWA_UI_DialogClass;this.Dialog.Create();var c=[];c.push("<div class='ewa_menu_box' onmousemove='window."+this.ClassName+".IsOut=false;' onmouseout='window."+this.ClassName+".IsOut=true; var t1=new Date().getTime(); if(t1-$(this).attr(&quot;open_time&quot;)>1000){ window.setTimeout(function(){var a=window."+this.ClassName+";a.AutoHidden(this);},1410);}'  onselectstart='return false' style='width:120px;cursor:pointer;-moz-user-select:none;'>");
for(var d=0;d<b.length;d+=1){var e=b[d];c.push("<div class='ewa_menu_m' EWA_MG=\""+e.Group+"\" style='cursor:pointer' EWA_CMD=\""+e.Cmd+"\" onclick='"+this.ClassName+".Click(event,this);' onmouseover='"+this.ClassName+".MouseOver(this);'><table boder=0 width=100% cellpadding=0 cellspacing=0>");e.Txt.toUpperCase().indexOf("<HR")>=0?c.push("<tr><td colspan=2 style='white-space:nowrap'>"+e.Txt+"</td></tr></table></div>"):(c.push("<tr><td class='ewa_menu_m0'>"),e=b[d].Img,e!=null&&e.indexOf("index=0,size=0")<
0&&e.trim().length>0&&(e.indexOf("fa")>=0?c.push('<i class="'+e+'"></i>'):c.push('<img src="'+b[d].Img+'">')),c.push("</td><td class='ewa_menu_m1' style='white-space:nowrap'>"+b[d].Txt+"</td></tr></table></div>"))}c.push("</div>");this.Dialog.SetHtml(c.join(""))}};this.HiddenMemu=function(){this.Dialog.Show(!1);EWA.UI.CurMenu=null};this.ShowByObject=function(b,c,d){var e=EWA.UI.Utils.GetPosition(b);this.SHOW_BY_OBJECT=b;c=c||this.Dialog;d==null||d==0?c.Move(e.X,e.Y):c.Move(e.X+b.offsetWidth-5,e.Y-
b.offsetHeight+4);c.Show(!0);$(c.GetFrame()).find(".ewa_menu_box").attr("open_time",(new Date).getTime());c.ResizeByContent()};this.ShowByMouse=function(b,c){if(this.Dialog){var d=0,e=$X(this.Dialog.FrameContent).childNodes[0];if(c==null)d=e.childNodes.length;else for(var g=0;g<e.childNodes.length;g++)e.childNodes[g].getAttribute("EWA_MG")==c||c==null||c==""?(e.childNodes[g].style.display="",d++):e.childNodes[g].style.display="none";d>0?(c=b.x?b.x:b.pageX,b=b.y?b.y:b.pageY,b+=document.documentElement.scrollTop||
document.body.scrollTop,c+=document.documentElement.scrollLeft||document.body.scrollLeft,this.Dialog.Move(c,b),this.Dialog.Show(!0),this.Dialog.ResizeByContent()):this.Dialog.Show(!1)}};this.MouseOver=function(b){this._LastObj!=null&&(this.MenuShowType=="LEFT"?this._LastObj.parentNode.className=this._LastObj.parentNode.className.replace("_mv",""):this._LastObj.className=this._LastObj.className.replace("_mv1",""));if(this.MenuShowType=="LEFT")this._LastObj=b,this._LastObj.parentNode.className+="_mv";
else{this._LastObj=b;this.IsOut=!1;this._LastObj.className+="_mv1";EWA.UI.CurMenu==null&&(EWA.UI.CurMenu=this);var c=this._CalcLevel(b);b.getAttribute("EWA_MF_CHILD")=="1"&&(this.Dialogs.length<=c&&this.Dialogs.push(this._CreateDialog()),this._ShowPullDownMenu(b,this.Dialogs[c]),this.ShowByObject(b,this.Dialogs[c],c))}};this._HiddenDialogs=function(){this.Dialog!=null&&this.Dialog.Show(!1);for(var b=0;b<this.Dialogs.length;b++){this.Dialogs[b].Show(!1);for(var c=$X(this.Dialogs[b].FrameContent).childNodes[0].rows[0].cells[0];c.childNodes.length>
0;)this._ItemsDiv.appendChild(c.childNodes[0])}};this._InitEvent=function(){this.MenuShowType!="LEFT"&&(EWA.B.IE?document.body.attachEvent("onclick",function(){typeof EWA.UI.CurMenu!="undefined"&&EWA.UI.CurMenu._HiddenDialogs()}):document.body.addEventListener("click",function(){typeof EWA.UI.CurMenu!="undefined"&&EWA.UI.CurMenu._HiddenDialogs()}))}}
var EWA_UI_Metro={show_title:function(a){if(a.getAttribute("_title")==""||a.getAttribute("_title")==null){var b=a.title;if(b==""||b==null)return;a.setAttribute("_title",b);a.title=""}$(".pop_title div").html(a.getAttribute("_title"));b=$(a).offset();a=$(a).width();var c=$(".pop_title").height(),d=$(".pop_title").width();$(".pop_title").css("top",b.top-c-8);$(".pop_title").show();$(".pop_title").css("left",b.left-(d-a)/2)},item_click:function(a){var b=$(a);a=b.attr("u");b=b.attr("_title");a&&(a.startsWith("js:")?
(a=a.replace("js:",""),eval(a)):(a.indexOf("/")>0||(a=a.indexOf("?")>=0?EWA.CP+"/EWA_STYLE/cgi-bin/"+a:EWA.CP+"/EWA_STYLE/cgi-bin/?"+a),top.AddTab(a,b)))},add_menus:function(a,b,c,d,e,g){this.g_menu_cols=window.g_menu_cols||6;this.g_menu_rows=window.g_menu_rows||3;this.menuLoadInRight=window.menuLoadInRight||!1;d=d||this.g_menu_cols;e=e||this.g_menu_rows;for(var h=0;h<a.length;h++){var k=a[h];if(k&&k.icon&&k.icon.indexOf("gear")>0){a[h]=null;a[d*e-1]=k;break}}var l=document.createElement("table");
$X(b).innerHTML="";$X(b).className="ewa-metro-menu";$X(b).appendChild(l);$($X(b)).append('<div class="pop_title" style="display: none;"><div>-</div><p></p></div>');$($X(b)).css("background","transparent").css("border",0);l.align="center";var m=0,n=[];for(h=0;h<e;h++){var p=b+"_htr_"+h;k=l.insertRow(-1);k.id=p;var r=k.insertCell(-1);r.colSpan=d;k.style.display="none";r.id=p+"a";r=l.insertRow(-1);for(var q=0;q<d;q++){k=a[m];m++;var t=this.add_menu_item(r,k,g,m,c,p);k&&(t.id="M_"+k.id);t&&k&&(k.all==
null||k.all==1)&&n.push(t.innerHTML)}}!this._is_load_main_menu&&this.menuLoadInRight&&(parent.$("#RIGHT").html(n.join("")),parent.$("#RIGHT .item").each(function(){$(this).append($(this).attr("_title"));$(this).attr("onmouseout",null);$(this).attr("onmouseover",null);$(this).attr("onclick","EWA_UI_Metro.right_show_menu_sub(this,event)")}));this._is_load_main_menu=!0},add_menu_item:function(a,b,c,d,e,g){if(c||b){var h=a.insertCell(-1);h.innerHTML="<div class='"+e+"'><i id='memu_item_"+d+"'></i></div>"}if(b)return a=
$(h).find("i"),c=a.parent(),b.icon&&b.icon.trim().length>0?b.icon.indexOf("fa")==0?a.attr("class",b.icon):(c.append("<table width=100% height=100%><tr><td align=center><img style='max-width:90%;max-height:90%' src='"+b.icon+"' /></td></tr></table>"),a.hide()):b.img&&(c.append("<table width=100% height=100%><tr><td align=center><img  src='"+b.img+"' /></td></tr></table>"),a.hide()),c.attr("_title",b.title),c.attr("onmouseover","EWA_UI_Metro.show_title(this)"),c.attr("onmouseout","$('.pop_title').hide()"),
c.attr("hid",g),b.url?(c.attr("u",b.url),c.attr("onclick","EWA_UI_Metro.item_click(this,event)")):b.subs&&(c.attr("subs",JSON.stringify(b.subs)),c.attr("onclick","EWA_UI_Metro.show_menu_sub(this,event)")),h.id="M_"+b.id,h},show_menu_sub:function(a){var b=$(a),c=b.attr("class"),d=b.attr("hid");window.last_open&&window.last_open!=a&&window.last_open.click();if(b.attr("is_open")==1)b.attr("is_open","0"),$X(d).style.display="none",window.last_open=null,b.attr("class",c.split(" ")[0]);else{b.attr("is_open",
"1");var e=JSON.parse(a.getAttribute("subs"));$X(d).style.display="";$X(d).style.opacity=0;EWA_UI_Metro.add_menus(e,d+"a","item_sub",9,Math.round(e.length/9+.4),!1);b.attr("class",c+" open");$($X(d)).animate({opacity:1},300);window.last_open=a;EWA_UI_Metro.load_msg_sub()}this.show_menu_sub_after&&this.show_menu_sub_after(a)},css:function(){if(!this._css_setted){var a=[];a.push(".nav_box {");a.push("margin: auto;");a.push("margin-top: 50px;");a.push("}");a.push(".nav_box .item {");a.push("margin: 5px;");
a.push("background-color: #08c;");a.push("width: 140px;");a.push("height: 140px;");a.push("text-align: center;");a.push("color: #fff;");a.push("transition-duration: 0.3s;");a.push("-webkit-transition-duration: 0.3s;");a.push("cursor: pointer;");a.push("position: relative;");a.push("}");a.push(".nav_box .item .msg {");a.push("position: absolute;");a.push("top: -8px;");a.push("right: -8px;");a.push("height: 18px;");a.push("border-radius: 10px;");a.push("background-color: red;");a.push("color: #fff;");
a.push("line-height: 18px;");a.push("text-align: center;");a.push("min-width: 18px;");a.push("padding: 2px;");a.push("box-shadow: 1px 1px 13px rgba(0, 0, 245, 0.7);");a.push("}");a.push(".nav_box .open {");a.push("-webkit-transform: rotate(45deg) scale(0.7);");a.push("-webkit-transition-duration: 0.7s;");a.push("transform: rotate(45deg) scale(0.7);");a.push("transition-duration: 0.7s;");a.push("}");a.push(".nav_box .open i {");a.push("transform: rotate(-45deg);");a.push("-webkit-transform: rotate(-45deg);");
a.push("}");a.push(".nav_box .item:hover {");a.push("background-color: #fff;");a.push("color: #08c;");a.push("-webkit-transition-duration: 0.3s;");a.push("transition-duration: 0.3s;");a.push("}");a.push(".nav_box .item i {");a.push("line-height: 140px;");a.push("font-size: 60px;");a.push("}");a.push(".nav_box .item img {");a.push("max-height: 100px;");a.push("max-width: 100px;");a.push("}");a.push(".nav_box .item_sub {");a.push("margin: 12px;");a.push("background-color: darkorange;");a.push("width: 70px;");
a.push("height: 70px;");a.push("text-align: center;");a.push("color: #fff;");a.push("-webkit-transition-duration: 0.3s;");a.push("transition-duration: 0.3s;");a.push("cursor: pointer;");a.push("position: relative;");a.push("}");a.push(".nav_box .item_sub .msg {");a.push("position: absolute;");a.push("top: -8px;");a.push("right: -8px;");a.push("height: 18px;");a.push("border-radius: 10px;");a.push("background-color: #fff;");a.push("color: red;");a.push("line-height: 18px;");a.push("text-align: center;");
a.push("min-width: 18px;");a.push("padding: 2px;");a.push("box-shadow: 1px 1px 13px rgba(255, 0, 0, 0.7);");a.push("}");a.push(".nav_box .item_sub i {");a.push("line-height: 70px;");a.push("font-size: 30px;");a.push("}");a.push(".nav_box .item_sub:hover {");a.push("background-color: #fff;");a.push("color: darkorange;");a.push("-webkit-transition-duration: 0.3s;");a.push("transition-duration: 0.3s;");a.push("}");a.push(".pop_title{ position: absolute;min-width: 50px;display: none;z-index: 212;white-space: nowrap;}");
a.push(".pop_title div {position: relative;width: 100%;z-index: 2;height: 30px;line-height: 30px;text-align: center;background-color: #8D8804;padding: 0 4px;border-radius: 5px;color: #fff;}");a.push(".pop_title p {");a.push("position: relative;");a.push("padding: 0px;");a.push("height: 12px;");a.push("width: 12px;");a.push("transform: rotate(45deg);");a.push("-webkit-transform: rotate(45deg);");a.push("margin: auto;");a.push("margin-top: -6px;");a.push("z-index: 1;");a.push("background-color: #8D8804;");
a.push("}");var b=document.createElement("style");b.textContent=a.join("\n");document.getElementsByTagName("head")[0].appendChild(b);this._css_setted=!0}},right_show_menu_sub:function(a,b){b=b||event;if((b.target||b.srcElement).className=="item"){b=$(a);var c=this.right_add_menu_subs(a);window.last_open&&window.last_open!=a&&window.last_open.click();b.attr("is_open")==1?(b.attr("is_open","0"),c&&(c.style.display="none"),window.last_open=null):(b.attr("is_open","1"),c&&(c.style.display=""),window.last_open=
a)}},right_add_menu_subs:function(a){var b=("M_"+Math.random()).replace(".","");a.id=a.id||b;var c=a.id+"_s";if($X(c))return $X(c);var d;(b=a.getAttribute("subs"))&&(d=JSON.parse(b));if(d&&d.length!=0){b=document.createElement("div");b.id=c;a.appendChild(b);for(a=0;a<d.length;a++){c=d[a];var e=document.createElement("p");$(e).attr({onclick:"EWA_UI_Metro.right_item_click(this)",_title:c.title,u:c.url});e.innerHTML="<b class='"+c.icon+"'></b><span>"+c.title+"</span>";b.appendChild(e)}return b}this.right_item_click(a)},
right_item_click:function(a){var b=$(a);a=b.attr("u");b=b.attr("_title");a&&(a.indexOf("/")>0||(a=a.indexOf("?")>=0?EWA.CP+"/EWA_STYLE/cgi-bin/"+a:EWA.CP+"/EWA_STYLE/cgi-bin/?"+a),AddTab(a,b))},load_msg_sub:function(){}},__Menu={C:EWA_UI_MenuClass,OnMouseOver:function(a){__Menu._LastObj!=null&&(__Menu._LastObj.style.backgroundColor="");__Menu._LastObj=a;a.style.backgroundColor="#DDD"},OnClick:function(a,b){__Menu._LastObj!=null&&(__Menu._LastObj.style.backgroundColor="");__Menu._LastObj=null;typeof a.stopPropagation!=
"undefined"?a.stopPropagation():a.cancelBubble=!0;if(b.id.indexOf("_EWA_MF_")>0&&b.id.indexOf("*")>0){a=b.id.split("*")[0];a=document.getElementById(a);for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];d.getAttribute("EWA_MF_PID")==a.id&&alert(d.innerHTML)}}EWA.C.Utils.RunCmd(b)}};EWA.UI.Menu=__Menu;var __EMP_TIP_TIMER_SHOW,__EMP_TIP_CLASS;function EMP_TIP_HIDE(){window.clearInterval(__EMP_TIP_TIMER_SHOW);__EMP_TIP_CLASS._Hidden();__EMP_TIP_TIMER_SHOW=null}
function EWA_UI_TipClass(a){this.ParentWindow=window;this.TipFrame=null;this.Alpha=0;this.IsShow=!0;this._Id="__EWA_TIP_"+a;this._BakFrame=this._BakTable=this._ForTable=this._ShowDocument=null;this._InitTipFrame=function(){var b=this._InitDiv(),c=this._InitTable();this._ForTable=c;this._InitTableImgForground(c);b.appendChild(c);this._BakTable=c=this._InitTable();this._InitTableImgBackground(c);b.appendChild(c);this.TipFrame=b;this.ParentWindow.document.body.appendChild(b);__EMP_TIP_CLASS=this};this._InitDiv=
function(){var b=this.ParentWindow.document.createElement("div");b.id=this._Id;b.style.zIndex="1998";b.style.display="none";b.className="ewa-tip";b.innerHTML=EWA.B.IE?"<iframe src='javascript:false' style=\"position:absolute; visibility:inherit; top:0px; left:0px; width:1px; height:1px; z-index:-1; filter='progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)';\"></iframe>":'<div style="position:absolute; visibility:inherit; top:0px; left:0px; width:1px; height:1px; z-index:-1;"></div>';this._BakFrame=
b.childNodes[0];return b};this._CreateImgHtml=function(b,c,d){return"<img src='"+((EWA.RV_STATIC_PATH==null?EWA.CP:EWA.RV_STATIC_PATH)+"/EWA_STYLE/images/tip/"+b)+"' width="+c+" height="+d+">"};this._SetBackgound=function(b,c){b.style.backgroundImage="url('"+((EWA.RV_STATIC_PATH==null?EWA.CP:EWA.RV_STATIC_PATH)+"/EWA_STYLE/images/tip/"+c)+"')";b.style.backgroundRepeat="repeat-x"};this._InitTableImgForground=function(b){b.className="ewa-tip-for";b.rows[2].cells[1].onmouseover=function(){window.clearInterval(__EMP_TIP_TIMER_SHOW);
__EMP_TIP_TIMER_SHOW=null;this.bgColor="#FFCC66"};b.onmouseout=function(){window.clearInterval(__EMP_TIP_TIMER_SHOW);__EMP_TIP_TIMER_SHOW=null;__EMP_TIP_CLASS.HiddenTip();this.rows[2].cells[1].bgColor="white"};b.rows[0].cells[0].className="ewa-tip-arrow";b.rows[1].cells[0].className="ewa-tip-tl";b.rows[1].cells[1].className="ewa-tip-tm";b.rows[1].cells[2].className="ewa-tip-tr";b.rows[2].cells[0].className="ewa-tip-l";b.rows[2].cells[1].className="ewa-tip-m";b.rows[2].cells[2].className="ewa-tip-r";
b.rows[3].cells[0].className="ewa-tip-bl";b.rows[3].cells[1].className="ewa-tip-bm";b.rows[3].cells[2].className="ewa-tip-br"};this._InitTableImgBackground=function(b){};this._InitTable=function(){var b=this.ParentWindow.document.createElement("table"),c=b.insertRow(-1);c.insertCell(-1);for(var d=0;d<3;d++){c=b.insertRow(-1);for(var e=0;e<3;e++)c.insertCell(-1).style.fontSize=d==1&&e==1?"12px":"1px"}c=b.insertRow(-1);c.insertCell(-1);b.border=0;b.cellSpacing=0;b.cellPadding=0;b.style.fontSize="1px";
b.rows[0].cells[0].colSpan=3;b.rows[4].cells[0].colSpan=3;return b};this.ShowTip=function(b,c,d){window.clearInterval(__EMP_TIP_TIMER_SHOW);__EMP_TIP_TIMER_SHOW=null;this.TipFrame.style.display="";this._ForTable.rows[2].cells[1].innerHTML=b;b=this._ForTable.offsetWidth;this._ForTable.style.width=this._ForTable.rows[2].cells[1].offsetWidth+12+"px";var e=c-b/4+14;e<0?e=12:this._ShowDocument!=null&&b+e>this._ShowDocument.body.offsetWidth&&(e=this._ShowDocument.body.offsetWidth-b-2);this.TipFrame.style.left=
e+"px";this.TipFrame.style.top=d+3+"px";e=c-e;c=e+3;var g="/EWA_STYLE/images/tip/image048.gif";d="/EWA_STYLE/images/tip/image013.png";e<b/2&&e-32>0&&(g="/EWA_STYLE/images/tip/image050.gif",d="/EWA_STYLE/images/tip/image015.png",e-=32,e<0&&(e=4),c=e-3);b=document.all?6:9;var h=EWA.RV_STATIC_PATH==null?EWA.CP:EWA.RV_STATIC_PATH;this._ForTable.rows[0].cells[0].innerHTML="<img src='"+h+g+"' width=32 height=21 style='position: relative; left: "+e+"px; top: "+b+"px'>";e="<img src='"+h+d+"' width=37 height=21 style='position: relative; left: "+
c+"px; top: "+b+"px'>";document.all&&(e="<div style=\"filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+(h+d)+"', sizingMethod='scale'); position: relative; left: "+c+"px; top: "+b+'px; width:37px; height:21px"></DIv>');this._BakTable.rows[0].cells[0].innerHTML=e;this.TipFrame.style.display=""};this.HiddenTip=function(){__EMP_TIP_CLASS=this;__EMP_TIP_TIMER_SHOW!=null&&window.clearInterval(__EMP_TIP_TIMER_SHOW);__EMP_TIP_TIMER_SHOW=window.setInterval(EMP_TIP_HIDE,500)};this.GetObjectLocation=
function(b,c){b=EWA.UI.Utils.GetPosition(b);return[b.X,b.Y]};this._Hidden=function(){this.TipFrame.style.display="none"};this._InitTipFrame()}
function EWA_UI_LinkClass(a,b){this.LinkObj1=a;this.LinkObj2=b;this.LinkObj=null;this._Style="2px solid blue";this.getSize=function(c){var d=EWA$UI$COMMON.GetPosition(c);return{X:d.X,Y:d.Y,W:c.offsetWidth,H:c.offsetHeight}};this._CreateLinkObj=function(){var c=document.createElement("table");EWA.B.IE?c.style.cssText="position: absolute; width: 100px; height: 100px; z-index: -11; left: 693px; top: 174px;font-size:1px;":c.setAttribute("style","position: absolute; width: 100px; height: 100px; z-index: -11; left: 693px; top: 174px;font-size:1px;");
c.cellSpacing=0;for(var d=c.cellPadding=0;d<2;d++)for(var e=c.insertRow(-1),g=0;g<2;g++)e.insertCell(-1).innerHTML="&nbsp;";document.body.appendChild(c);this.LinkObj=c};this.Link=function(){this.LinkObj==null&&this._CreateLinkObj();this.LinkObj.rows[0].cells[0].style.border="";this.LinkObj.rows[0].cells[1].style.border="";this.LinkObj.rows[1].cells[0].style.border="";this.LinkObj.rows[1].cells[1].style.border="";var c=this.getSize(this.LinkObj1),d=this.getSize(this.LinkObj2);if(c.X+c.W<d.X){var e=
c.X+c.W;var g=d.X-c.X-c.W;this.LinkObj.rows[0].cells[0].style.width=g/2+"px"}else c.X<d.X?(e=c.X-20,g=d.X-c.X+20,this.LinkObj.rows[0].cells[0].style.width="20px"):c.X>=d.X&&c.X<d.X+d.W?(e=d.X-20,g=c.X-d.X+20,this.LinkObj.rows[0].cells[0].style.width="20px"):(e=d.X+d.W,g=c.X-d.X-d.W,this.LinkObj.rows[0].cells[0].style.width=g/2+"px");if(c.Y<d.Y){var h=d.Y-d.H/2-c.Y+c.H/2;var k=c.Y-c.H/2}else h=c.Y-c.H/2-d.Y+d.H/2,k=d.Y-d.H/2;this.LinkObj.style.width=g+"px";this.LinkObj.style.height=h+"px";this.LinkObj.style.left=
e+"px";this.LinkObj.style.top=k+"px";k=this.LinkObj.rows[0].cells[0];e=this.LinkObj.rows[0].cells[1];h=this.LinkObj.rows[1].cells[0];g=this.LinkObj.rows[1].cells[1];c.Y<d.Y?c.X+c.W<d.X?(k.style.borderTop=this._Style,k.style.borderRight=this._Style,h.style.borderRight=this._Style,g.style.borderBottom=this._Style):(c.X<d.X?(k.style.borderTop=this._Style,k.style.borderLeft=this._Style,h.style.borderLeft=this._Style,g.style.borderBottom=this._Style):c.X>=d.X&&c.X<d.X+d.W?(k.style.borderTop=this._Style,
k.style.borderLeft=this._Style,h.style.borderLeft=this._Style,e.style.borderTop=this._Style):(e.style.borderTop=this._Style,k.style.borderRight=this._Style,h.style.borderRight=this._Style),h.style.borderBottom=this._Style):c.X+c.W<d.X?(e.style.borderTop=this._Style,k.style.borderRight=this._Style,h.style.borderRight=this._Style,h.style.borderBottom=this._Style):c.X<d.X?(k.style.borderTop=this._Style,e.style.borderTop=this._Style,k.style.borderLeft=this._Style,h.style.borderLeft=this._Style,h.style.borderBottom=
this._Style):c.X>=d.X&&c.X<d.X+d.W?(k.style.borderTop=this._Style,k.style.borderLeft=this._Style,h.style.borderLeft=this._Style,g.style.borderBottom=this._Style,h.style.borderBottom=this._Style):(k.style.borderTop=this._Style,k.style.borderRight=this._Style,h.style.borderRight=this._Style,g.style.borderBottom=this._Style)}}
function EWA_UI_TabsClass(a){this._ClassName=a;this._Index=0;this._ContentsParent=this._TabsParent=null;this._IdTabTag="__EWA_TAB_HEAD_";this._IdFrameTag="__EWA_TAB_FRAME_";this.CurrentWindow=null;this._CurId="";this.CreateTab=function(b,c){var d=this._CheckExist(b);if(d==null){d=this._Index;var e=this._CreateTabHead(b,c||"...");b=this._CreateIframe(b);this._Index++;c||EWA_ChkIframeOk(b,function(g,h){g=g.document.title;$(e).find(".bg_c span:eq(0)").text(g)})}this.ShowTab(d)};this._CreateTabHead=function(b,
c){var d=this._Index,e=this._TabsParent.ownerDocument.createElement("table");e.cellPadding=0;e.cellSpacing=0;e.border=0;e.setAttribute("ewa_tab_url",b);e.title="\u53cc\u51fb\u5173\u95ed\u7a97\u53e3\r\n\u53f3\u952e\u5237\u65b0\u5f53\u524d\u7a97\u53e3";b=e.insertRow(-1);b.insertCell(-1).className="bg_l";var g=b.insertCell(-1);g.className="bg_c";g.innerHTML="<nobr><span>"+c+"</span><b class='ewa_tab_close'></b></nobr></div>";g.getElementsByTagName("b")[0].onclick=function(){var h=this.parentNode.parentNode.parentNode.parentNode.parentNode,
k=h.id.split("_");k=k[k.length-1];eval("window."+h.getAttribute("ewa_class_name")).RemoveTab(k)};b.insertCell(-1).className="bg_r";e.id=this._IdTabTag+d;e.className="ewa_tab_act";e.setAttribute("ewa_class_name",this._ClassName);e.onclick=function(){if(e.getAttribute("ewa_tab_act")==0){var h=this.id.split("_");h=h[h.length-1];eval("window."+this.getAttribute("ewa_class_name")).ShowTab(h)}};e.ondblclick=function(){var h=this.id.split("_");h=h[h.length-1];eval("window."+this.getAttribute("ewa_class_name")).RemoveTab(h)};
e.onselectstart=function(){return!1};e.oncontextmenu=function(h){this.onclick();EWA.B.IE?window.event.returnValue=!1:h.preventDefault();h=this.id.split("_");var k="__EWA_TAB_FRAME_"+h[h.length-1];h=new EWA_UrlClass;k=$X(k).contentWindow;h.SetUrl(k.location.href);h.RemoveParameter("________r");h.AddParameter("________r",Math.random());k.location.href=h.GetUrl();return!1};EWA.B.IE||(e.onmousedown=function(h){typeof h.preventDefault!="undefined"&&h.preventDefault()});this._TabsParent.appendChild(e);
return e};this._CreateIframe=function(b){var c=this._ContentsParent.ownerDocument.createElement("IFRAME");c.frameBorder=0;c.width="100%";c.height="100%";c.src=b;c.id=this._IdFrameTag+this._Index;this._ContentsParent.appendChild(c);return c};this.RemoveCurrentTab=function(){this.RemoveTab(this._CurId)};this.RemoveTab=function(b){for(var c=9999999999999,d,e=this._ContentsParent.getElementsByTagName("iframe"),g=null,h=0;h<e.length;h++){var k=e[h];k.id!=this._IdFrameTag+b?c>k.getAttribute("ewa_tab_show_seq")*
1&&(c=k.getAttribute("ewa_tab_show_seq")*1,d=k.id):g=k}this._ContentsParent.removeChild(g);b=this._TabsParent.ownerDocument.getElementById(this._IdTabTag+b);this._TabsParent.removeChild(b);d!=null&&(d=d.split("_"),d=d[d.length-1],this._ContentsParent.ownerDocument.getElementById(this._IdTabTag+d)!=null&&this.ShowTab(d))};this._CheckExist=function(b){for(var c=this._TabsParent.childNodes,d=0;d<c.length;d++){var e=c[d];if(e.getAttribute("ewa_tab_url")==b)return b=e.id.split("_"),b[b.length-1]}return null};
this.ShowTab=function(b){this._CurId=b;var c=this._ContentsParent.getElementsByTagName("iframe");this.CurrentWindow=null;for(var d,e,g,h,k=0;k<c.length;k++){var l=c[k],m=l.id.split("_");m=l.ownerDocument.getElementById(this._IdTabTag+m[m.length-1]);l.id==this._IdFrameTag+b?(this.CurrentWindow=l.contentWindow,d=m,e=l):(l.style.display!="none"&&(g=m,h=l),m=l.getAttribute("ewa_tab_show_seq")*1+1,l.setAttribute("ewa_tab_show_seq",m))}this.showTabBeforeCallback&&this.showTabBeforeCallback(d,e,g,h)?console.log("showTabBeforeCallback return stop next"):
(d.className="ewa_tab_act",d.setAttribute("ewa_tab_act",1),e.setAttribute("ewa_tab_show_seq",0),e.style.display="",e.style.zIndex=1,(b=e.getAttribute("s_top"))&&l.contentWindow.document.scrollingElement&&(l.contentWindow.document.scrollingElement.scrollTop=b*1),h&&(g.className="ewa_tab_dact",g.setAttribute("ewa_tab_act",0),h.style.display="none",h.style.zIndex=0,l.contentWindow.document.scrollingElement&&(b=l.contentWindow.document.scrollingElement.scrollTop,h.setAttribute("s_top",b))),this.showTabAfterCallback&&
this.showTabCallback(d,e,g,h))};this.Init=function(b,c){if(!EWA.B.IE)try{b.style.MozUserFocus="ignore",b.style.MozUserInput="disabled",b.style.MozUserSelect="none"}catch(e){}var d=b.ownerDocument.createElement("table");d.style.width="100%";d.style.height="100%";d.onselectstart=function(){return!1};d.cellSpacing=0;d.cellPadding=0;d.insertRow(-1).insertCell(-1).vAlign="bottom";d.className="ewa_tab";b.appendChild(d);this._ContentsParent=c;this._TabsParent=d.rows[0].cells[0];d=null}}
function EWA_UI_DialogClass(){this.zIndex=999;this.Id=null;this.Height=this.Width="200px";this.Top=this.Left="-1000px";this.Offset="5";this.ShadowColor="#777777";this.IsShowTitle=!1;this.IsCanMove=!0;this.AutoSize=this.IsCover=!1;this.DisposeOnClose=!0;this._WindowIndex=this._CreateWindowIndex=this.CreateWindow=this.FrameTitle=this.FrameContent=this.Frame=null;this.GetFrame=function(){return this.GetObject(this.Frame)};this.GetFrameContent=function(){return this.GetObject(this.FrameContent)};this.GetFrameTitle=
function(){return this.GetObject(this.FrameTitle)};this.GetObject=function(a){return a==null?null:this.CreateWindow.$X(a)};this.SetHtml=function(a){this.GetFrameContent().innerHTML=a};this.SetObject=function(a){this.GetFrameContent().appendChild(a)};this.SetTitle=function(a){this.GetFrameTitle()!=null&&(this.GetFrameTitle().innerHTML=a)};this.ScrollMoveDiv=function(){var a=this.GetFrame();if(a!=null){var b=a.ownerDocument,c=b.body.scrollLeft;b=b.body.scrollTop;var d=a.getAttribute("_SCROLL_X")*1,
e=a.getAttribute("_SCROLL_Y")*1;a.style.left=c-d+$X(this.Frame).offsetLeft+"px";a.style.top=b-e+$X(this.Frame).offsetTop+"px";a.setAttribute("_SCROLL_X",c);a.setAttribute("_SCROLL_Y",b)}};this.MoveBottom=function(a){var b=$(a).offset();b.Y=b.top+$(a).height();b.X=b.left;var c=a.ownerDocument,d=c.parentWindow?c.parentWindow:c.defaultView;if(d==this.CreateWindow){var e=document.body.clientWidth;c=document.body.clientHeight;var g=b.X;d=b.Y;var h=(this.Height+"").replace("px","")*1,k=(this.Width+"").replace("px",
"")*1;b.Y+a.clientHeight+h>c&&(d=b.Y-a.clientHeight-h);b.X+k>e&&(g=e-k-a.clientWidth);EWA.B.PAD&&(g=0);this.Move(g,d+4)}else g=d._EWA_DialogWnd._Dialog.GetFrame(),e=g.offsetLeft,c=g.offsetTop,h=this.GetFrame(),h.setAttribute("_SCROLL_X",g.getAttribute("_SCROLL_X")),h.setAttribute("_SCROLL_Y",g.getAttribute("_SCROLL_Y")),a=$(a).height(),g=b.X+e,EWA.B.PAD&&(g=0),e=d._EWA_DialogWnd._Dialog.GetFrameTitle().clientHeight,this.Move(g,b.Y+c+a+e)};this.Move=function(a,b){var c=this.GetFrame();c!=null&&EWA.UI.Utils.MoveTo(c,
a,b<0?0:b)};this.MoveCenter=function(){var a=this.GetFrame(),b=a.clientWidth,c=a.clientHeight,d=EWA.UI.Utils.GetDocSize(this.CreateWindow);c=(d.H-c)/2-40;b=(d.W-b)/2;b<0&&(b=0);c<0&&(c=0);var e=d.SH;d=d.SW;a.setAttribute("_SCROLL_X",d);a.setAttribute("_SCROLL_Y",e);this.Move(b+d,c+e)};this.ResizeByContent=function(){var a=this.GetFrame(),b=this.GetFrameContent().childNodes[0];if(b.tagName=="IFRAME"){var c=b.contentWindow;c&&c.document&&c.document.body&&(c=c.document.getElementById("Test1"))&&(b=c)}c=
this.GetFrameContent().parentNode.parentNode.parentNode;var d=$(c).css("border-left-width").replace("px","")*1+$(c).css("border-right-width").replace("px","")*1;var e=$(c).css("border-top-width").replace("px","")*1+$(c).css("border-bottom-width").replace("px","")*1;this._calc_frame_table=d;c=$(b).width();c+=d;b=$(b).height()+e;d=a.style.left.replace("px","")*1;a=a.style.top.replace("px","")*1;c+d>this.CreateWindow.document.body.clientWidth&&this.Move(this.CreateWindow.document.body.clientWidth-c-
20,a);this.Resize(c,b,!0)};this.Resize=function(a,b,c){if(this.IsShowTitle){var d=this.GetFrameTitle();b+=$(d).parent().height()}var e=d=0;c||(c=this.GetFrameContent().parentNode.parentNode.parentNode,this._calc_frame_table=d=$(c).css("border-left-width").replace("px","")*1+$(c).css("border-right-width").replace("px","")*1,e=$(c).css("border-top-width").replace("px","")*1+$(c).css("border-bottom-width").replace("px","")*1);a+=d;b+=e;c=this.GetFrame();c.style.width=a+"px";c.style.height=b+"px";for(d=
0;d<c.childNodes.length;d+=1)e=c.childNodes[d],e.style.width=a+"px",e.style.height=b+"px",e.id.indexOf("divContent")>0&&(e.style.overflow="hidden");this.GetFrameContent();a=this.GetObject(this._DivCover);$(a).css("background-image","none");$(a).attr("background-image","none")};this.Show=function(a){var b=this.GetFrame();a?(b.style.display="",this.IsShowTitle&&this.AutoSize&&(_EWA_DIALOG_ON_TIMER=this,this.TimerHandle=window.setInterval(function(){var c=_EWA_DIALOG_ON_TIMER;window.clearInterval(c.TimerHandle);
var d=c.GetFrame(),e=c.GetFrameContent(),g=e.childNodes[0].offsetWidth,h=c.GetObject(c._FrameFore).offsetHeight;d.style.width=g+"px";d.style.height=h+"px";c.GetObject(c._FrameBack1)&&(c.GetObject(c._FrameBack1).style.width=g+"px",c.GetObject(c._FrameBack1).style.height=h+"px");c.GetObject(c._FrameBack2)&&(c.GetObject(c._FrameBack2).style.width=g+"px",c.GetObject(c._FrameBack2).style.height=h+3+"px");if(c=e.childNodes[0])c.style.width=g-2+"px",c.style.height=h-2+"px";c=_EWA_DIALOG_ON_TIMER=null;g=
c.GetObject(this._DivCover);$(g).css("background-image","none");$(g).attr("background-image","none")},32))):b.style.display="none";b=oCover=null};this.Dispose=function(){this.CreateWindow&&(this.CreateWindow._EWA_DIALOGS[this._CreateWindowIndex]=null,_EWA_DIALOGS[this._WindowIndex]=null,this._DivCover!=null&&(EWA$UI$COMMON.Drop(this.GetObject(this._DivCover)),this._DivCover=null),this.GetObject(this.Frame).innerHTML="",EWA$UI$COMMON.Drop(this.GetObject(this.Frame)),this.CreateWindow=null,EWA.B.IE&&
CollectGarbage())};this.SetZIndex=function(a){this.CreateWindow._EWA_UI_DIALOG_COVERINDEX+=a;this.zIndex=this.CreateWindow._EWA_UI_DIALOG_COVERINDEX;this.GetObject(this.Frame).style.zIndex=this.zIndex};this.CreateId=function(){var a=Math.random();return(new Date).getTime()+"_"+a};this.Create=function(){this.CreateWindow==null&&(this.CreateWindow=window);this.IsCover&&this._CreateCover();var a=this.CreateId(),b=this.CreateWindow;b._EWA_UI_DIALOG_COVERINDEX==null&&(b._EWA_UI_DIALOG_COVERINDEX=0);b._EWA_UI_DIALOG_COVERINDEX+=
1;this.zIndex=b._EWA_UI_DIALOG_COVERINDEX;var c=EWA$UI$COMMON.CreateObject(b,"div","display:none; "+(window.EWA_UI_DIALOG_FIXED?"position:fixed":"position:absolute")+"; width:"+this.Width+"; height:"+this.Height+"; z-index:"+this.zIndex+"; left:"+this.Left+"; top:"+this.Top+";",b.document.body);c.setAttribute("EWA_NAME","DIV_FRAME");c.className="ewa-dialog";c.id=a+"divFrame";this.Frame=c.id;var d=EWA$UI$COMMON.CreateObject(b,"div","position: absolute; width: 100%; height: 100%; left: 0px; top: 0px;",
c);d.setAttribute("EWA_NAME","DIV_BACK1");d.id=a+"divBack1";this._FrameBack1=d.id;if(this.ShadowColor!=null&&this.ShadowColor!=""){var e=EWA$UI$COMMON.CreateObject(b,"div","position: absolute; background-color:"+this.ShadowColor+"; width:100%; height:100%; left:"+this.Offset+"px; top: "+(this.Offset*1+2)+"px;",c);e.style.filter="alpha(opacity=50)";e.style.opacity=.5;e.id=a+"divBack2";this._FrameBack2=e.id}EWA.B.IE&&(d.innerHTML="<iframe src='javascript:false' style=\"position:absolute;top:0px;left:0px;width:100%; height:100%; z-index:-1; filter='progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)';\"></iframe>",
this.ShadowColor!=null&&this.ShadowColor!=""&&(e.innerHTML="<iframe src='javascript:false' style=\"position:absolute;top:0px;left:0px;width:100%; height:100%; z-index:-1; filter='progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)';\"></iframe>"));c.setAttribute("_SCROLL_X",0);c.setAttribute("_SCROLL_Y",0);this._CreateContent();$(c).append("<i style='z-index:"+this.zIndex+"0' onclick='this.parentNode.style.display=\"none\"' class='ewa-dialog-close'></i>");this.CreateWindow._EWA_DIALOGS||(this.CreateWindow._EWA_DIALOGS=
[],addEvent(this.CreateWindow,"scroll",EWA.UI.DialogOnScroll));window._EWA_DIALOGS||(_EWA_DIALOGS=[],addEvent(window,"scroll",EWA.UI.DialogOnScroll));this._CreateWindowIndex=this.CreateWindow._EWA_DIALOGS.length;this.CreateWindow._EWA_DIALOGS[this._CreateWindowIndex]=this;this._WindowIndex=_EWA_DIALOGS.length;_EWA_DIALOGS[this._WindowIndex]=this};this._CreateContent=function(){var a=this.CreateId(),b=EWA$UI$COMMON.CreateObject(this.CreateWindow==null?window:this.CreateWindow,"div","position: absolute; width: 100%; height: 100%; z-index: 2; left: 0px; top: 0px;  background-color:white",
this.GetFrame());b.setAttribute("EWA_NAME","CONTENT");b.className="EWA_POP_MAIN";b.id=a+"divContent";if(this.IsShowTitle){var c=" EWA_WND_ID='"+this.Id+"'",d="this.ownerDocument.parentWindow";EWA.B.IE||(d="this.ownerDocument.defaultView");if(this.IsCanMove){var e=d+"._EWA_UI_WINDOW_LIST[this.getAttribute('EWA_WND_ID')]._OpenerWindow.EWA$UI$COMMON$Move.";c=c+(' onmousedown="'+e+'OnMouseDown(this.parentNode.parentNode,event,true,true);" onmousemove="')+(e+'OnMouseMove(this.parentNode.parentNode,event,true,true);" onmouseup="')+
(e+'OnMouseUp(this.parentNode.parentNode);" onmouseout="try{')+(e+"OnMouseOut(this.parentNode.parentNode);}catch(e){}\" style='cursor:pointer' ")}e="<img src='"+(EWA.RV_STATIC_PATH==null?"/EmpScriptV2":EWA.RV_STATIC_PATH)+"/EWA_STYLE/images/dialog/but_1.gif' style='cursor:pointer'  onmouseover=\"var m=this.src.lastIndexOf('.');var s = this.src.substring(0, m);if(s.substring(s.length - 1).toUpperCase() == 'C'){return;}s+='c'+this.src.substring(m);this.src = s;\"";if(this.DisposeOnClose){var g=' ondblclick="'+
d+"._EWA_UI_WINDOW_LIST['"+this.Id+"'].CloseWindow();\"";d=' onclick="'+d+"._EWA_UI_WINDOW_LIST['"+this.Id+"'].CloseWindow();\""}else g=' ondblclick="'+d+"._EWA_UI_WINDOW_LIST['"+this.Id+"']._Dialog.Show(false);\"",d=' onclick="'+d+"._EWA_UI_WINDOW_LIST['"+this.Id+"']._Dialog.Show(false);\"";c="<table unselectable='on' onselectstart='return false;' style='cursor:pointer;margin-bottom:1px;width:100%;height:100%;-moz-user-select:none;' cellpadding='0' cellspacing='0' "+c+"><tr><td "+(g+" class='EWA_POP_TITLE_L'>...</td><td class='EWA_POP_TITLE_R' align=\"right\">")+
(e+" onmouseout =\"var m=this.src.lastIndexOf('.');var s = this.src.substring(0, m - 1);s = s + this.src.substring(m);this.src = s;\""+(d+" /></td></tr><tr><td class='EWA_POP_CNT' colspan=\"2\" valign=top></td></tr></table>"));b.innerHTML=c;c=a+"FrameContent";this.FrameContent=b.childNodes[0].rows[1].cells[0].id=c;a+="FrameTitle";this.FrameTitle=b.childNodes[0].rows[0].cells[0].id=a;this._FrameFore=b.id}else this.FrameContent=b.id};this._CreateCover=function(){var a=this.CreateWindow;a._EWA_UI_DIALOG_COVERINDEX==
null&&(a._EWA_UI_DIALOG_COVERINDEX=1E7);a._EWA_UI_DIALOG_COVERINDEX+=1;var b=a.document.createElement("div");b.style.cssText="display:block; width:100%; height:100%; ";b.setAttribute("style","display:block; width:100%; height:100%; ");b.style.zIndex=a._EWA_UI_DIALOG_COVERINDEX;b.className="ewa-ui-dialog-cover";b.id=this.CreateId()+"_DivCover";this._DivCover=b.id;a.document.body.appendChild(b)}}
function EWA_UI_PopWindowClass(a,b){this._DivCover=null;this._Dialog=new EWA_UI_DialogClass;this._Dialog.DisposeOnClose=b;this.OpendDialogs=[];this.ClassName=this._Name=this.Id=null;this._Url="about:blank";this._ParentWindow=a;this._OpenerWindow=window;this.OpendObject=EWA.B.IE?window.event?window.event.srcElement:null:null;this._CallBack=null;this.SetCallBack=function(c){this._CallBack=c};this._ReturnBack=null;this.SetReturnBack=function(c){this._ReturnBack=c};this.GetReturnBack=function(){return this._ReturnBack};
this.Show=function(c){this._Dialog.Show(c)};this.Hidden=function(){this._Dialog.Show(!1)};this.CloseWindow=function(){for(var c=0;c<this.OpendDialogs.length;c+=1)this.OpendDialogs[c].Dispose(),this.OpendDialogs[c]=null;this._Dialog.Dispose();if(this._OpenerWindow)try{this._OpenerWindow.document.body.focus(),this.OpendObject&&this.OpendObject.focus()}catch(d){}this.Dispose()};this.Dispose=function(){if(this._CallBack!=null)try{this._CallBack.Dispose()}catch(d){}if(this._ReturnBack!=null)try{this._ReturnBack.Dispose()}catch(d){}try{var c=
this.GetIframeWindow();c&&(c._EWA_DialogWnd=null)}catch(d){}if(this._OpenerWindow)try{this._OpenerWindow.EWA.UI.Dialog.WND[this.Id]=null,this._ParentWindow._EWA_UI_WINDOW_LIST[this.Id]=null}catch(d){}try{this._Dialog.Dispose(),this._ReturnBack=this._CallBack=this.OpendObject=this._OpenerWindow=this._ParentWindow=this._Dialog=null}catch(d){}EWA.B.IE&&CollectGarbage()};this.SetNewSize=function(c,d){this._Dialog.Resize(c,d)};this.Move=function(c,d){this._Dialog.Move(c,d)};this.MoveCenter=function(){this._Dialog.MoveCenter()};
this.GetIframeWindow=function(){if(this._ParentWindow!=null){var c="__EMP_COMMON_IFRAME"+this._Name;if(EWA.B.IE)var d=this._ParentWindow.frames[c];else for(var e=0;e<this._ParentWindow.frames.length;e+=1)if(this._ParentWindow.frames[e].name==c){d=this._ParentWindow.frames[e];break}return d}};this.SetCaption=function(c){this._Dialog.SetTitle(c)};this.SetUrl=function(c){c!="about:blank"&&(this.GetIframeWindow().location=c)};this.Create=function(c,d,e){this._Name=e;this._CreateDialog(c,d);this._ParentWindow._EWA_UI_WINDOW_LIST==
null&&(this._ParentWindow._EWA_UI_WINDOW_LIST={});this._ParentWindow._EWA_UI_WINDOW_LIST[this.Id]=this};this._CreateDialog=function(c,d){this._Dialog.Id=this.Id;this._Dialog.Width=c;this._Dialog.Height=d;this._Dialog.CreateWindow=this._ParentWindow;this._Dialog.IsShowTitle=!0;this._Dialog.IsCanMove=!0;this._Dialog.IsCover=!0;this._Dialog.Create();this._Dialog.Show(!0);this.SetHtml("<iframe style='width:100%;height:100%;' name='__EMP_COMMON_IFRAME"+this._Name+"' frameborder='0'></iframe>")};this.SetHtml=
function(c){this._Dialog.SetHtml(c)};this.ResizeByContent=function(){this._Dialog.ResizeByContent()}}EWA.UI.DialogOnScroll=function(){if(!window.EWA_UI_DIALOG_FIXED&&typeof _EWA_DIALOGS!="undefined")for(var a=0;a<_EWA_DIALOGS.length;a+=1)if(_EWA_DIALOGS[a]!=null)try{_EWA_DIALOGS[a].ScrollMoveDiv()}catch(b){_EWA_DIALOGS[a]=null}};
function EWA_Command(){this.CmdWindow=window;this.Cmd=null;this.CmdArgus=[];this.IsRunAuto=!1;this.Run=function(){if((typeof this.Cmd).toLowerCase()=="function")this.Cmd(this.CmdArgus);else{var a=this.CmdWindow.eval(this.Cmd);a==null?alert("EWA_Command.Cmd undefined! Pls check call method"):a(this.CmdArgus)}};this.Dispose=function(){for(var a=0;a<this.CmdArgus.length;a++)this.CmdArgus[a]=null;this.CmdArgus.length=0;this.Cmd=this.CmdWindow=this.CmdArgus=null}}
var __Dialog={D:EWA_UI_DialogClass,C:EWA_UI_PopWindowClass,WND:{},WNDCUR:null,CMD:EWA_Command,Pop:function(a,b,c){b=new EWA_UI_PopWindowClass(window,!0);typeof _EWA_DialogWnd!="undefined"&&(b.CreateWindow=_EWA_DialogWnd._ParentWindow);b.Width=172;b.Height=200;b.ShadowColor="";__Cal.WND=new EWA_CalendarClass;typeof _EWA_DialogWnd=="undefined"?b.CreateWindow=window:(b.CreateWindow=_EWA_DialogWnd._ParentWindow,_EWA_DialogWnd.OpendDialogs[_EWA_DialogWnd.OpendDialogs.length]=b);b.Create();b.SetHtml(a);
b.MoveCenter();b.Show(!0);return b},_GetTopWindow:function(){for(var a=window;a.parent!=a;)a=a.parent;return a.document.documentElement.innerHTML.toUpperCase().indexOf("<FRAMESET")>=0?window:a},_DialogMointer:function(){var a=EWA.UI.Dialog.WNDCUR;__Dialog.TimerInc++;if(!(a==null&&__Dialog.TimerInc>100)&&a!=null){var b=a.GetIframeWindow();b==null?(window.clearInterval(a._TimerHandle),EWA.UI.Dialog.WNDCUR=null):b.location.href!=a._Url&&(b.document.readyState?b.document.readyState=="complete"&&(window.clearInterval(a._TimerHandle),
EWA.UI.Dialog._SetTitle(a)):b.document.body!=null&&(b=b.document.documentElement.innerHTML,b=b.toLowerCase(),b.indexOf("</body>")>0||b.indexOf("</html>")>0)&&(a._IncNoIe==0?a._IncNoIe=1:EWA.UI.Dialog._SetTitle(a)))}},_SetTitle:function(a){if(a!=null){var b=a.GetIframeWindow();b._EWA_DialogWnd=a;a._Url=b.location.href;a.SetCaption(b.document.title);b.document.getElementsByTagName("INPUT");b.document.body.onunload=function(){try{this._EWA_DialogWnd._Url=""}catch(d){}};var c=__Dialog._SetInputFocus(b.document);
c||__Dialog._SetTextAreaFocus(b.document);c||b.document.body.focus();__Dialog._SetClose(b.document);b.document.body.style.margin="0px";b.document.body.style.overflow="hidden";a._Dialog.ResizeByContent();a.MoveCenter();a._CallBack!=null&&a._CallBack.Run();b=null}},_SetClose:function(a){for(var b=a.getElementsByTagName("INPUT"),c=0;c<b.length;c+=1){var d=b[c].type.toLowerCase();d!="button"&&d!="submit"||__Dialog._SetCloseFunction(b[c])}b=a.getElementsByTagName("BUTTON");for(c=0;c<b.length;c++)__Dialog._SetCloseFunction(b[c])},
_SetCloseFunction:function(a){var b=a.value.trim().toLowerCase();a.tagName.toLowerCase()=="button"&&(b=a.innerHTML);!(b.indexOf("\u5173\u95ed")>=0||b.indexOf("\u53d6\u6d88")>=0||b.indexOf("close")>=0||b.indexOf("cancel")>=0)||a.onclick!=null&&a.onclick.toString().indexOf("EWA")>=0||(a.onclick=function(){var c=this.ownerDocument;(c.parentWindow?c.parentWindow:c.defaultView)._EWA_DialogWnd.CloseWindow()})},_SetInputFocus:function(a){a=a.getElementsByTagName("INPUT");for(var b=0;b<a.length;b+=1){var c=
a[b],d=c.type.toLowerCase();if(d=="text"||d=="password")if(d=c.parentNode.innerHTML,!(d!=null&&d.toString().indexOf("EWA.F.I.Date")>=0))try{return c.focus(),a=null,!0}catch(e){}}return!1},_SetTextAreaFocus:function(a){a=a.getElementsByTagName("TEXTAREA");for(var b=0;b<a.length;b+=1)try{return a[b].focus(),a=null,!0}catch(c){}return!1},OpenReloadClose:function(a,b,c,d,e,g,h){EWA.UI.Dialog.OpenFrame(a,b,c,d,e,"RELOAD_PARENT,CLOSE_SELF",g,h)},OpenReload:function(a,b,c,d,e,g,h){EWA.UI.Dialog.OpenFrame(a,
b,c,d,e,"RELOAD_PARENT",g,h)},OpenReloadClear:function(a,b,c,d,e,g,h){EWA.UI.Dialog.OpenFrame(a,b,c,d,e,"RELOAD_PARENT,CLEAR_SELF",g,h)},OpenFrame:function(a,b,c,d,e,g,h,k){g==null&&(g="");__Dialog[a]||(__Dialog[a]={});__Dialog[a].AfterMsg=h==null?"":h;if(k=="yes"&&EWA.F&&EWA.F.FOS[a]&&EWA.F.FOS[a].Url){k=new EWA_UrlClass(EWA.F.FOS[a].Url);k.RemoveEwa();e=new EWA_UrlClass("a1?"+e);for(var l in e._Paras)h=e.GetParameter(l),k.AddParameter(l,h);e=k.GetParas()}g="EWA_P_BEHAVIOR="+g+"&EWA_PARENT_FRAME="+
a;a=EWA.UI.Dialog.GetUrl(b,c,e?e+"&"+g:g);EWA.UI.Dialog.OpenWindow(a,b+"-"+c,100,50,d)},OpenWindow:function(a,b,c,d,e,g,h,k){var l=k===void 0?!0:k;var m=e?window:EWA.UI.Dialog._GetTopWindow();e=a;e!=null&&e!="about:blank"&&(e=a.indexOf("?")>0?e+("&_r="+Math.random()):e+("?_r="+Math.random()));e=e.replace(/\|/ig,"%7c");a="_EWA_UI_DIALOG_"+b;EWA.UI.Dialog.WND[a]=null;EWA.UI.Dialog.WND[a]=new EWA.UI.Dialog.C(m,l);l=EWA.UI.Dialog.WND[a];l.Id=a;l.DisposeOnClose=k;l.Create(c,d,b);e!=null&&l.SetUrl(e);g!=
null&&l.SetCallBack(g);h!=null&&l.SetReturnBack(h);__Dialog.TimerInc=0;l._TimerHandle=window.setInterval(EWA.UI.Dialog._DialogMointer,155);l._IncNoIe=0;EWA.UI.Dialog.WNDCUR=l;return EWA.UI.Dialog.WND[a]},GetUrl:function(a,b,c){return EWA.CP+"/EWA_STYLE/cgi-bin/?XMLNAME="+a.toURL()+"&ITEMNAME="+b.toURL()+"&"+c}};
EWA.OW={Dia:null,PWin:null,Frame:null,Close:function(){EWA.OW.Dia?EWA.OW.Dia.CloseWindow():alert("Dialog not Load")},Load:function(){EWA.OW.Dia=window._EWA_DialogWnd;EWA.OW.PWin=EWA.OW.Dia?EWA.OW.Dia._OpenerWindow:null;EWA.OW.Frame=EWA.OW.PWin?EWA.OW.PWin.EWA.F.FOS[EWA.OW.PWin.EWA.F.CID]:null}};EWA.UI.Dialog=__Dialog;
function EWA_UI_DiaNewClass(){this.Id=null;this.IS_AUTO_SIZE=!0;this._GetIndex=function(){var a=window;a._EWA_UI_DIALOG_COVERINDEX==null&&(a._EWA_UI_DIALOG_COVERINDEX=1E7);a._EWA_UI_DIALOG_COVERINDEX++;return a._EWA_UI_DIALOG_COVERINDEX};this._GetCover=function(){return $X(this.Id+"_cover")};this.Create=function(a,b,c,d,e,g,h){this._isUrl=e;this._width=a;this._height=b;this._title=c;this._content=d;this._noHeader=g;var k=this._GetIndex();this.index=k;this.Id=this.Id||("_EWA_UI_DIA_"+Math.random()).replace(".",
"");var l=["<div id='"+this.Id+"' class='ewa-ui-dialog'>"];l.push("<div id='"+this.Id+"_cover'  class='ewa-ui-dialog-cover' style='position: fixed;z-index: "+k+";'></div>");k=" EWA_WND_ID='"+this.Id+"'";k+=' onmousedown="window.EWA$UI$COMMON$Move.OnMouseDown(this.parentNode.parentNode,event,true,true);" onmousemove="window.EWA$UI$COMMON$Move.OnMouseMove(this.parentNode.parentNode,event,true,true);" onmouseup="window.EWA$UI$COMMON$Move.OnMouseUp(this.parentNode.parentNode);" onmouseout="window.EWA$UI$COMMON$Move.OnMouseOut(this.parentNode.parentNode);"';
l.push("<div id='"+this.Id+"_box'  class='ewa-ui-dialog-box'  style='position: fixed;z-index: "+this._GetIndex()+";'>");l.push("<div style='position:relative;'>");g?l.push("<div id='"+this.Id+"_title' class='ewa-ui-dialog-title-noheader' style=''><a href='javascript:class_"+this.Id+".Close();' class='fa' style='text-decoration:none;padding:2px 2px 3px 3px;display:block'>&#xf00d</a></div>"):l.push("<div  id='"+this.Id+"_title'  class='ewa-ui-dialog-title'"+k+" style=''><span style='margin-left: 5px;'></span><a href='javascript:class_"+
this.Id+".Close();' class='fa' style=''>&#xf00d</a></div>");l.push("<div  id='"+this.Id+"_content' class='ewa-ui-dialog-content' style='width: 100%;overflow: auto;'></div>");l.push("</div>");l.push("</div>");l.push("</div>");$("body").append(l.join(""));$(".ewa-ui-dialog-title a.fa").css({color:"#aaa"}).hover(function(){$(this).css({color:"orangered"})},function(){$(this).css({color:"#aaa"})});$("#"+this.Id+"_box");this.SetSize(a,b);this.SetTitle(c);this.ShowCover(!0);this.MoveCenter();window["class_"+
this.Id]=this;this.SetContent(d,e,h);return this};this.SetSize=function(a,b){var c=$("#"+this.Id+"_content");a||(a=document.documentElement.clientWidth,a=a>410?400:a>300?a-10:300);b=b?b:200;c.css("width",a);c.css("height",b);$("#"+this.Id+"_title span").length>0&&(title_height=$("#"+this.Id+"_title").height())};this.SetTitle=function(a){a&&$("#"+this.Id+"_title span").html(a)};this.getTitleContainer=function(){var a=$("#"+this.Id+"_title");return a.length==0?null:a[0]};this.SetContent=function(a,
b,c){var d=$("#"+this.Id+"_content");b?(a='<iframe style="width:100%;height:100%" frameborder="0" src="'+a+'"></iframe>',d.css("overflow","hidden")):$(this._GetCover()).css("background-image","none");d.html(a);if(b){var e=this;setTimeout(function(){e._ChkIframeLoaded(c)},222)}else c&&c(this)};this.SetObject=function(a,b){var c=$("#"+this.Id+"_content");$(this._GetCover()).css("background-image","none");b||c.html("");c.append(a)};this._ChkIframeLoaded=function(a){var b=$("#"+this.Id+"_content iframe");
if(b.length!=0){b=b[0];try{if(b.contentWindow&&b.contentWindow.document&&b.contentWindow.document.readyState=="complete"&&b.contentWindow.$)try{this._IframeLoaded(b.contentWindow,a)}catch(d){this._IframeLoaded(b.contentWindow,a)}else{var c=this;setTimeout(function(){c._ChkIframeLoaded(a)},222)}}catch(d){console.log(d)}}};this._IframeLoaded=function(a,b){a._EWA_DialogWnd=this;this.SetTitle(a.document.title);new EWA_UrlClass(a.location.href);this.IS_AUTO_SIZE&&this.AutoSize();this.MoveCenter();var c=
this;a=a.$.find("button,input");for(var d=0;d<a.length;d++){var e=a[d],g=!1;if(e.id&&e.id.toLowerCase().indexOf("close")>=0)g=!0;else{var h=e.value||e.innerHTML;h&&(h.indexOf("\u5173\u95ed")>=0||h.indexOf("\u53d6\u6d88")>=0)&&(g=!0)}g&&(e.onclick=function(){c.Close()})}$(this._GetCover()).css("background-image","none");b&&b(this)};this.AutoSize=function(){var a=$(this.getContent());if(this._isUrl){if(a=a.find("iframe"),a=a[0].contentWindow,a.$){var b=a.$("#Test1");b.length>0&&(a=b.outerWidth(),b=
b.outerHeight(),this.SetSize(a,b),this.MoveCenter())}}else b=a.find("#Test1"),b.length>0?(a=b.outerWidth(),b=b.outerHeight()):(b=a[0].scrollHeight,a=a[0].scrollWidth),this.SetSize(a,b),this.MoveCenter()};this.getContent=function(){return $("#"+this.Id+"_content")[0]};this.getMain=function(){return $("#"+this.Id+"_box")[0]};this.ShowCover=function(a){var b=$("#"+this.Id+"_cover");if(a){a=$(window).width();var c=$(window).height();b.css("width",a);b.css("height",c);b.show()}else b.hide()};this.MoveCenter=
function(){var a=$(window).width(),b=$(window).height(),c=$("#"+this.Id+"_box"),d=c.width();c=c.height();a=(a-d)/2;b=(b-c)/2;a<0&&(a=0);b<0&&(b=0);this.Move(a,b)};this.Move=function(a,b){var c=$("#"+this.Id+"_box");c.css("top",b);c.css("left",a)};this.Close=function(){this.IsCloseAsHidden?$("#"+this.Id).hide():this.Dispose()};this.Dispose=function(){$("#"+this.Id).remove();window["class_"+this.Id]=null;delete window["class_"+this.Id]};this.Show=function(){this.IsCloseAsHidden?$("#"+this.Id).show():
alert("\u8bf7\u8bbe\u7f6e\u53c2\u6570 IsCloseAsHidden=true")}}$Dialog=function(a,b,c,d,e,g){var h=!(c&&d),k=new EWA_UI_DiaNewClass;k.IS_AUTO_SIZE=h;k.Create(c,d,b,a,!0,e,g);k.MoveCenter();return k};$DialogHtml=function(a,b,c,d,e,g){var h=new EWA_UI_DiaNewClass;h.Create(c,d,b,a,!1,e);h.MoveCenter();g&&g(h,id);return h};
$DialogInstall=function(a,b,c,d,e,g){var h=EWA_Utils.tempId("dialogInstall"),k=$DialogHtml("<div id='"+h+"'></div>","",c,d,e);$Install(a,h,function(){var l=!(c&&d);if(e||b)l&&k.AutoSize(),g&&g(k,p);else{var m=k.getContent(),n=$(m).find(".EWA_TABLE");if(n.length!=0&&n[0].id){var p=n[0].id;n=p.replace("EWA_FRAME_","").replace("EWA_LF_","");if(EWA&&EWA.F&&EWA.F.FOS&&EWA.F.FOS[n])if(n=EWA.F.FOS[n].Title,p.startsWith("EWA_LF_"))var r=0,q=setInterval(function(){r++;if(r>90)window.clearInterval(q),l&&k.AutoSize(),
g&&g(k,p);else{var t=$(m).find(".ewa_lf_func");if(t.length!=0){window.clearInterval(q);var v=k.getTitleContainer();if(v){t.css({"background-color":"transparent",display:"block","float":"left","font-size":"14px"});var u=t.find(".ewa_lf_func_caption");u.css("color","#08c");u.text(u.text().replace("[","").replace("]","").trim());$(v).find("span:eq(0)").remove();$(v).append(t).css("border-bottom","1px solid #eee")}l&&k.AutoSize();g&&g(k,p)}}},10);else n&&k.SetTitle(n),l&&k.AutoSize(),g&&g(k,p);else l&&
k.AutoSize(),g&&g(k,p)}else l&&k.AutoSize(),g&&g(k,p)}});return k};
function EWA_UI_CalendarYearClass(){this.Create=function(a,b,c,d,e){console.log(b,c,d);this.classId=("CY"+Math.random()).replace(".","");EWA.UI.CalendarYear=EWA.UI.CalendarYear||{};EWA.UI.CalendarYear[this.classId]=this;$($X(a)).append('<div class="ewa-ui-calendar-year" id="'+this.classId+'"></div>');a=$("#"+this.classId);var g=new EWA_CalendarClass,h=new Date;b&&c&&(h=new Date(b,c-1,1));b=c=h.getMonth();e||(b=Math.round(c/3-.5)*3);e=h.getFullYear();if(!d||d<=0)d=12;for(h=1;h<=d;h++){if(EWA.LANG==
"enus"){var k=b+1+"/"+e;g.SetDate(_EWA_G_SETTINGS.DATE=="dd/MM/yyyy"?"01/"+(b+1)+"/"+e:b+1+"/01/"+e)}else k=e+"-"+(b+1),g.SetDate(k+"-01");c=g.CreateCalendar();var l=this.classId+"_"+e+"_"+b;c.id=l;c.setAttribute("yearmonth",e+(b<10?"0":"")+b);a.append(c);$(c.rows[3]).remove();$(c.rows[0].cells[1]).remove();k="<a href='javascript:EWA.UI.CalendarYear."+this.classId+'.chooeseMonth("'+l+"\",event)'>"+k+"</a>";$(c.rows[0].cells[0]).html(k);$(c).find("th").attr("onclick","EWA.UI.CalendarYear."+this.classId+
".chooeseWeek('"+l+"',this, event)");b++;b==12&&(b=0,e++);$(c).find("th:eq(0)").addClass("rq-sun");$(c).find("th:eq(6)").addClass("rq-sat")}a.append('<div style="clear:both"></div>');a.find(".ewa-ui-days td").attr("onclick","EWA.UI.CalendarYear."+this.classId+".Click(this,event)");_EWA_CALENDAR_ITEM=g};this.chooeseWeek=function(a,b,c){var d=b.cellIndex;a=$("#"+a).find(".ewa-ui-days")[0];for(var e=$(b).attr("chooese"),g=[],h=1;h<a.rows.length;h++){var k=a.rows[h].cells[d];k.childNodes.length!=0&&(e?
$(k).removeClass("ewa-ui-calendar-year-chooese").attr("chooese",null):$(k).addClass("ewa-ui-calendar-year-chooese").attr("chooese",1),g.push($(k).find("div:eq(0)").attr("title")))}e?$(b).attr("chooese",null):$(b).attr("chooese",1);this.ClickEvent&&this.ClickEvent(g,!e,c)};this.chooeseMonth=function(a,b){var c=$("#"+a),d=c.attr("all1"),e=[];d?(c.attr("all1",null),$("#"+a+" .ewa-ui-days .ewa-ui-calendar-year-chooese").each(function(){$(this).removeClass("ewa-ui-calendar-year-chooese").attr("chooese",
null);e.push($(this).find("div:eq(0)").attr("title"))}),c.find("th").attr("chooese",null)):(c.attr("all1","yes"),$("#"+a+" .ewa-ui-days tr:gt(0) td div[title]").parent().each(function(){$(this).addClass("ewa-ui-calendar-year-chooese").attr("chooese",1);e.push($(this).find("div:eq(0)").attr("title"))}),c.find("th").attr("chooese",1));this.ClickEvent&&this.ClickEvent(e,!d,b)};this.SetChooeses=function(a,b){for(var c in a){var d=a[c][b];d&&(d=d.split(" ")[0],$("#"+this.classId+" .ewa-ui-days td div[title='"+
d+"']").parent().addClass("ewa-ui-calendar-year-chooese").attr("chooese",1))}$("#"+this.classId+" .ewa-ui-date").each(function(){$(this).find(".ewa-ui-calendar-year-chooese").length==$(this).find("td div[title]").length&&($(this).attr("all1","yes"),$(this).find("th").attr("chooese","yes"))})};this.GetChooeses=function(a){var b=[];(a?$(a):$("#"+this.classId+" .ewa-ui-days")).find(".ewa-ui-calendar-year-chooese").each(function(){b.push($(this).find("div:eq(0)").attr("title"))});return b};this.GetUnChooeses=
function(a){var b=[];(a?$(a):$("#"+this.classId+" .ewa-ui-days")).find("td").each(function(){if(!$(this).attr("chooese")){var c=$(this).find("div:eq(0)").attr("title");c&&b.push(c)}});return b};this.Click=function(a,b){if(a.innerHTML.trim()!=""){if($(a).attr("chooese")){$(a).removeClass("ewa-ui-calendar-year-chooese").attr("chooese",null);var c=!1}else $(a).addClass("ewa-ui-calendar-year-chooese").attr("chooese",1),c=!0;this.ClickEvent&&(a=[$(a).find("div:eq(0)").attr("title")],this.ClickEvent(a,
c,b))}};this.ClickEvent=function(a,b,c){console.log("overwrite xxx.ClickEvent(rqs,   isChecked, evt)")}}
function EWA_UI_CalendarYearGroupClass(){this.denysBefore=function(a){a=new EWA_DateClass(a);for(var b=1;b<1500;b++){var c=a.AddDays(-1);c=c.split(" ")[0];if(this.denyDay(c).length==0)break}};this.denysAfter=function(a){a=new EWA_DateClass(a);for(var b=1;b<1500;b++){var c=a.AddDays(1);c=c.split(" ")[0];if(this.denyDay(c).length==0)break}};this.denyDay=function(a){a=$("#"+this.classId).find(".ewa-ui-days td").find("div[title='"+a+"']").parent();a.addClass("ewa-ui-calendar-year-deny").attr("deny",1);
return a};this.unDenyDay=function(a){a=$("#"+this.classId).find(".ewa-ui-days td").find("div[title='"+a+"']").parent();a.removeClass("ewa-ui-calendar-year-deny").attr("deny",null);return a};this.CUR_GROUP_NAME=null;this.setGroupName=function(a){a?(this.CUR_GROUP_NAME="CYG_"+a.replace(/:|\?|\.|=|;|\(|\)|\-/ig,""),this.CUR_GROUP_NAME_O=a):this.CUR_GROUP_NAME_O=this.CUR_GROUP_NAME=null};this.Create=function(a,b,c,d,e,g,h){this.classId=("CY"+Math.random()).replace(".","");EWA.UI.CalendarYear=EWA.UI.CalendarYear||
{};EWA.UI.CalendarYear[this.classId]=this;$($X(a)).append('<div class="ewa-ui-calendar-year" id="'+this.classId+'"></div>');a=$("#"+this.classId);var k=new Date;b&&c&&(k=new Date(b,c-1,1));b=c=k.getMonth();e||(b=Math.round(c/3-.5)*3);e=k.getFullYear();if(!d||d<=0)d=12;k=new EWA_CalendarClass;for(c=1;c<=d;c++){var l=b+1;if(EWA.LANG=="enus"){var m=l+"/"+e;k.SetDate(_EWA_G_SETTINGS.DATE=="dd/MM/yyyy"?"01/"+l+"/"+e:l+"/01/"+e)}else m=e+"-"+(b+1),k.SetDate(m+"-01");var n=k.CreateCalendar(),p=e+(l<10?"0":
"")+l;l=this.classId+"_"+p;n.id=l;n.setAttribute("yearmonth",p);a.append(n);$(n.rows[3]).remove();$(n.rows[0].cells[1]).remove();m="<a href='javascript:EWA.UI.CalendarYear."+this.classId+'.chooeseMonth("'+l+"\",event)'>"+m+"</a>";$(n.rows[0].cells[0]).html(m);$(n).find("th").attr("onclick","EWA.UI.CalendarYear."+this.classId+".chooeseWeek('"+l+"',this, event)");b++;b==12&&(b=0,e++);$(n).find("th:eq(0)").addClass("rq-sun");$(n).find("th:eq(6)").addClass("rq-sat")}a.append('<div style="clear:both"></div>');
a.find(".ewa-ui-days td").attr("onclick","EWA.UI.CalendarYear."+this.classId+".Click(this,event)");_EWA_CALENDAR_ITEM=k;g&&this.denysBefore(g);h&&this.denysAfter(h)};this.getChooeseName=function(){return this.CUR_GROUP_NAME?this.CUR_GROUP_NAME:"chooese"};this.addOrRemoveMark=function(a,b,c){var d=this.getChooeseName(),e=$(a);b?(e.find("."+d).remove(),e.attr(d,null),this.unMarkEvent&&this.unMarkEvent(a,c)):e.find("."+d).length==0&&(e.append("<nobr class='ewa-ui-calendar-year-item "+d+"'></nobr>"),
e.attr(d,1),this.markEvent&&this.markEvent(a,c));e.attr("_last_item_count_")&&e.removeClass(e.attr("_last_item_count_"));a=e.find(".ewa-ui-calendar-year-item").length;a>0?(e.addClass("ewa-ui-calendar-year-chooese"),a=a<100?"N"+a:"NP",e.addClass("N "+a).attr("_last_item_count_",a)):e.removeClass("ewa-ui-calendar-year-chooese").removeClass("N")};this.chooeseWeek=function(a,b,c){for(var d=$("#"+a).find(".ewa-ui-days")[0],e=this.getChooeseName(),g=[],h=b.cellIndex,k=!0,l=!1,m=1;m<d.rows.length;m++){var n=
d.rows[m].cells[h];if(n.childNodes.length!=0&&($(n).attr("deny")||(l=!0),$(n).attr(e)||(k=!1),l&&!k))break}if(!l)$Tip("\u6ca1\u6709\u53ef\u9009\u7684\u65e5\u671f");else if(!this.ClickBeforeEvent||this.ClickBeforeEvent(a,b,c,"WEEK")){for(m=1;m<d.rows.length;m++)n=d.rows[m].cells[h],n.childNodes.length==0||$(n).attr("deny")||(a=$(n).find("div:eq(0)").attr("title"),g.push(a),this.addOrRemoveMark(n,k,a));k?$(b).attr(e,null):$(b).attr(e,1);this.ClickEvent&&this.ClickEvent(g,!k,c)}};this.chooeseMonth=function(a,
b){for(var c=$("#"+a+" .ewa-ui-days")[0],d=this.getChooeseName(),e=!0,g=!1,h=1;h<c.rows.length;h++){for(var k=c.rows[h],l=0;l<k.cells.length;l++){var m=k.cells[l];m.childNodes.length!=0&&(g||$(m).attr("deny")||(g=!0),$(m).attr(d)||(e=!1))}if(!e&&g)break}if(!g)$Tip("\u6ca1\u6709\u53ef\u9009\u7684\u65e5\u671f");else if(!this.ClickBeforeEvent||this.ClickBeforeEvent(a,null,b,"MONTH")){a=[];for(h=1;h<c.rows.length;h++)for(k=c.rows[h],l=0;l<k.cells.length;l++)m=k.cells[l],m.childNodes.length==0||$(m).attr("deny")||
(d=$(m).find("div:eq(0)").attr("title"),a.push(d),this.addOrRemoveMark(m,e,d));this.ClickEvent&&this.ClickEvent(a,!e,b)}};this.SetChooeses=function(a,b,c,d){this._RQ_MAP=null;var e=$("#"+this.classId);e.find(".ewa-ui-days td");for(var g in a){var h=a[g],k=h[b];if(k){c&&this.setGroupName(h[c]);k=k.split(" ")[0];var l=this.findTdByRq(k);l&&l.length>0?(this.addOrRemoveMark(l,!1,k),d&&d(l[0],k,h)):console.log("\u65e0\u6548\u7684\u65e5\u671f"+k)}}this._RQ_MAP=null;e.find(".ewa-ui-date").each(function(){$(this).find(".ewa-ui-calendar-year-chooese").length==
$(this).find("td div[title]").length&&($(this).attr("all1","yes"),$(this).find("th").attr("chooese","yes"))})};this.findTdByRq=function(a){if(!a)return null;if(!this._RQ_MAP)this._RQ_MAP={};else if(this._RQ_MAP[a])return this._RQ_MAP[a];var b=a.replace(/-/ig,""),c=b.substring(0,6);c=$("#"+this.classId+" table[yearmonth='"+c+"']");if(c.length==0)return this._RQ_MAP[a]=null;this._RQ_MAP[a]=c.find("div[date='"+b+"']").parent();return this._RQ_MAP[a]};this.GetChooeses=function(a){var b=[];(a?$(a):$("#"+
this.classId+" .ewa-ui-days")).find(".ewa-ui-calendar-year-chooese").each(function(){b.push($(this).find("div:eq(0)").attr("title"))});return b};this.GetUnChooeses=function(a){var b=[];(a?$(a):$("#"+this.classId+" .ewa-ui-days")).find("td").each(function(){if(!$(this).attr("chooese")){var c=$(this).find("div:eq(0)").attr("title");c&&b.push(c)}});return b};this.Click=function(a,b){if(!$(a).attr("deny")&&a.innerHTML.trim()!=""&&(!this.ClickBeforeEvent||this.ClickBeforeEvent(a.id,a,b,"DAY"))){var c=
$(a).find("div:eq(0)").attr("title"),d=this.getChooeseName();d=$(a).attr(d);this.addOrRemoveMark(a,d,c);this.ClickEvent&&this.ClickEvent([c],!d,b)}};this.ClickBeforeEvent=function(a,b,c,d){console.log("overwrite xxx.ClickBeforeEvent(id, obj, evt, type)");return!0};this.ClickEvent=function(a,b,c){console.log("overwrite xxx.ClickEvent(rqs,   isChecked, evt)")}}
function EWA_CalendarClass(){this._Weeks=_EWA_G_SETTINGS.WEEKS.split(",");this._Days=[31,28,31,30,31,30,31,31,30,31,30,31];this._Months=_EWA_G_SETTINGS.MONTHS.split(",");this._CurDate=new Date;this._SelectMinute=this._SelectHour=this._SelectYear=this._SelectMonth=this._DaysTable=null;this.CreateWindow=window;this.IsShowTime=!1;this.Dialog=this.Object=null;this.ChangeDate=function(){this._SetNewDate(this._SelectYear.value,this._SelectMonth.value,1);this._WriteDays(!1)};this._SetNewDate=function(a,
b,c){if(!a){a=this._SelectYear.value;b=this._SelectMonth.value;c=this._DaysTable.getAttribute("EMP_CURRENT_DAY");var d=((a-2008)%4==0&&a%100!=0||a%400==0)&&b==1?29:this._Days[b];c>d&&(c=d)}this._CurDate=new Date(a,b,c);this.IsShowTime&&(a=this._SelectMinute.value,this._CurDate.setHours(this._SelectHour.value),this._CurDate.setMinutes(a))};this.SetDate=function(a){a=a.split(" ");var b=a[0].split("-");b.length<3&&(b=a[0].split("/"));b.length<3&&(b=a[0].split("."));b.length==3&&(b[0]=parseInt(b[0]),
b[1].substring(0,1)=="0"&&(b[1]=b[1].substring(1)),b[2].substring(0,1)=="0"&&(b[2]=b[2].substring(1)),b[1]=parseInt(b[1]),b[2]=parseInt(b[2]),b[0]+""!="NaN"&&b[1]+""!="NaN"&&b[2]+""!="NaN"&&(EWA.LANG.toUpperCase()=="ENUS"?this._CurDate=_EWA_G_SETTINGS.DATE=="dd/MM/yyyy"?new Date(b[2],b[1]-1,b[0]):new Date(b[2],b[0]-1,b[1]):this._CurDate=new Date(b[0],b[1]-1,b[2]),a.length>1&&(b=a[1].split(":"),this._CurDate.setHours(b[0]),b.length>1&&this._CurDate.setMinutes(b[1]),b.length>2&&this._CurDate.setSeconds(b[2].split(".")[0]))),
a=this._CurDate.getDate(),this._DaysTable&&this._DaysTable.setAttribute("EMP_CURRENT_DAY",a))};this._CreateTime=function(){var a=this._CurDate,b=this.CreateWindow.document.createElement("div"),c=this.CreateWindow.document.createElement("select"),d=this.CreateWindow.document.createElement("select"),e=this.CreateWindow.document.createElement("span");EWA.LANG.toLowerCase()=="enus"?e.innerHTML="Time ":e.innerHTML="\u65f6\u95f4 ";var g=this.CreateWindow.document.createElement("span");g.innerHTML=":";for(var h=
0;h<24;h++){var k=h<10?"0"+h:h+"";c.options[c.options.length]=new Option(k,k)}c.value=(100+a.getHours()+"").substring(1);b.appendChild(e);b.appendChild(c);b.appendChild(g);b.appendChild(d);c=this.CreateWindow.document.createElement("span");c.innerHTML="&nbsp;";e=this.CreateWindow.document.createElement("span");e.style.cursor="pointer";e.style.color="blue";e.setAttribute("IS_ALL",0);e.onclick=function(){d.options.length=0;if(this.getAttribute("IS_ALL")==1){for(var l=0;l<12;l++){var m=(100+l*5+"").substring(1);
d.options[d.options.length]=new Option(m,m)}l=a.getMinutes();l=l%5==0?l:parseInt(l/5)*5;d.value=(100+l+"").substring(1);this.setAttribute("IS_ALL",0);this.innerHTML="\u5168\u90e8"}else{for(l=0;l<60;l++)m=(100+l+"").substring(1),d.options[d.options.length]=new Option(m,m);l=a.getMinutes();d.value=(100+l+"").substring(1);this.setAttribute("IS_ALL",1);this.innerHTML="\u6bcf5\u5206\u949f"}};b.appendChild(c);b.appendChild(e);return b};this.CreateTime=function(){var a=[];a.push("<table border=0 class='ewa-ui-date-picker' style='border:1px solid #aaa' bgcolor='#E1E1E1' onselectstart='return false'>");
a.push("<tr><td><nobr></nobr></td></tr>");a.push("</table>");var b=this.CreateWindow.document.createElement("DIV");b.innerHTML=a.join("");a=b.childNodes[0].rows[0].cells[0].childNodes[0];for(var c=this._CreateTime();c.childNodes.length>0;)a.appendChild(c.childNodes[0]);c=a.getElementsByTagName("span")[3];c.setAttribute("IS_ALL",1);c.click();c.style.display="none";c=this.CreateWindow.document.createElement("input");c.type="button";if(EWA.LANG.toLowerCase()=="enus"){c.value="OK";var d="Clear"}else c.value=
"\u786e\u5b9a",d="\u6e05\u9664";c.onclick=function(){var e=EWA.B.IE?this.ownerDocument.parentWindow:this.ownerDocument.defaultView,g=this.parentNode.getElementsByTagName("select"),h=e._EWA_CALENDAR_TIME_ITEM.Object.value;g=g[0].value+":"+g[1].value;e._EWA_CALENDAR_TIME_ITEM.Object.value=g;e._EWA_CALENDAR_TIME_ITEM.Dialog.Show(!1);h!=g&&($(e._EWA_CALENDAR_TIME_ITEM.Object).trigger("keyup"),$(e._EWA_CALENDAR_TIME_ITEM.Object).trigger("blur"))};a.appendChild(c);c="<a href='javascript:void(0)' style='margin:0 5px;color:#08c;font-size:12px;'>"+
d+"</a>";$(a).append(c);$(a).find("a").click(function(){var e=EWA.B.IE?this.ownerDocument.parentWindow:this.ownerDocument.defaultView,g=e._EWA_CALENDAR_TIME_ITEM.Object.value;e._EWA_CALENDAR_TIME_ITEM.Object.value="";e._EWA_CALENDAR_TIME_ITEM.Dialog.Show(!1);g!=""&&($(e._EWA_CALENDAR_TIME_ITEM.Object).trigger("keyup"),$(e._EWA_CALENDAR_TIME_ITEM.Object).trigger("blur"))});$(a).append("<b class='fa fa-close' style='color:#666;font-size:12px;'></b>");$(a).find("b").click(function(){(EWA.B.IE?this.ownerDocument.parentWindow:
this.ownerDocument.defaultView)._EWA_CALENDAR_TIME_ITEM.Dialog.Show(!1)});return b.childNodes[0]};this.CreateCalendar=function(a){this.IsShowTime=a;var b=[];b.push("<table border=0 class='ewa-ui-date' onselectstart='return false'>");b.push("<tr>");b.push("<td height=28>"+this._CreateMonth()+"</td>");b.push("<td align=right>"+this._CreateYear()+"</td>");b.push("</tr>");b.push("<tr><td colspan=2>"+this._CreateDaysTable()+"</td></tr>");b.push("<tr style='display:none'><td colspan=2></td></tr>");b.push("<tr><td colspan=2>"+
this._CreateToDay()+"</td></tr>");b.push("</table>");var c=this.CreateWindow.document.createElement("DIV");c.innerHTML=b.join("");this._DaysTable=c.childNodes[0].rows[1].cells[0].childNodes[0];b=c.getElementsByTagName("select");this._SelectMonth=b[0];this._SelectYear=b[1];this._WriteDays();if(a){a=c.childNodes[0].rows[2];a.style.display="";a=a.cells[0];for(b=this._CreateTime();b.childNodes.length>0;)a.appendChild(b.childNodes[0]);a.getElementsByTagName("span")[3].click();this._SelectHour=a.getElementsByTagName("select")[0];
this._SelectMinute=a.getElementsByTagName("select")[1]}return c.childNodes[0]};this._CreateToDay=function(){var a={};EWA.LANG.toLowerCase()=="enus"?(a.today="Today",a.empty_title="Empty",a.empty="Empty",a.close="Close"):(a.today="\u8bbe\u7f6e\u4e3a\u4eca\u5929",a.empty_title="\u6e05\u7a7a\u65e5\u671f",a.empty="\u7a7a",a.close="\u5173\u95ed");var b="<div class='ewa-ui-date-today-day' title='"+a.today+"' onclick='_EWA_CALENDAR_ITEM.Object.value=this.innerHTML;if(_EWA_CALENDAR_ITEM.Object.onkeyup!=null)_EWA_CALENDAR_ITEM.Object.onkeyup();if(_EWA_CALENDAR_ITEM.Object.onblur!=null)_EWA_CALENDAR_ITEM.Object.onblur();_EWA_CALENDAR_ITEM.Dialog.Show(false);'>"+
this.GetDate(new Date)+"</div>";var c="<table border=0 class='ewa-ui-date-today' width=100%><tr><td class='ewa-ui-date-today-day' onclick='_EWA_CALENDAR_ITEM.Object.value=$(this).next().text();if(_EWA_CALENDAR_ITEM.Object.onkeyup!=null)_EWA_CALENDAR_ITEM.Object.onkeyup();if(_EWA_CALENDAR_ITEM.Object.onblur!=null)_EWA_CALENDAR_ITEM.Object.onblur();_EWA_CALENDAR_ITEM.Dialog.Show(false);'>"+(_EWA_G_SETTINGS.Today+"</td>");c=c+("<td>"+b+"</td><td><div class='ewa-ui-date-today-clear' title='")+(a.empty_title+
"' onclick='_EWA_CALENDAR_ITEM.Object.value=\"\";if(_EWA_CALENDAR_ITEM.Object.onkeyup!=null)_EWA_CALENDAR_ITEM.Object.onkeyup();if(_EWA_CALENDAR_ITEM.Object.onblur!=null)_EWA_CALENDAR_ITEM.Object.onblur();_EWA_CALENDAR_ITEM.Dialog.Show(false);'>"+a.empty+"</div></td>");c+="<td align=right><div class='ewa-ui-date-close' title='"+a.close+"' onclick='_EWA_CALENDAR_ITEM.Hidden()'><b>X</b></div></td>";return c+"</tr></table>"};this.MarkDay=function(){for(var a=this._DaysTable.getAttribute("EMP_CURRENT_DAY")*
1,b=1;b<this._DaysTable.rows.length;b+=1)for(var c=this._DaysTable.rows[b],d=0;d<c.cells.length;d+=1){var e=c.cells[d];e.childNodes.length>0&&GetInnerText(e.childNodes[0])*1==a?this.MarkSelected(e):this.MarkUnSelected(e)}};this.MarkSelected=function(a){$(a).addClass("ewa-ui-date-selected")};this.MarkUnSelected=function(a){$(a).removeClass("ewa-ui-date-selected")};this.MarkBlur=function(a){$(a).addClass("ewa-ui-date-blur")};this.MarkUnBlur=function(a){$(a).removeClass("ewa-ui-date-blur")};this._CreateMonth=
function(){for(var a=this._CreatePervNext(),b="<select onchange='_EWA_CALENDAR_ITEM.ChangeDate();'>",c=this._CurDate.getMonth(),d=0;d<this._Months.length;d+=1)b=d==c?b+("<option value='"+d+"' selected>"+this._Months[d]+"</option>"):b+("<option value='"+d+"'>"+this._Months[d]+"</option>");return a=a.replace("[$]",b+"</select>")};this._CreateYear=function(){for(var a=this._CurDate.getFullYear(),b=this._CreatePervNext(),c=["<select onchange='_EWA_CALENDAR_ITEM.ChangeDate();'>"],d=1900;d<=2050;d+=1)d==
a?c.push("<option value='"+d+"' selected>"+d+"</option>"):c.push("<option value='"+d+"'>"+d+"</option>");c.push("</select>");return b=b.replace("[$]",c.join(""))};this._CreatePervNext=function(){return"<table cellpadding=0 cellspacing=0 border=0><tr><td><div class='ewa-ui-date-prev'  onclick='var o=this.parentNode;var o1=o.nextSibling.childNodes[0];if(o1.selectedIndex>0){o1.value=o1.value*1-1;o1.onchange();}o=o1=null'><b class='fa fa-caret-left'></b></div></td><td>[$]</td><td><div class='ewa-ui-date-next' onclick='var o=this.parentNode;var o1=o.previousSibling.childNodes[0];if(o1.options.length-1>o1.selectedIndex){o1.value=o1.value*1+1;o1.onchange();}o=o1=null'><b class='fa fa-caret-right'></div></td></tr></table>"};
this._WriteDays=function(a){if(this.__LAST__WriteDaysDate!=this._CurDate){this.__LAST__WriteDaysDate=this._CurDate;var b=this._CreateDays();this._CurDate.getDate();var c=this._CurDate.getMonth(),d=this._CurDate.getFullYear();this._SelectMonth.value=c;this._SelectYear.value=d;var e=c+1;e<10&&(e="0"+e);c=d+"-"+e+"-DD";var g=this._CurDate.getFullYear()+""+e;EWA.LANG!=null&&EWA.LANG.toUpperCase()=="ENUS"&&(c=_EWA_G_SETTINGS.DATE=="dd/MM/yyyy"?"DD/"+e+"/"+d:e+"/DD/"+d);for(e=1;e<this._DaysTable.rows.length;e+=
1){for(var h=this._DaysTable.rows[e],k=0;k<h.cells.length;k+=1)d=h.cells[k],d.innerHTML=b[e]==null||b[e][k]==null?"":"<div date='"+(g+b[e][k])+"' title='"+c.replace("DD",b[e][k])+"'>"+b[e][k]+"</div>",this.MarkUnSelected(d);$(h).text()==""?$(h).hide():$(h).show()}}a&&this.MarkDay()};this._CreateDaysTable=function(){var a=[];a[0]="<table class='ewa-ui-days' align ='center' border=0 cellpadding=1 cellspacing=1 EMP_CURRENT_DAY='"+this._CurDate.getDate()+"'>";for(var b=0;b<7;b+=1){a.push("<tr>");for(var c=
0;c<7;c+=1)b==0?a.push("<th>"+this._Weeks[c]+"</th>"):(a.push("<td onmouseover='if(this.innerHTML.length>0)_EWA_CALENDAR_ITEM.MarkBlur(this);'"),a.push(" onmouseout='if(this.innerHTML.length>0)_EWA_CALENDAR_ITEM.MarkUnBlur(this);'"),a.push(" onclick='_EWA_CALENDAR_ITEM.Clicked(this);'></td>"));a.push("</tr>")}a.push("</table>");return a.join("")};this.Clear=function(){this.Object.value="";this.Hidden()};this.Hidden=function(a){if(this.Object.onblur!=null&&!a)this.Object.onblur();this.Object=null;
this.Dialog.Show(!1)};this.Clicked=function(a){if(a.innerHTML.length>0){this._DaysTable.setAttribute("EMP_CURRENT_DAY",a.childNodes[0].innerHTML);this._SetNewDate();this.MarkDay();this.Object.value=this.GetDate();if(this.Object.onkeyup!=null)this.Object.onkeyup();if(this.Object.onblur!=null)this.Object.onblur();if(this.Object.onchange!=null)this.Object.onchange();else $(this.Object).trigger("change");this.Hidden(!0)}};this.GetDate=function(a){var b=_EWA_G_SETTINGS.DATE;a==null&&(a=this._CurDate);
var c=a.getFullYear(),d=a.getMonth()+1,e=a.getDate();d<10&&(d="0"+d);e<10&&(e="0"+e);b=b.replace("yyyy",c);b=b.replace("MM",d);b=b.replace("dd",e);this.IsShowTime&&(d=a.getHours(),a=a.getMinutes(),b+=" "+(d<10?"0"+d:d)+":"+(a<10?"0"+a:a));return b};this._CreateDays=function(){var a=(new Date(this._CurDate.getFullYear(),this._CurDate.getMonth(),1)).getDay(),b=1,c=[];c[0]=this._Weeks;for(var d=1,e=this._getCurMonthDays(),g=0;g<49;g+=1){if(g==0||a==7)c[d]=[],d+=1;a==7&&(a=0);if(b<=e)c[d-1][a]=b<10?"0"+
b:b+"";else break;b+=1;a+=1}return c};this._getCurMonthDays=function(){return((this._CurDate.getFullYear()-2008)%4==0&&(this._CurDate.getFullYear()-400)%100!=0||(this._CurDate.getFullYear()-400)%400==0)&&this._CurDate.getMonth()==1?29:this._Days[this._CurDate.getMonth()]}}
var __Cal={C:EWA_CalendarClass,WND:null,WND_PARENT:null,WND_DIA:null,Pop:function(a,b){var c="WND_PARENT/Pop/"+b;__Cal[c]||(__Cal[c]={});c=__Cal[c];c.OBJ=a;if(c.WND==null){var d=c.WND_DIA=new EWA_UI_DialogClass;d.Width=172;d.Height=200;d.ShadowColor="";c.WND=new EWA_CalendarClass;typeof _EWA_DialogWnd=="undefined"?d.CreateWindow=window:(d.CreateWindow=_EWA_DialogWnd._ParentWindow,_EWA_DialogWnd.OpendDialogs[_EWA_DialogWnd.OpendDialogs.length]=d);d.CreateWindow._EWA_CALENDAR_ITEM=c.WND;d.Create();
c.WND.CreateWindow=d.CreateWindow;c.WND.SetDate(a.value);b=c.WND.CreateCalendar(b);d.SetObject(b);c.WND.Dialog=d;$(d.GetFrameContent()).css("width","").css("height","")}c.WND.SetDate(a.value);c.WND._WriteDays(!0);c.WND.Dialog.SetZIndex(10);c.WND.Object=a;c.WND_DIA.MoveBottom(a);c.WND_DIA.Show(!0)},PopTime:function(a){__Cal["WND_PARENT/PopTime/"]||(__Cal["WND_PARENT/PopTime/"]={});var b=__Cal["WND_PARENT/PopTime/"];b.OBJ=a;if(b.WND==null){var c=b.WND_DIA=new EWA_UI_DialogClass;c.Width=180;c.Height=
20;c.ShadowColor="";b.WND=new EWA_CalendarClass;typeof _EWA_DialogWnd=="undefined"?c.CreateWindow=window:(c.CreateWindow=_EWA_DialogWnd._ParentWindow,_EWA_DialogWnd.OpendDialogs[_EWA_DialogWnd.OpendDialogs.length]=c);c.CreateWindow._EWA_CALENDAR_TIME_ITEM=b.WND;c.Create();b.WND.CreateWindow=c.CreateWindow;b.WND.SetDate(a.value);var d=b.WND.CreateTime();c.SetObject(d);b.WND.Dialog=c;$(c.GetFrameContent()).css("width","").css("height","")}b.WND.CreateWindow._EWA_CALENDAR_TIME_ITEM.Object=a;b.WND.CreateWindow._EWA_CALENDAR_TIME_ITEM.Dialog=
b.WND_DIA;b.WND.SetDate(a.value);b.WND.Dialog.SetZIndex(10);b.WND.Object=a;b.WND_DIA.MoveBottom(a);b.WND_DIA.Show(!0)}};EWA.UI.Calendar=__Cal;
function EWA_UI_MsgClass(a,b){this._IsSelfWindow=b;this._Dialog=null;this._Msg=a;this._Buttons=[];this._Caption=null;this._Icon="MSG_ICON";this.SetIcon=function(c){this._Icon=c};this.SetCaption=function(c){this._Caption=c};this.AddButton=function(c,d){this._Buttons.push({Text:c,Event:d})};this.AddButtons=function(c){if(c!=null)for(var d=0;d<c.length;d++)this._Buttons.push(c[d])};this.addClass=function(c){$(this._Dialog.getMain()).addClass(c)};this._Init=function(){var c=document.documentElement.clientWidth;
c=c>410?400:c>300?c-10:300;let d=this._CreateHtml(c);this._Dialog=$DialogHtml(d,this._Caption,c);this._Dialog._ParentWindow=window;let e=this;$(this._Dialog.getContent()).find("button[_ewa_dialog_]").on("click",function(){$(this).attr("_ewa_dialog_",e._Dialog.Id);$(this).attr("evt")?e.fire($(this).attr("evt")):e.Hidden()});this._Dialog.AutoSize()};this._CreateHtml=function(c){var d=[];d.push("<table border=0 class='MSG_INFO' style='width: "+c+"px'>");d.push("<tr><td rowspan=2 style='width:130px;' align='center'>");
d.push("<div class='"+this._Icon+"'>&nbsp;</div></td>");d.push("<td class='MSG_TEXT'>");d.push(this._Msg);d.push("</td></tr>");d.push("<tr><td class='MSG_BUTS'>");if(this._Buttons.length>0){d.push("<hr><table><tr>");for(c=0;c<this._Buttons.length;c++){var e=this._Buttons[c];d.push("<td>");var g="<button _ewa_msg_default='"+(e.Default?1:0)+"'  type='button' _ewa_dialog_='[~ID~]' ";g=e.Event&&typeof e.Event=="function"?g+(" evt='"+c+"'>"+e.Text+"</button>"):g+(">"+e.Text+"</button>");d.push(g);d.push("</td>")}d.push("</tr></table>")}d.push("</td></tr></table>");
return d.join("")};this.fire=function(c){if((c=this._Buttons[c])&&c.Event)try{c.Event(this)}catch(d){console.log(d)}this.Hidden()};this.Show=function(c,d){this._Dialog==null&&this._Init();if(c)if(c=this._Dialog._ParentWindow.document.getElementsByTagName("button"),d){var e=[];for(d=0;d<c.length;d++){var g=$(c[d]);g.attr("_ewa_dialog_")==this._Dialog.Id&&(g.prop("disabled",!0),e.push(g))}setTimeout(function(){for(var h in e)e[h].prop("disabled",!1)},435)}else for(this._Dialog.AutoSize(),d=0;d<c.length;d++)if(c[d].getAttribute("_ewa_msg_default")==
1&&c[d].getAttribute("_ewa_dialog_")==this._Dialog.Id){c[d].focus();break}};this.Hidden=function(){this._Dialog.Close()}}
EWA.UI.Msg={IS_IN_APP:!1,C:EWA_UI_MsgClass,Show:function(a,b,c,d){if(a.indexOf("(")>0&&a.trim().endsWith(")"))try{a=eval(a)}catch(e){console.log(a)}a=new EWA_UI_MsgClass(a);a.SetCaption(c);a.AddButtons(b);a.SetIcon(d);a.Show(!0,EWA.UI.Msg.IS_IN_APP);return a},ShowInfo:function(a,b,c){__EWA_MSG__=EWA.UI.Msg.Show(a,b,c,"MSG_ICON");__EWA_MSG__.addClass("ewa-msg-info");return __EWA_MSG__},ShowError:function(a,b){var c=[];c[0]={Text:_EWA_INFO_MSG["BUT.OK"],Event:null,Default:!0};__EWA_MSG__=EWA.UI.Msg.Show(a,
c,b,"ERR_ICON");__EWA_MSG__.addClass("ewa-msg-err");return __EWA_MSG__},Alter:function(a,b){console.log("\u62fc\u5199\u9519\u8bef\uff0c\u5e94\u8be5\u662fAlert");return EWA.UI.Msg.Alert(a,b)},Alert:function(a,b){var c=[];c[0]={Text:_EWA_INFO_MSG["BUT.OK"],Event:null,Default:!0};__EWA_MSG__=EWA.UI.Msg.Show(a,c,b,"MSG_ICON");__EWA_MSG__.addClass("ewa-msg-alert");return __EWA_MSG__},Confirm:function(a,b,c,d){var e=[];e[0]={Text:_EWA_INFO_MSG["BUT.YES"],Event:c};e[1]={Text:_EWA_INFO_MSG["BUT.NO"],Event:d,
Default:!0};__EWA_MSG__=EWA.UI.Msg.Show(a,e,b,"QUS_ICON");__EWA_MSG__.addClass("ewa-msg-confirm");return __EWA_MSG__},_Tip:function(a,b,c,d){var e=document.createElement("table");document.body.appendChild(e);$(e).css(b);b=e.insertRow(-1).insertCell(-1);$(b).css(c);if(d&&d instanceof Function){b.innerHTML='<i class="fa fa-refresh fa-spin"></i> '+a;var g=setInterval(function(){d()&&(window.clearInterval(g),$(e).animate({opacity:0},200,function(){$(e).remove()}))},300)}else{b.innerHTML=a;if(!d||isNaN(d))d=
1500;setTimeout(function(){$(e).animate({opacity:0},200,function(){$(e).remove()})},d)}},Tip:function(a,b){var c={width:300,height:80,padding:10,"background-color":"rgba(10,20,30,0.7)",position:"fixed",top:"50%",left:"50%","margin-left":-150,"margin-top":-60,"border-radius":10,"z-index":window._EWA_UI_DIALOG_COVERINDEX?window._EWA_UI_DIALOG_COVERINDEX+10:1E6,color:"#fff"};EWA.B.IE&&EWA.B.VERSION*1<9&&(c.filter="progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr='#77000000',EndColorStr='#77000000')");
EWA.UI.Msg._Tip(a,c,{"text-align":"center","font-size":16,"line-height":1.5},b)},TipBR:function(a,b){var c={height:20,padding:2,"background-color":"rgba(222,222,0,0.7)",position:"fixed",bottom:5,right:5,"border-radius":1,"z-index":window._EWA_UI_DIALOG_COVERINDEX?window._EWA_UI_DIALOG_COVERINDEX+10:1E6,color:"#111"};EWA.B.IE&&EWA.B.VERSION*1<9&&(c.filter="progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr='#66000000',EndColorStr='#66000000')");EWA.UI.Msg._Tip(a,c,{"text-align":"center",
"font-size":12,"line-height":1.5},b)},TipBL:function(a,b){var c={height:20,padding:2,"background-color":"rgba(222,222,0,0.7)",position:"fixed",bottom:5,left:5,"border-radius":1,"z-index":window._EWA_UI_DIALOG_COVERINDEX?window._EWA_UI_DIALOG_COVERINDEX+10:1E6,color:"#111"};EWA.B.IE&&EWA.B.VERSION*1<9&&(c.filter="progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr='#66000000',EndColorStr='#66000000')");EWA.UI.Msg._Tip(a,c,{"text-align":"center","font-size":12,"line-height":1.5},
b)},TipTL:function(a,b){var c={height:20,padding:2,"background-color":"rgba(222,222,0,0.7)",position:"fixed",top:5,left:5,"border-radius":1,"z-index":window._EWA_UI_DIALOG_COVERINDEX?window._EWA_UI_DIALOG_COVERINDEX+10:1E6,color:"#111"};EWA.B.IE&&EWA.B.VERSION*1<9&&(c["background-color"]="filter:progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr='#00000000',EndColorStr='#66000000')");EWA.UI.Msg._Tip(a,c,{"text-align":"center","font-size":12,"line-height":1.5},b)},TipTR:function(a,
b){var c={height:20,padding:2,"background-color":"rgba(222,222,0,0.7)",position:"fixed",top:5,right:5,"border-radius":1,"z-index":window._EWA_UI_DIALOG_COVERINDEX?window._EWA_UI_DIALOG_COVERINDEX+10:1E6,color:"#111"};EWA.B.IE&&EWA.B.VERSION*1<9&&(c["background-color"]="filter:progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr='#00000000',EndColorStr='#66000000')");EWA.UI.Msg._Tip(a,c,{"text-align":"center","font-size":12,"line-height":1.5},b)}};
$Mark=function(a,b){var c=b*1E3||3E3,d="<div class='ewa-mark' style='transition-duration:"+(b||3)+"s;'></div>";$(a).each(function(){var e=$(d),g=$(this).offset();g={left:g.left+2,top:g.top-2,width:$(this).outerWidth(),height:$(this).outerHeight()};e.css(g);$("body").append(e);setTimeout(function(){e.css("opacity",0)},10);setTimeout(function(){e.remove()},c+10)})};$Confirm=EWA.UI.Msg.Confirm;$Tip=EWA.UI.Msg.Tip;$TipBR=EWA.UI.Msg.TipBR;$TipBL=EWA.UI.Msg.TipBL;$TipTR=EWA.UI.Msg.TipTR;$TipTL=EWA.UI.Msg.TipTL;
function EWA_UI_FlowChartClass(){this.DEF_CHART_WIDTH=200;this.DEF_CHART_HEIGHT=50;this.DEF_BG_COLOR="#08c";this.DEF_COLOR="#fff";this.Create=function(a,b,c,d,e,g,h,k){this.PID=a;this.FIELD_ID=c;this.FIELD_TEXT=d;this.CHART_WIDTH=e||this.DEF_CHART_WIDTH;this.CHART_HEIGHT=g||this.DEF_CHART_HEIGHT;this.BG_COLOR=h||this.DEF_BG_COLOR;this.COLOR=k||this.DEF_COLOR;this.OFF=Math.round(this.CHART_HEIGHT*Math.sqrt(2)/2);this._CreateCss();c=["<div style='z-index:1;padding-left:"+this.OFF+"px;height:"+this.CHART_HEIGHT+
"px;position:relative;margin:auto;width:"+(this.CHART_WIDTH*b.length-(this.OFF-4)*(b.length-1)+4)+"px'>"];for(d=0;d<b.length;d++)e=this._CreateChart(b[d],d,d==b.length-1),c.push(e);c.push("</div>");$X(a)?$($X(a)).append(c.join("")):$("body").append(c.join(""))};this._CreateCss=function(){var a=this.CHART_HEIGHT,b=this.OFF,c=Math.round(b);this.CSS={main:"position:relative;margin-left:-"+(b-4)+"px;float:left;z-index:[ZINDEX];height:"+a+"px;width:[WIDTH]px;overflow:hidden;",leftbox:"background-color:[BGCOLOR];float:left;width:"+
c+"px;height:"+a+"px;overflow:hidden",leftarrow:"background: #fff;margin-left: -"+b+"px;width:"+a+"px;height:"+a+"px;-webkit-transform: rotate(45deg);transform: rotate(45deg);",center:"height:"+a+"px;float:left;text-overflow: ellipsis;overflow: hidden;line-height:"+a+"px;background-color:[BGCOLOR];width:"+(this.CHART_WIDTH-c*2)+"px;text-align:center;font-size:16px",centertd:"color:[COLOR];text-overflow: ellipsis;overflow: hidden;width:100%;text-align:center;font-size:16px",rightbox:"float:right;width:"+
c+"px;height:"+a+"px;overflow:hidden",rightarrow:"background:[BGCOLOR];margin-left: -"+c+"px;width:"+a+"px;height:"+a+"px;-webkit-transform: rotate(45deg);transform: rotate(45deg);"}};this._CreateChart=function(a,b,c){console.log(a);var d=[],e=this.CSS.main.replace("[ZINDEX]",1E3-b).replace("[LEFT]",(this.CHART_WIDTH-20)*b);e=e.replace("[WIDTH]",this.CHART_WIDTH);d.push("<div id='"+a[this.FIELD_ID]+"' style='"+e+"'>");var g=a.bgColor||this.BG_COLOR;e=this.CSS.leftbox.replace("[BGCOLOR]",g);var h=
this.CSS.center.replace("[BGCOLOR]",g);g=this.CSS.rightarrow.replace("[BGCOLOR]",g);var k=this.CSS.centertd.replace("[COLOR]",a.color||this.COLOR);d.push("<div style='"+e+"'>");d.push("<div style='"+this.CSS.leftarrow+"'></div>");d.push("</div>");d.push("<table border=0 cellpadding=0 cellspacing=0  style='"+h+"'><tr><td style='"+k+"'>");typeof this.FIELD_TEXT=="function"?(a=this.FIELD_TEXT(a,b,c),d.push(a)):d.push(a[this.FIELD_TEXT]);d.push("</td></tr></table>");d.push("<div style='"+this.CSS.rightbox+
"'>");d.push("<div style='"+g+"'></div>");d.push("</div>");d.push("</div>");return d.join("")}}
var EWA_UI_HtmlEditorConfig={OPT_PopImgProperties:!0,OPT_ImageResizes:null,fonts:[{name:"\u5fae\u8f6f\u96c5\u9ed1",font:"Microsoft YaHei"},{name:"\u5b8b\u4f53",font:"\u5b8b\u4f53"},{name:"Arial",font:"Arial"},{name:"STHeiti",font:"STHeiti"}],formats:[{name:"H1",format:"h1"},{name:"H2",format:"h2"},{name:"H3",format:"h3"},{name:"H4",format:"h4"},{name:"H5",format:"h5"},{name:"\u666e\u901a",format:"p"}],sizes:[{name:"\u8d85\u5927",size:"7"},{name:"\u7279\u5927",size:"6"},{name:"\u5927",size:"5"},{name:"\u6807\u51c6",
size:"4"},{name:"\u5c0f",size:"3"},{name:"\u7279\u5c0f",size:"2"},{name:"\u7279\u5c0f",size:"1"}],css:"img{max-width:100%}html{background:#2f2f2f}body{width: 800px; padding:10px 20px; margin: auto; box-shadow: rgb(241, 241, 241) 1px 1px 13px; font-size:14px; box-sizing: border-box;overflow-y: scroll;   font-family: 'Microsoft YaHei', STHeiti, \u5fae\u8f6f\u96c5\u9ed1, tahoma, Verdana, Arial, sans-serif, \u5b8b\u4f53; background: rgb(255, 255, 255);}",colors:"#ffffff #000000 #eeece1 #1f497d #4f81bd #c0504d #9bbb59 #8064a2 #4bacc6 #f79646 #f2f2f2 #7f7f7f #ddd9c3 #c6d9f0 #dbe5f1 #f2dcdb #ebf1dd #e5e0ec #dbeef3 #fdeada #d8d8d8 #595959 #c4bd97 #8db3e2 #b8cce4 #e5b9b7 #d7e3bc #ccc1d9 #b7dde8 #fbd5b5 #bfbfbf #3f3f3f #938953 #548dd4 #95b3d7 #d99694 #c3d69b #b2a2c7 #92cddc #fac08f #a5a5a5 #262626 #494429 #17365d #366092 #953734 #76923c #5f497a #31859b #e36c09 #7f7f7f #0c0c0c #1d1b10 #0f243e #244061 #632423 #4f6128 #3f3151 #205867 #974806 #c00000 #ff0000 #ffc000 #ffff00 #92d050 #00b050 #00b0f0 #0070c0 #002060 #7030a0".split(" "),
buts:{FormatBlock:{id:"fn_FormatBlock",cmd:"PopFormatBlock",title:"\u683c\u5f0f","class":"fa fa-header"},FontSize:{id:"fn_FontSize",cmd:"PopFontSize",title:"\u5b57\u9ad4\u5927\u5c0f","class":"fa fa-text-height"},FontName:{id:"fn_FontName",cmd:"PopFont",title:"\u5b57\u4f53","class":"fa fa-font"},BOLD:{id:"st_bold",cmd:"BOLD",title:"BOLD","class":"fa fa-bold"},ITALIC:{id:"st_italic",cmd:"ITALIC",title:"ITALIC","class":"fa fa-italic"},UNDERLINE:{id:"st_underline",cmd:"UNDERLINE",title:"UNDERLINE","class":"fa fa-underline"},
InsertOrderedList:{id:"st_insertorderedlist",cmd:"InsertOrderedList",title:"InsertOrderedList","class":"fa fa-list-ol"},InsertunOrderedList:{id:"st_insertunorderedlist",cmd:"InsertunOrderedList",title:"InsertunOrderedList","class":"fa fa-list-ul"},INDENT:{id:"st_indent",cmd:"INDENT",title:"INDENT","class":"fa fa-indent"},Outdent:{id:"st_outdent",cmd:"Outdent",title:"Outdent","class":"fa fa-outdent"},JustifyLEFT:{id:"st_justifyleft",cmd:"JustifyLEFT",title:"\u5de6\u5bf9\u9f50","class":"fa fa-align-left"},
JustifyCENTER:{id:"st_justifycenter",cmd:"JustifyCENTER",title:"\u5c45\u4e2d","class":"fa fa-align-center"},JustifyRIGHT:{id:"st_justifyright",cmd:"JustifyRIGHT",title:"\u53f3\u5bf9\u9f50","class":"fa fa-align-right"},CreateLink:{id:"st_createlink",cmd:"CreateLink",title:"\u521b\u5efa\u94fe\u63a5","class":"fa fa-chain"},CODE_TXT:{id:"code_txt",cmd:"CODE_TXT",title:"\u6e90\u4ee3\u7801","class":"fa fa-html5"},eraser:{id:"eraser",cmd:"eraser",title:"\u6e05\u9664\u683c\u5f0f","class":"fa fa-eraser"},
ForColor:{id:"fn_ForColor",cmd:"PopForColor",title:"\u5b57\u9ad4\u984f\u8272","class":"fa fa-font ewa-editor-for"},BackColor:{id:"fn_BackColor",cmd:"PopBackColor",title:"\u80cc\u666f\u984f\u8272","class":"fa fa-font ewa-editor-bg"},Img:{id:"fn_Img",cmd:"PopImg",title:"\u5716\u7247","class":"fa fa-camera"},FullScreen:{id:"fn_FullScreen",cmd:"FullScreen",title:"\u5168\u5c4f","class":"fa fa-square-o"},Word2Html:{id:"fn_Word2Html",cmd:"Word2Html",title:"\u8f6c\u6362Word","class":"fa fa-file-word-o"}},
defaultConf:[["FontName","FormatBlock","FontSize"],["BOLD","ITALIC","UNDERLINE"],["InsertOrderedList","InsertunOrderedList"],["JustifyLEFT","JustifyCENTER","JustifyRIGHT"],["INDENT","Outdent"],["CreateLink","eraser"],["ForColor","BackColor"],["Word2Html","Img","FullScreen"],["CODE_TXT"]],pop:function(a,b){for(var c in __Cal)c.indexOf("EDITOR_Pop_")==0&&__Cal[c].WND.Show(!1);c="EDITOR_Pop_"+(a?a.id:"");__Cal[c]||(__Cal[c]={});var d=__Cal[c];d.OBJ=a;if(d.WND==null){var e=d.WND=new EWA_UI_DialogClass;
e.Width=172;e.Height=50;e.ShadowColor="";e.CreateWindow=window;e.CreateWindow._EWA_CALENDAR_ITEM=d.WND;e.Create();e.SetHtml(b);$(e.GetFrameContent()).find("a").attr("onclick",'__Cal["'+c+'"].WND.Show(false);');$('div[ewa_name="DIV_BACK1"]').hide()}d.WND.SetZIndex(10);a?(d.WND.Object=a,d.WND.MoveBottom(a)):d.WND.MoveCenter();d.WND.Show(!0);return d},pop1:function(a,b,c,d){a="EDITOR_Pop_"+a;__Cal[a]||(__Cal[a]={});var e=__Cal[a];if(e.WND==null){var g=e.WND=new EWA_UI_DialogClass;g.Width=c;g.Height=
d;g.ShadowColor="";typeof _EWA_DialogWnd=="undefined"?g.CreateWindow=window:(g.CreateWindow=_EWA_DialogWnd._ParentWindow,_EWA_DialogWnd.OpendDialogs[_EWA_DialogWnd.OpendDialogs.length]=g);g.CreateWindow._EWA_CALENDAR_ITEM=e.WND;g.Create()}e.WND.SetHtml(b);$(e.WND.GetFrameContent()).find("#butClose").attr("onclick",'__Cal["'+a+'"].WND.Show(false);');e.WND.SetZIndex(10);e.WND.MoveCenter();e.WND.Show(!0);return e}};
function EWA_UI_HtmlEditorClass(){this.DEF_CHART_WIDTH=200;this.DEF_CHART_HEIGHT=50;this.DEF_BG_COLOR="#08c";this.DEF_COLOR="#fff";this.OBJ_REPLACE=null;this.pasteClass=new EWA_MiscPasteToolClass;this._CreateFonts=function(){for(var a=["<table class='ewa-editor-pop'>"],b=0;b<EWA_UI_HtmlEditorConfig.fonts.length;b++){var c=EWA_UI_HtmlEditorConfig.fonts[b];a.push("<tr><td>");a.push("<a style='font-size:16px;line-height:1.5;font-family:"+c.font+"' href='javascript:"+this.Id+'.executeSetFont("'+c.font+
"\")'>"+c.name+"</a>");a.push("</td></tr>")}a.push("</table>");return a.join("\n")};this._CreateFormats=function(){for(var a=["<table class='ewa-editor-pop'>"],b=0;b<EWA_UI_HtmlEditorConfig.formats.length;b++){var c=EWA_UI_HtmlEditorConfig.formats[b];a.push("<tr><td>");a.push("<"+c.format+"><a href='javascript:"+this.Id+'.executeSetFormat("'+c.format+"\")'>"+c.name+"</a></"+c.format+">");a.push("</td></tr>")}a.push("</table>");return a.join("\n")};this._CreateFontSizes=function(){for(var a=["<table class='ewa-editor-pop'>"],
b=0;b<EWA_UI_HtmlEditorConfig.sizes.length;b++){var c=EWA_UI_HtmlEditorConfig.sizes[b];a.push("<tr><td>");a.push("<font size="+c.size+"><a href='javascript:"+this.Id+'.executeFontSize("'+c.size+"\")'>"+c.name+"</a></font>");a.push("</td></tr>")}a.push("</table>");return a.join("\n")};this.executeFontSize=function(a){$("#"+this.BoxId+" iframe:eq(0)");this.execDocumentCommand("FontSize",!1,a)};this.executeSetFont=function(a){$("#"+this.BoxId+" iframe:eq(0)");this.execDocumentCommand("FontName",!1,a)};
this.executeSetFormat=function(a){$("#"+this.BoxId+" iframe:eq(0)");this.execDocumentCommand("FormatBlock",!1,a)};this.executeForColor=function(a){$("#"+this.BoxId+" iframe:eq(0)");this.execDocumentCommand("ForeColor",!1,a)};this.executeBackColor=function(a){var b=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow;this.execDocumentCommand("BackColor",!1,a);$(b.document.body).css("background","#fff")};this.execDocumentCommand=function(a,b,c){$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow.document.execCommand(a,
b,c);this.executeAfterEvent(a,c)};this.executeImages=function(a){for(var b=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow,c=0,d=0,e=this,g=0;g<a.files.length;g++){var h=a.files[g];if(h.type&&h.type.indexOf("image/")==0){c++;var k=new FileReader;k.onloadend=function(l){var m=new Image;m.src=l.target.result;m.style.maxWidth="100%";b.document.body.appendChild(m);d++;d==c&&(e.pasteClass.target=b.document.body,e.pasteClass.processAsHtml(),e.pasteClass.process());e.executeAfterEvent("executeImages",
m)};k.readAsDataURL(h)}}};this.executeWord=function(a){for(var b=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow,c=EWA.CP+(EWA.CP.endsWith("/")?"":"/")+"EWA_STYLE/cgi-bin/_re_/?method=2Html",d=this,e=0;e<a.files.length;e++){var g=a.files[e],h=g.name.lastIndexOf(".");if(h>0){if(h=g.name.substring(h).toLowerCase(),h!=".doc"&&h!=".docx"&&h!=".xls"&&h!=".xlsx"&&h!=".odt"){$Tip("\u4ec5\u652f\u6301 doc/docx/xls/xlsx/odt\u6587\u4ef6");break}}else{$Tip("\u4ec5\u652f\u6301 doc/docx/xls/xlsx/odt\u6587\u4ef6");
break}h=new FileReader;h.onloadend=function(k){var l={};l.src=k.target.result;c+="&name="+g.name.toURL();k=$X(d.BoxId).parentNode;var m=d.BoxId+"_cover",n='<div id="'+m+'" style="width:100%;height:100%" class="ewa-ui-dialog-cover"></div>';$(k).css("position","relative").append(n);$JP(c,l,function(p){p.rst?(b.document.body.innerHTML=p.cnt,$(b.document.body).find("img").each(function(){$(this).attr("src",p.img_root+$(this).attr("src"))}),$("#"+m).remove(),$Tip("\u5904\u7406\u5b8c\u6210"),d.executeAfterEvent("executeWord",
p)):$Tip(p.msg)})};h.readAsDataURL(g)}};this.PopFontSize=function(a){var b=this._CreateFontSizes();EWA_UI_HtmlEditorConfig.pop(a,b)};this.PopFont=function(a){var b=this._CreateFonts();EWA_UI_HtmlEditorConfig.pop(a,b)};this.PopFormatBlock=function(a){var b=this._CreateFormats();EWA_UI_HtmlEditorConfig.pop(a,b)};this.PopForColor=function(a){var b=this._CreateColorBox("executeForColor");EWA_UI_HtmlEditorConfig.pop(a,b)};this.PopBackColor=function(a){var b=this._CreateColorBox("executeBackColor");EWA_UI_HtmlEditorConfig.pop(a,
b)};this.PopImg=function(){};this.FullScreen=function(){var a=$("#"+this.BoxId);if(a.attr("isfull")){var b=a.attr("old_css");a.attr("style",b).attr("isfull","")}else{window._EWA_UI_DIALOG_COVERINDEX?_EWA_UI_DIALOG_COVERINDEX++:_EWA_UI_DIALOG_COVERINDEX=999;var c=_EWA_UI_DIALOG_COVERINDEX;b=a.attr("style");a.attr("old_css",b).attr("isfull","1");a.css({position:"fixed",left:0,top:0,right:0,bottom:0,width:"100%",height:"100%","z-index":c})}};this._CreateColorBox=function(a){for(var b=["<table class='ewa-editor-pop'><tr>"],
c=0;c<EWA_UI_HtmlEditorConfig.colors.length;c++){c>0&&c%10==0&&b.push("</tr><tr>");var d=EWA_UI_HtmlEditorConfig.colors[c];b.push("<td><a href='javascript:"+this.Id+"."+a+'("'+d+"\")' class='ewa-edit-pop-color' style='background:"+d+"'>&nbsp;</a></td>")}b.push("</table>");return b.join("\n")};this.Word2Html=function(){};this.GetHtml=function(){var a=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow,b=$("#"+this.BoxId+" iframe:eq(1)")[0].contentWindow;return $("#"+this.BoxId+" iframe:eq(0)").css("display")==
"none"?a.document.body.innerHTML=b.getText():a.document.body.innerHTML};this.GetText=function(){var a=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow,b=$("#"+this.BoxId+" iframe:eq(1)")[0].contentWindow;return $("#"+this.BoxId+" iframe:eq(0)").css("display")=="none"?a.document.body.innerHTML=b.getText():a.document.body.innerText};this.Create=function(a){this.OBJ_REPLACE=a;this.Id=("EWA_Html_"+Math.random()).replace(".","_");this.BoxId=this.Id+"box";window[this.Id]=this;EWA.F.FOS[this.Id]=this;
var b=a.value||a.innerHTML,c=$(a).height(),d={border:"1px solid #ccc",position:"relative",width:$(a).width(),height:c,overflow:"hidden"};a.getAttribute("EWA_DHTML")=="1"&&(d.width="100%");c=document.createElement("table");c.id=this.BoxId;$(c).css(d).addClass("ewa-editor").attr("cellpadding",0).attr("cellspacing",0);d=c.insertRow(-1).insertCell(-1);d.className="ewa-editor-buts";var e=c.insertRow(-1).insertCell(-1);$(e).css("position","static").css("opacity",1).addClass("ewa-ui-dialog-cover");var g=
[],h=EWA_UI_HtmlEditorConfig.defaultConf,k;for(k in h){k>0&&g.push("<span class='ewa-editor-but-spt '>|</span>");for(var l in h[k]){var m=this._CreateButton(EWA_UI_HtmlEditorConfig.buts[h[k][l]]);g.push(m)}}d.innerHTML=g.join("");a.parentNode.insertBefore(c,a);a.style.display="none";this._CreateIframe(e,b,a);a="<input onchange='"+this.Id+".executeImages(this)' multiple accept='image/jpeg,image/png,image/bmp' type=file  style='width:30px;height:30px;position:absolute;top:4px;left:0px;opacity:0.0'>";
$("#"+this.BoxId).find("a[id=fn_Img]").append(a);a="<input onchange='"+this.Id+".executeWord(this)' accept='doc,docx,odt' type=file  style='width:30px;height:30px;position:absolute;top:4px;left:0px;opacity:0.0'>";$("#"+this.BoxId).find("a[id=fn_Word2Html]").append(a);this.executeAfterEvent("init","ok");if(window.__Cal)for(k in __Cal)k.indexOf("EDITOR_Pop_")==0&&delete window.__Cal[k]};this._CreateIframe=function(a,b,c){a.innerHTML="<iframe id='"+this.Id+"cntent' frameborder=0 width=100% height=100%></iframe><iframe id='"+
this.Id+"code' src0='"+(EWA.RV_STATIC_PATH||"/EmpScriptV2")+"/EWA_STYLE/editor/CodeMirror/index.html' style='display: none; width: 100%; height: 100%' frameborder=0></iframe>";var d=this;setTimeout(function(){var e=$("#"+d.BoxId+" iframe:eq(0)"),g=e[0].contentWindow,h=g.document;h.body.style.minHeight=e.height()+"px";e.width()<840&&(h.body.style.boxSizing="border-box",h.body.style.width="100%");e=h.createElement("style");e.textContent=EWA_UI_HtmlEditorConfig.css;h.getElementsByTagName("head")[0].appendChild(e);
e=EWA.CP+(EWA.CP.endsWith("/")?"":"/")+"EWA_STYLE/cgi-bin/_re_/index.jsp?method=HtmlImages";EWA_UI_HtmlEditorConfig.OPT_ImageResizes&&(e+="&ImageReiszes="+EWA_UI_HtmlEditorConfig.OPT_ImageResizes.toURL());d.pasteClass.bind(g.document.body,e,function(k){d.executeAfterEvent("HtmlImages",k)});h.contentEditable=!0;h.designMode="on";h.body.innerHTML=b;$(h.body).css(EWA_UI_HtmlEditorConfig.css);EWA_UI_HtmlEditorConfig.OPT_PopImgProperties&&(h.onmousedown=function(k){k=k||event;k=k.target||k.srcElement;
k.tagName=="IMG"&&d.PopImgProperties(k)});$(h.body).bind("cut",function(){setTimeout(function(){d.executeAfterEvent("cut")},10)});$(h.body).bind("keyup",function(){d.executeAfterEvent("keyup")});$(h.body).bind("paste",function(){setTimeout(function(){d.executeAfterEvent("paste")},10)});$(h.body).bind("undo",function(){d.executeAfterEvent("undo")});$(h.body).bind("redo",function(){d.executeAfterEvent("redo")})},411)};this.PopImgProperties=function(a){var b=["<table style='background:rgba(0,0,0,0.77);color:#f1f1f1;' border=0 width=300 height=140>"];
b.push("</tr><td colspan=2 align=center>\u8bbe\u5b9a\u56fe\u7247\u5c5e\u6027</td></tr>");b.push("<tr><td>\u5c3a\u5bf8\uff1a</td><td><input name='width' value='"+a.width+"' size=4 maxlength=4> x ");b.push("<input name='height' value='"+a.height+"' size=4 maxlength=4>");b.push("</td></tr>");b.push("<tr><td>\u6d6e\u52a8\uff1a</td><td><select name='float'><option value=''></option>");b.push("<option value='left'>\u5de6</option>");b.push("<option value='right'>\u53f3</option>");b.push("</select></td></tr>");
b.push("<tr><td>\u8fb9\u754c\uff1a</td><td><input name='margin' value='2' size=4 maxlength=2> \u50cf\u7d20 ");b.push("</td></tr>");b.push("<tr><td>\u8fb9\u754c\uff1a</td><td><input type='checkbox' name='bt'> \u8bbe\u4e3a\u6807\u9898\u56fe ");b.push("</td></tr>");b.push("</tr><td colspan=2 align=center><input type=button value='\u786e\u5b9a' id='butOk'>&nbsp;");b.push("<input type=button onclick='$(this).parentsUntil(\"div[ewa_name=DIV_FRAME]\").last().parent().hide()' value='\u5173\u95ed'></td></tr>");
b.push("</table>");var c=EWA_UI_HtmlEditorConfig.pop1(a.getAttribute("_tmp_id"),b.join(""),300,150).WND.GetFrameContent(),d=this;$(c).find("#butOk").bind("click",function(){$(this.parentNode).find("#butClose").click();var e=$(c).find("[name=width]").val();e!=""?a.width=e:$(a).attr("width",null);e=$(c).find("[name=height]").val();e!=""?a.height=e:$(a).attr("height",null);e=$(c).find("[name=float]").val();$(a).css("float",e);$(a).css("margin",$(c).find("[name=margin]").val()+"px");$(c).find("[name=bt]")[0].checked&&
(e=a.src.replace(location.origin,""),e=e.replace("//","/"),$("#NWS_HEAD_PIC").val(e),d.userSetHeaderPic&&d.userSetHeaderPic(e))})};this._CreateButton=function(a){try{return"<a href='javascript:void(0)' class='btn "+a["class"]+"' onclick='"+this.Id+".execute(this)' id='"+a.id+"' cmd='"+a.cmd+"' title='"+a.title+"'></a>"}catch(b){return console.log(a),""}};this.showCode=function(a){var b=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow,c=$("#"+this.BoxId+" iframe:eq(1)")[0].contentWindow;b=c.style_html(b.document.body.innerHTML,
4," ",80);a.setAttribute("tag","txt");c.editor?c.editor.setValue(b):c.initEditor(b,"html")};this.execute=function(a){var b=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow,c=$("#"+this.BoxId+" iframe:eq(1)")[0].contentWindow,d=b.document,e=a.getAttribute("cmd");if(a.id.indexOf("st_")==0)e=="CreateLink"?d.execCommand(e,!0,null):d.execCommand(e,!1,null);else if(a.id.indexOf("fn_")==0)this[e](a);else if(e=="eraser")this.executeEraser();else if(e=="CODE_TXT"){var g=a.getAttribute("tag"),h=$("#"+this.BoxId+
" iframe:eq(0)");d=$("#"+this.BoxId+" iframe:eq(1)");if(g)h.show(),d.hide(),a.setAttribute("tag",""),b.document.body.innerHTML=c.getText();else if(h.hide(),d.show(),d.attr("src0")){b=d.attr("src0");d.attr("src",b);d.removeAttr("src0");var k=this;this._WAIT_CODE_LOAD_COMPLETE=setInterval(function(){c.document.readyState=="complete"&&(window.clearInterval(k._WAIT_CODE_LOAD_COMPLETE),k._WAIT_CODE_LOAD_COMPLETE=null,k.showCode(a))},100)}else this.showCode(a)}else a.id=="IMG"?insertImg(window):(a.id==
"CreateLink"?b.document.execCommand(a.id,!0,null):b.document.execCommand(a.id,!1,null),b.document.body.focus());this.executeAfterEvent(e)};this.executeEraser=function(){var a=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow.document.body;$(a).find("p,h1,h2,h3,h4,h5").each(function(){$(this).find("img").length==0&&(this.innerText=this.innerText,this.innerText.trimEx()==""&&$(this).remove())});$(a).find("div,font,span,a").each(function(){$(this).find("img").length==0&&this.innerText.trimEx()==""&&
$(this).remove()});$(a).find("script").remove();$(a).find("style").remove();$(a).find("link").remove();$(a).find("meta").remove();$(a).find("title").remove();$(a).find("colgroup").remove();$(a).find("*").each(function(){let b={};for(let c=0;c<this.attributes.length;c++){let d=this.attributes[c].name;d!="src"&&(b[d]=null)}$(this).attr(b)});this.OBJ_REPLACE.value=a.innerHTML=a.innerHTML.replace(/\x3c!--[\w\W\r\n]*?--\x3e/gim,"")};this.executeAfterEvent=function(a,b){var c=$("#"+this.BoxId+" iframe:eq(0)")[0].contentWindow.document.body;
if(a!="init"||b!="ok")this.OBJ_REPLACE.value=c.innerHTML;this.userAfterEvent&&this.userAfterEvent(a,b,c)};this.userAfterEvent=function(a,b,c){}}
function EWA_MiscPasteToolClass(){this.target=document.body;this.handleUrl=null;this.images=[];this.paste=function(a){if((a=a.originalEvent)&&a.clipboardData&&a.clipboardData.items&&a.clipboardData.items.length>0)for(var b=0;b<a.clipboardData.items.length;b++){var c=a.clipboardData.items[b];if(c.type=="image/png")this.processAsPaste(c);else if(c.type=="text/html"){var d=this;a.clipboardData.getData("text/html")&&setTimeout(function(){d.processAsHtml();d.process()},311);break}}};this.processAsPaste=
function(a){var b=new FileReader,c=this,d={};$(c.target).find("img").each(function(){d[this]=!0});b.onloadend=function(){var e=null;$(c.target).find("img").each(function(){e!=null||d[this]||(e=this)});e||c.target.ownerDocument.execCommand("InsertImage",!1,this.result);$(c.target).find("img").each(function(){e!=null||d[this]||(e=this)});if(e){var g=c.tmpId(e);c.images.push({id:g,src:e.src,mode:"base64"});c.process()}else console.log("not img")};b.readAsDataURL(a.getAsFile())};this.processAsHtml=function(){var a=
this.target,b=this;$(a).find("img").each(function(){if(!this.getAttribute("_tmp_id")){var c=b.tmpId(this);this.src&&this.src.indexOf(location.origin)!=0&&b.images.push({id:c,src:this.src,mode:this.src.indexOf("data:image")==0?"base64":"normal"})}});this.processRemoveComments();$(a).find("*").each(function(){var c=$(this).css("background-image");c&&(c=c.replace("url(","").replace(")",""))&&c.startsWith("http://")&&b.images.push({id:EWA_MiscPasteTool.tmpId(this),src:c,mode:"background"});$(this).attr({onclick:null,
onload:null,onkeydown:null,onkeyup:null,onerror:null,onmousedown:null,onmouseout:null,onmouseover:null,onkeypress:null,onblur:null,onscroll:null})})};this.processRemoveComments=function(a){a==null&&(a=this.target);var b=[],c;for(c in a.childNodes){var d=a.childNodes[c];d.nodeType==8||d.tagName=="SCRIPT"||d.tagName=="LINK"||d.tagName=="STYLE"||d.tagName=="IFRAME"?b.push(d):d.tagName=="SPAN"&&(GetInnerText(d)||b.push(d))}for(c in b)a.removeChild(b[c]);for(c in a.childNodes)d=a.childNodes[c],d.nodeType==
1&&d.childNodes&&this.processRemoveComments(d)};this.tmpId=function(a){if(a.getAttribute("_tmp_id"))return a.getAttribute("_tmp_id");var b=("r_"+Math.random()).replace(".","");a.setAttribute("_tmp_id",b);$(a).css("max-width","100%");return b};this.process=function(){if(this.images.length!=0){var a={d:JSON.stringify(this.images)};this.images=[];var b=this;$JP(this.handleUrl,a,function(c){if(c.rst)for(var d=0;d<c.rsts.length;d++){var e=c.rsts[d],g=e.id,h=e.local;e.mode=="background"?$(b.target).find('[_tmp_id="'+
g+'"]').css("background-image","url("+h+")"):$(b.target).find('img[_tmp_id="'+g+'"]').attr("src",h)}else $Tip("\u5904\u7406\u9519\u8bef");b.handleUrlAfterEvent&&b.handleUrlAfterEvent(c)})}};this.bind=function(a,b,c){if(b){this.handleUrl=b;this.images=[];this.target=a;var d=this;$(document).ready(function(){$(a).bind("paste",function(e){d.paste(e)})});this.handleUrlAfterEvent=c?c:null}else alert("\u8bf7\u5b9a\u4e49\u63d0\u4ea4\u5730\u5740")}}
function EWA_UI_MapClass(a,b){this.cfg=a;this._FromId=b;this.showFull=function(){var c="div$"+this._FromId+"$MAP1",d=c+"d";if(!$X(c)){var e="<div class='ewa-map-full' id='"+c+"'><div class='ewa-map-full-cnt' id='"+d+"'></div><p title='\u9000\u51fa\u5168\u5c4f' onclick='$(this.parentNode).hide();' class='fa fa-power-off' id='"+c+"1p'></p></div>";$("body").append(e)}$($X(c)).show();this.gps1=new EWA_GMapClass;this.gps1.init(14);e=this.getLngLat();c=e[0];e=e[1];c&&e?this.gps1.showMap(d,c,e,$X(this._FromId).value):
this.search_addr($X(this._FromId),this.gps1,d)};this.getLngLat=function(){if(this.cfg.lng)var c=$X(this.cfg.lng).value;else(c=$($X(this._FromId+"_LNG")).val())||(home_lang=$($X(this._FromId.split("_")[0]+"_LNG")).val());if(this.cfg.lat)var d=$X(this.cfg.lat).value;else(d=$($X(this._FromId+"_LAT")).val())||(d=$($X(this._FromId.split("_")[0]+"_LAT")).val());return[c,d]};this.init=function(){var c=this._FromId+"$MAPClass",d="div$"+this._FromId+"$MAP",e=this;addEvent($X(this._FromId),"blur",function(){e.search_addr(this,
e.gps,d)});var g=$X(this._FromId).parentNode.parentNode,h=g.parentNode.insertRow(g.rowIndex+1).insertCell(-1);h.innerHTML="<div class='ewa-map-small'><div class='ewa-map-small-cnt' id='"+d+"'></div><div class='ewa-map-full-but' title='\u5168\u5c4f\u67e5\u770b' onclick='"+c+".showFull()'><b class='fa fa-square-o'></b></div></div>";h.colSpan=g.cells.length;h.className="ewa-map-small-td";this.gps=new EWA_GMapClass;this.gps.init(10);g=this.getLngLat();c=g[0];g=g[1];c&&g?this.gps.showMap(d,c,g,$X(this._FromId).value):
this.search_addr($X(this._FromId),this.gps,d)};this.setSearchResult=function(c,d,e){this.cfg.lng?$X(this.cfg.lng).value=c.Q_LNG:($X(this._FromId+"_LNG")&&($X(this._FromId+"_LNG").value=c.Q_LNG),$X(this._FromId.split("_")[0]+"_LNG")&&($X(this._FromId.split("_")[0]+"_LNG").value=c.Q_LNG));this.cfg.lat?$X(this.cfg.lat).value=c.Q_LAT:($X(this._FromId+"_LAT")&&($X(this._FromId+"_LAT").value=c.Q_LAT),$X(this._FromId.split("_")[0]+"_LAT")&&($X(this._FromId.split("_")[0]+"_LAT").value=c.Q_LAT));this.cfg.zip?
$X(this.cfg.zip).value=c.Q_ZIP||"":($X(this._FromId+"_ZIP")&&($X(this._FromId+"_ZIP").value=c.Q_ZIP),$X(this._FromId.split("_")[0]+"_ZIP")&&($X(this._FromId.split("_")[0]+"_ZIP").value=c.Q_ZIP));this.cfg.province?$X(this.cfg.province).value=c.Q_STATE||"":($X(this._FromId+"_STATE")&&($X(this._FromId+"_STATE").value=c.Q_STATE),$X(this._FromId.split("_")[0]+"_STATE")&&($X(this._FromId.split("_")[0]+"_STATE").value=c.Q_STATE));this.cfg.city&&($X(this.cfg.city).value=c.Q_CITY||"");this.cfg.country&&($X(this.cfg.country).value=
c.Q_COUNTRY||"");e=d.showMap(e,c.Q_LNG,c.Q_LAT,c.Q_SEARCH);d.map.setCenter(e);this.searchResultAfter&&this.searchResultAfter(c)};this.search_addr=function(c,d,e){c=c.value;if(c!=""){var g=this;c=[c];g.cfg.city&&c.push($X(g.cfg.city).value);g.cfg.province&&c.push($X(g.cfg.province).value);g.cfg.country&&c.push($X(g.cfg.country).value);c=c.join(", ");d.getGpsFromAddress(c,function(h,k,l){g.setSearchResult(l,d,e)})}}}
function EWA_UI_PicViewClass(){this.id=("EWAUIPicView"+Math.random()).replace(".","Gdx");this.t_start=-1;this.dist_base=0;this.is_move=!1;this.table=null;this.prevIdx=-1;this.setImg=function(a){$(a).attr("mw",a.width).attr("mh",a.height).css("margin-left",0).css("margin-top","0");$(a).parent().css("background-image","none")};this.addPic=function(a){var b=this.table.rows[0].cells.length,c=this.table.rows[0].insertCell(b);c.align="center";var d="<img style='max-width:100%;max-height:100%' onload='"+
this.id+".setImg(this)' id='"+(this.id+"_"+b)+"' ";d+=" src1='"+a+"'>";$(c).hide().css({"background-image":"url('/static/images/loading2.gif')","background-position":"center center","background-repeat":"no-repeat"});c.innerHTML=d;$(this.table1).find("td").append("<b>&bull;</b>");b==0?this.changePhoto(0):$(this.table1).show();this.total=b+1};this.changePhoto=function(a){if(this.prevIdx!=a){if(this.prevIdx>=0){var b=$("#"+this.id+"_"+this.prevIdx);$(b).parent().hide();$(this.table1).find("b:eq("+this.prevIdx+
")").css("color","#ccc")}this.prevIdx=a;b=$("#"+this.id+"_"+a);if(b.attr("src1"))b.attr("src",b.attr("src1")),b.attr("scr1",""),b[0].setAttribute("src1","");else{try{if(b.attr("mw")){var c=b.attr("mw")*1;b.attr("mh");b.css("width",c).css("height".mh)}}catch(d){console.log(d)}b.css("margin-left",0).css("margin-top",0).attr("r",null).attr("rold",null).css("transform","scale(1)")}b.parent().show();$(this.table1).find("b:eq("+a+")").css("color","yellow")}};this.close=function(){$(this.table).parent().remove();
delete window[this.id]};this.create=function(){window[this.id]=this;var a=document.createElement("div"),b=document.createElement("table");b.insertRow(-1);var c=document.createElement("table");c.insertRow(-1).insertCell(-1).align="center";var d=document.createElement("div");d.innerHTML="<b class='fa fa-close'></b>";$(a).css({position:"fixed",top:0,left:0,width:"100%",height:"100%","z-index":99999999,background:"rgba(0, 0, 0, 0.9)"});$(b).css({position:"absolute",left:0,top:0,height:"100%",width:"100%",
"table-layout":"fixed"});$(c).css({position:"absolute",left:0,height:30,width:"100%",overflow:"hidden",bottom:"5px","z-index":3,color:"#ccc","font-size":"30px",display:"none"});$(d).css({position:"absolute",right:20,top:30,height:40,width:40,"line-height":"40px",overflow:"hidden","z-index":4,color:"darkred","font-size":"30px","text-align":"center",display:"block"}).attr("onclick",this.id+".close()");this.table=b;this.table1=c;$(a).append(b);$(a).append(c);$(a).append(d);$("body").append(a);var e=
this;b.ontouchstart=function(g){g.targetTouches.length==1?e.t_start=g:g.targetTouches.length==2&&(e.t_start1=g,e.dist_base=0);e.is_move=!1;g.preventDefault();g.stopPropagation()};b.ontouchmove=function(g){if(g.targetTouches.length==2){e.t_start1a=g;var h=g.targetTouches[0].pageX-e.t_start1.pageX,k=g.targetTouches[0].pageY-e.t_start1.pageY,l=g.targetTouches[1].pageX-e.t_start1.pageX,m=g.targetTouches[1].pageY-e.t_start1.pageY;k=Math.sqrt((h-l)*(h-l)+(k-m)*(k-m));e.dist_base==0?e.dist_base=k:(k/=e.dist_base,
h=$(g.target).attr("rold"),k*=h?h*1:1,k<=1&&(k=1),k>5&&(k=5),$(g.target).css("transform","scale("+k+")").attr("r",k),k==1&&$(g.target).css("margin-left",0).css("margin-top",0))}else if(g.targetTouches.length==1){k=$(g.target).attr("r");if(k==null||k==1)return;h=g.pageX-e.t_start.pageX;k=g.pageY-e.t_start.pageY;m=$(g.target).css("margin-left").replace("px","")*1;l=$(g.target).css("margin-top").replace("px","")*1;h=m+h;k=l+k;$(g.target).css("margin-left",h).css("margin-top",k);e.t_start=g;e.is_move=
!0}g.preventDefault();g.stopPropagation()};b.ontouchend=function(g){g.preventDefault();g.stopPropagation();if(e.t_start){var h=g.pageX-e.t_start.pageX,k=g.timeStamp-e.t_start.timeStamp;h<-50&&k<244?(h=e.prevIdx,h++,h==e.total&&(h=0),e.changePhoto(h)):h>50&&k<244?(h=e.prevIdx,h--,h<0&&(h=e.total-1),e.changePhoto(h)):Math.abs(h)<10&&k<150&&!e.is_move&&e.click_page()}console.log(e.t_start1);e.t_start1&&(h=$(g.target).attr("r"),console.log(h),$(g.target).attr("rold",h));e.t_start=null;e.t_start1=null}}}
function EWA_UI_H5FrameSet(){this.Create=function(a,b){this.Id=a;this.FrameType=b;this.LOC_ID="EWA_UI_H5FrameSet_"+this.Id;this.ParentDiv=$("#F0_"+this.Id).parent();this.objOne=this.ParentDiv.find(".ewa-frameset-one");this.objTwo=this.ParentDiv.find(".ewa-frameset-two");this.objSplit=this.ParentDiv.find(".ewa-frameset-split");this.objCover=this.ParentDiv.find(".ewa-frameset-cover");$("body").css("height","100vh");b=="H5"?this.CreateMoveH5():this.CreateMoveV5();window.localStorage[this.LOC_ID]&&this.ChangeLocation(window.localStorage[this.LOC_ID]*
1)};this._GetMoveInstance=function(){if(window.__EWA_MOVE_EWA_UI_H5FrameSetInstance)return window.__EWA_MOVE_EWA_UI_H5FrameSetInstance;window.__EWA_MOVE_EWA_UI_H5FrameSetInstance=new EWA.UI.Move;window.__EWA_MOVE_EWA_UI_H5FrameSetInstance.NAME="__EWA_MOVE_EWA_UI_H5FrameSetInstance";window.__EWA_MOVE_EWA_UI_H5FrameSetInstance.Init(window.__EWA_MOVE_EWA_UI_H5FrameSetInstance);return window.__EWA_MOVE_EWA_UI_H5FrameSetInstance};this.CreateMoveV5=function(){this.mv1=this._GetMoveInstance();var a=this.objSplit[0],
b=this;this.mv1.AddMoveObjectY(a,a,function(c){b.objCover.hide();b.objSplit.css("z-index",1)},document.body,function(c,d){c=$(c).css("top").replace("px","")*1;b.ChangeLocation(c);window.localStorage[b.LOC_ID]=c},function(){b.objCover.show()})};this.CreateMoveH5=function(){this.mv1=this._GetMoveInstance();var a=this.objSplit[0],b=this;this.mv1.AddMoveObjectX(a,a,function(c){b.objCover.hide();b.objSplit.css("z-index",1)},document.body,function(c,d){c=$(c).css("left").replace("px","")*1;b.ChangeLocation(c);
window.localStorage[b.LOC_ID]=c},function(){b.objCover.show()})};this.ChangeLocation=function(a){this.FrameType=="H5"?(this.objOne.css("width",a),this.objTwo.css("left",a+1),this.objSplit.css("left",a)):(this.objOne.css("height",a),this.objTwo.css("top",a+1),this.objSplit.css("top",a))}}
var EWA_UI_Dock={dockObj:null,dockTitleObj:null,menuMap:{},init:function(a){var b=["<div class='ewa-dock'><table class='ewa-dock-table'><tr>"],c;for(c in a){var d=a[c],e=EWA_Utils.tempId("_EWA_UI_Dock_");this.menuMap[e]=d;var g=this.getMenuText(d);g=this.filterHtml(g);b.push("<td class='ewa-dock-item-td' ><div class='ewa-dock-item-div' id='"+e+"' _title=\""+g+"\" onclick='EWA_UI_Dock.click(this)' onmouseover='EWA_UI_Dock.showTitle(this)' onmouseout='EWA_UI_Dock.hideTitle(this)'><div class='ewa-dock-item-icon "+
d.ICON+"'></div></div></td>")}b.push("</tr></table></div>");this.dockObj=$(b.join(""));this.dockTitleObj=$('<div class="ewa-dock-title" style="display: none;"><div>--</div><p></p></div>');$("body").append(this.dockObj).append(this.dockTitleObj)},click:function(a){var b=this.menuMap[a.id];b||console.log("menu ["+a.id+"]?");b.CMD?b.CMD instanceof Function?b.CMD(a):eval(b.CMD):console.log("NO CMD in menu",b)},getMenuText:function(a){return a.TEXT},filterHtml:function(a){return a.replace(/</ig,"&lt;").replace(/>/ig,
"&gt;").replace(/"/ig,"&quot;")},showTitle:function(a){if(a.getAttribute("_title")==""||a.getAttribute("_title")==null){var b=a.title;if(b==""||b==null)return;a.setAttribute("_title",b);a.title=""}this.dockTitleObj.find("div:eq(0)").html(a.getAttribute("_title"));b=$(a).offset();a=$(a).width();var c=this.dockTitleObj.height(),d=this.dockTitleObj.width();this.dockTitleObj.css("top",b.top-c-8);this.dockTitleObj.show();this.dockTitleObj.css("left",b.left-(d-a)/2)},hideTitle:function(){this.dockTitleObj.hide()}};
class EWA_UI_NavBarClass{constructor(){this.tabsCfg=this.parent=this.id=null;this.lastIdx=0}show(a){let b=a*1;b!==this.lastIdx&&(this.lastIdx=b,a=$(this.parent).find(".ewa-tab-box"),$(this.parent).find(".ewa-tab-tab").each(function(){$(this).attr("idx")*1===b?$(this).removeClass("EWA_GROUP_CNT_TOP").addClass("EWA_GROUP_CNT_TOP1"):$(this).removeClass("EWA_GROUP_CNT_TOP1").addClass("EWA_GROUP_CNT_TOP")}),a.hide(),$(a[b]).show())}getBox(a){a=$(this.parent).find(".ewa-tab-box:eq("+a+")");return a.length==
0?null:a[0]}setContent(a,b,c){let d=this.getBox(a);d.html(b);c&&c(d,a,b)}install(a,b,c){let d=this.getBox(a);$Install(b,d,function(e,g,h){c&&c(d,a,b,e,g,h)})}createInstallCfg(a,b,c,d){return{text:a,url:b,cb:c,show:d}}createContentCfg(a,b,c,d){return{text:a,content:b,cb:c,show:d}}demo(){document.body.innerHTML="";this.init("demo",document.body,[{text:"\u6807\u7b7e\u4e00"},{text:"\u6807\u7b7e\u4e8c"},{text:"<b>\u6807\u7b7e\u4e09</b>",show:!0}])}init(a,b,c){this.id=a;this.parent=b;this.tabsCfg=c;var d=
[],e=[];for(let h in c){let k=`<div idx="${h}" class="ewa-tab-tab ${h>0?"EWA_GROUP_CNT_TOP":"EWA_GROUP_CNT_TOP1"}" id="tab_${a}_${h}">
<a style='display:block'>${c[h].text}</a></div>`;e.push(`<div idx="${h}" class='ewa-tab-box' id="box_${a}_${h}" style="display: ${h>0?"none":"block"}"></div>`);d.push(k)}d=d.join("");e=e.join("");a=$(`<div class="ewa-tab" id="${a}">
	<div class="ewa-tab-headers" id="headers_${a}">${d}<div style='clear:both'></div></div>
	<div class="ewa-tab-boxes" id="boxes_${a}">${e}</div>
</div>`);let g=this;a.find("a").on("click",function(){let h=$(this).parent().attr("idx")*1;g.show(h)});$(b).append(a);for(let h in c)b=c[h],b.url?g.install(h,b.url,b.cb):b.content&&g.setContent(h,b.content,b.cb),b.show&&(console.log(b),this.show(h))}}
var EWA_Behavior={RELOAD_PARENTA:function(a){var b=window.parent;try{b.EWA.F.FOS[a]&&b.EWA.F.FOS[a].Reload?b.EWA.F.FOS[a].Reload():b.location=b.location.href}catch(c){b.location=b.location.href}},RELOAD_PARENT:function(a){let b=EWA_Behavior.getParentWindow();if(b){var c=EWA_Behavior.getParentFrame(a);try{c?c.Reload(window.location.href):(console.warn("not found parent frame:"+a),_EWA_DialogWnd.CloseWindow(),b.location=b.location.href)}catch(d){console.log(d),b.location=b.location.href}}},getParentWindow:function(){return window._EWA_DialogWnd==
null?null:_EWA_DialogWnd._OpenerWindow},getParentFrame:function(a){let b=EWA_Behavior.getParentWindow();return b&&b.EWA&&b.EWA.F&&b.EWA.F.FOS&&b.EWA.F.FOS[a]?b.EWA.F.FOS[a]:null},CLOSE_SELF:function(){window._EWA_DialogWnd==null?self.close():_EWA_DialogWnd.CloseWindow()},CLEAR_SELF:function(){self.document.forms[0].reset()}};
function EWA_PostBehavior(a,b){if(a.indexOf("RELOAD_PARENTA")<0)try{if(!window._EWA_DialogWnd){console.log("not parent window");return}if(window.STOP_RELOAD){window.STOP_RELOAD=!1;return}var c=_EWA_DialogWnd._OpenerWindow,d=c.__Dialog[b];d&&d.AfterMsg&&c.EWA.UI.Msg.Alert(d.AfterMsg,_EWA_INFO_MSG["EWA.SYS.CHOOSE_ITEM_TITLE"])}catch(e){console.log(e)}if(c=EWA_Behavior.getParentFrame(b))for(c.outParams=[],d=2;d<arguments.length;d++)c.outParams.push(arguments[d]);c=a.split(",");for(d=0;d<c.length;d+=
1)EWA_Behavior[c[d]](b)}EWA.UI.Ext=EWA.UI.Ext||{};
EWA.UI.Ext.initExtsMap=function(){function a(c,d,e){c=c.split(",");for(let g in c){let h=c[g].trim().toLowerCase();b.mapImg[h]=d;b.mapIcon[h]=e}}if(!this.mapImg){this.mapImg={def:"Edit.png"};this.mapIcon={def:"fa fa-file-text-o"};var b=this;a(".doc,.docx,.rtf","MSWD.png","fa fa-file-word-o ewa-file-ext-color-word");a(".xls,.xlsx","XCEL.png","fa fa-file-excel-o ewa-file-ext-color-excel");a(".ppt,.pptx","PPT3.png","fa fa-file-powerpoint-o ewa-file-ext-color-powerpoint");a(".txt,.cvs,.pom","Edit.png",
"fa fa-file-text-o ewa-file-ext-color-text");a(".pdf","ACR_App.png","fa fa-file-pdf-o ewa-file-ext-color-pdf");a(".7z,.zip,.rar,.arc,.gz,.tar","zip.png","fa fa-file-zip-o ewa-file-ext-color-zip");a(".odt","openoffice.png","fa fa-file-text-o ewa-file-ext-color-text");a(".html,.htm","html.png","fa fa-internet-explorer ewa-file-ext-color-html");a(".mp3,.wav,.mid,.m4a,.oga,.flac,.weba,.opus,.ogg","mp3.png","fa fa-file-audio-o ewa-file-ext-color-audio");a(".mp4,.mov,.flv,.vod,.ogm,.ogv,.wmv,.mpg,.mpeg,.m4v,.avi,.asx,.webm",
"vod.png","fa fa-file-video-o ewa-file-ext-color-video");a(".jpg,.jpeg,.jiff,jfif,.png,.bmp,.webp,.tiff,.avif","vod.png","fa fa-file-image-o ewa-file-ext-color-image")}};EWA.UI.Ext.getFileIco=function(a){this.initExtsMap();var b=(EWA.RV_STATIC_PATH||"/EmpScriptV2")+"/EWA_STYLE/images/file_png/";a==null&&(a="");a=a.toLowerCase();a.indexOf(".")<0&&(a="."+a);return this.mapImg[a]?b+this.mapImg[a]:b+this.mapImg.def};EWA.UI.Ext.FileIco=EWA.UI.Ext.getFileIco;
EWA.UI.Ext.getFileIcon=function(a){this.initExtsMap();a==null&&(a="");a=a.toLowerCase();a.indexOf(".")<0&&(a="."+a);return this.mapIcon[a]?this.mapIcon[a]:this.mapIcon.def};EWA.UI.Ext.FileExt=function(a){if(a==null)return"";a=a.toLowerCase();var b=a.lastIndexOf("."),c="";b>0&&(c=a.substring(b));return c};
EWA.UI.Ext.getFileLen=function(a,b){if(a==null||isNaN(a))return a||"";if(b==null||isNaN(b))b=0;return a>=1099511627776?(a/1099511627776).fm(b)+"T":a>=1073741824?(a/1073741824).fm(b)+"G":a>=1048576?(a/1048576).fm(b)+"M":a>=1024?(a/1024).fm(b)+"K":a+"B"};EWA.UI.Ext.FileLen=EWA.UI.Ext.getFileLen;
EWA.UI.Ext.Mobile=function(a){if(a){var b=a.id||"R"+Math.random();a.id=b;b="__mobile_"+b;$(a).attr("mobile_id",b);if(!$X(b)){var c=[];c.push("<table class='ewa-text-help-box' border=0 cellpadding=3 cellspacing=0 id='"+b+"'>");c.push("<tr><td>");c.push(EWA.UI.Ext.IdCard1(3));c.push("</td><td>-</td><td>");c.push(EWA.UI.Ext.IdCard1(4));c.push("</td><td>-</td><td>");c.push(EWA.UI.Ext.IdCard1(4));c.push("</td><td><i></i></td></tr></table>");$("body").append(c.join(""));c=$X(b);$(c).find("td").css("background-color",
"#fff").attr("align","center");$(a).attr("maxLength",11)}c=$X(b);addEvent(a,"focus",function(){var d=$(this).attr("mobile_id");d=$($X(d)).show();d.css("top",$(this).offset().top-d.height()-7);d.css("left",$(this).offset().left);EWA.UI.Ext.Mobile2(this)});addEvent(a,"blur",function(){var d=$(this).attr("mobile_id");$($X(d)).hide()});addEvent(a,"keyup",function(){EWA.UI.Ext.Mobile2(this)})}};
EWA.UI.Ext.Mobile2=function(a){var b=$(a).attr("mobile_id");b=$($X(b));a=a.value;var c=b.find("div");c.html("");for(var d=!0,e=0;e<a.length;e++){var g=a.substring(e,e+1),h="";isNaN(g)&&(h="red",d=!1);c[e]&&(c[e].innerHTML="<span style='font-size:16px;color:"+h+"'>"+g+"</span>")}a.length==c.length&&d?b.find("i").html("<font color=green>\u6b63\u786e</font>"):b.find("i").html("<font color=red>\u9519\u8bef</font>")};
EWA.UI.Ext.IdCard=function(a){if(a){var b=a.id||"R"+Math.random();a.id=b;b="__sfz_"+b;$(a).attr("sfz_id",b);if(!$X(b)){var c=[];c.push("<table class='ewa-text-help-box' border=0 cellpadding=1 cellspacing=1 id='"+b+"'>");c.push("</tr><td height=18>\u5730\u533a</td><td >\u5e74</td><td>\u6708</td><td>\u65e5</td><td>\u987a\u5e8f\u53f7</td></tr>");c.push("<tr><td>");c.push(EWA.UI.Ext.IdCard1(6));c.push("</td><td>");c.push(EWA.UI.Ext.IdCard1(4));c.push("</td><td>");c.push(EWA.UI.Ext.IdCard1(2));c.push("</td><td>");
c.push(EWA.UI.Ext.IdCard1(2));c.push("</td><td>");c.push(EWA.UI.Ext.IdCard1(4));c.push("</td></tr><tr><td colspan=5>\u72b6\u6001 <i></i></td></tr></table>");$("body").append(c.join(""));c=$X(b);$(c).find("td").css("background-color","#fff").attr("align","center");$(a).attr("maxLength",18)}c=$X(b);addEvent(a,"focus",function(){var d=$(this).attr("sfz_id");d=$($X(d)).show();d.css("top",$(this).offset().top-d.height()-8);d.css("left",$(this).offset().left);EWA.UI.Ext.IdCard2(this)});addEvent(a,"blur",
function(){var d=$(this).attr("sfz_id");$($X(d)).hide()});addEvent(a,"keyup",function(){EWA.UI.Ext.IdCard2(this)})}};EWA.UI.Ext.IdCard1=function(a){for(var b=[],c=0;c<a;c++)b.push("<div></div>");return b.join("")};
EWA.UI.Ext.IdCard2=function(a){var b=[1,31,28,31,30,31,30,31,31,30,31,30,31],c=$(a).attr("sfz_id");c=$($X(c)).show();var d=a.value,e=c.find("div");e.html("");for(var g=!0,h=[],k=[],l=[],m=[],n=0;n<d.length;n++){var p=d.substring(n,n+1),r="";n<6?h.push(p):n>=6&&n<10?k.push(p):n>=10&&n<12?l.push(p):n>=12&&n<14&&m.push(p);n<17?isNaN(p)&&(r="red",g=!1):p!="x"&&p!="X"&&isNaN(p)&&(r="red",g=!1);e[n]&&(e[n].innerHTML="<span style='font-size:16px;color:"+r+"'>"+p+"</span>")}h=k.join("");k=[];if(isNaN(h))g=
!1,k.push("\u5e74:"+h);else{if(h<1900||h>2100){g=!1;for(n=6;n<10;n++)$(e[n]).find("span").css("color","red");k.push("\u5e74:"+h)}b[2]=(h-1996)%4==0?29:28}l=l.join("");ismonth1=!0;if(isNaN(l))g=ismonth1=!1,k.push("\u6708:"+l);else if(l<1||l>12){ismonth1=g=!1;for(n=10;n<12;n++)$(e[n]).find("span").css("color","red");k.push("\u6708:"+l)}m=m.join("");if(isNaN(m))g=!1;else if(ismonth1&&(m<1||m>b[l*1])){g=!1;for(n=12;n<14;n++)$(e[n]).find("span").css("color","red");k.push("\u65e5:"+m)}d.length==e.length&&
g?(c.find("i").html("<font color=green>\u6b63\u786e</font>"),b={YEAR:h,MONTH:l,DAY:m,SEX:$(e[16]).text()*1%2},$(a).attr("sfz_json",JSON.stringify(b))):c.find("i").html("<font color=red>"+k.join(", ")+"\u9519\u8bef</font>")};
(function(){function a(){let l=k.$(".ewa-slider-puzzle-box"),m=k.$(".ewa-slider-puzzle-swiper"),n=k.$(".ewa-slider-puzzle-verify"),p=k.$(".ewa-slider-puzzle-text"),r=h?"touchmove":"mousemove",q=h?"touchend":"mouseup";m.bind(h?"touchstart":"mousedown",function(t){t.stopPropagation();n.css({display:"block"});var v=(h?t.touches[0]:t).clientX-$(this).offset().left;$(this).offset();p.css("opacity","0");l.unbind(r);l.unbind(q);l.bind(r,function(u){var w=h?u.touches[0]:u,x=k.$(".ewa-slider-puzzle-handle");
u=k.$(".ewa-slider-puzzle-swiper");let y=k.$(".ewa-slider-puzzle-verify");w=w.clientX-v-$(x).offset().left;x=$(x).width()+29;w<0?w=0:w>x&&(w=x);u.css("left",w);y.css("left",w+10)});l.bind(q,function(u){l.unbind(r);l.unbind(q);u=new EWA_UrlClass(g.ewa_url);let w={};w.left=n.position().left;w.top=n.position().top;w.left1=n.offset().left;w.top1=n.offset().top;w.ewa_trigger_valid_mode="check";w.ewa_trigger_valid_name=g.ewa_trigger_valid_name;w.ewa_ajax=g.ewa_trigger_valid;console.log("0. Puzzle post check");
$JP(u.GetUrl(),w,function(x){x.RST?(console.log("1. puzzle valid ok"),l.addClass("ewa-slider-puzzle-successful"),d&&d(x)):(l.addClass("ewa-slider-puzzle-fail"),setTimeout(()=>{l.removeClass("ewa-slider-puzzle-fail");m.css("left","0px");n.css("left","10px");p.css("opacity","1");e&&e(x);x.newConfig&&(x.newConfig.ewa_trigger_valid_name=g.ewa_trigger_valid_name,x.newConfig.ewa_trigger_valid=g.ewa_trigger_valid,x.newConfig.ewa_url=g.ewa_url,g=x.newConfig,b(g))},500))})})})}function b(l){var m=k.$(".ewa-slider-puzzle-imgbox"),
n=k.$(".ewa-slider-puzzle-imgbox img");m.css("width",l.imgBigWidth).css("height",l.imgBigHeight);n.length?n.attr("src",l.imgBig):m.prepend("<img src='"+l.imgBig+"' />");k.$(".ewa-slider-puzzle-verify").css("background-image","url('"+l.imgSmall+"')").css("top",l.imgTop).css("width",l.imgSmallWidth).css("height",l.imgSmallHeight)}var c=[];c.push('<div class="ewa-slider-puzzle-box">');c.push('<div class="ewa-slider-puzzle-imgbox">');c.push('<div class="ewa-slider-puzzle-verify"></div>');c.push('<div class="ewa-slider-puzzle-refresh"></div>');
c.push("</div>");c.push('<div class="ewa-slider-puzzle-handle">');c.push('<span class="ewa-slider-puzzle-swiper"></span>');c.push('<span class="ewa-slider-puzzle-text"></span>');c.push("</div>");c.push("</div>");var d,e,g,h=/iphone|android|ipad/ig.test(navigator.userAgent)||window.EWA_App,k;EWA.UI.SlidePuzzle=function(l,m,n,p){g=l;d=n;e=p;m=$(m||"body");m.append(c.join(""));k=m[0].ownerDocument.defaultView;m=k.$(".ewa-slider-puzzle-refresh");k.$(".ewa-slider-puzzle-box").css("width",l.imgBigWidth);
b(l);m.click(function(r){r.stopPropagation();r=new EWA_UrlClass(g.ewa_url);r.AddParameter("ewa_trigger_valid_mode","refresh");r.AddParameter("ewa_trigger_valid_name",g.ewa_trigger_valid_name);r.AddParameter("ewa_ajax",g.ewa_trigger_valid);r.AddParameter("ewa_trigger_valid_width",document.documentElement.clientWidth);$J(r,function(q){q.RST?(q.ewa_trigger_valid_name=g.ewa_trigger_valid_name,q.ewa_trigger_valid=g.ewa_trigger_valid,q.ewa_url=g.ewa_url,g=q,b(g)):alert(q.ERR)})});a()}})();
typeof EWA=="undefined"&&(EWA={});
EWA.F={FOS:{},GetFOSOne:function(){for(var a in EWA.F.FOS)return EWA.F.FOS[a]},getSubEwas:function(a){var b=[];$(a||document.body).find(".EWA_TABLE, .ewa-tree").each(function(){var c=$(this).attr("id");c&&(c=c.replace("EWA_FRAME_","").replace("EWA_LF_","").replace("EWA_TREE_",""),(c=EWA.F.FOS[c])&&b.push(c))});return b},U:{WND:null},Cmd:function(){this.EWA_ACTION=null;this.EWA_NO_CONTENT=this.EWA_AJAX="1";this.EWA_TREE_TEXT=this.EWA_TREE_PARENT_KEY=this.EWA_TREE_KEY=null;this.EWA_AFTER_EVENT=""},
Install:function(a,b,c,d,e){b=(window.EWA_CGI?window.EWA_CGI:EWA.CP+"/EWA_STYLE/cgi-bin/")+"?xmlName="+b+"&itemName="+c+"&EWA_FRAMESET_NO=1&EWA_AJAX=INSTALL&"+d;(new EWA.C.Ajax).Install(b,"_r=1",a,e)},InstallHtml:function(a,b,c){var d=$X(a);if(d==null)alert("Object ["+a+"] not found");else{d.innerHTML=b;try{EWA.C.Utils.JsRegisters(rst)}catch(e){console.log(e)}if(c!=null)try{c(a)}catch(e){console.log(e)}}},replaceXmlName:function(a,b){a=a.unURL().replace(/\|/ig,"/").split("/");let c=[];for(let d=0;d<
a.length-1;d++){let e=a[d];e!==""&&c.push(e)}c.push(b);return c.join("/")}};
EWA.F.POP={AJAX:null,PostBehavior:function(a,b,c){var d=EWA.F.FOS[a];if(d==null)alert("Object EWA.F.FOS."+a+" not exists!");else if(d=d.Url==null?d._Url:d.Url,d==null)alert("Object EWA.F.FOS."+a+".Url not exists!");else{a="EWA_AJAX=1&EWA_NO_CONTENT=1&EWA_ACTION="+c;if(b!=null)for(c=0;c<b.length;c+=1){var e=b[c].Name,g=b[c].Value;e!=null&&e!=""&&g!=null&&g!=""&&(g=encodeURIComponent(g),a=a+"&"+e+"="+g)}EWA.F.POP.AJAX=new EWA.C.Ajax;EWA.F.POP.AJAX.LoadingType="image";EWA.F.POP.AJAX.Post(d,a,EWA.F.POP.CallBack)}},
CallBack:function(){var a=EWA.F.POP.AJAX;if(a._Http.readyState==4)if(a.HiddenWaitting(),a._Http.status==200){if(a=a._Http.responseText,EWA.F.CheckCallBack(a))try{eval(a)}catch(b){alert(a)}}else alert("ERROR:\r\n"+a._Http.statusText)}};EWA.F.CheckCallBack=function(a){return a.indexOf("\x3c!--EWA_ERROR_INFOMATION--\x3e")>=0?(EWA.SHOW_ERROR==1&&$DialogHtml(a,"ERROR","90vw","90vh"),!1):!0};EWA.F.ST={};
EWA.F.ST.SaveStatus=function(a,b){var c=EWA.CP+"/EWA_STYLE/cgi-bin/_st_/";c=c.replace("//","/");var d=new EWA.C.Ajax;d.AddParameter("U",document.location.href);d.AddParameter("T",b);d.AddParameter("V",a);d.AddParameter("M","1");d.PostNew(c,function(){});d.HiddenWaitting()};
EWA.F.ST.GetStatus=function(a,b){var c=EWA.CP+"/EWA_STYLE/cgi-bin/_st_/";c=c.replace("//","/");EWA.F.ST.Ajax=new EWA.C.Ajax;EWA.F.ST.Ajax.AddParameter("U",document.location.href);EWA.F.ST.Ajax.AddParameter("T",a);EWA.F.ST.Ajax.AddParameter("M","0");EWA.F.ST.Ajax.FrameClass=b;EWA.F.ST.Ajax.PostNew(c,EWA.F.GetStatusCallBack)};
EWA.F.GetStatusCallBack=function(){var a=EWA.F.ST.Ajax;a._Http.readyState==4&&(a.HiddenWaitting(),a._Http.status==200?(eval(a._Http.responseText),a.FrameClass.LoadStatus()):alert("ERROR:\r\n"+a._Http.statusText),EWA.F.ST.Ajax=null)};
EWA.F.Ajax={TIMER_ID:null,AJAX_LIST:[],_GetId:function(a){var b=this.AJAX_LIST.length;this.AJAX_LIST[b]=a;return b},_StartMonitor:function(){this.TIMER_ID==null&&(this.TIMER_ID=window.setInterval(this._Moninter,100))},_Moninter:function(){for(var a=!0,b=0;b<EWA.F.Ajax.AJAX_LIST.length;b++){var c=EWA.F.Ajax.AJAX_LIST[b];c==null||c.isStop||EWA.F.Ajax._CallBack(c)||(a=!1)}a&&(window.clearInterval(EWA.F.Ajax.TIMER_ID),EWA.F.Ajax.TIMER_ID=null)},_CallBack:function(a){var b=a.ajax;if(b._Http.readyState!=
4)return!1;a.isStop=!0;b.HiddenWaitting();a.ret=b._Http.status==200?b._Http.responseText:"ERROR:\r\n"+b._Http.statusText;a.ReplaceObject();return!0},Install:function(a,b){this.replaceId=b;this.CLASS_NAME="EWA.F.Ajax.Install";this.ajax=new EWA.C.Ajax;this.ret=null;this.isStop=!0;this.id=EWA.F.Ajax._GetId(this);this.ajax.Get(a,function(){});this.isStop=!1;EWA.F.Ajax._StartMonitor();this.ReplaceObject=function(){$X(this.replaceId).innerHTML=this.ret;this.AddScripts()};this.AddScripts=function(){var c=
this.ret.match(/<script(.|\n|\r)*?>(.|\n|\r)*?<\/script(.|\n|\r)*?>/ig);if(c!=null)for(var d=document.getElementsByTagName("head")[0]||document.documentElement,e=0;e<c.length;e++){var g=c[e];g=g.replace(/<script(.|\n|\r)*?>/ig,"").replace(/<\/script(.|\n|\r)*?>/ig,"").trim();if(g.length!=0)try{var h=document.createElement("script");h.type="text/javascript";EWA.B.IE?h.text=g:h.appendChild(document.createTextNode(g));d.insertBefore(h,d.firstChild);d.removeChild(h)}catch(k){}}}}};
EWA.F.U.Upload=function(a,b,c){var d=new EWA.UI.Dialog.CMD;d.CmdArgus[0]=c;d.CmdArgus[1]="UPFILE";EWA.UI.Dialog.OpenWindow(EWA.CP+"/EWA_STYLE/cgi-bin/_up_/?xmlName="+a+"&ITEMNAME="+b+"&FROMITEM="+c.id,"upfile",420,310,!1,null,d)};EWA.F.Tip=function(a){var b=_EWA_INFO_MSG[a];b==null&&(b=a);b!=null&&b.trim()!=""&&alert(b)};EWA.F.I={};
EWA.F.I.DropList=function(a){EWA.F.FOS[a.id]==null&&(EWA.F.FOS[a.id]=new EWA_FrameItemClass);EWA.F.FOS[a.id].DropList(a);$(a).next().val("");a.getAttribute("_check_blank")||(a.setAttribute("_check_blank","haha"),addEvent(a,"blur",function(){if($(this).next().val()==""){this.value="";var b=$(this).next().attr("afterevent");if(b)if(window[b])window[b]("","",$(this).next()[0],this);else try{eval(b)("","",$(this).next()[0],this)}catch(c){console.log(c)}}}))};
EWA.F.I.Date=function(a,b){EWA.F.FOS[a.id]=new EWA.UI.Calendar.Pop(a,b)};function EWA_Parameters(){this.ParaNames=[];this.ParaValues=[];this.Add=function(a,b){a!=null&&a.trim()!=""&&(this.ParaNames[this.ParaNames.length]=a.trim(),this.ParaValues[this.ParaValues.length]=b)};this.GetString=function(){for(var a="",b=0;b<this.ParaNames.length;b=1+b)a.length>0&&(a+="&"),a+=encodeURIComponent(this.ParaValues[b]);return a}}
function EWA_FrameInstallClass(a,b,c,d){this.Xml=new EWA.C.Xml;this.XmlName=b;this.ItemName=c;this.Parameters=d;this.Install=function(e){e==null&&(e=this.GetUrl());this.Xml.LoadXmlFile(e);var g=this.Xml.GetElement("FrameData"),h=this.Xml.GetElementAttribute(g,"Type"),k=this.Xml.GetElementAttribute(g,"ClassName");g=this.Xml.GetElement("Css",g);g=this.Xml.GetElementText(g);document.write(g);h.toUpperCase()=="TREE"&&(e=new EWA.F.T.C(a,k,e),eval(k+"=c"),EWA.F.FOS[k]=e,e.CreateByXml(this.Xml))};this.GetUrl=
function(){var e=EWA.CP+"/EWA_STYLE/cgi-bin/?XMLNAME=";e+=this.XmlName.toURL()+"&ITEMNAME="+this.ItemName.toURL();e+="&EWA_AJAX=XML";this.Parameters!=null&&(e+="&"+this.Parameters.GetString());return e}}
function EWA_FrameCommonItems(){this._ClassXml=null;this.Items={};this._EWA_JS_ALERT_DEFAULT={MaxMinLength:"\u957f\u5ea6\u5e94\u5728{MinLength}-{MaxLength}\u4e4b\u95f4 ",MaxMinValue:"\u503c\u5e94\u5728({MinValue} - {MaxValue})\u4e4b\u95f4",IsMustInput:"*"};this.Init=function(a){this._ClassXml=a;a=a.GetElements("root/XItem");var b=!1;if(this.F){var c=new EWA_UrlClass;c.SetUrl(this.F.Url);c.GetParameter("EWA_MTYPE")=="M"&&(b=!0)}for(c=0;c<a.length;c++){var d=this.GetItemValue(a[c],"Name","Name"),e=
d.toUpperCase(),g=a[c];this.Items[e]=g;var h=this.GetItemValue(g,"DataItem","Valid");h&&h.toUpperCase()=="MOBILE"?EWA.UI.Ext.Mobile($X(e)):h&&h.toUpperCase()=="IDCARD"&&EWA.UI.Ext.IdCard($X(e));b&&this.disableOnModify(g,d)}};this.disableOnModify=function(a,b){(a=this.GetItemValue(a,"DataItem","DisableOnModify"))&&a.toUpperCase()=="YES"&&(b=$X(b))&&(b.setAttribute("disabled","disabled"),b.getAttribute("DlsShow")&&$(b).prev().attr("disabled","disabled"))};this.GetItem=function(a){a=a.toUpperCase().trim();
return this.Items[a]};this.GetItemValue=function(a,b,c){if(a==null)return null;a=this._ClassXml.GetElement(b+"/Set",a);return a==null?null:a.getAttribute(c)};this.GetDescription=function(a){a=$(this.GetItem(a)).find("DescriptionSet Set[Lang="+EWA.LANG+"]");return{Info:a.attr("Info"),Memo:a.attr("Memo")}};this.GetValue=function(a,b,c){a=this.GetItem(a);return this.GetItemValue(a,b,c)};this.CheckValid=function(a,b){if(a.tagName=="SPAN"||a.tagName=="IMG")return!0;var c=this.GetItem(a.id),d=[],e=this._CheckMustInput(a,
b,c);e&&d.push(e);if(b==null||b==""){if(d.length==0)return EWA_FrameRemoveAlert(a),!0;EWA_FrameShowAlert(a,d.join(", "));return!1}(e=this._CheckMaxMinLength(a,b,c))&&d.push(e);(e=this._CheckDataValid(a,b,c))&&d.push(e);(e=this._CheckDataType(a,b,c))&&d.push(e);(e=this._CheckMaxMinValue(a,b,c))&&d.push(e);(e=this._CheckPassword(a,b,c))&&d.push(e);(e=this._CheckExtent(a,b,c))&&d.push(e);if(d.length==0)return EWA_FrameRemoveAlert(a),!0;EWA_FrameShowAlert(a,d.join(", "));return!1};this._CheckExtent=function(a,
b,c){b=null;a=a.getAttribute("EWA_VALID_EX");a=a==null?"":a;a.length>0&&(b=a);return b};this._CheckDataType=function(a,b,c){if(b==null||b.trim()=="")return null;c=null;this.isNumber(a)&&(a=b.replace(/,/ig,""),isNaN(a)&&(c=_EWA_INFO_MSG["EWA.SYS.INVALID_NUMBER_FORMAT"]));return c};this._CheckPassword=function(a,b,c){if(a.tagName.toLowerCase()!="input"||a.type.toLowerCase()!="password")return null;c=$("#USR_PWD").parentsUntil("form").last().find("input[type=password]");b=null;for(var d=a.id,e=0;e<c.length;e+=
1)if(c[e].type=="password"&&c[e]!=a&&c[e].id==d+"1"){b=c[e];break}c=null;b!=null&&(b.value!=a.value?(isok=!1,c=_EWA_INFO_MSG["EWA.F.PASSWORD"]):EWA_FrameRemoveAlert(b));return c};this._CheckMustInput=function(a,b,c){return this.GetItemValue(c,"IsMustInput","IsMustInput")!="1"||b!=null&&b.length>0||"hidden"==a.type&&"ht5upload"==$(a).attr("ewa_tag")&&$(a).parent().find(".ewa_app_upload_form1:visible").length>0?null:b=(b=_EWA_JS_ALERT.IsMustInput)?b.replace("{Name}",a.id):"*"};this._CheckMaxMinLength=
function(a,b,c){if(!b)return null;var d=this.GetItemValue(c,"MaxMinLength","MaxLength");c=this.GetItemValue(c,"MaxMinLength","MinLength");d=d==null?-1:parseInt(d);c=c==null?-1:parseInt(c);var e=!0;!isNaN(d)&&d>0&&b.length>d&&(e=!1);e&&!isNaN(c)&&c>0&&b.length<c&&(e=!1);b=null;e||(b=_EWA_JS_ALERT.MaxMinLength||this._EWA_JS_ALERT_DEFAULT.MaxMinLength,b=b.replace("{Name}",a.id),b=b.replace("{MaxLength}",d),b=b.replace("{MinLength}",c));return b};this._CheckDataValid=function(a,b,c){a=this.GetItemValue(c,
"DataItem","Valid");if(a==null||a.trim()=="")return"";if(b.length>0)return a=_EWA_VALIDS[a.toUpperCase().trim()],a==null?"":a.REGEX.test(b)?"":a.MSG};this._CheckMaxMinValue=function(a,b,c){a=this.GetItemValue(c,"MaxMinValue","MaxValue");c=this.GetItemValue(c,"MaxMinValue","MinValue");var d=a==null||a.trim()==""?null:a*1,e=c==null||c.trim()==""?null:c*1,g=!0;d!=null&&(g=b*1<=d?!0:!1);e!=null&&(g=b*1>=e?g&1:!1);if(g)return"";errorInfo=_EWA_JS_ALERT.MaxMinValue||this._EWA_JS_ALERT_DEFAULT.MaxMinValue;
errorInfo=errorInfo.replace("{MaxValue}",a);return errorInfo=errorInfo.replace("{MinValue}",c)};this.isNumber=function(a){if(!a)return null;a=(a=this.GetItem(a.id))?this.GetItemValue(a,"DataItem","DataType"):"";a=a==null?"":a.toUpperCase();return a=="NUMBER"||a=="INT"||a=="BIGINT"};this.isTrim=function(a){if(!a)return null;if($(a).attr("ewa_trim"))return!0;var b=this.GetItem(a.id);b=(b=b?this.GetItemValue(b,"DataItem","Trim"):"")?b.toUpperCase():"YES";if(b=b=="YES")$(a).attr("ewa_trim","yes").on("blur",
function(){this.value=this.value.trim()});return b};this.getFormat=function(a){return a?(a=this.GetItem(a.id))?this.GetItemValue(a,"DataItem","Format"):"":""};this.GetObjectValue=function(a){var b=a.tagName.toUpperCase(),c=a,d="";if(b=="DIV"&&$(a).hasClass("ewa-switch"))return a.getElementsByTagName("input")[0].checked?"on":"off";if(b=="DIV"&&a.getAttribute("TAG")=="REPT"){a=a.getElementsByTagName("input");for(var e=0;e<a.length;e+=1)a[e].checked&&(d.length>0&&(d+=","),d+=a[e].value);return d}if(b==
"DIV"&&a.getAttribute("EWA_DHTML")=="1")return d=a.getElementsByTagName("iframe")[0].contentWindow,b=d.document.getElementsByTagName("textarea"),d=b.length>0&&b[0].style.display!="none"?b[0].value:d.frames[0].document.body.innerHTML,location.search!=null&&location.search.toUpperCase().indexOf("EWA_DHTML_HOST")<0&&(e="http:\\/\\/"+eval("document.location.host")),e=eval("/"+e+"/ig"),d=d.replace(e,""),a=a.getElementsByTagName("input")[0],a.value=d,a.value;if(b=="SELECT")return d="",c.options.selectedIndex>=
0&&(d=c.options[c.options.selectedIndex].value),d;if(b=="TEXTAREA"&&c.style.display=="none")return a.value;if(b=="INPUT"&&c.getAttribute("ewa_tag")=="IMG_UPLOAD")return d=EWA.CP!="/"?c.value.replace(EWA.CP,""):c.value,d=d.replace("//","/");if(b=="INPUT"&&c.getAttribute("val_ref")){a=c.getAttribute("val_ref");try{d=eval("(function(){var a="+a+";return a;})()")}catch(g){console.log(a),console.log(g),d=""}return d}if(b=="INPUT"&&(c.type=="checkbox"||c.type=="radio"))return d=c.checked?c.value:"";(d=
c.value)&&this.isTrim(a)&&(e=d.trim(),e!==d&&(d=e));if(b!=="INPUT"||!this.isNumber(a))return d;if(d!==""&&d!=="-"&&d!=="."){if(isNaN(d)&&(d=d.replace(/,/ig,""),isNaN(d)))try{d=EWA_Utils.chineseToNumber(d)+"",a.value=d}catch(g){return d}e=this.getFormat(a);if("LeastMoney"==e||"Money"==e)e=d.split("."),a.value=e.length==1?(d*1).fm(0):(d*1).fm(e[1].length)+(e[1].length==0?".":"");return d}}}function EWA_FrameResourceDescription(){this.Memo=this.Info=this.Lang=null}
function EWA_FrameResoure(){this.Name=null;this.Descriptions={};this.GetDescription=function(){var a=this.Descriptions[EWA.LANG];if(a==null)for(var b in this.Description)return this.Description[b];return a};this.GetInfo=function(){var a=this.GetDescription();return a==null?null:a.Info};this.GetMemo=function(){var a=this.GetDescription();return a==null?null:a.Memo}}
function EWA_FrameResoures(){this.Init=function(a){var b=a.GetElements("root/PageInfo");if(b!=null){for(var c=0;c<b.length;c+=1){var d=new EWA_FrameResoure;d.Name=b[c].getAttribute("Name");for(var e=a.GetElements("Set",b[c]),g=0;g<e.length;g++){var h=new EWA_FrameResourceDescription;h.Info=e[g].getAttribute("Info");h.Memo=e[g].getAttribute("Memo");h.Lang=e[g].getAttribute("Lang");d.Descriptions[h.Lang]=h}this[d.Name]=d}this.ReplaceResById();this.ReplaceRes()}};this.ReplaceResById=function(){for(var a in this){var b=
this[a],c=$X(a);c&&(c.tagName.toLowerCase()=="input"?c.value=b.GetInfo():c.innerHTML=b.GetInfo(),c.title=b.GetMemo())}};this.ReplaceRes=function(){var a=[];a.push(document.getElementsByTagName("div"));a.push(document.getElementsByTagName("span"));a.push(document.getElementsByTagName("input"));a.push(document.getElementsByTagName("button"));for(var b=0;b<a.length;b++)for(var c=a[b],d=0;d<c.length;d+=1){var e=c[d].getAttribute("res");if(e!=null&&(e=e.trim(),e.indexOf("EWA.F.FOS")==0&&(e.indexOf(".Resources.")>
0||e.indexOf(".Resources[")>0))){var g="";try{g=eval(e)}catch(h){g=h.message}c[d].tagName=="INPUT"?c[d].value=g:c[d].innerHTML=g}}a.length=0}}
function EWA_FrameClass(){this._Ajax=this.Xml=null;this.ItemList=new EWA_FrameCommonItems;this.Resources={};this.doPostAfter=this._Id=this._ValidExObj=this._ValidExFail=this._ValidExOk=this.Url=null;this.isShowPostWaitting=!0;this.textareaAutoSize=function(){window.autosize?autosize(this.getObj("textarea").addClass("ewa-textarea-auto-size")):console.warn("autosize.js \u6ca1\u6709\u5f15\u5165\uff0c/third-party/autosize-master/dist/autosize.min.js")};this.getObj=function(a){var b=$("#EWA_FRAME_"+this._Id);
return a?b.find(a):b};this.switchButtonAction=function(a,b){if(b){var c=this.getUrlClass(),d={};d.ewa_switch_name=a.name;d.ewa_action=b;d.ewa_ajax="json";d.ewa_switch=a.checked?"on":"off";b=a.parentNode;var e=b.getAttributeNames();for(let h in e){let k=e[h],l=b.getAttribute(k);k.indexOf("on")!=0&&k!="name"&&k!="id"&&k!="class"&&(d[k]=l)}var g=this;c=c.GetUrl();$JP(c,d,function(h){g.extSwitchCallBack&&g.extSwitchCallBack(a,h)})}};this.setDisable=function(){var a=this.getObj();a.find("input,textarea,select,label").each(function(){this.disabled||
this.type=="hidden"||(this.disabled=!0,this.setAttribute("ewadisabled",1))});a.find(".EWA_DHTML").each(function(){if(this.tagName=="DIV")var b=$(this).find("iframe")[0].contentWindow,c=setInterval(function(){if(b.document.readyState=="complete"){window.clearInterval(c);b.frames[0].document.body.contentEditable=!1;b.frames[0].document.body.style.backgroundColor="#eee";var e=b.document.getElementsByClassName("but")[0];e.style.pointerEvents="none";e.style.filter="grayscale(1) opacity(0.8)"}},300);else if(this.tagName==
"TEXTAREA"){var d=$(this).parent();c=setInterval(function(){var e=d.find("iframe");e.length>0&&(e=e[0].contentWindow)&&e.document.readyState=="complete"&&(window.clearInterval(c),e.document.body.contentEditable=!1,e.document.body.style.backgroundColor="#eee",d.find(".ewa-editor").attr("ewadisabled",1))},300)}})};this.setEnable=function(){var a=this.getObj();a.find("input,textarea,select,label").each(function(){this.disabled&&this.getAttribute("ewadisabled")&&(this.disabled=!1,this.removeAttribute("ewadisabled"))});
a.find(".EWA_DHTML").each(function(){if(this.tagName=="DIV"){var b=$(this).find("iframe")[0].contentWindow;b.frames[0].document.body.contentEditable=!0;b.frames[0].document.body.style.backgroundColor="";b=b.document.getElementsByClassName("but")[0];b.style.pointerEvents="";b.style.filter=""}else if(this.tagName=="TEXTAREA"){var c=$(this).parent();b=c.find("iframe")[0].contentWindow;b.document.body.contentEditable=!0;b.document.body.style.backgroundColor="";c.find(".ewa-editor").removeAttr("ewadisabled")}})};
this.convertFilterCheckbox=function(a,b,c,d,e,g){function h(u){var w=$("<nobr></nobr>");p.append(w);p.append(" ");var x=$(u).parent();u=$(u).attr("id")+"_"+r;x.attr("id",u);w.append(x.children());w.attr("ref_id",u)}function k(u){u=$(u).parent();var w=u.attr("ref_id");w&&($("#"+w).append(u.children()),u.remove())}var l={},m=this.getObj(".ewa-row-"+a),n=this.getObj(".ewa-row-"+b),p=$("<div class='ewa-filter-checked'></div>");m.find("#"+a).prepend(p).addClass("ewa-filter-chks");var r=this._Id;c||(c=
"PY");m.find("input[type=checkbox]").each(function(){var u=JSON.parse($(this).attr("json"))[c];u&&(u=u.toUpperCase().trim().substring(0,1),l[u]||(l[u]=[]),l[u].push(this.id),this.checked&&h(this),$(this).on("change",function(){this.checked?h(this):k(this)}))});a="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");b=["<a class='ewa-filter-char ewa-filter-char-all' code=''>ALL</a>"];for(var q in a){var t=a[q],v=l[t];v&&b.push("<a class='ewa-filter-char' code='"+t+"'>"+t+"<span class='ewa-filter-char-num'>("+v.length+
")</span></a>")}n.find(".EWA_TD_M").html(b.join(" "));d&&(m.find(".EWA_TD_L").hide(),m.find(".EWA_TD_M").attr("colspan",2));n.find("a.ewa-filter-char").on("click",function(){var u=$(this).attr("code");m.find("input[type=checkbox]").each(function(){u?this.checked?p.append($(this).parent()):($(this).parent().attr("ref_id")&&k(this),$(this).parent().hide()):$(this).parent().show()});if(u){for(var w=l[u],x=0;x<w.length;x++)m.find("#"+w[x]).parent().show();g&&g(this,m,n)}});e&&e(m,n)};this.createFilterCheckbox=
function(a,b,c,d,e,g,h){var k=this;$J(d,function(l){k.createFilterCheckboxByData(a,b,c,l,e,g,h)})};this.createFilterCheckboxByData=function(a,b,c,d,e,g,h){var k={},l=l?"[]":c.split(",");c={};for(var m in l)c[l[m]]=1;l=[];var n=[],p=a.id;for(m in d){var r=d[m],q=r[e];q&&(q=q.replace(/</ig,"&lt;"));var t=r[g];t&&(t=t.replace(/</ig,"&lt;"));var v=r[h],u=c[q],w=[];w.push("<nobr class='ewa-filter-chk' style='float:left;margin-right:4px'>");w.push('<input class="ewa-filter-chkbox" type="checkbox" ');u&&
w.push(" checked ");r=p+"_"+m;w.push(' value="'+q+'" id="'+r+'" name="'+p+'"><label ');w.push(' for="'+r+'">'+t+"</label></nobr>");u?n.push(w.join("")):l.push(w.join(""));b&&(q=v?v.substring(0,1).toUpperCase():"",k[q]||(k[q]=[]),k[q].push(r))}a.innerHTML=n.join(" ")+" "+l.join(" ");if(b){d=['<a href="javascript:void(0)">ALL</a>'];for(m="A".charCodeAt();m<="Z".charCodeAt();m++)e=String.fromCharCode(m),k[e]&&d.push('<a href="javascript:void(0)">'+e+"</a>");b.innerHTML=d.join(" ");$(b).find("a").each(function(){var x=
$(this).text();x!="ALL"&&$(this).attr("ids",k[x].join(","));$(this).on("click",function(){if($(this).text()=="ALL")$(a).find("nobr.ewa-filter-chk").show();else{var y=$(this).attr("ids").split(","),z={},A;for(A in y)z[y[A]]=1;$(a).find("input.ewa-filter-chkbox").each(function(){this.checked||z[this.id]?$(this).parent().show():$(this).parent().hide()})}})})}};this.hiddenNoContentRow=function(){let a=this.getObj();this.getObj(".EWA_TD_M").each(function(){if($(this).text()==""&&$(this).find("img,a,input[type=text],input[type=button],textarea").length==
0){$(this).parent().hide();var b=$(this).find("*:eq(0)").attr("id");b&&a.find(".ewa-row-"+b).hide().attr("hiddennocontentrow",1)}})};this.itemReload=function(a,b,c){if(a){var d=new EWA_UrlClass(this.Url);d.AddParameter("EWA_AJAX","SELECT_RELOAD");d.AddParameter("EWA_RELOAD_ID",a);this.getObj("input,select").each(function(){this.name!=a&&this.value.length<100&&d.AddParameter(this.name,this.value)});var e=d.GetUrl(),g=this.getObj("#"+a)[0],h={};for(let k=0;k<g.options.length;k++)h[g.options[k].value]=
1;$J(e,function(k){if(k.RST){var l=k.ITEM.LST;g.options.length=0;var m=[],n;for(n in l){var p=l[n];if(!p.V||!h[p.V]){var r=new Option(p.T,p.V);p.json&&$(r).attr("json",p.json);g.options[g.options.length]=r;m.push(r);p._used=!0}}for(n in l)p=l[n],p._used||(r=new Option(p.T,p.V),p.json&&$(r).attr("json",p.json),g.options[g.options.length]=r);if(b)g.value=b;else for(let q in m)if(m[q].value){g.value=m[q].value;break}if(c)try{c(k,g)}catch(q){console.log(q)}}else $Tip(k.ERR)})}};this._checkSelectOptionsChange=
function(){if(this._SelectFilters){var a=this;this.isSelectFilter&&setTimeout(function(){a._checkSelectOptionsChange()},311);for(var b in this._SelectFilters){var c=this._SelectFilters[b];this.getObj("#"+c.id).html()!=c.html&&a._selectOptionsChangeed(c)}setTimeout(function(){a._checkSelectOptionsChange()},311)}};this._selectOptionsChangeed=function(a){var b=this.getObj("select#"+a.id),c="initSelectFilter"+this._Id+"-"+a.id+"-filter",d="initSelectFilter"+this._Id+"-"+a.id+"-filter2",e=this._initSelectFilterCreateCode(a.codeJsonFrom||
a.filterFrom,b);this.getObj("#"+c).html(e);this.getObj("#"+d).html("");a.html=b.html()};this._initSelectFilterCreateCode=function(a,b){var c=["<option value=''>-ALL-</option>"];if(a){var d={},e=[];b.find("option").each(function(){if(this.value!=""){var k;this.hasAttribute("para_"+a)?k=this.getAttribute("para_"+a):this.getAttribute("json")&&(k=JSON.parse(this.getAttribute("json"))[a]);k&&(d[k]?d[k]+=1:(d[k]=1,e.push(k)))}});var g=e.sort(),h;for(h in g)b=g[h],b=b.replace(/>/ig,"&lt;").replace(/"/,"&quot;"),
c.push('<option value="'+b+'">'+b+" ["+d[b]+"]</option>")}else for(h="A".charCodeAt();h<="Z".charCodeAt();h++)b=String.fromCharCode(h),c.push('<option value="'+b+'">'+b+"</option>");return c.join("")};this.initSelectFilter=function(a,b,c,d){if(!this["INIT_SELECT_FILTER"+a]){this["INIT_SELECT_FILTER"+a]=!0;var e=this.getObj("select#"+a),g=e.parent(),h="initSelectFilter"+this._Id+"-"+a+"-filter",k="initSelectFilter"+this._Id+"-"+a+"-filter2",l="initSelectFilter"+this._Id+"-"+a+"-filter-table";$X(l)&&
(g.append(e),$($X(l)).remove());g.addClass("ewa-select-filter");h=["<table id='"+l+"' cellpadding=0 cellspacing=0 width=100%><tr><td class='ewa-select-filter-char'><select class='EWA_SELECT' style='margin-right:4px' id='"+h+"' onchange='EWA.F.FOS[\""+this._Id+'"]._chCode(this,"'+b+'","'+c+"\")'>"];l=this._initSelectFilterCreateCode(d||c,e);h.push(l);h.push("</select><select id='"+k+"' style='display:none'></select></td><td class='ewa-select-filter-target'></td></tr></table>");g.prepend(h.join(""));
g.find(".ewa-select-filter-target").append(e);this._SelectFilters||(this._SelectFilters={});g={};g.html=e.html();g.id=a;g.filterType=b;g.filterFrom=c;g.codeJsonFrom=d;this._SelectFilters[g.id]=g}};this._chCode=function(a,b,c){this.isSelectFilter=!0;var d=$(a).next(),e=$(a).parent().parent().find(".ewa-select-filter-target select");d[0].options.length==0&&d.html(e.html());if(a.value=="")e.html(d.html());else{for(var g=["<option></option>"],h=1;h<d[0].options.length;h++){var k=d[0].options[h];this._chCodeFilter(k,
b,c,a.value)&&g.push(GetOuterHTML(k))}e.html(g.join(""));this._SelectFilters[e[0].id].html=e.html();this.isSelectFilter=!1}};this._chCodeFilter=function(a,b,c,d){b=="json"?(a=JSON.parse(a.getAttribute("json"))[c],c=="ADM_LID"&&(c=a.split("."),a=c[c.length-1])):a=b=="text"?a.text:a.value;return a?a.substring(0,d.length).toUpperCase()==d.toUpperCase()?!0:!1:!1};this.setUnMust=function(a){(a=this.ItemList.Items[a.toUpperCase()])&&a.getElementsByTagName("IsMustInput")[0].getElementsByTagName("Set")[0].setAttribute("IsMustInput",
0)};this.setMust=function(a){(a=this.ItemList.Items[a.toUpperCase()])&&a.getElementsByTagName("IsMustInput")[0].getElementsByTagName("Set")[0].setAttribute("IsMustInput",1)};this.RedrawCreateSpans=function(){for(var a=this.getObj("tr"),b=0;b<a.length;b++){var c=a[b];if(c.style.display!="none")for(var d=0,e=!1,g=c.cells.length-1;g>=0;g--){var h=c.cells[g];h.style.display=="none"?e?d++:(d=1,e=!0):e&&(h.colSpan=d+1,e=!1)}}EWA_FrameShowAlert=EWA_FrameShowAlert1;EWA_FrameRemoveAlert=EWA_FrameRemoveAlert1;
this.getObj(".ewa_d1").each(function(){this.title=this.innerHTML});for(var k in this.ItemList.Items)a=this.GetItemDescription(k).Memo,a!=null&&a.trim().length>0&&(this.getObj("#"+k).attr("placeHolder",a),this.getObj("#"+k).attr("title",a));this.RedrawChangWidth()};this.GetItemDescription=function(a){return this.ItemList.GetDescription(a)};this.ShowPlaceHolder=function(a){this.getObj().addClass("ewa-frame-cols-"+a);for(var b in this.ItemList.Items){var c=this.ItemList.GetValue(b,"Name","Name");if(c=
this.GetObject(c)){c=$(c);var d=this.GetItemDescription(b),e=d.Memo;d=d.Info;var g=null;a==1||c.parent().attr("colspan")?(g=d,e&&e!=g&&(g=c.attr("ewa_tag")=="smsValid"?e:g+(", "+e)),c.hasClass("ewa-switch")&&c.prepend("<div class='ewa-switch-info'>"+g+"</div>")):a==2&&e!=null&&e.trim().length>0&&(g=e);g&&(c[0].type=="hidden"?c.prev().attr("placeholder",g):c[0].tagName=="SELECT"?c[0].options.length>0&&c[0].options[0].value==""&&(c[0].options[0].text="-- "+g+" --",c[0].options[0].value=""):(c.attr("placeHolder",
g),c.attr("title",g)))}}};this.RedrawChangWidth=function(){let a=this.getObj(),b=a.width(),c=a.find(".ewa_msg_box")[0].colSpan/2;$("#EWA_FRAME_"+this._Id+">tbody>tr[class*='ewa-row-']:not('.ewa-row-msg-box')").each(function(){let e=$(this).find("td.ewa_redraw_info:visible").length,g=(b-90*e)/c;$(this).find("td.ewa_redraw_ctl:visible").each(function(){let h=this.colSpan||1;$(this).css("width",g*h)})});var d=this;addEvent(window,"size",function(){d.RedrawChangWidth()})};this.Mearge=function(a,b,c){console.log("\u62fc\u5199\u9519\u8bef\uff1a\u8bf7\u7528 Merge");
this.Merge(a,b,c)};this.Merge=function(a,b,c,d){this.merges(b,[b,a],c,d)};this.merges=function(a,b,c,d){if(a&&b&&b.length!=0){typeof b=="string"&&(b=b.split(","));var e=[];e.push("<table class='ewa-merge-table' cellpadding=0 cellpadding=0><tr>");for(let g=0;g<b.length;g++){let h=(b[g]+"").trim();e.push(`<td class='ewa-merge-td ${g===0?"ewa-merge-td-first ":""}
				${g===b.length-1?"ewa-merge-td-last ":""}
			'>@@${h}</td>`)}e.push("</tr></table>");this.MergeExp(a,e.join(""),c,d)}};this.MergeExp=function(a,b,c,d){if(b){var e=b.match(/@@[a-zA-Z0-9\-\._:]*\b/ig),g=[],h=b;b={};for(var k=this.getObj(),l=0;l<e.length;l++){var m=e[l];g.push(m);var n=m.replace("@@","");let r=k.find(".ewa-row-"+n),q="<span class='ewa-row-merge "+(r.hasClass("ewa-row-must")?"ewa-row-must":"")+" ewa-row-merge-"+n+"' mid=\""+n+'"></span>';h=h.replace(m,q);n!=a&&r.hide().addClass("ewa-row-merge-hide").attr("hiddennocontentrow",
1);b[n]=this.GetItemDescription(n).Info}e=document.createElement("div");e.style.display="none";e.innerHTML=h;document.body.appendChild(e);m=k.find('[id="'+a+'"]');if(m.length==0)console.log("not find "+a);else{a=m.parent();for(var p in g)if(m=g[p].replace("@@",""),h=k.find('[id="'+m+'"]'),h.length==0)console.log("not found [id="+m+"]");else if(l=$(e).find('span[mid="'+m+'"]'),"placeholder"==c?h.attr("placeholder",b[m]):c&&(l.append("<span class='ewa-row-merge-memo'></span>"),l.find(".ewa-row-merge-memo").text(b[m])),
m=k.find(".ewa-row-"+m+" .EWA_TD_M"),m.length==0)l.append(h);else for(;m[0].childNodes.length>0;)l.append(m[0].childNodes[0]);for(;e.childNodes.length>0;)a.append(e.childNodes[0]);$(e).remove();d&&d(a)}}else console.log("mergeExp \u6ca1\u6709\u8bbe\u7f6e")};this.MergeItems=function(){for(var a in this.MeargeMap){var b=this.MeargeMap[a],c=$X("_ewa_tr$"+a);if(c){for(var d=c.cells.length,e=$(c.cells[0]);c.cells.length>1;)e.append(c.cells[1].innerHTML),c.removeChild(c.cells[1]);c.cells[0].colSpan=d;c=
[];for(d=0;d<b.length;d++){for(var g=$X("_ewa_tr$"+b[d]),h=["<nobr>"],k=0;k<g.cells.length;k++)h.push(g.cells[k].innerHTML);h.push("</nobr>");c.push(h.join(" "));g.parentNode.removeChild(g)}e.append(c.join(" "))}}};this.LoadJson=function(a,b){a!=null&&$J(this.Url+"&EWA_ACTION="+a+"&EWA_AJAX=JSON",b)};this.DoAction=function(a,b,c,d,e,g){EWA.F.CID=this._Id;if(b!=null&&b.trim()!=""){if(c!=null&&c.trim().length>0)if(a=_EWA_INFO_MSG[c],a!=null&&a!=""){if(!window.confirm(a))return}else if(!window.confirm(c))return;
this.DoPostBefore();this._Ajax=this.CreateAjax(null,!0);this._Ajax.LoadingType="image";this._Ajax.AddParameter("EWA_AJAX","1");this._Ajax.AddParameter("EWA_ACTION",b);this._Ajax.AddParameter("EWA_ID",this._Id);this._Ajax.AddParameter("EWA_NO_CONTENT","1");this._Ajax.AddParameter("EWA_ACTION_TIP",d);g!=null&&g.trim().length>0?(this._Ajax.AddParameter("EWA_AFTER_EVENT",g),this.StopAjaxAfterReload=!0,this._Ajax.AddParameter("EWA_ACTION_RELOAD","0")):this.StopAjaxAfterReload=!1;if(e!=null&&e.length>0)for(b=
0;b<e.length;b+=1)this._Ajax.AddParameter(e[b].Name,e[b].Value);e=new EWA.C.Url;e.SetUrl(this.Url);e=e.RemoveParameter("EWA_ACTION");this._Ajax.PostNew(e,EWA.F.FOS[EWA.F.CID]._CallBackJs)}};this.GuideShowCreate=function(a){this._GroupInfos=a;var b=$X("EWA_FRAME_"+this._Id);a=a.length-1;b.setAttribute("EWA_GUIDE_IDX","0");b.setAttribute("EWA_GUIDE_IDX_MAX",a);b.rows[b.rows.length-1].style.display="none";b.clientHeight>100&&(b.parentNode.style.height=b.clientHeight+"px");a=document.createElement("input");
a.id="ewa_but_"+Math.random();a.type="button";a.value=EWA.LANG=="enus"?"Back":"\u4e0a\u4e00\u6b65";a.style.display="none";a.onclick=function(){var h=b.getAttribute("EWA_GUIDE_IDX");if(h*1==0)$Tip("\u5230\u5934\u4e86");else{var k=b.id.replace("EWA_FRAME_","");EWA.F.FOS[k].GuidePrevBefore&&EWA.F.FOS[k].GuidePrevBefore(h,this,b);EWA.F.FOS[k].GuideShow(h*1-1);EWA.F.FOS[k].GuidePrevAfter&&EWA.F.FOS[k].GuidePrevAfter(h,this,b)}};var c=document.createElement("input");c.id="ewa_but_"+Math.random();c.type=
"submit";c.value=EWA.LANG=="enus"?"Next":"\u4e0b\u4e00\u6b65";c.onclick=function(){var h=b.getAttribute("EWA_GUIDE_IDX"),k=b.id.replace("EWA_FRAME_","");EWA.F.FOS[k].GuideShowCheck(h)&&(EWA.F.FOS[k].GuideNextBefore&&EWA.F.FOS[k].GuideNextBefore(h,this,b),this.getAttribute("ewa_guide_method")=="ok"?$F(b,"input","type","submit")[0].click():EWA.F.FOS[k].GuideShow(h*1+1),EWA.F.FOS[k].GuideNextAfter&&EWA.F.FOS[k].GuideNextAfter(h,this,b))};var d=b.parentNode.parentNode.parentNode.parentNode.parentNode,
e=d.insertRow(-1).insertCell(-1);e.appendChild(a);e.appendChild(c);e.className="EWA_FRAME_GROUP_BUTTONS";tdTitle=d.insertRow(0).insertCell(-1);d="ewa_title_"+Math.random();e=[];for(var g=0;g<this._GroupInfos.length;g++)e.push('<div style="float:left" id="ewa_'+this._Id+"_"+g+'">'+(g+1)+". "+this._GroupInfos[g].DES+"</div>");tdTitle.innerHTML="<div style='text-align:left'>"+e.join(" <div style='float:left;color:#aaa'>&nbsp;&gt;&nbsp;</div> ")+"</div><div id='"+d+"'></div>";tdTitle.className="EWA_FRAME_GROUP_TITLE";
b.setAttribute("EWA_GUIDE_ID_PREV",a.id);b.setAttribute("EWA_GUIDE_ID_NEXT",c.id);b.setAttribute("EWA_GUIDE_ID_TITLE",d);this.GuideShowTitle(0);a=document.createElement("div");b.clientHeight>100&&(a.style.width=b.clientWidth+"px",a.style.height=b.clientHeight+20+"px",a.style.overflow="auto");b.parentNode.appendChild(a);a.appendChild(b);b.parentNode.className="EWA_GROUP_GUIDE"};this.GuideShowTitle=function(a){for(var b=$X("EWA_FRAME_"+this._Id).getAttribute("EWA_GUIDE_IDX_MAX"),c=0;c<=b;c++){var d=
"ewa_"+this._Id+"_"+c;c==a?($X(d).style.color="blue",$X(d).style.borderBottom="2px solid green"):($X(d).style.color="green",$X(d).style.borderBottom="2px")}};this.GuideShowCheck=function(a){var b=!0,c=null,d;for(d in this.ItemList.Items){var e=this.ItemList.GetItemValue(this.ItemList.Items[d],"Name","Name");e=this.getObj("#"+e);if(e.length!=0){e=e[0];var g=this._GetTr(e);g!=null&&g.getAttribute("groupindex")==a&&((b&=this.CheckValid(e))||c!=null||(c=e))}}c!=null&&c.focus();return b};this._GetTr=function(a){for(var b=
0;b<100;){b++;a=a.parentNode;try{if(a.tagName.toUpperCase()=="TR"&&a.getAttribute("id")!=null&&a.getAttribute("id").indexOf("_ewa_tr$")==0)return a}catch(c){break}}return null};this.GuideShow=function(a){this.GuideShowTitle(a);var b=$X("EWA_FRAME_"+this._Id);if(b.getAttribute("EWA_GUIDE_IDX")!=a){var c=b.getAttribute("EWA_GUIDE_IDX_MAX"),d=b.getAttribute("EWA_GUIDE_ID_PREV"),e=b.getAttribute("EWA_GUIDE_ID_NEXT");a==c?($X(e).value=EWA.LANG=="enus"?"Confirm":"\u786e\u5b9a",$X(e).setAttribute("ewa_guide_method",
"ok")):($X(e).value=EWA.LANG=="enus"?"Next":"\u4e0b\u4e00\u6b65",$X(e).setAttribute("ewa_guide_method",""));a==0?$X(d).style.display="none":$X(d).style.display="";b.setAttribute("EWA_GUIDE_IDX",a);this._ShowHidenGroup(b,a)}};this._ShowHidenGroup=function(a,b){for(var c=0;c<a.rows.length-1;c++){var d=a.rows[c];if(d.getAttribute("groupIndex")!=null&&d.getAttribute("groupIndex")!=""){var e=d.getAttribute("groupIndex")*1;d.style.display=b==e?"":"none"}}};this.GroupShow=function(a,b){if(!(a.className.indexOf("1")>
0)){this.GroupShowBefore&&this.GroupShowBefore(a,b);for(var c=$X("EWA_FRAME_"+this._Id),d=a.parentNode.parentNode,e=0;e<c.rows.length;e++){var g=c.rows[e];if(g!=d&&!(g.cells.length==1&&g.cells[0].className&&g.cells[0].className.indexOf("EWA_TD_B")>=0)&&g.getAttribute("hiddennocontentrow")!="1"){var h=0;g.getAttribute("groupIndex")!=null&&g.getAttribute("groupIndex")!=""&&(h=g.getAttribute("groupIndex")*1);g.style.display=b==h?"":"none"}}c=d.getElementsByTagName("div");for(e=0;e<c.length;e++)d=c[e],
d.className=d==a?d.className+"1":d.className.replace("1","");this.GroupShowAfter&&this.GroupShowAfter(a,b)}};this.DoActionJSON=function(a,b,c,d){EWA.F.CID=this._Id;this._Ajax=new EWA.C.Ajax;this._Ajax.LoadingType="image";this._Ajax.AddParameter("EWA_AJAX","JSON");this._Ajax.AddParameter("EWA_ACTION",a);this._Ajax.AddParameter("EWA_ID",this._Id);this._Ajax.AddParameter("EWA_JSON_NAME",b);this._AjaxJsonAfter=d!=null?d:null;if(c!=null&&c.length>0)for(a=0;a<c.length;a+=1)this._Ajax.AddParameter(c[a].Name,
c[a].Value);c=new EWA.C.Url;c.SetUrl(this.Url);c=c.RemoveParameter("EWA_ACTION");this._Ajax.PostNew(c,EWA.F.FOS[EWA.F.CID]._CallBackJs)};this._CallBackJs=function(){var a=EWA.F.FOS[EWA.F.CID],b=a._Ajax;if(b._Http.readyState==4)if(b.HiddenWaitting(),b._Http.status==200){if(b=b._Http.responseText,EWA.F.CheckCallBack(b)){eval(b);a._AjaxJsonAfter&&(a._AjaxJsonAfter(),a._AjaxJsonAfter=null);try{a.ReloadAfter&&a.ReloadAfter(b)}catch(c){alert(b)}}}else alert("ERROR:\r\n"+b._Http.statusText)};this.RewriteInfo=
function(a,b,c,d,e){var g=$("this.getObj()_"+this._Id),h=[];b=b||"id";c=c||"info";d=d||"memo";for(var k=0;k<a.length;k++){var l=a[k],m=g.find("#"+l[b]);m.length!=0&&(m=m.parentsUntil("tr[show_msg]").last().parent(),l[c]==null||l[c].trim()==""?(m.hide(),e&&e(m[0],l,k)):m[0].cells.length==3?(h.push(m[0]),m[0].cells[2].innerHTML=l[d],m[0].cells[0].innerHTML=l[c],e&&e(m[0],l,k)):m[0].cells.length==2?(h.push(m[0]),m[0].cells[0].innerHTML=l[c],e&&e(m[0],l,k)):m[0].cells.length==1&&(m=m.prev(),m[0].cells.length>
1&&(m[0].cells[1].innerHTML=l[d]),h.push(m[0]),m[0].cells[0].innerHTML=l[c],e&&e(m[0],l,k)))}return h};this._HiddenMemo=function(a,b){var c=a.parentNode.parentNode;b=!1;c.style.display=="none"&&(b=!0);c.style.display="none";c.id="tr_"+a.id;c=c.previousSibling;c.nodeType==3&&(c=c.previousSibling);c.style.display="none";a="<span id=tab_"+a.id+' class="ewa_merge_tab" onclick="EWA.F.FOS[\''+this._Id+"'].ShowMemo(this.id);\">"+c.cells[0].innerHTML+"</span>";return b?"":a};this.ShowMemo=function(a){for(var b=
$X(this._Id+"__ewa_meger").getElementsByTagName("SPAN"),c=0;c<b.length;c++){var d=b[c].id.replace("tab_","tr_");b[c].className=="ewa_merge_tab1"&&(b[c].className="ewa_merge_tab",$X(d).style.display="none");b[c].id==a&&(b[c].className="ewa_merge_tab1",$X(d).style.display="")}};this.MergeMemo=function(){var a=$X("EWA_FRAME_"+this._Id).getElementsByTagName("textarea");if(a.length!=0&&a[0].getAttribute("ewa_merge")!="1"){for(var b=[],c=0;c<a.length;c++){var d=this._HiddenMemo(a[c]);d="<nobr>"+d.replace("\u2022 ",
"").trim()+"</nobr>";b.push(d)}a=a[0];c=a.parentNode.parentNode;d=c.previousSibling;d.nodeType==3&&(d=d.previousSibling);d.id=this._Id+"__ewa_meger";d.cells[0].colSpan=3;d.cells[0].innerHTML=b.join("");d.cells[0].style.width="100%";d.cells[0].style.height="25px";d.style.display="";c.style.display="";$X("tab_"+a.id).className="ewa_merge_tab1";window._EWA_DialogWnd!=null&&EWA.UI.Dialog._SetTitle(window._EWA_DialogWnd)}};this.DoValidEx=function(a,b,c,d,e,g){a.value!=""&&(this._ValidExOk=this.Resources[e],
this._ValidExFail=this.Resources[g],this._ValidExObj=a,b.toLowerCase().trim()=="action"?this._DoValidExAction(a,d,this.Resources[e].GetInfo(),this.Resources[g].GetInfo()):(c.indexOf("&quot;")>=0&&(c=c.replace(/&quot;/ig,'"')),eval(c)?(EWA_FrameShowAlert(a,this._ValidExOk.GetInfo()),a.setAttribute("EWA_VALID_EX","")):(EWA_FrameShowAlert(a,this._ValidExFail.GetInfo()),a.setAttribute("EWA_VALID_EX",this._ValidExFail.GetInfo()))))};this._DoValidExAction=function(a,b,c,d){if(a!=null&&!$(a).is(":hidden"))if(b==
null||b.trim()=="")alert("action not value");else{var e=a.id+","+a.value;if(this.DoValidExAction_RETS&&this.DoValidExAction_RETS[e]!=null)this.DoValidExAction_RETS[e]==0?(EWA_FrameRemoveAlert(a,c),a.setAttribute("EWA_VALID_EX","")):(EWA_FrameShowAlert(a,d),a.setAttribute("EWA_VALID_EX",d));else{var g=new EWA.C.Ajax;g.LoadingType="image";g.AddParameter("EWA_AJAX","HAVE_DATA");g.AddParameter("EWA_ACTION",b);g.AddParameter("EWA_ID",this._Id);g.AddParameter("EWA_NO_CONTENT","1");g.AddParameter(a.id,a.value);
this.DoValidExAction_RETS||(this.DoValidExAction_RETS={});var h=this;g.PostNew(this.Url,function(){if(g._Http.readyState==4){g.HiddenWaitting();if(g._Http.status==200){var k=g._Http.responseText;if(EWA.F.CheckCallBack(k))try{var l=parseInt(k.trim());h.DoValidExAction_RETS[e]=l;l==0?(EWA_FrameRemoveAlert(a,c),a.setAttribute("EWA_VALID_EX","")):(EWA_FrameShowAlert(a,d),a.setAttribute("EWA_VALID_EX",d))}catch(m){alert(m+","+k)}}else alert("ERROR:\r\n"+g._Http.statusText);g=null}})}}};this.ValidCodeError=
function(a){let b=this._t_ValidCodeError||0,c=(new Date).getTime();c-b<1E3?a||(a=_EWA_EVENT_MSG.ValidCodeError,$Tip(a),$(".ewa-valid-code-img").parent().parent().find("input").focus().select()):(this._t_ValidCodeError=c,$(".ewa-valid-code-img").each(function(){this.click()}),a||(a=_EWA_EVENT_MSG.ValidCodeError,$Tip(a),$(".ewa-valid-code-img").parent().parent().find("input").focus().select()))};this.checkIdempotenceError=function(){$Tip(_EWA_EVENT_MSG.IdempotanceError)};this.checkValidSildePuzzleError=
function(){$Tip(_EWA_EVENT_MSG.ValidSildePuzzleError)};this.Init=function(a){this.Xml=new EWA.C.Xml;this.Xml.LoadXml(a);this.ItemList.F=this;this.ItemList.Init(this.Xml);this.Resources=new EWA_FrameResoures;this.Resources.Init(this.Xml);EWA.LANG=="enus"&&$(".ewa-ipt-droplist").attr("placeholder","Input character selection");this._InitTranslations();this._GetDropListValue();this._InitMustInputs();this._InitEncyptions();this._InitTriggerValids()};this._InitTriggerValids=function(){var a=this.getObj(),
b="EWA.F.FOS['"+this._Id+"'].callTriggerValid(this)";this.triggerValids={};for(var c in this.ItemList.Items){var d=this.ItemList.Items[c],e=this.ItemList.GetItemValue(d,"Name","Name"),g=$(d).find("DataItem Set[TriggerValid]").attr("TriggerValid");if(g){this.triggerValids[e]=null;var h=a.find("#"+e);h.length===0&&contine;h.attr("ewa_trigger_valid",g);d=$(d).find("Tag Set").attr("Tag");if("submit"==d)break;if("smsValid"==d){h=a.find(".ewa-row-"+e+" .ewa-sms-valid-code-button");d=h.attr("id");d||(d=
EWA_Utils.tempId(),h.attr("id",d));let k=$("<a style='position:absolute;left:0;top:0;right:0;bottom:0'></a>");k.attr("ewa_trigger_valid",g);k.attr("ewa_trigger_valid_rid",e);k.attr("ewa_trigger_valid_click_id",d);h.parent().css("position","relative").append(k);h=k}(e=h.attr("onclick"))&&h.attr("_onclick",e);h.attr("onclick",b)}}};this.callTriggerValidBefore=function(a){return!0};this.callTriggerValid=function(a){if(this.callTriggerValidBefore(a)){var b=this.getObj(),c=$(a),d=c.attr("id");d||(d=c.attr("ewa_trigger_valid_rid"));
var e=this.getUrlClass(),g=c.attr("ewa_trigger_valid");e.AddParameter("ewa_ajax",g);e.AddParameter("ewa_trigger_valid_name",d);e.AddParameter("ewa_trigger_valid_mode","create");e.AddParameter("ewa_trigger_valid_width",document.documentElement.clientWidth);var h=this,k=EWA_Utils.tempId();$J(e.GetUrl(),function(l){if(l.RST){c.attr("_trigger_valid_id",k);var m=top.$DialogHtml("<div id='"+k+"'></div>",EWA.LANG=="enus"?"Silde puzzle":"\u62fc\u56fe\u9a8c\u8bc1",l.bigImgWidth+20,200,!1);$(m.getContent()).css("overflow",
"hidden");l.ewa_trigger_valid_name=d;l.ewa_trigger_valid=g;l.ewa_url=e.GetUrl();EWA.UI.SlidePuzzle(l,top.$("#"+k),function(n){console.log("2. puzzle cb true");let p=!1;c.attr("_onclick")&&(c.attr("onclick",$(a).attr("_onclick")),p=!0);setTimeout(function(){$(m.getMain()).animate({opacity:0},500)},500);setTimeout(function(){let r=c.attr("type");h.triggerValids[d]=n.VALID;let q=$(a).attr("ewa_trigger_valid_click_id");q?(c.remove(),console.log(q+".click"),b.find("#"+q).click()):p?(console.log("3. puzzle click"),
c.click()):"submit"==r&&console.log("3. puzzle submit");m.Close()},1E3)});setTimeout(()=>{m.AutoSize()},100)}else alert(l.ERR)})}};this._InitMustInputs=function(){var a=this.getObj(),b;for(b in this.ItemList.Items){var c=this.ItemList.Items[b],d=this.ItemList.GetItemValue(c,"Name","Name");$(c).find('IsMustInput Set[IsMustInput="1"]').length>0&&(c="#"+d,a.find(".ewa-row-"+d).addClass("ewa-row-must"),d=a.find(c),d.addClass("ewa-row-item-must"),d.length>0&&d.attr("type")&&d.attr("type").toLowerCase()==
"hidden"&&d.prev().addClass("ewa-row-item-must"))}};this._InitEncyptions=function(){var a=this.getObj(),b;for(b in this.ItemList.Items){var c=this.ItemList.Items[b],d=this.ItemList.GetItemValue(c,"Name","Name");c=$(c).find("DispEnc Set");if(c.length!=0&&(d=a.find("#"+d),d.length!=0&&c.attr("EncType"))){if(d[0].tagName=="INPUT"||d[0].tagName=="TEXTAREA"){if(!d.val())continue;d.prop("disabled",!0);d.attr("ewa_encyrption","yes")}var e=$("<div class='ewa-enc-cover' style='position:absolute;left:0;top:0;width:100%;height:100%;'><div></div></div>");
d.parent().append(e);d.parent().css("position","relative");if(c=c.attr("EncShowUrl")){e.find("div").html("\u70b9\u51fb\u67e5\u770b").css({position:"absolute",height:30,"line-height":"30px",top:"50%","margin-top":"-15px",right:10,"text-align":"right"});c=new EWA_UrlClass(c);e=new EWA_UrlClass(this.Url);for(var g in e._Paras)if(!c.GetParameter(g)){var h=e._Paras[g];h!=null&&(h=h.unURL());c.AddParameter(g,h)}c.AddParameter("EWA_ENCY_FROM_ID",d.attr("id"));c=c.GetUrl();d.parent().attr("enc_url",c).attr("fid",
d.attr("id"));d.parent().on("click",function(){if(!$(this).attr("enc_ok")){var k=$(this).attr("t")||100,l=(new Date).getTime();if(!(l-k<400)){$(this).attr("t",l);k=$(this).attr("enc_url");var m=$(this).find("#"+$(this).attr("fid"));$J(k,function(n){n.RST?(m.prop("disabled",!1),m.removeAttr("ewa_encyrption"),m.val(n.VALUE),$(m).parent().find(".ewa-enc-cover").remove(),$(m).parent().attr("enc_ok","1")):(n.ERR||n.MSG)&&$Tip(n.ERR||n.MSG)})}}})}}}};this._InitTranslations=function(){var a="EWA.F.FOS[&quot;"+
this._Id+"&quot;]._Trans(this)",b;for(b in this.ItemList.Items){var c=this.ItemList.Items[b],d=this.ItemList.GetItemValue(c,"Name","Name"),e=$(c).find("DataItem Set[Translation]");if(c=e.attr("Translation")){e=e.attr("TransTarget");var g=c=="en2zh"?" \u82f1\u8bd1\u4e2d":" \u4e2d\u8bd1\u82f1";EWA.LANG=="enus"&&(g=c=="en2zh"?" En-Zh":" Zh-En");c=$('<a class="ewa-but-trans" href="javascript:void(0)" onclick="'+a+'" _transf="'+d+'" _transp="'+c+'" _transt="'+e+'">'+g+"</a>");e=$("#EWA_FRAME_"+this._Id+
" .ewa-row-"+d+" .EWA_TD_L");e.length==0&&(e=$("#EWA_FRAME_"+this._Id+" .ewa-row-"+d+" .EWA_TD"));e.length==0&&(e=$("#EWA_FRAME_"+this._Id+" #"+d).parent().prev().find(".ewa_d1"));e.length==0&&(e=$("#EWA_FRAME_"+this._Id+" #"+d).parent(),e.css("position","relative"),c.addClass("ewa-but-trans-float"));e.append(c)}}};this._Trans=function(a){if(a){var b=$(a).attr("_transf"),c=$(a).attr("_transp");a=$(a).attr("_transt");b=$("#EWA_FRAME_"+this._Id+" #"+b);a=$("#EWA_FRAME_"+this._Id+" #"+a);if(b.length==
0||a.length==0)console.log("trans ex:",b,a);else{var d=b[0].tagName.toLowerCase();if(b=d=="input"||d=="textarea"||d=="hidden"?b.val():b.text()){var e=new EWA_TransClass;c=="en2zh"?e.transToCn(b,a[0]):e.transToEn(b,a[0]);$Tip(EWA.LANG=="enus"?"Translating...":"\u7ffb\u8bd1\u4e2d...",function(){return!e.IsRun})}}}};this._bindCompostion=function(a,b){if(!EWA.B.IE){var c=this;c._droplist_||(c._droplist_={});c._droplist_[b.id]={_is_composition:!1};$(a).on("compositionstart",function(){c._droplist_[b.id]._is_composition=
!0}).on("compositionend",function(){c._droplist_[b.id]._is_composition=!1;EWA.F.I.DropList(this)}).removeAttr("oninput").removeAttr("onkeyup").on("input",function(){c._droplist_[b.id]._is_composition||EWA.F.I.DropList(this)})}};this._GetDropListValue=function(){var a=this.getObj();if(a.length!=0){a=a[0];var b=a.getElementsByTagName("input");this._droplist_={};for(var c=0;c<b.length;c++){var d=b[c];if(d.getAttribute("ewa_class")=="droplist"){var e=d.nextSibling;e.tagName.toUpperCase()=="INPUT"&&e.type.toUpperCase()==
"HIDDEN"&&(this._GetDropListValue1(d,e),this._bindCompostion(d,e))}}a=a.getElementsByTagName("select");for(c=0;c<a.length;c++)if(d=a[c],b=d.getAttribute("_ListFilterType"))e=d.getAttribute("_ListFilterField"),this.initSelectFilter(d.id,b,e);this._SelectFilters&&this._checkSelectOptionsChange()}};this.refreshDropList=function(a,b){let c=this.getObj('input[id="'+a+'"]');if(c.length==0)console.warn("Can not found id="+a);else{var d=c.prev();d.length==0?console.warn("Can not found  id="+a+" prev"):d.attr("ewa_class")==
"droplist"?(c.val(b),this._GetDropListValue1(d[0],c[0])):console.warn("Not droplist id="+a+" prev")}};this._GetDropListValue1=function(a,b){if(b.value=="")b.setAttribute("setvalue",1);else{var c=b.getAttribute("DlsShow");if(c==null||c=="")b.setAttribute("canopen",0),a.value=obj1.value,b.setAttribute("canopen",1);else{var d=b.getAttribute("xmlName"),e=b.getAttribute("itemName"),g=b.getAttribute("paraName"),h=b.getAttribute("DlsAction"),k=b.value;var l=this.EWA_CGI?this.EWA_CGI:window.EWA_CGI?window.EWA_CGI:
EWA.CP+"/EWA_STYLE/cgi-bin/";var m=l.indexOf("?")==-1?"?":"&";l=(l+(m+"XMLNAME="+d+"&ITEMNAME="+e+"&EWA_AJAX=JSON")).replace("//","/");l=l.replace("//","/");l=l.replace("//","/");d={};d[g]=k;h!=null&&h.trim().length>0&&(d.EWA_ACTION=h,d[b.id]=b.value);$JP(l,d,function(n){if(n.length!=0){var p=n[0],r=[];n={};for(var q in p)r.push(p[q]),n["@"+q.toUpperCase()]=p[q],p[q]&&b.setAttribute("para_"+q.toLowerCase(),p[q]);if(c==null||c=="")n=r.join("/");else{q=c.match(/@[a-zA-Z0-9\-\._:]*\b/ig);for(p=0;p<q.length;p++){r=
q[p];var t=n[r.toUpperCase()];c=c.replace(r,t)}n=c}b.setAttribute("canopen",0);a.value=n;b.id=b.id==null||b.id==""?Math.random():b.id;b.getAttribute("isdlseventload")=="yes"&&(EWA.F.FOS[b.id]=new EWA_FrameItemClass,EWA.F.FOS[b.id].DropList(a),EWA.F.FOS[b.id].CallAfterEvent());b.setAttribute("canopen",1);b.setAttribute("setvalue",1)}})}}};this.DoPostEx=function(){EWA.F.F.CUR=this;if(this.CheckValidAll(document.forms[0])){this._Ajax=new EWA.C.Ajax;this._Ajax.LoadingType="image";this._Ajax.AddParameter("EWA_AJAX",
"1");this._Ajax.AddParameter("EWA_POST","1");this._Ajax.AddParameter("EWA_NO_CONTENT","1");for(var a=document.getElementsByTagName("input"),b=0;b<a.length;b+=1){var c=a[b],d=c.name==""?c.id:c.name;d!=null&&d!=""&&this._Ajax.AddParameter(d,c.value)}a=document.getElementsByTagName("select");for(b=0;b<a.length;b+=1)c=a[b],d=c.name==""?c.id:c.name,d!=null&&d!=""&&this._Ajax.AddParameter(d,c.value);a=document.getElementsByTagName("textarea");for(b=0;b<a.length;b+=1)c=a[b],d=c.name==""?c.id:c.name,d!=null&&
d!=""&&this._Ajax.AddParameter(d,c.value);this._Ajax.PostNew(this.Url,EWA.F.F.CUR._CallBack)}};this.createAjax=this.CreateAjax=function(a,b){EWA.F.F.CUR=this;a==null&&(a=$("#f_"+this._Id)[0]);if(!b&&!this.CheckValidAll(a))return null;a=new EWA.C.Ajax;b=this.CreatePostData();for(var c in b)a.AddParameter(c,b[c]);return a};this.createPostData=this.CreatePostData=function(a){a=a||$("#f_"+this._Id)[0];var b={},c;for(c in this.ItemList.Items){var d=this.ItemList.GetItemValue(this.ItemList.Items[c],"Name",
"Name"),e=this.GetObject(d,a);if(e!=null&&!$(e).attr("ewa_encyrption")){var g=e.getAttribute("ewa_tag"),h=void 0;if("signature"==g){var k="N";h=this.tablets[c];for(let m=0;m<h.lines.length;m++)if(h.lines[m]){k="Y";break}h=k=="Y"?this._GetObjectValue(e):"";b[d+"_CHANGED"]=k}else h=this._GetObjectValue(e);h!=null&&(b[d]=h);e.tagName.toUpperCase()=="DIV"&&e.getAttribute("EWA_DHTML")=="1"&&(k=$X("UP_IMG_"+d).value,b[d+"_imgs_split"]=k);if("swffile"==g||"IMG_UPLOAD"==g)if(d=e.getAttribute("UP_PARAS"),
d!=null&&d.length>0)for(d=d.split(","),g=0;g<d.length;g++){var l=d[g];b[l]=e.getAttribute(l)}else b.UP_URL=e.value;else"markdown"==g&&(e=e.parentNode.getElementsByTagName("textarea"),e.length>1&&(b[e[1].id]=e[1].value))}}if(this.PostAddData)for(l in this.PostAddData)b[l]=this.PostAddData[l];if(this.triggerValids)for(let m in this.triggerValids)b[m+"_TRIGGER_VALID_RESULT"]=this.triggerValids[m];return b};this.DoPostBefore=function(){return!0};this.isDoPostBeforeTimer=function(){return this._checkStatusFristResult!=
null};this._uploadingFileCheck=function(a){a=window["h5u_"+this._Id+"$"+a.id];if(!a.haveFile())return!1;if(a.UPLOAD_STATUS=="ok")return a.removeWaitBox(),this.uploadProcess=!1;if(a.UPLOAD_STATUS=="nofile")return this.uploadProcess=!1,a.removeWaitBox(),!1;if(a.UPLOAD_STATUS=="error"||a.UPLOAD_STATUS=="abort")return this._stopPost=!0,this._stopPostError=EWA.LANG=="enus"?"Upload file error or aborted":"\u4e0a\u4f20\u6587\u4ef6\u9519\u8bef\u6216\u88ab\u4e2d\u6b62",console.log(this._stopPostError),!1;
if(a.UPLOAD_STATUS=="start"||a.UPLOAD_STATUS=="checking")return!0;a.submitUploads();if(a.UPLOAD_STATUS=="nofile")return this.uploadProcess=!1,a.removeWaitBox(),!1;$X(a.WAIT_ID)||a.createWaitBox();return this.uploadProcess=!0};this._checkTriggerValids=function(){if(!this.triggerValids)return!0;var a=this.getObj();for(var b in this.triggerValids)if(!this.triggerValids[b]){a=a.find("#"+b);if(a.length>0&&"submit"==a[0].type){b=a.attr("_trigger_valid_inc")?a.attr("_trigger_valid_inc")*1:0;if(b==0)this.callTriggerValid(a);
else{let c=a.attr("_trigger_valid_id");if(!c)return!1;if(top.$("#"+c).length==0)return this._cancelPostWait=!0,a.removeAttr("_trigger_valid_inc"),a.removeAttr("_trigger_valid_id"),console.log("\u7a97\u53e3\u4e0d\u89c1\u4e86\uff0c\u53d6\u6d88\u63d0\u4ea4\u7b49\u5f85"),!1}b++;a.attr("_trigger_valid_inc",b)}return!1}return!0};this.DoPost=function(a,b,c){if(this.posting)return!1;if(this._cancelPostWait)return console.log("\u53d6\u6d88\u63d0\u4ea4"),this._cancelPostWait=null,!1;var d=this;if(!c){var e=
this.DoPostBefore();if(e instanceof Array){d=this;this._checkStatusInc=0;this._checkStatusFristResult=e;this._checkStatusTimer=window.setInterval(function(){var n=d._checkStatusInc==0?d._checkStatusFristResult:d.DoPostBefore();d._checkStatusInc++;let p=n[0];if(p!==null&&p!==void 0){window.clearInterval(d._checkStatusTimer);d._checkStatusTimer=null;d._checkStatusInc=null;d._checkStatusFristResult=null;var r=n[1];n=n[2];p&&!n?d.DoPost(a,b,!0):p&&n?$Confirm(r,r,function(){d.DoPost(a,b,!0)},function(){}):
r&&$Tip(r)}},232);return}if(!e)return}var g=$(a).find("input[ewa_tag=ht5upload]");if(!(g.length>0)||this.uploadProcess||this.CheckValidAll(a)){var h=0;for(e=0;e<g.length>0;e++){var k=g[e];this._uploadingFileCheck(k)&&h++}if(h>0)setTimeout(function(){d.DoPost(a,b)},700);else{g=$(a).find("input[ewa_tag=ht5takephoto]");if(g.length>0&&!this.uploadProcess&&!this.CheckValidAll(a))return!1;for(e=0;e<g.length>0;e++){k=g[e];h=!1;k=window["h5takephoto_"+this._Id+"$"+k.id];if(k.UPLOAD_STATUS!="ok"){if(!$X(k.H5_UPLOAD.WAIT_ID)){try{k.submitUpload()}catch(n){console.log("ht5takephotos - ht5.submitUpload: "+
n);$Tip("\u60a8\u6ca1\u6709\u83b7\u53d6\u7167\u7247");return}k.H5_UPLOAD.createWaitBox();this.uploadProcess=!0}h||(d=this,setTimeout(function(){d.DoPost(a,b)},700),h=!0);return}k.H5_UPLOAD.removeWaitBox()}if(this._stopPostError)return EWA.UI.Msg.ShowError(this._stopPostError,""),!1;e=this.CreateAjax(a);if(e==null)return!1;if(this._checkTriggerValids()){b==null&&(b=this.Url);if(b==""||b==null)b=window.location.href;this._Ajax=e;this._Ajax.AddParameter("EWA_AJAX","1");this._Ajax.AddParameter("EWA_POST",
"1");this._Ajax.AddParameter("EWA_NO_CONTENT","1");this._Ajax.LoadingType="image";this.DoPostStart&&this.DoPostStart(this._Ajax);e=new EWA_UrlClass(b);for(var l in this._Ajax._Parameters)e.RemoveParameter(l);b=e.GetUrl();this.posting=!0;var m=this;if(this.triggerValids)for(let n in this.triggerValids)this.triggerValids[n]=null,this.getObj("#"+n).removeAttr("_trigger_valid").removeAttr("_trigger_valid_inc");this._Ajax.PostNew(b,function(){m._CallBack()});this.isShowPostWaitting||this._Ajax.HiddenWaitting();
this.getObj("input[type=submit]").attr("disabled","disabled");return!0}setTimeout(function(){d.DoPost(a,b,c)},500)}}};this._CallBack=function(){var a=this._Ajax;if(a.IsRunEnd())if(this.getObj("input[type=submit]").attr("disabled",null),this.posting=!1,this.DoPostEnd&&this.DoPostEnd(a,a._Http.status,a._Http.responseText,a._Http.statusText),a._Http.status==200){if(a=a._Http.responseText,EWA.F.CheckCallBack(a)){this.ValidCodeError(!0);let b=null;this.doPostAfter?b=this.doPostAfter:this.ReloadAfter&&
(console.warn("\u8bf7\u7528\uff1adoPostAfter"),b=this.ReloadAfter);try{b&&b(a)||eval(a)}catch(c){console.log(a),console.error(c),alert(a)}}}else alert("ERROR:\r\n"+a._Http.statusText)};this.Reload=function(){};this.Reload1=function(){console.log("Reload1 \u8fd9\u4e2a\u5e72\u561b\u7528\uff1f\u8c01\u5728\u8c03\u7528\uff1f")};this.ReloadFrame=function(a){var b=$("#f_"+this._Id);if(b.length!=0){var c=new EWA_UrlClass(this.Url),d=null,e=this._last_reload_frame_id;e?d=$("#"+this._last_reload_frame_id):
(e=EWA_Utils.tempId("ewa_frame_relaod"),d=b.parentsUntil("#EWA_FRAME_MAIN").last().parent(),d[0].id!="EWA_FRAME_MAIN"&&(d=$("<div class='ewa-reload-frame'></div>"),d.insertBefore(b),d.append(b)),this._last_reload_frame_id=e,d.attr("id",e));c=new EWA_UrlClass(this.Url);c.AddParameter("ewa_ajax","install");b=c.GetUrl();$Install(b,e,function(){a&&a(d,this)})}};this.CheckValidAll=function(a){var b=!0,c=null,d;for(d in this.ItemList.Items){var e=this.ItemList.GetItemValue(this.ItemList.Items[d],"Name",
"Name");e=this.GetObject(e,a);e!=null&&((b&=this.CheckValid(e))||c!=null||(c=e))}c!=null&&c.focus();return b};this.H5Type=function(){for(var a in this.ItemList.Items){var b=this.ItemList.Items[a],c=this.ItemList.GetItemValue(b,"Name","Name");c=this.getObj('[id="'+c+'"]');if(c.length!=0){var d=this.ItemList.GetItemValue(b,"Tag","Tag"),e=this.ItemList.GetItemValue(b,"DataItem","Valid");this.ItemList.GetItemValue(b,"DataItem","Format");b=this.ItemList.GetItemValue(b,"IsMustInput","IsMustInput");e=="Email"&&
c.attr("type","email");d=="valid"&&c.attr("type","tel");b==1&&c.attr("required","required")}}};this.GetObject=function(a,b){b||(b=$("FORM#f_"+this._Id));a=$(b).find('[id="'+a+'"]');return a.length>0?a[0]:null};this.CheckValid=function(a,b){if(a.tagName=="SPAN"||a.tagName=="IMG")return!0;if(a&&b&&a.tagName=="DIV"&&a.getAttribute("tag")=="REPT"){b=b.target.tagName;if(b=="LABEL"||b=="INPUT"){var c=this;setTimeout(function(){c._GetObjectValue(a);c.ItemList.CheckValid(a,d)},10)}return!0}var d=this._GetObjectValue(a);
return this.ItemList.CheckValid(a,d)};this._GetObjectValue=function(a){return this.ItemList.GetObjectValue(a)};this.getUrlClass=function(){var a=new EWA_UrlClass;a.SetUrl(this.Url);return a}}var __EWA_ALTER_MSG=null;
function EWA_FrameShowAlert(a,b){if(a.getAttribute("show_alert")!=1){a.setAttribute("show_alert",1);var c=a;do if(c=c.parentNode,c.tagName=="BODY"){c=null;break}while(c.tagName!="TR"||c.getAttribute("SHOW_MSG")!=1);if(!c){var d=$(a);d.attr("ori_bc",d.css("background-color"));d.css("background-color","pink");a.tagName!="SELECT"&&a.focus();d=$(a).parentsUntil("tbody").last();d.prev().hasClass("ewa-row-"+a.id)&&(c=d.prev()[0])}if(c)if(c.cells.length==1||c.parentNode.parentNode.getAttribute("error_show_type")==
"1"){d=$(c);var e=d.next();e.attr("error")||(e=c.parentNode.insertRow(c.rowIndex+1),e.setAttribute("error",1),e.setAttribute("rid",a.id),a=e.insertCell(-1),a.colSpan=c.cells.length,a.className="ewa-tip-error",e=$(e),a.innerHTML='<div class="ewa-tip-error-info"></div>');d.find("td").addClass("ewa-tip-error");e.find(".ewa-tip-error-info").html(b)}else c.cells.length==3?(c.style.backgroundColor="lightyellow",a.getAttribute("ori_msg")==null&&(a.setAttribute("ori_msg",c.cells[2].innerHTML),a.setAttribute("ori_st",
c.cells[2].style.borderLeft)),c.cells[2].innerHTML=a.getAttribute("ORI_MSG")+"(<font color=red>"+b+"</font>)",c.cells[2].style.borderLeft="2px solid red"):($(c).find("td").css("background-color","lightyellow"),a.tagName!="SELECT"&&a.focus(),c.cells.length==1?(c=$(c).prev(),c.attr("id")&&c.attr("id").indexOf(a.id)>0?(a.getAttribute("ori_msg")==null&&a.setAttribute("ori_msg",c[0].cells[0].innerHTML),c[0].cells[0].innerHTML=a.getAttribute("ori_msg")+"(<font color=red>"+b+"</font>)"):(alert("\u8bf7\u8f93\u5165\uff1a"+
b),a.focus())):(a.getAttribute("ori_msg")==null&&a.setAttribute("ori_msg",c.cells[0].innerHTML),c.cells[0].innerHTML=a.getAttribute("ori_msg")+"(<font color=red>"+b+"</font>)"))}}
function EWA_FrameRemoveAlert(a){__EWA_ALTER_MSG&&(__EWA_ALTER_MSG.style.display="none");if(a.getAttribute("show_alert")==1){a.setAttribute("show_alert",0);var b=a;do if(b=b.parentNode,b.tagName=="BODY"){b=null;break}while(b.tagName!="TR"||b.getAttribute("SHOW_MSG")!=1);if(!b){var c=$(a);c.css("background-color",c.attr("ori_bc"));c=$(a).parentsUntil("tbody").last();c.prev().prev().hasClass("ewa-row-"+a.id)&&(b=c.prev().prev()[0])}b&&(b.style.backgroundColor="",b.cells.length==1||b.parentNode.parentNode.getAttribute("error_show_type")==
"1"?(a=$(b),a.find("td").removeClass("ewa-tip-error"),a=a.next(),a.attr("error")&&a.remove()):b.cells.length==3?(b.cells[2].innerHTML=a.getAttribute("ori_msg"),b.cells[2].style.borderLeft=a.getAttribute("ori_st")):b.cells.length==1?(b=$(b).prev(),b.attr("id")&&b.attr("id").indexOf(a.id)>0&&(b[0].cells[0].innerHTML=a.getAttribute("ori_msg"))):($(b).find("td").css("background-color",""),b.cells[0].innerHTML=a.getAttribute("ori_msg")))}}
function EWA_FrameShowAlert1(a,b){var c=a;do if(c=c.parentNode,c.tagName=="BODY"){c=null;break}while(c.tagName!="TD"||c.getAttribute("SHOW_MSG")!=1&&c.className!="ewa_redraw_info");if(c){var d=c.parentNode.parentNode.parentNode,e=c.previousElementSibling?c.previousElementSibling:c.previousSibling;c.style.backgroundColor="lightblue";e&&e.nodeType==1?(e.style.backgroundColor="lightblue",a.getAttribute("ori_msg")==null&&(a.setAttribute("ori_msg",e.innerHTML),a.setAttribute("ori_st",e.style.borderLeft)),
b=="*"&&(b=$(e).find(".ewa_d1").html()+"\uff1a\u9700\u8981\u8f93\u5165"),e.style.borderLeft="2px solid red"):c.style.borderLeft="2px solid red";a="ERR_"+a.id;c=$(d).find('.ewa_msg_err span[id="'+a+'"]');c.length>0?c.html(b+"&nbsp;"):$(d).find(".ewa_msg_err").append('<span id="'+a+'">'+b+"&nbsp;</span>")}else b=="*"&&(b=a.parentNode.innerText+"\uff1a\u9700\u8981\u8f93\u5165"),$(".ewa_msg_err").html(b),a.focus()}
function EWA_FrameRemoveAlert1(a){if(a.getAttribute("ori_msg")!=null){var b=a;do if(b=b.parentNode,b.tagName=="BODY")return;while(b.tagName!="TD"||b.getAttribute("SHOW_MSG")!=1&&b.className!="ewa_redraw_info");var c=b.parentNode.parentNode.parentNode,d=b.previousElementSibling?b.previousElementSibling:b.previousSibling;b.style.backgroundColor="";d&&d.nodeType==1?(d.style.backgroundColor="",d.style.borderLeft=a.getAttribute("ori_st")):b.style.borderLeft=a.getAttribute("ori_st");a="ERR_"+a.id;$(c).find('.ewa_msg_err span[id="'+
a+'"]').remove()}}EWA.F&&EWA.F.F?EWA.F.F.C=EWA_FrameClass:(EWA.F||(EWA.F={}),EWA.F.F={CUR:null,C:EWA_FrameClass});
function EWA_FrameItemClass(){this._Dialog=this._Object1=this._Object=this._Ajax=null;this._Items={};this._SelectedValue=this._LastMoveTr=null;this.DropList=function(a,b){var c=a.nextSibling;this._Object=a;this._Object1=c;if(a.value=="")c.value="";else if(c.getAttribute("canopen")!=0)if(b||this._SelectedValue==null||this._SelectedValue!=a.value){this._inputValue=a.value;var d=c.getAttribute("xmlName"),e=c.getAttribute("itemName");b=c.getAttribute("paraName");_EWA_FRAME_ITEM=this;var g=new EWA.C.Ajax;
g.LoadingType="none";var h="%"+a.value+"%";var k=window.EWA_CGI?window.EWA_CGI:EWA.CP+"/EWA_STYLE/cgi-bin/";k+="?XMLNAME="+d.toURL()+"&ITEMNAME="+e.toURL()+"&EWA_AJAX=NOJS&EWA_LF_NOHEADER=1";(d=$U())&&(k+="&"+d);$(a).attr("ewa_drop_list_para")?k+="&"+$(a).attr("ewa_drop_list_para"):$(c).attr("ewa_drop_list_para")&&(k+="&"+$(c).attr("ewa_drop_list_para"));a=new EWA_UrlClass(k);a.RemoveParameter(b);k=a.GetUrl();g.AddParameter(b,h);g.PostNew(k,function(){if(g.IsRunEnd()){var l=g.GetRst();_EWA_FRAME_ITEM.Show(!0);
_EWA_FRAME_ITEM.SetContent(l)}});this.SetContent(this._Items[c.value])}else this._SelectedValue=null};this.MouseOver=function(a){a=a?a:window.event;a=a.srcElement?a.srcElement:a.target;if(a.tagName=="TD"){a=a.parentNode;if(this._LastMoveTr!=null)for(var b=0;b<this._LastMoveTr.cells.length;b+=1)this._LastMoveTr.cells[b].style.backgroundColor="";if(a.getAttribute("EWA_TAG")=="HEADER")this._LastMoveTr=null;else{for(b=0;b<a.cells.length;b+=1)a.cells[b].style.backgroundColor="#cccccc";this._LastMoveTr=
a}}};this.MouseDown=function(a){a=a?a:window.event;a=a.srcElement?a.srcElement:a.target;if(a.tagName!="DIV"){if(a.tagName=="TR")var b=a;else{var c=$(a).parentsUntil("tbody").last();if(c.length==0){console.log(a);return}b=c[0]}if(b==null)console.log(a);else if(b.tagName!="TR")console.log(a);else if(b.getAttribute("ewa_tag")!="HEADER"){a=this._Object.nextSibling;a.setAttribute("canopen",0);c=[];for(var d={},e=0;e<b.cells.length;e+=1){var g=b.cells[e];g.style.backgroundColor="lightyellow";var h=GetInnerText(g).trim();
c[c.length]=h;g=g.childNodes[0].id;g!=null?(d["@"+g.toUpperCase()]=h,this._Object1.setAttribute("para_"+g.toLowerCase(),h)):d[e]=h}this._LastMoveTr=null;this._SelectedValue=c[0];this._Object1.value=c[0];b=this._Object1.getAttribute("DlsShow");if(b==null||b=="")this._Object.value=c[0];else{h=b.match(/@[a-zA-Z0-9\-\._:]*\b/ig);for(e=0;e<h.length;e++){g=h[e];var k=d[g.toUpperCase()];b=b.replace(g,k)}this._Object.value=b}this._Object.parentNode.setAttribute("title",c.join("\n"));this._Object1.getAttribute("afterEvent");
this.CallAfterEvent();this.Show(!1);a.setAttribute("canopen",1)}}};this.CallAfterEvent=function(){var a=this._Object1.getAttribute("afterEvent");if(a!=null&&a.trim().length!=0){var b=eval("window."+a);typeof b=="function"?b(this._Object1.value,this._Object.value,this._Object1,this._Object):alert("\u5b9a\u4e49\u7684Js "+a+"\u4e0d\u5b58\u5728, \u5bf9\u8c61\u4e3a"+typeof b)}};this.Show=function(a){if(this._Dialog==null){var b=$(this._Object).width();b=b>400?b+"px":"500px";var c="180px";this._Object1.getAttribute("set-dialog-width")!=
null&&(b=this._Object1.getAttribute("set-dialog-width"));this._Object1.getAttribute("set-dialog-height")!=null&&(c=this._Object1.getAttribute("set-dialog-height"));EWA.B.PAD&&(b=document.documentElement.clientWidth+"px",c=document.documentElement.clientHeight-300+"px");this._Dialog=new EWA_UI_DialogClass;this._Dialog.Width=b;this._Dialog.Height=c;this._Dialog.ShadowColor="";typeof _EWA_DialogWnd=="undefined"?this._Dialog.CreateWindow=window:(this._Dialog.CreateWindow=_EWA_DialogWnd._ParentWindow,
_EWA_DialogWnd.OpendDialogs[_EWA_DialogWnd.OpendDialogs.length]=this._Dialog);this._Dialog.Create();b="<div style='position:absolute;width:"+b+";height:"+c+";overflow-y:scroll;overflow-x:hidden;border:1px solid #ccc;cursor:pointer'";b=EWA.B.PAD?b+" onclick='_EWA_FRAME_ITEM.MouseDown(event)' ></div>":b+" onmouseover='_EWA_FRAME_ITEM.MouseOver(event)'  onmousedown='_EWA_FRAME_ITEM.MouseDown(event)' ></div>";this._Dialog.SetHtml(b);$(this._Dialog.GetFrame()).addClass("ewa-ddl-list")}this._Dialog.ShowType=
a;this._Dialog.MoveBottom(this._Object);this._Dialog.Show(a);this._Dialog.CreateWindow._EWA_FRAME_ITEM=this;_EWA_FRAME_ITEM=this};this.SetContent=function(a){if(a!=null)if(a=a.replace(/onmouseout/ig,"z1"),a=a.replace(/onmousedown/ig,"z2"),a=a.replace(/onmouseover/ig,"z3"),this._Items[this._Object.value]==null&&(this._Items[this._Object.value]=a),this._Dialog.GetFrameContent().childNodes[0].innerHTML=a,a=this._Dialog.GetFrameContent().childNodes[0].getElementsByTagName("table")[0],a.style.position=
"absolute",a.rows.length<=1||this._Object.value.length==0)a.rows.length<=1&&this.Show(!1);else{try{for(var b=eval("/("+this._Object.value+")/ig"),c=1;c<a.rows.length;c+=1)for(var d=a.rows[c],e=0;e<d.cells.length;e++){var g=GetInnerText(d.cells[e].childNodes[0]);d.cells[e].childNodes[0].innerHTML=g.replace(b,"<font color=blue><b>$1</b></font>")}}catch(h){}this.Show(!0)}}}EWA.F.F?EWA.F.F.FI=EWA_FrameItemClass:EWA.F.F={CUR:null,FI:EWA_FrameItemClass};
function EWA_FrameMapToClass(){this.EWA=null;this.mapRef=function(a,b,c){this.POST_URL=c;this.EWA=b;var d=$("#EWA_FRAME_"+this.EWA._Id);this._Id=this.EWA._Id+"_MAPTO";EWA.F.FOS[this._Id]=this;var e=this;$(a).find("[ref]").each(function(){try{e.mapRefItem(this,d)}catch(g){console.log(g,this)}})};this.checkbox=function(a){a=$(a).parentsUntil('div[tag="REPT"]').last().parent();var b=[];a.find("input:checked").each(function(){b.push(this.value)});a={key:a.attr("id"),val:b.join(",")};$JP(this.POST_URL||
window.location.href,a,function(c){c.RST?$TipTL("\u4fdd\u5b58\u5b8c\u6bd5"):$Tip(c.ERR)})};this.showGpsMap=function(a,b){var c=a.attr("ref_map");if(c){var d=b.parent().parent().next().find(".ewa-map-small");if(d.length==0){var e=this;setTimeout(function(){e.showGpsMap(a,b)},100)}else c.indexOf(".")==0||c.indexOf("#")==0?$(c).append(d.css("height","100%")):$("#"+c).append(d.css("height","100%"))}};this.mapRefItem=function(a,b){var c=$(a),d=c.attr("ref");d=b.find('[id="'+d+'"]');var e=!1,g=this,h="",
k="EWA.F.FOS['"+this._Id+"']";if(d[0].type=="hidden"){if(!d.attr("setvalue")){setTimeout(function(){g.mapRefItem(a,b)},100);return}d=d.prev();h=d.val();c.attr("onclick",k+".modifyRef(this)").css("cursor","pointer")}else if("addressMap"==d.attr("ewa_tag"))h=d.val(),c.attr("onclick",k+".modifyRef(this)").css("cursor","pointer"),this.showGpsMap(c,d);else{if(d.attr("tag")=="REPT"){c=$(a);c.offset();c.offset();c.outerWidth();c.append(d);d.find("input[type=checkbox]").attr("onclick",k+".checkbox(this)");
return}"1"==d.attr("ewa_dhtml")?(e=!0,h=d[0].textContent,c.attr("onclick",k+".modifyRefHtml(this)").css("cursor","pointer")):("SELECT"==d[0].tagName?h=d[0].options[d[0].selectedIndex].text:"TEXTAREA"==d[0].tagName?((h=d.val())&&(h="<div>"+h.replace(/</,"&lt;").replace(/>/,"&gt;").replace(/\n/ig,"</div><div>")+"</div>"),e=!0):h=d.val(),c.attr("onclick",k+".modifyRef(this)").css("cursor","pointer"))}h||(h="...................");e?c.html(h):c.text(h);c.append('<i style="margin-left:5px" class="fa fa-edit"></i>')};
this.createRefCaption=function(a,b,c,d){if($X(a+"_____tip"))e=$($X(a+"_____tip")),e.show();else{e=document.createElement("div");var e=$(e);e.css({position:"absolute",left:c,top:d-30,height:30,"line-height":"30px",background:"antiquewhite",padding:"0 10"}).text(b);e.attr("id",a+"_____tip");$("body").append(e)}return e};this.modifyRefHtml=function(a){var b=$(a),c=b.attr("ref"),d=$("#EWA_FRAME_"+this.EWA._Id).find('[id="'+c+'"]').prev(),e=b.offset().left,g=b.offset().top,h=b.outerWidth(),k=b.outerHeight();
h={position:"absolute",left:e,top:g,width:h,height:k,font:b.css("font"),border:"2px solid antiquewhite",outline:"none"};d.css(h);$(d.find("iframe")[0].contentWindow.document.body).css("width","auto").css("font",b.css("font"));oldv=window[d.attr("id").replace("box","")].GetHtml();d.attr("oldv",oldv);h=$($X("_ewa_tr$"+c).cells[0]).text();var l=this.createRefCaption(c,h,e,g);d.focus();var m=this;window.onmousedown=function(n){if(!m.checkInHtmlEditor(n.target)){n=d.attr("id").replace("box","");var p=
window[n].GetHtml();window.onmousedown=null;n=d.attr("oldv");p==n?($(d).attr("style",""),l.hide()):(n={key:$(a).attr("ref"),val:p},$JP(m.POST_URL||window.location.href,n,function(r){$(d).attr("style","");l.hide();r.RST?(p==""&&(p="............."),b.html(p),$TipTL("\u4fdd\u5b58\u5b8c\u6bd5"),b.append('<i style="margin-left:5px" class="fa fa-edit"></i>')):$Tip(r.ERR)}))}}};this.checkInHtmlEditor=function(a){a=$(event.target).parents();for(var b=0;b<a.length;b++){var c=$(a[b]);if(c.hasClass("ewa-editor")||
c.hasClass("ewa-editor-pop")||c.hasClass("ewa-dialog"))return!0}return!1};this.modifyRef=function(a){var b=$(a);a=b.attr("ref");var c=$("#EWA_FRAME_"+this.EWA._Id).find('[id="'+a+'"]');c[0].type=="hidden"&&(c=$(c).prev());var d=b.offset().left,e=b.offset().top,g=b.outerWidth(),h=b.outerHeight();c[0].tagName=="TEXTAREA"&&(h+=30);g={position:"absolute",left:d,top:e,width:g,height:h,font:b.css("font"),border:"2px solid antiquewhite",outline:"none"};c.css(g);g=c.val();c.attr("oldv",g);g=$($X("_ewa_tr$"+
a).cells[0]).text();var k=this.createRefCaption(a,g,d,e);c.focus();if(!c.attr("evtblur")){c.attr("evtblur","is_setted");var l=this;addEvent(c[0],"keydown",function(m){m=m.keyCode;13==m&&"TEXTAREA"!=c[0].tagName?this.blur():27==m&&(this.value=$(this).attr("oldv"),this.blur())});addEvent(c[0],"blur",function(){var m=$(this.parentNode.parentNode.cells[0]),n=m.css("background-color"),p=$(this).attr("onmousedown");if(p){var r=p.indexOf(".CheckValid");p=p.substring(0,r);if(eval(p).CheckValid(this))$(this).css("background",
"");else{this.focus();$(this).css("background","pink");return}}p=this.id;r=this.value;$(this).attr("ewa_class")=="droplist"&&(r=$(this).next().val(),p=$(this).next().attr("id"));p={key:p,val:r};if(n=="rgb(255, 255, 224)")$Tip(m.html()),k.hide(),this.focus();else if(this.value==$(this).attr("oldv"))$(this).attr("style",""),k.hide();else{var q=this;$JP(l.POST_URL||window.location.href,p,function(t){$(q).attr("style","");k.hide();t.RST?(t="SELECT"==q.tagName?q.options[q.selectedIndex].text:q.value,q.tagName==
"TEXTAREA"?t==""?b.html("............."):(t=t.replace(/</ig,"&lt;").replace(/>/ig,"&gt;"),t="<div>"+t.split("\n").join("</div><div>")+"</div>",b.html(t)):(t==""&&(t="............."),b.text(t)),b.append('<i style="margin-left:5px" class="fa fa-edit"></i>'),$TipTL("\u4fdd\u5b58\u5b8c\u6bd5")):$Tip(t.ERR)})}})}}}
function EWA_ListFrameClass(){this._Ajax=this.Xml=null;this.ItemList=new EWA_FrameCommonItems;this._SortName=this._Sort=this._RecordCountName=this._PageCountName=this._PageSizeName=this._PageCurrentName=this._RecordCount=this._PageCount=this._PageSize=this._PageCurrent=null;this._SearchExp="";this._SearchHtml=null;this._SearchFields=[];this._Id=null;this._IsCheckedAll=!0;this._SearchDialog=null;this._SearchJson={};this.Resources={};this.GotoParas=[];this._CurTr=null;this._TrSelectMulti=!0;this.IsTrSelect=
!1;this.CheckedAllAfter=this.ReloadAfter=null;this.REPLACE_HISTORY_STATE=this._isStickyHeaders=this.IsNotMDownAutoChecked=!1;this._IsSearchGroup=!0;this.changeTag=function(a){a=new EWA_UrlClass("fake?"+a);let b=new EWA_UrlClass(this.Url);for(let c in a._Paras)b.AddParameter(c,a._Paras[c]);this.Url=b.GetUrl();this.Reload()};this._InitMneu=function(){var a=window["_EWA_MENU_"+this._Id];if(a&&a.length!=0){var b=[];for(let c=0;c<a.length;c++){let d=a[c],e=(c==0?"ewa-lf-menu-marked":"")+(c==a.length-1?
"ewa-lf-menu-last":""),g=d.Cmd.replace(/"/g,"&quot;");b.push(`<a class="ewa-lf-menu ${e}" onclick="${"$(this).parent().find('.ewa-lf-menu-marked').removeClass('ewa-lf-menu-marked');$(this).addClass('ewa-lf-menu-marked');"} ${g}">${d.Txt}</a>`)}a=b.join('<b class="ewa-lf-menu-span"></b >');$("#EWA_RESHOW_"+this._Id).find(".ewa_lf_func_caption").after(a)}};this.stickyHeaders=function(){if(this._isStickyColumns)console.warn("stickyColumns is enabled, stickyHeaders will not work properly.");else{this._isStickyHeaders=
!0;var a=$("#EWA_RESHOW_"+this._Id),b=EWA.UI.findScrollParent(a[0]);if(b){var c=a.find(".ewa_lf_func").parent();c.length!=1||c.hasClass("ewa-lf-sticky-func")||c.css("position","sticky").css("top",c.offset().top).addClass("ewa-lf-sticky-func");c=a.find(".ewa-lf-search");c.length!=1||c.hasClass("ewa-lf-sticky-search")||c.css("position","sticky").css("top",c.offset().top).addClass("ewa-lf-sticky-search");a=a.find(".ewa-lf-header");a.length!=1||a.hasClass("ewa-lf-sticky-header")||a.css("position","sticky").css("top",
a.offset().top).addClass("ewa-lf-sticky-header");a="scroll-ref-"+this._Id;if(!$(b).attr(a)){c=b.tagName=="BODY"?window:b;const d=b.tagName=="BODY"?document.documentElement:b;$(b).attr(a,1);$(c).on("scroll",function(){d.scrollTop===0?$(b).removeClass("ewa-lf-sticky-scroll-vertical"):$(b).hasClass("ewa-lf-sticky-scroll-vertical")||$(b).addClass("ewa-lf-sticky-scroll-vertical")});$(c).trigger("scroll")}}}};this.stickyColumns=function(a){if(this._isStickyHeaders)console.warn("stickyHeaders is enabled, stickyColumns will not work properly.");
else{this._isStickyColumns=!0;var b=$X("EWA_LF_"+this._Id);if(b==null)console.log("not found table[#EWA_LF_"+this._Id+"]");else if(b.rows.length!=0){for(let d=0;d<a;d++)this.stickyColumn(d,d==a-1,b);var c=b.parentNode;a="scroll-ref-hor-"+this._Id;if(!$(c).attr(a)){b=c.tagName=="BODY"?window:c;const d=c.tagName=="BODY"?document.documentElement:c;$(c).attr(a,1);$(c).addClass("ewa-lf-sticky-scroll");$(b).on("scroll",function(){d.scrollLeft===0?$(c).addClass("ewa-lf-sticky-last-hide"):$(c).hasClass("ewa-lf-sticky-last-hide")&&
$(c).removeClass("ewa-lf-sticky-last-hide")});$(b).trigger("scroll")}}}};this.stickyColumn=function(a,b,c){c=c||$X("EWA_LF_"+this._Id);if(c==null)console.log("not found table[#EWA_LF_"+this._Id+"]");else if(c.rows.length!=0){var d=c.rows[0].cells[a];if(d){var e=$(d).position().left;d=$(d).width();e={left:e,width:d};for(d=0;d<c.rows.length;d++){let g=$(c.rows[d].cells[a]);g.css(e).addClass("ewa-lf-sticky");b&&g.addClass("ewa-lf-sticky-last").css("overflow","initial")}}}};this.composeSearchTexts=function(){var a=
[],b=[],c=$("#EWA_RESHOW_"+this._Id+" .ewa-lf-search-type-text");if(c.length==0)return null;c.each(function(g){var h=$(this).find(".ewa-lf-search-item-title").text();h=h.replace(":","").replace("\uff1a","").replace("\u5305\u542b","").replace("Like","").trim();var k=$(this).find("input[type=text]").attr("name");a.push(h);b.push(k);g>0&&$(this).hide()});let d=$(c[0]);d.addClass("ewa-app-lf-search-compose");d.find("input[type=text]").attr("name",b.join(",")).attr("placeholder",a.join(", "));let e=d.find("a").clone();
d.find(".ewa-lf-search-item-title b").text(EWA.LANG=="enus"?"Search":"\u7efc\u5408\u641c\u7d22").append(e);return c};this.switchButtonAction=function(a,b){if(b){var c=this.getUrlClass();c.AddParameter("ewa_switch_name",a.name);c.AddParameter("ewa_action",b);c.AddParameter("ewa_ajax","json");c.AddParameter("ewa_switch",a.checked?"on":"off");c.AddParameter("ewa_action_key",$(a).parentsUntil("tbody").last().attr("ewa_key"));var d=a.parentNode,e=d.getAttributeNames();b={};for(let h in e){let k=e[h],l=
d.getAttribute(k);k.indexOf("on")!=0&&k!="name"&&k!="id"&&k!="class"&&(b[k]=l)}var g=this;c=c.GetUrl();$JP(c,b,function(h){g.extSwitchCallBack&&g.extSwitchCallBack(a,h)})}};this.ShowRecycle=function(){var a=$X("EWA_LF_"+this._Id);if(a!=null&&(a=$(a).parentsUntil("table").last().find(".ewa_lf_func_caption"),a.length!=0)){var b="\u56de\u6536\u7ad9";window._EWA_INFO_MSG&&window._EWA_INFO_MSG.RECYCLE&&(b=window._EWA_INFO_MSG.RECYCLE);b="<div class='ewa_lf_func_dact ewa-lf-func-recycle' onclick='EWA.F.FOS[\""+
this._Id+"\"].ShowRecycle1(this)' ><b class='fa fa-recycle'></b>"+b+"</div>";a.parent().append(b)}};this.ShowRecycle1=function(a){var b=new EWA_UrlClass(this.Url);$(a).attr("recycle")?(b=b.RemoveParameter("ewa_recycle"),$(a).attr("recycle",null).removeClass("ewa-lf-func-recycle-yes")):(b=b.AddParameter("ewa_recycle","1"),$(a).attr("recycle",1).addClass("ewa-lf-func-recycle-yes"));this.Url=b;this.Goto(1)};this.BindButton=function(a,b){$("#EWA_LF_"+this._Id+' tr[ewa_key] [id="'+a+'"]').each(function(){$(this).attr("onclick",
"$(this).parent().parent().find('[id=\""+b+"\"]')[0].click()");$(this).addClass("ewa-map-button")})};this.Merges=function(a){if(a==null||a.length==0)console.log("cfg.from, cfg.to, cfg.str, cfg.func, cfg.header");else for(let b=0;b<a.length;b++){let c=a[b];this.Merge(c.from,c.to,c.str,c.func,c.header)}};this.Merge=function(a,b,c,d,e){let g=$("#EWA_LF_"+this._Id);c==null?c="":c.indexOf("<")==-1&&(c="<span class='ewa-merge-str ewa-mearge-str'>"+c+"</span>");g.find("tr[ewa_key],tr.ewa-lf-sub-tr").each(function(){let h=
$(this).find('[id="'+b+'"]').parentsUntil("tr").last();if(h.attr("ewa-merged")!="yes"){h.attr("ewa-merged","yes");var k=$(this).find('[id="'+a+'"]');k.parentsUntil("tr").last().hide().addClass("ewa-row-merge-hide");h.append(c);h.append(k);d&&d(h,this)}});e&&(e="<span class='ewa-lf-merge-header-split'></span>"+g.find('tr[ewa_tag="HEADER"] [id="'+a+'"]').html(),g.find('tr[ewa_tag="HEADER"] [id="'+b+'"]').append(e));g.find('tr[ewa_tag="HEADER"] [id="'+a+'"]').parent().hide();g.find("td#ADD_ROW_"+a).hide()};
this.Mearge=function(a,b,c){console.log("\u62fc\u5199\u9519\u8bef\uff0c\u8bf7\u7528 Merge");this.Merge(a,b,c)};this.createMergeExpParameters=function(a){const b=a.match(/@(@)?[a-zA-Z_][a-zA-Z0-9_]*/g)||[],c={};try{const d={};$(`<div>${a}</div>`).find("*").addBack().each(function(){$.each(this.attributes,function(e,g){d[g.name]=g.value})});b.forEach(e=>{const g=e.startsWith("@@")?e.slice(2):e.slice(1);let h=!1,k="";for(const [l,m]of Object.entries(d))if(m.includes(e)){h=!0;k=l;break}c[e]={id:g,isAttr:h,
attrName:k}})}catch(d){b.forEach(e=>{const g=e.startsWith("@@")?e.slice(2):e.slice(1);c[e]={id:g,isAttr:!1,attrName:""}})}return c};this.MergeExp=function(a,b,c,d,e){if(b){var g=$("#EWA_LF_"+this._Id),h=this.createMergeExpParameters(b),k=b,l={};b=[];for(const n in h){var m=h[n];const p=m.id;m.isAttr||(k=k.replace(n,"<span class='ewa-lf-merge ewa-lf-merge-"+p+" ewa-lf-mearge ewa-lf-mearge-"+p+"' mid=\""+p+'"></span>'));p!=a&&(g.find('tr[ewa_tag="HEADER"] [id="'+p+'"]').parent().hide(),g.find("td#ADD_ROW_"+
p).hide());m=g.find('tr[ewa_tag="HEADER"] [id="'+p+'"]').html();l[p]=m;b.push(m)}e&&(e=b.join("<span class='ewa-lf-merge-header-split'></span>"),g.find('tr[ewa_tag="HEADER"] [id="'+a+'"]').html(e));g.find("tr[ewa_key],tr.ewa-lf-sub-tr").each(function(){if($(this).find('[id="'+a+'"]').length==0)console.log("not find "+a);else{var n=$(this).hasClass("ewa-lf-sub-tr")?$(this).find('[id="ADD_ROW_'+a+'"]'):$(this).find(".ewa-col-"+a);if("yes"!=n.attr("ewa-merged")){var p=$('<div style="display:none"></div>');
p.html(k);for(const t in h){var r=h[t];console.log(r);const v=r.isAttr,u=r.id;var q=$(this).find('[id="'+u+'"]');if(q.length!=0)if(u!=a&&q.parent().hide().addClass("ewa-row-merge-hide"),v){const w=r.attrName;p.find("["+w+"='"+t+"']").each(function(){$(this).attr(w)===t&&$(this).attr(w,q.text().trim())})}else r=p.find('span[mid="'+u+'"]'),c&&(r.append("<span class='ewa-lf-mearge-memo'></span>"),r.find(".ewa-lf-mearge-memo").html(l[u])),r.append(q)}for(;p[0].childNodes.length>0;)n.append(p[0].childNodes[0]);
$(p).remove();d&&d(n,this);n.attr("ewa-merged","yes")}}})}else console.log("mergeExp \u6ca1\u6709\u8bbe\u7f6e")};this.MeargeExp=function(a,b,c,d){console.log("\u62fc\u5199\u9519\u8bef\uff0c\u8bf7\u7528 MereExp");this.MergeExp(a,b,c,d)};this.SubBottoms=function(a){this.SubBottomsArray=a.split(",");this._SubBottoms()};this.reCalcBottoms=function(){this._SubBottoms()};this._SubBottoms=function(){let a=$("#EWA_LF_"+this._Id).find(".ewa-lf-sub-tr");a.length==0?(a=$(this.AddRow([])),a.addClass("ewa-lf-sub-tr"),
a.find("td").addClass("ewa-lf-sub-td")):a.find("td").text("");for(let b in this.SubBottomsArray){let c=this.SubBottomsArray[b],d=0,e=0;$("#EWA_LF_"+this._Id+' .ewa-lf-data-row [name="'+c+'"]').each(function(){let h;h=this.hasAttribute("value")?this.value:this.hasAttribute("title")?this.title:this.innerText;h!=null&&h.length!==0&&(h=h.replace(/,/ig,""),isNaN(h)||(d+=h*1,h.indexOf(".")>0&&(e=2)))});let g="<span id='"+c+"' name='"+c+"' class='ewa-lf-sub'>"+d.fm(e)+"</span>";a.find("td[id=ADD_ROW_"+c+
"]").html(g)}};this.ChangeRowStyle=function(a,b,c){for(var d=$X("EWA_LF_"+this._Id),e=1;e<d.rows.length;e++){var g=d.rows[e];if(!(g.cells.length==0||g.cells.length<=a)){var h=g.cells[a].childNodes[0].getAttribute(b);if(h!=null&&c[h])for(var k=0;k<g.cells.length;k++)g.cells[k].style.cssText=g.cells[k].style.cssText+";"+c[h]}}if(this.ReloadAfter==null){var l=this;this.ReloadAfter=function(){l.ChangeRowStyle(a,b,c)}}};this.MDownEvent=function(a,b){};this.LoadJson=function(a,b){a!=null&&$J(this.Url+"&EWA_ACTION="+
a+"&EWA_AJAX=JSON",b)};this.Workflow=function(a,b,c,d,e,g){EWA.F.CID=this._Id;this._Ajax=this.CreateAjax();this._Ajax.AddParameter("EWA_AJAX","WORKFLOW");this._Ajax.AddParameter("EWA_ID",this._Id);this._Ajax.AddParameter("EWA_WF_NAME",b);c!=null?(a=this.GetRowKey(c),this._Ajax.AddParameter("EWA_ACTION_KEY",a),c.getAttribute("ewa_wf_control")=="true"?this._Ajax.AddParameter("EWA_WF_CTRL",1):this._Ajax.AddParameter("EWA_WF_CTRL",0)):this._Ajax.AddParameter("EWA_WF_CTRL",1);d!=null&&this._Ajax.AddParameter("EWA_ACTION_KEY",
d);e&&this._Ajax.AddParameter("EWA_WF_UOK",e);g&&this._Ajax.AddParameter("EWA_WF_UMSG",g);var h=this;this._Ajax.PostNew(this.Url,function(){h._CallBackJs()})};this.GetRowKey=function(a){a=this.GetRow(a);return a!=null?a.getAttribute("EWA_KEY"):null};this.GetRow=function(a){if(a==null||a.tagName==null||a.tagName=="")return null;var b=0;for(a=a.parentNode;a.tagName!="TR"||a.getAttribute("EWA_KEY")==null;){a=a.parentNode;if(a.tagName=="BODY"){a=null;break}b++;if(b>100){alert("\u5faa\u73af100\u6b21\uff0c\u672a\u53d1\u73b0TR");
break}}return a};this.RecordModify=function(a,b,c){var d=this.SelectChecked();if(d.length==0)EWA.UI.Msg.Alter("\u8bf7\u5148\u9009\u62e9","\u4fee\u6539");else{var e="EWA_MTYPE=M";c!=null&&c.trim().length>0&&(e+="&"+c);EWA.UI.Dialog.OpenReloadClose(this._Id,a,b,!1,e+d)}};this.RecordNew=function(a,b,c){var d="EWA_MTYPE=N";c!=null&&c.trim().length>0&&(d+="&"+c);EWA.UI.Dialog.OpenReloadClose(this._Id,a,b,!1,d)};this.SelectSingle=function(){this.IsTrSelect=!0;this._TrSelectMulti=!1};this.SelectMulti=function(){this._TrSelectMulti=
this.IsTrSelect=!0};this.MOver=function(a,b){if(this.IsTrSelect&&this._CurTr!=a&&(this._CurTr!=null&&(this._CurTr.getAttribute("__ewa_lf_mdown")!="1"?this._MSetBg(this._CurTr,""):this._MSetBg(this._CurTr,"down")),a.getAttribute("__ewa_lf_mdown")!="1"?this._MSetBg(a,"over"):this._MSetBg(a,"down"),this._CurTr=a,this.MOverEvent))try{this.MOverEvent(a,b)}catch(c){console.log(c,this.MOverEvent)}};this.MOut=function(a){if(this.IsTrSelect&&this._CurTr!=null&&this._CurTr.getAttribute("__ewa_lf_mdown")!="1"){this._MSetBg(this._CurTr,
"out");if(this.MOutEvent)try{this.MOutEvent(this._CurTr,a)}catch(b){console.log(b,this.MOutEvent)}this._CurTr=null}};this.MDownEnableCheck=function(a,b){return!0};this.checkMDownEnable=function(a,b){if(!b)return!0;b=b.srcElement?b.srcElement:b.target;return!b||b.tagName=="TD"&&b.parentNode==a?!0:b.tagName=="A"||b.parentNode.tagName=="A"||b.tagName=="INPUT"||b.tagName=="SELECT"||b.tagName=="BUTTON"||b.tagName=="TEXTAREA"||b.className.indexOf("EWA_LF_EDIT")>=0||b.className.indexOf("ewa-lf-edit")>=0||
b.className.indexOf("ewa-lf-search-text-click")>=0||b.parentNode.className.indexOf("ewa-lf-search-text-click")>=0||b.parentNode.parentNode.className.indexOf("ewa-lf-search-text-click")>=0||b.className.indexOf("ewa-mdown-stop")>=0?!1:!0};this.mDownAutoCheck=function(a,b,c){for(var d,e=0;e<b.length&&!(b[e].parentNode.className.indexOf("ewa-switch")>=0);e++){if(b[e].type.toUpperCase()=="RADIO")return d=b[e],d.click(),d;if(b[e].type.toUpperCase()=="CHECKBOX"){d=b[e];d.click();if(!this._TrSelectMulti){let g=
$(b[e]).attr("id")||$(b[e]).attr("name");$(c).find(b[e]).length==0&&$(a).siblings(".ewa-lf-data-row").find("input[name='"+g+"']:checked").prop("checked",!1);d.checked=!0}return d}}return null};this.newRowOneTd=function(a){if(a==null)return null;a=$(a)[0];var b=a.parentNode.rows[a.rowIndex+1];if(b!=null&&b.getAttribute("add_pre_row")=="1")return b;b=a.parentNode.parentNode;let c=b.rows[0].cells.length;b=b.insertRow(a.rowIndex+1);b.setAttribute("add_pre_row",1);a=b.insertCell(-1);a.colSpan=c;a.className=
"ewa-lf-add-pre-cell";b.style.display="none";a.id=EWA_Utils.tempId("EWA_LF_NR_"+this._Id);$(b).addClass("ewa-lf-add-pre-row");return b};this.MDown=function(a,b){if(this.IsTrSelect){var c=(new Date).getTime(),d=$(a).attr("mdown_time_last");if(!(d!=null&&c-d<500)&&($(a).attr("mdown_time_last",c),b=b==null?window.event:b,this.MDownEnableCheck(a)&&this.checkMDownEnable(a,b))){d=b.srcElement?b.srcElement:b.target;var e=null;c=a.getElementsByTagName("input");this.IsNotMDownAutoChecked||(e=this.mDownAutoCheck(a,
c,d));if(a.getAttribute("__ewa_lf_mdown")=="1")this._TrSelectMulti&&(e&&e.type.toUpperCase()=="CHECKBOX"&&(e.checked=!1),this._MSetBg(a,""),a.removeAttribute("__ewa_lf_mdown"),$(a).removeClass("ewa-lf-mdown"));else{e&&(e.checked=!0);this._MSetBg(a,"down");a.setAttribute("__ewa_lf_mdown",1);$(a).addClass("ewa-lf-mdown");if(!this._TrSelectMulti&&(e=a.parentNode)&&e.rows)for(d=0;d<e.rows.length;d++){var g=e.rows[d];g.getAttribute("__ewa_lf_mdown")=="1"&&g!=a&&(g.removeAttribute("__ewa_lf_mdown"),$(g).removeClass("ewa-lf-mdown"),
this._MSetBg(g,""))}if(this.IsReShow)for(d=0;d<c.length;d++)c[d].type.toUpperCase()=="BUTTON"&&(e=c[d],e.getAttribute("disabled")=="true"||e.getAttribute("disabled")==1||e.parentNode.getAttribute("disabled")=="true"||e.parentNode.getAttribute("disabled")==1?(this._ReshowButs[e.value].disabled=!0,this._ReshowButs[e.value].style.display="none"):(this._ReshowButs[e.value].disabled=!1,this._ReshowButs[e.value].style.display=""))}this._IsAddPreRow?(c=a.getAttribute("ewa_key"),this.AddPreRowCheck(a,c,b)&&
(d=this.newRowOneTd(a),this.prevTr&&(this.AddPreRowCloseBeforeEvent&&this.AddPreRowCloseBeforeEvent(this._Id,a,c,this.prevTr,b),this.prevTr.style.display="none",this.prevTr.cells[0].innerHTML="",this.AddPreRowCloseEvent&&this.AddPreRowCloseEvent(this._Id,a,c,this.prevTr,b)),this.prevTr==d?this.prevTr=null:(this.prevTr=d,this.prevTr.style.display="",this.MDownEvent(this._Id,a,c,this.prevTr,b)))):this.MDownEvent(a,b)}}};this.AddPreRow=function(a){this._IsAddPreRow||(this.MDownEvent=a);this._IsAddPreRow=
!0};this.AddPreRowCheck=function(a,b,c){return!0};this.AddPreRowCloseBeforeEvent=function(a,b,c,d,e){};this.AddPreRowCloseEvent=function(a,b,c,d,e){};this._MSetBg=function(a,b){let c="";b=="down"?c="ewa_grid_down":b=="over"&&(c="ewa_grid_mover");$(a).children("td").removeClass("ewa_grid_mover ewa_grid_down").addClass(c)};this._ReShowSearchQuick=function(){var a=this,b=EWA_ListFrameClass.prototype.RESOURCES.search_text_items,c,d,e;for(e in b){var g=b[e];g.Id=="eq"&&(c=g);g.Id=="lk"&&(d=g)}for(e in this._SearchJson){var h=
this._SearchJson[e];h.isSearchQuick&&(b=$("#EWA_LF_"+this.Id+' .ewa-lf-data-row [id="'+e+'"]'),b.bind("click",function(k){k.stopPropagation();k=$(this).attr("search_tag");var l=$(this).text(),m=l,n=$("#EWA_SEARCH_ITEM_"+a.Id+' .ewa-lf-search-item-ctl [name="'+this.id.toUpperCase()+'"]');if(k=="number"||k=="date")n=n.parentsUntil(".ewa-lf-search-item").last().find("input");var p=n.parentsUntil(".ewa-lf-search-item").last().find("a");if(k=="date")l=l.split(" ")[0],m=l+" 23:59:59";else if(k=="fix"){var r=
null;n.find("option").each(function(){this.text==l&&(r=this.value)});l=r===null?"":r}n.val()==l?(k=="text"&&d&&p.length>0&&(p.attr("tag",d.Id),p.html(EWA.LANG=="enus"?d.TxtEn:d.Txt)),n.val("")):(k=="text"&&c&&p.length>0&&(p.attr("tag",c.Id),p.html(EWA.LANG=="enus"?c.TxtEn:c.Txt)),n.val(l),k=="date"&&(n[1].value=m))}),b.each(function(){$(this).text()&&$(this).addClass("ewa-lf-search-text-click").attr("search_tag",h.T)}))}};this.ReShowWithNoButtons=function(){var a=$X("EWA_LF_"+this._Id),b=[],c;for(c in this.ItemList.Items){var d=
this.ItemList.Items[c],e=this._GetSubValue("Tag","Tag",d);if(e!=null&&e.trim().toLowerCase()=="button")for(e=0;e<a.rows[0].cells.length;e++)if(a.rows[0].cells[e].childNodes[0].id.toUpperCase()==c){b.push(e);d.setAttribute("but_show","1");break}}this.ShowHiddenColumns(b,!1)};this.ReShowButtonsInDailogTitle=function(){EWA.OW.Load();if(EWA.OW.Dia){var a=$(EWA.OW.Dia._Dialog.GetFrameTitle()),b=$($X("EWA_RESHOW_"+this._Id)).find("td.ewa_lf_func:eq(0)"),c=this;b.find(".ewa_lf_func_dact").each(function(){this.id=
EWA_Utils.tempId("gDx_"+c._Id+"_")});a.html(b.html());a.find(".ewa_lf_func_dact").each(function(){this.onclick=function(){b.find('div[id="'+this.id+'"]').click()}});b.parent().hide();$(EWA.OW.Dia._Dialog.GetFrame()).addClass("ewa-lf-btns-in-title")}};this.ReShow=function(a){this.IsReShow=!0;this.NewDivId=a="_G_"+this._Id;var b=[];b.push("<table class='ewa-lf-reshow' id='EWA_RESHOW_"+this._Id+"'>");b.push("<tr style='display:none'><td style='padding:0'></td></tr>");b.push("<tr><td class='ewa_lf_func' style='padding:0'>");
b.push("<div style='display:none'></div>");b.push("<div><div class='ewa_lf_func_caption'></div></div>");b.push("</td></tr>");b.push("<tr><td style='width:100%;padding:0;vertical-align:top'>");b.push("<div id='"+a+"' style=''></div>");b.push("</td></tr>");b.push("</table>");var c=$(b.join("")),d=!(this.Url.toUpperCase().indexOf("EWA_AJAX=INSTALL")>0||this.Url.toUpperCase().indexOf("EWA_CALL_METHOD=INNER_CALL")>0||this.Url.toUpperCase().indexOf(".JSP")>0);d?EWA.UI.Utils.SetStyle(c[0],"width:100%;height:100%;border-spacing:0"):
EWA.UI.Utils.SetStyle(c[0],"width:100%;border-spacing:0");css="";var e=$X("EWA_LF_"+this._Id);a=e.parentNode.parentNode;b=e.parentNode;c.find("td:eq(2)>div").append(b);b=c[0];let g=c.find("tr:eq(0)")[0],h=c.find("td:eq(0)")[0],k=c.find("td:eq(1)")[0],l=c.find("td:eq(2)")[0];for(d&&window.setTimeout(function(){$X("__EWA_DEBUG")&&l.childNodes[0].appendChild($X("__EWA_DEBUG"))},100);a.childNodes.length>0;)k.childNodes[0].appendChild(a.childNodes[0]);c=c.find(".ewa_lf_func_caption")[0];var m=!1;d=GetInnerText(k);
d=d.trim();this._ReshowButs={};e=$(e.rows[0]);for(var n in this.ItemList.Items){var p=this.ItemList.Items[n],r=this._GetSubValue("Tag","Tag",p);if(r&&(r.toLowerCase()=="button"||r.toLowerCase()=="butflow")&&(r=this._GetSubValue("Name","Name",p),e.find(".ewa-col-"+r).length!==0)){m=!0;var q=this._GetSubValue("DescriptionSet","Info",p),t=this._GetSubValue("DescriptionSet","Memo",p),v=this._GetSubValue("EventSet","EventName",p),u="";v!=null&&v.toLowerCase().trim()=="ewa_click"&&(u=this._GetSubValue("EventSet",
"EventValue",p));d=d.replace(q,"");p=this._ReShowButton(q,t,null);this._ReshowButs[q]=p;p.setAttribute("f_id",this._Id);p.setAttribute("t_id",r);k.childNodes[1].appendChild(p);u==""?p.setAttribute("onclick","EWA.F.FOS['"+this._Id+"'].reShowButtonClick(this)"):p.setAttribute("onclick",u)}}m&&this._ReShowSplit(k.childNodes[1]);r=k.getElementsByTagName("input");m={};for(e=0;e<r.length;e++){var w=r[e];w.style.display="none";if(w.id==null||w.id=="")w.id=("_tmp_"+Math.random()).replace(".","_");if(w.type==
"button"){if(p=this._ReShowButton(w.value,w.title,w.id),q=w.nextSibling){var x="";q.nodeType==3&&(x=q.nodeValue.trimEx());x=="|"&&this._ReShowSplit(k.childNodes[1])}}else(q=w.nextSibling)&&(x=q.nodeType==3?q.nodeValue.replace("|",""):q.innerHTML),p=this._ReShowButton(x.trimEx(),w.title,w.id),p.id=("_tmp_"+Math.random()).replace(".","_"),m[w.name]||(m[w.name]=[]),m[w.name].push(p.id);k.childNodes[1].appendChild(p)}d=d.replace(/ /ig,"").replace(/\|/ig,"").trimEx();d!=""?d.indexOf("if")>=0?g.style.display=
"none":h.innerHTML=d.replace(/ /,""):g.style.display="none";a.appendChild(b);for(n in m)for(x=m[n],e=0;e<x.length;e++)w=$X(x[e]),w.setAttribute("_r_ids",x.join(",")),w.onclick=function(){var B=this.getAttribute("_ewa_event_id");$X(B).click();B=this.getAttribute("_r_ids").split(",");for(var C=0;C<B.length;C++)w.id!=B[C]&&($X(B[C]).style.fontWeight="",$X(B[C]).style.color="");this.style.fontWeight="bold";this.style.color="blue"};c.innerHTML='<b><i class="fa fa-star-o">&nbsp;</i>'+this.Description+"</b>";
if(this.Url.toUpperCase().indexOf("EWA_BTNS_IN_TITLE")>0)var y=this,z=0,A=setInterval(function(){z++;z>1E3&&window.clearInterval(A);EWA.OW.Load();EWA.OW.Dia&&(window.clearInterval(A),y.ReShowButtonsInDailogTitle())},10);this._InitMneu()};this.reShowButtonClick=function(a){a=a.getAttribute("t_id");var b=this.SelectCheckedRows();if(b==null||b.length==0)EWA.UI.Msg.Alert(_EWA_INFO_MSG["EWA.SYS.CHOOSE_ITEM"],_EWA_INFO_MSG["EWA.SYS.CHOOSE_ITEM_TITLE"]);else{b=b[0].getElementsByTagName("input");for(var c=
0;c<b.length;c++){var d=b[c];if(d.name===a){d.click();break}}}};this._ReShowSplit=function(a){EWA.UI.Utils.CreateObject(window,"div","",a).className="ewa_lf_func_split"};this._ReShowButton=function(a,b,c){var d=EWA.UI.Utils.CreateObject(window,"div","cursor:pointer",document.body);d.innerHTML="<nobr>"+a+"</nobr>";c!=null&&(d.setAttribute("_ewa_event_id",c),d.onclick=function(){var e=this.getAttribute("_ewa_event_id");$X(e).click()});EWA.B.IE&&(d.onselectstart=function(){return!1});d.className="ewa_lf_func_dact";
d.title=b;return d};this.CheckValid=function(a){var b=a.tagName.toLowerCase();if(b!="input"&&b!="textarea"&&b!="select"||"button"==a.type||"submit"==a.type||"image"==a.type)return!0;b=this.ItemList.GetObjectValue(a);return this.ItemList.CheckValid(a,b)};this.ShowEdit=function(a){a.parentNode.style.width=a.clientWidth+"px";a.style.display="none";__show_obj__=a.nextSibling;__show_obj__.style.display="";var b=__show_obj__.childNodes[0];b.nodeType==3&&(b=__show_obj__.childNodes[1]);b.setAttribute("old",
b.value);b.tagName!="SELECT"||b.getAttribute("func")||(b.setAttribute("func",1),b.onchange=function(){EWA.F.FOS[this.getAttribute("__ewa_fid__")].EditAfter(this)});b.getAttribute("__ewa_fid__")==null&&(b.setAttribute("__ewa_fid__",this._Id),b.onblur=function(){EWA.F.FOS[this.getAttribute("__ewa_fid__")].EditAfter(this)},b.onkeydown=function(c){c=c==null?window.event:c;var d=c.target?c.target:c.srcElement;c.keyCode==13&&d.tagName=="INPUT"&&EWA.F.FOS[this.getAttribute("__ewa_fid__")].EditAfter(this);
c.keyCode==27&&EWA.F.FOS[this.getAttribute("__ewa_fid__")].EditReset(this)});setTimeout(function(){b.focus();b.select()},10)};this.EditReset=function(a){a.parentNode.style.display="none";var b=a.parentNode.previousSibling;b.style.display="";b.innerHTML=a.getAttribute("old");a.tagName.toLowerCase()=="select"?b.innerHTML=a.options[a.selectedIndex].text:a.value=a.getAttribute("old").replace(/</ig,"&lt;").replace(/>/ig,"&gt;")};this.EditAfter=function(a){if(this.CheckValid(a))if(a.getAttribute("old")==
a.value)this.EditReset(a);else{a.parentNode.style.display="none";var b=a.parentNode.previousSibling;b.style.display="";if(a.getAttribute("ewa_class")=="droplist"){var c=$(a.parentNode.getElementsByTagName("input")[1]).attr("name");var d=a.parentNode.getElementsByTagName("input")[1].value;b.innerHTML=a.parentNode.getElementsByTagName("input")[0].value}else a.tagName.toLowerCase()=="select"?(c=$(a).attr("name"),b.innerHTML=a.options[a.selectedIndex].text):(c=a.value.replace(/</ig,"&lt;").replace(/>/ig,
"&gt;").replace(/\n/ig,"<br>"),b.innerHTML=c,c=$(a).attr("name")),d=a.value;b=a.getAttribute("action_name");if(b==""||b==null)b="OnListFrameUpdateCell";var e=a.getAttribute("action_confirm");e=e==null?"":e;var g=a.getAttribute("action_tip");g==null&&(g="");var h=a.getAttribute("action_js"),k=this.ItemList.GetValue(c,"DataItem","DataType");c=[{Name:"EWA_FIELD_ID",Value:c},{Name:"EWA_FIELD_VAL",Value:d},{Name:"EWA_ACTION_RELOAD",Value:"0"},{Name:c,Value:d},{Name:"EWA_DATA_TYPE",Value:k},{Name:"EWA_FIELD_VAL_OLD",
Value:a.getAttribute("old")}];this.EditEvent={FROM:a,OLD_VAL:a.getAttribute("old"),NEW_VAL:a.value};this.DoAction(a,b,e,g,c,h)}else a.focus()};this.RewriteInfo=function(a,b,c,d,e){var g=$("#EWA_LF_"+this._Id),h=[];if(a)this._INFO={},this._INFO.INFO=a,this._INFO.ID_NAME=b||"id",this._INFO.INFO_NAME=c||"info",this._INFO.MEMO_NAME=d||"memo";else if(!this._INFO||!this._INFO.INFO)return;for(a=0;a<this._INFO.INFO.length;a++)if(b=this._INFO.INFO[a],c=g.find('[id="'+b[this._INFO.ID_NAME]+'"]:eq(0)'),c.length!==
0){d=c.parentsUntil("tr").last();var k=b[this._INFO.INFO_NAME],l=b[this._INFO.MEMO_NAME];if(k==null||k.trim()=="")for(k=d.parent()[0],l=0;l<k.cells.length;l++){if(k.cells[l]==d[0]){this.ShowHiddenColumn(l,!1);break}}else c.children().length==0?c.text(k):c.children()[0].innerText=k,l&&c.attr("title",l);h.push(c[0]);e&&e(c[0],b,a)}return h};this.ShowHiddenColumn=function(a,b){var c=$X("EWA_LF_"+this._Id),d="";if(b==null||b==0||b=="none")d="none";for(b=0;b<c.rows.length;b++)c.rows[b].cells.length==c.rows[0].cells.length&&
(c.rows[b].cells[a].style.display=d)};this.ShowHiddenColumns=function(a,b){var c=$X("EWA_LF_"+this._Id),d="";if(b==null||b==0||b=="none")d="none";b=c.rows[0].cells.length;for(var e=0;e<c.rows.length;e++){var g=c.rows[e];if(g.cells.length==b)for(var h=0;h<a.length;h++)g.cells[a[h]].style.display=d}};this.GroupShowHidden=function(a){var b=$(a).attr("t"),c=(new Date).getTime();if(!(b&&c-b<333)){$(a).attr("t",c);b=a.parentNode.parentNode;c=b.getAttribute("ewa_group");c==""?(c="none",a.childNodes[0].innerHTML=
" + "):(c="",a.childNodes[0].innerHTML=" - ");b.setAttribute("ewa_group",c);for(var d=b.parentNode.parentNode,e=0,g=b.rowIndex+1;g<d.rows.length;g++){b=d.rows[g];if(b.getAttribute("ewa_tag")=="group")break;b.getAttribute("add_pre_row")?c=="none"?(b.style.display!="none"&&b.setAttribute("ewa_group_show_old",b.style.display),b.style.display="none"):b.hasAttribute("ewa_group_show_old")&&(b.style.display=b.getAttribute("ewa_group_show_old"),b.removeAttribute("ewa_group_show_old")):(b.style.display=c,
e++)}a.childNodes[a.childNodes.length-1].innerHTML=" ("+e+")"}};this.Sort=function(a){var b=this._last_sort_timer||0,c=this._Sort||"",d=(new Date).getTime();c==a&&d-b<500||(this._last_sort_timer=d,this._Sort=a,this.Goto(1))};this.SearchClear=function(a){a=a.parentNode.parentNode.parentNode.parentNode;for(var b=0;b<a.rows.length;b+=1)for(var c=a.rows[b].getElementsByTagName("input"),d=0;d<c.length;d++){var e=c[d];if(e.type=="text")e.value="";else if(e.type=="radio"||e.type=="checkbox")e.checked=!1}};
this.SearchGetExpInit=function(){let a=$("#_G_"+this._Id);var b=[];$(a).find(".ewa-lf-search-item").each(function(){var c=$(this).find("input");if(c.length==0&&(c=$(this).find("select"),c.length==0))return;var d=c[0],e=$(d).attr("t");if(c.length==1){var g=d.value;if(d.value.trim()!="")for(e=="text"&&(c=$(d.parentNode.parentNode).find("a").attr("tag"))&&(e=c),d=d.name.split(","),c=0;c<d.length;c++)b.push(d[c]+"["+e+"]"+g)}else if((e=="date"||e=="number")&&c.length==2){if(g=d.value,e=c[1].value,e!=
""||g!="")b.push(d.name+"[gte]"+g),e&&b.push(d.name+"[lte]"+e)}else if(e=="fix"&&d.tagName=="INPUT"){var h=[""];$(this).find("input").each(function(){this.checked&&h.push(this.value)});h.length!=1&&b.push(d.name+"[or]"+h.join(";"))}});return b.join(",")};this.SearchGetExp=function(a){var b=[];$(a).find(".ewa-lf-search-item").each(function(){var c=$(this).find("input");if(c.length==0&&(c=$(this).find("select"),c.length==0))return;var d=c[0],e=$(d).attr("t");if(c.length==1){var g=d.value;d.value.trim()!=
""&&(e=="text"&&(c=$(d.parentNode.parentNode).find("a").attr("tag"))&&(e=c),b.push("@!@"+d.name+"~!~"+e+"~!~"+g))}else if((e=="date"||e=="number")&&c.length==2)g=d.value,c=c[1].value,c==""&&g==""||b.push("@!@"+d.name+"~!~"+e+"~!~"+g+"~!~"+c);else if(e=="fix"&&d.tagName=="INPUT"){var h=[""];$(this).find("input").each(function(){this.checked&&h.push(this.value)});h.length!=1&&b.push("@!@"+d.name+"~!~"+e+h.join("~!~"))}});return b.join("")};this.DoSearch=function(a){var b=!1;a.id=="EWA_SEARCH_ITEM_"+
this.Id?a=$X("EWA_SEARCH_ITEM_"+this.Id).childNodes[0]:(a=a.parentNode.parentNode.parentNode.parentNode,b=!0);this._SearchExp=this.SearchGetExp(a);b&&(this._SearchHtml=a.parentNode.innerHTML,this._SearchDialog.Show(!1));this.Goto(1)};this.Search=function(a){this._SearchHtml==null?(this._SearchCreate(),this._SearchDialog=new EWA.UI.Dialog.OpenWindow("about:blank","aa",400,100,!0,null,null,!1),this._SearchDialog.SetCaption(_EWA_INFO_MSG["EWA.LF.SEARCH.BUT.TITLE"]),this._SearchDialog._Dialog.AutoSize=
!0,this._SearchDialog._Dialog.SetHtml(this._SearchHtml),this._SearchDialog._Dialog.Show(!0),this._SearchDialog._Dialog.GetFrame().focus(),this._SearchDialog.MoveCenter()):(this._SearchDialog._Dialog.AutoSize=!1,this._SearchDialog.Show(!0))};this.ShowSearch=function(a,b){var c="EWA_SEARCH_ITEM_"+this.Id;b&&(this._IsSearchGroup=!1);$X(c)||(this._SearchCreateItm(),a&&this.composeSearchTexts(),this._ReShowSearchQuick())};this.ChangeSearchTextType=function(a){this._MENU_DATE_RANGE&&this._MENU_DATE_RANGE.HiddenMemu();
this._MENU_TEXT_TYPE.ShowByObject(a,null,0);let b=$(this._MENU_TEXT_TYPE.Dialog.GetFrame());b.find(".search-text-tag").remove();b.find('div[ewa_mg="'+$(a).attr("tag")+'"] td:eq(0)').html('<b class="fa fa-check search-text-tag"></b>')};this.ChangeSearchDateType=function(a){this._MENU_TEXT_TYPE&&this._MENU_TEXT_TYPE.HiddenMemu();this._MENU_DATE_RANGE.ShowByObject(a,null,0)};this.ChangeSearchTextTypeIt=function(a){var b=$(this._MENU_TEXT_TYPE.SHOW_BY_OBJECT).parentsUntil(".ewa-lf-search-item").last(),
c=$J2MAP(this.RESOURCES.search_text_items,"Id")[a];c=EWA.LANG=="enus"?c.TxtEn:c.Txt;b.find("a").attr("tag",a).html(c);let d=b.find("input");a=="blk"||a=="nblk"?d.val(c).prop("disabled",!0):d.prop("disabled")&&b.find("input").val("").prop("disabled",!1)};this._GetInitSearchMap=function(){var a=new EWA_UrlClass(this.Url),b={},c=a.GetParameter("ewa_search");if(!c)return b;this.Url=a.RemoveParameter("ewa_search");c=c.unURL();a=c.split(",");for(var d in a){var e=a[d],g=e.indexOf("["),h=e.indexOf("]");
g<0||h<g||(c=e.substring(0,g).trim(),c.length!=0&&(g=e.substring(g+1,h).trim().toLowerCase(),g.length!=0&&(e=e.substring(h+1).trim(),e!=""&&(b[c.toUpperCase()]||(b[c.toUpperCase()]={name:c,tag:g}),c=b[c.toUpperCase()],g=="lt"||g=="lte"?c.para2=e.unURL().replace(/\+/ig," "):c.para1=e.unURL().replace(/\+/ig," ")))))}return b};this.SearchFilterDate=function(a){var b=$(this._MENU_DATE_RANGE.SHOW_BY_OBJECT).parentsUntil(".ewa-lf-search-item").last(),c=b.find("input")[0];b=b.find("input")[1];if(a=="Clear")$(c).val(""),
$(b).val("");else{var d=EWA_Utils.Date(),e="",g="";a=="Today"?g=e=d.GetDateString():a=="Week"?(a=d.GetBenWeek(),e=a[0],g=a[1]):a=="Today-Weekend"?(a=d.GetBenWeek(),e=a[d.GetDateString()],g=a[1]):a=="Month"?(a=d.GetBenMonth(),e=a[0],g=a[1]):a=="Today-EOM"?(a=d.GetBenMonth(),e=a[d.GetDateString()],g=a[1]):a=="Quarter"?(a=d.GetBenQ(),e=a[0],g=a[1]):a=="Today-EOQ"?(a=d.GetBenQ(),e=a[d.GetDateString()],g=a[1]):a=="Year"?(a=d.GetBenYear(),e=a[0],g=a[1]):a=="Today-EOY"&&(a=d.GetBenYear(),e=a[d.GetDateString()],
g=a[1]);a=EWA_Utils.Date(e).FormatDate();d=EWA_Utils.Date(g).FormatDate();d+=" 23:59:59";$(c).val(a);$(b).val(d)}};this._SearchCreateDateRange=function(){var a="_MENU_DATE_RANGE"+this._Id;$("."+a).remove();var b=EWA.LANG.toLowerCase()=="enus"?"TxtEn":"Txt",c=JSON.parse(JSON.stringify(this.RESOURCES.search_date_items)),d="EWA.F.FOS[&quot;"+this._Id+"&quot;].SearchFilterDate",e;for(e in c){var g=c[e];g.Txt=g[b];g.Cmd=d+"(&quot;"+g.Id+"&quot;)"}b="EWA.F.FOS[&quot;"+this._Id+"&quot;]._MENU_DATE_RANGE";
this._MENU_DATE_RANGE=new EWA_UI_MenuClass(b);this._MENU_DATE_RANGE.Create(c);$(this._MENU_DATE_RANGE.Dialog.GetFrame()).addClass("ewa-lf-search-menu "+a);return b};this._SearchCreateTextType=function(){var a="_MENU_TEXT_TYPE"+this._Id;$("."+a).remove();var b=EWA.LANG.toLowerCase()=="enus"?"TxtEn":"Txt",c=JSON.parse(JSON.stringify(this.RESOURCES.search_text_items)),d="EWA.F.FOS[&quot;"+this._Id+"&quot;].ChangeSearchTextTypeIt",e;for(e in c){var g=c[e];g.Txt=g[b];g.Cmd=d+"(&quot;"+g.Id+"&quot;)";g.Group=
g.Id}b="EWA.F.FOS[&quot;"+this._Id+"&quot;]._MENU_TEXT_TYPE";this._MENU_TEXT_TYPE=new EWA_UI_MenuClass(b);this._MENU_TEXT_TYPE.Create(c);$(this._MENU_TEXT_TYPE.Dialog.GetFrame()).addClass("ewa-lf-search-menu "+a);this._MENU_TEXT_TYPE.clickBeforeEvent=function(h,k){$(this.Dialog.GetFrame()).find(".search-text-tag").remove();$(k).find("td:eq(0)").html('<b class="fa fa-check search-text-tag"></b>')};return b};this._SearchCreateItm=function(){var a="EWA_SEARCH_ITEM_"+this.Id,b=[],c=[],d=[],e={},g;for(g in this._SearchJson)this._SearchJson[g].ORI_NAME=
g,e[g.toUpperCase()]=this._SearchJson[g];this._SearchJson=e;var h="EWA.F.FOS[&quot;"+this._Id+"&quot;].ChangeSearchTextType(this)",k="EWA.F.FOS[&quot;"+this._Id+"&quot;].ChangeSearchDateType(this)",l=$J2MAP(this.RESOURCES.search_text_items,"Id");e=this._GetInitSearchMap();var m=!1,n=!1;for(g in this.ItemList.Items)if(this._SearchJson[g]!=null){var p=[],r=this._SearchJson[g],q=r.T,t=this._GetSubValue("DescriptionSet","Info",this.ItemList.Items[g]);p.push("<table class='ewa-lf-search-item ewa-ref-"+
g+" ewa-lf-search-type-"+q+" "+(q=="fix"?"ewa-lf-search-fix-m"+(r.M||"0"):"")+"' cellspacing=0 cellpadding=0>");p.push("<tr><td class='ewa-lf-search-item-title' style='position:relative'><nobr><b>");p.push(t);var v=t="",u="lk";e[g.toUpperCase()]&&(v=e[g.toUpperCase()],u=v.tag,t=v.para1,v=v.para2);var w="";q=="text"?(n=l[u]||l.lk,w=EWA.LANG=="enus"?n.TxtEn:n.Txt,p.push("<a class='ewa-lf-search-type' tag='"+u+"' href='javascript:void(0)' onclick='"+h+"'>"),p.push(w),p.push("</a>"),n=!0):q=="date"&&
(p.push("<a  href='javascript:void(0)' class='fa fa-calendar-check-o'  onclick='"+k+"'></a>"),m=!0);p.push("</b></nobr></td><td class='ewa-lf-search-item-ctl'>");q=="text"?u=="blk"||u=="nblk"?(r=this._SearchSingle(g,w),r=r.replace("<input","<input disabled "),p.push(r)):p.push(this._SearchSingle(g,t)):q=="date"?p.push(this._SearchDate(g,t,v)):q=="number"?p.push(this._SearchNumber(g,t,v)):q=="fix"&&(r="<div >"+this._SearchFix(g,r,"span",t)+"</div>",p.push(r));p.push("</td></tr></table>");q=="fix"&&
this._IsSearchGroup?c.push(p.join("")):d.push(p.join(""))}if(d.length+c.length!=0){b.push('<table class="ewa-lf-search-main" id="'+a+'" cellspacing="0" cellpadding="0">');b.push("<tr><td class='ewa-lf-search-des'></td><td>");d.length>0&&b.push(" "+d.join("")+" ");for(d=0;d<c.length;d++)b.push(" "+c[d]+" ");b.push("</td></tr></table>");var x=document.createElement("div");this._SEARCH_BOX=x;x.className="ewa-lf-search";x.innerHTML=b.join("");b=$X("EWA_LF_"+this.Id).parentNode;b.parentNode.insertBefore(x,
b);a="EWA_SEARCH_ITEM_"+this.Id;var y=this;m&&this._SearchCreateDateRange();n&&this._SearchCreateTextType();y._SEARCH_ITEM_EXP=this.SearchGetExp(x);JSON.stringify(e)!="{}"&&(y._SearchExp=y._SEARCH_ITEM_EXP);$(x).find("input[type=text]").on("compositionstart",function(){y._is_search_composition=!0}).on("compositionend",function(){y._is_search_composition=!1});this._TIMER_SEARCH=window.setInterval(function(){if(!y._is_search_composition){try{if(!$X(a)){window.clearInterval(y._TIMER_SEARCH);return}}catch(A){window.clearInterval(y._TIMER_SEARCH);
return}var z=y.SearchGetExp(x);z!=y._SEARCH_ITEM_EXP&&(y._SEARCH_ITEM_EXP=z,y.DoSearch($X(a)))}},700)}};this._SearchSingle=function(a,b){var c=[];c.push('<input t="text" type="text" autocomplete="off" class="EWA_INPUT" maxlength="40" name="');c.push(a.toInputValue());c.push('"');b!=null&&(c.push(' value="'),a=b.toInputValue(),c.push(a),c.push('" '));c.push(" />");return c.join("")};this._SearchDate=function(a,b,c){var d=[];d.push("<table border=0 cellpadding=0 cellspacing=0>");d.push('<td  ><input type="text" autocomplete="off" class="EWA_INPUT" t="date" readonly maxlength="8" onclick="EWA.UI.Calendar.Pop(this)" name="');
d.push(a);d.push('"');b&&(b=b.toInputValue(),d.push(' value="'),d.push(b),d.push('"'));d.push(' /></td><td><span class="ewa-lf-search-split"> - </span></td>');d.push('<td  ><input type="text" autocomplete="off" class="EWA_INPUT" t="date" readonly maxlength="8" onclick="EWA.UI.Calendar.Pop(this)" name="');d.push(a);d.push('1"');c&&(b=c.toInputValue(),d.push(' value="'),d.push(b),d.push('"'));d.push("/></td></tr></table>");return d.join("")};this._SearchNumber=function(a,b,c){var d=[];d.push('<input type="text" t="number" size="10" name="');
d.push(a);d.push('"');b&&(b*=1,d.push(' value="'),d.push(b),d.push('"'));d.push(' /><span class="ewa-lf-search-split"> - </span>');d.push('<input type="text" t="number" size="10" name="');d.push(a);d.push('1"');c&&(b=c*1,d.push(' value="'),d.push(b),d.push('"'));d.push("/>");return d.join("")};this._SearchFix=function(a,b,c,d){var e=[],g="radio";if(b.M=="1")g="checkbox";else if(b.M=="2")return this._SearchFix1(a,b,c,d);c="<"+c+"><nobr><input t='fix' [@CHK] id='@ID' value=\"@V\" type='"+g+"' name='"+
a+"' /><label for='@ID'>@T</label></nobr></"+c+"> ";g={};if(d){d=d.split(";");for(var h in d)g[d[h].trim().toUpperCase()]=1}for(h=0;h<b.D.length;h++){var k=b.D[h];d=k[0];k=k[1];var l=this.Id+"_"+a+"_SearchFix_"+h,m=c.replace("@ID",l);m=m.replace("@ID",l);m=m.replace("@V",d);m=g[d.toUpperCase().trim()]?m.replace("[@CHK]","checked"):m.replace("[@CHK]","");m=m.replace("@T",k);e.push(m)}return e.join("")};this._SearchFix1=function(a,b,c,d){c=[];c.push("<select t='fix' name='"+a+"'><option></option>");
for(var e=0;e<b.D.length;e++){var g=b.D[e],h="<option @CKD t='fix' id='@ID' value=\"@V\">@T</option> ".replace("@ID",this.Id+"_"+a+"_SearchFix_"+e);h=h.replace("@V",g[0]);h=h.replace("@T",g[1]);h=d&&g[0]==d?h.replace("@CKD","selected"):h.replace("@CKD","");c.push(h)}c.push("</select>");return c.join("")};this._SearchCreate=function(){var a=[];a.push("<div><table border=0 style='margin:0px;' class=EWA_TABLE cellspacing=1>");for(var b in this.ItemList.Items)if(this._SearchJson[b]!=null){var c=this._SearchJson[b],
d=c.T,e=this._GetSubValue("DescriptionSet","Info",this.ItemList.Items[b]);a.push("<tr><td class=EWA_TD_L width=140><nobr>"+e+"<nobr></td><td width=350 class=EWA_TD_M>");d=="text"?a.push(this._SearchSingle(b)):d=="date"?a.push(this._SearchDate(b)):d=="number"?a.push(this._SearchNumber(b)):d=="fix"&&a.push(this._SearchFix(b,c,"div"));a.push("</td></tr>")}a.push("<tr><td class=EWA_TD_B colspan=2 align=right><input onclick='EWA.F.FOS[\""+this._Id+"\"].SearchClear(this);' type=button value='"+_EWA_INFO_MSG["EWA.LF.SEARCH.BUT.CLEAR"]+
"'> <input type=submit value='"+_EWA_INFO_MSG["EWA.LF.SEARCH.BUT.SEARCH"]+"' onclick='EWA.F.FOS[\""+this._Id+"\"].DoSearch(this);'> <input type=button value='"+_EWA_INFO_MSG["EWA.LF.SEARCH.BUT.CLOSE"]+"' onclick='EWA.F.FOS[\""+this.Id+"\"]._SearchDialog.Show(false);'></td></tr>");a.push("</table></div>");this._SearchHtml=a.join("")};this.createRegExp=function(a){if(!a)return null;a=String(a).trim();if(a.length===0)return null;for(var b=[],c=0;c<a.length;c++){var d=a[c];d>="a"&&d<="z"||d>="A"&&d<=
"Z"||d>="0"&&d<="9"?b.push(d):b.push("\\"+d)}try{return new RegExp("("+b.join("")+")")}catch(e){return console.warn("new RegExp",a,e),null}};this.SearchMark=function(){for(var a=this._SearchExp.split("@!@"),b=$X("EWA_LF_"+this._Id),c=0;c<a.length;c+=1){var d=a[c].split("~!~");if(!(d.length<3))for(var e=2;e<d.length;e++){var g=d[e];if(g=="")continue;if(d[1]=="fix"){var h=d[2];$("table#EWA_SEARCH_ITEM_"+this.Id+' [name="'+d[0]+'"]').find("option").each(function(){this.value==h&&(g=this.text)})}let l=
this.createRegExp(g),m=d[0].split(",");for(let n in m){var k=m[n];this._SearchJson[k]&&(k=this._SearchJson[k].ORI_NAME);k=$(b).find(".ewa-lf-data-row .ewa-col-"+k).not("[ewa-search-marked=yes]");k.attr("ewa-search-marked","yes");try{k.find("*").each(function(){this.children.length==0&&(this.innerHTML=this.innerHTML.replace(l,"<font color=red><b>$1</b></font>"))})}catch(p){console.log(p)}}}}};this.DblClick=function(a){this._IsDblClick=a;for(var b=$X("EWA_LF_"+this._Id),c=1;c<b.rows.length;c++)b.rows[c].ondblclick=
function(){var d=this.getElementsByTagName("input");d.length>a&&d[a].disabled==0&&d[a].click()}};this.Init=function(a){this.Xml=new EWA.C.Xml;this.Xml.LoadXml(a);this.ItemList.Init(this.Xml);this.Resources=new EWA_FrameResoures;this.Resources.Init(this.Xml);if((a=$X("EWA_LF_"+this._Id))&&a.tagName=="table"&&!(a.rows.length<=1)){a=a.rows[1].getElementsByTagName("input");for(var b=0;b<a.length;b++)if(a[b].type.toUpperCase()=="RADIO"){this._TrSelectMulti=!1;break}}};this.SetPageParameters=function(a,
b,c,d,e){this._PageCurrent=a;this._PageSize=c;this._PageCount=b;this._RecordCount=d;this._Sort=e};this.SetPageParametersName=function(a,b,c,d,e){this._PageCurrentName=a;this._PageSizeName=c;this._PageCountName=b;this._RecordCountName=d;this._SortName=e};this.CheckedAll=function(){var a=document.getElementById("EWA_LF_"+this._Id);if(!(a.rows.length<=1)){for(var b=0;b<a.rows.length;b+=1){var c=a.rows[b].getElementsByTagName("input");c.length!=0&&(c[0].checked=this._IsCheckedAll)}this._IsCheckedAll=
this._IsCheckedAll?!1:!0;this.CheckedAllAfter&&this.CheckedAllAfter(a)}};this.SelectChecked=function(){var a=$X("EWA_LF_"+this._Id);if(!a||a.rows.length<1)return"";var b=[];let c=[];$("#EWA_LF_"+this._Id+">tbody>tr").find("input[type='radio'],input[type='checkbox']").each(function(){this.parentNode.className.indexOf("ewa-switch")==-1&&c.push(this)});if(c.length>0)for(var d=0;d<c.length;d++)c[d].checked&&b.push(c[d].value);else for(d=0;d<a.rows.length;d++){var e=a.rows[d];e.getAttribute("__ewa_lf_mdown")==
1&&b.push(e.getAttribute("EWA_KEY"))}return b.join(",")};this.SelectCheckedInputs=function(){var a=[],b=$X("EWA_LF_"+this._Id);if(b.rows.length<1)return a;b=b.getElementsByTagName("input");a=[];for(var c=0;c<b.length;c++)(b[c].type.toUpperCase()=="CHECKBOX"||b[c].type.toUpperCase()=="RADIO")&&b[c].checked&&a.push(b[c]);return a};this.SelectCheckedRows=function(){for(var a=[],b=$X("EWA_LF_"+this._Id),c=0;c<b.rows.length;c++){var d=b.rows[c],e=d.getElementsByTagName("input");e.length!=0&&e[0].checked&&
e[0].parentNode.className.indexOf("ewa-switch")==-1&&a.push(d)}if(a.length==0)for(c=0;c<b.rows.length;c++)d=b.rows[c],d.getAttribute("__ewa_lf_mdown")==1&&a.push(d);return a};this.Reload=function(a){this.StopAjaxAfterReload?this.StopAjaxAfterReload=!1:this.Goto(this._PageCurrent,a)};this.refreshPage=function(a,b){this.replaceRowsData(null,null,a,b)};this.replaceRowsData=function(a,b,c,d){var e=this.getUrlClass();e.AddParameter("EWA_AJAX","LF_RELOAD");e.AddParameter("EWA_IS_SPLIT_PAGE","no");e.AddParameter("EWA_IS_HIDDEN_CAPTION",
"yes");e=e.GetUrl();a&&(e+="&"+a);let g=a?new EWA_AjaxClass:this.CreateAjax(),h=this;g.PostNew(e,function(){if(g._Http.readyState==4){g.HiddenWaitting();var k=g._Http.responseText;g._Http.status!=200?(console.error(k),alert("ERROR:\r\n"+g._Http.statusText)):EWA.F.CheckCallBack(k)?h.replaceRowsWithDataHtml(k,b,c,d):console.error(k)}})};this.replaceRowsWithDataHtml=function(a,b,c,d){let e=$("<div></div>");e.html(a);let g=[],h=$("#EWA_LF_"+this._Id);e.find(".ewa-lf-data-row").each(function(){var k='tr[ewa_key="'+
$(this).attr("ewa_key")+'"]';let l=h.find(k);if(l.length==0)console.warn(k+" not found");else{k=$(this).attr("ewa_row_sign");var m=l.attr("ewa_row_sign"),n=!0;(k||m)&&m===k&&(n=!1);if(n){l.attr("ewa_row_sign",k);k=l.clone()[0];for(m=0;m<this.cells.length;m++){n=l[0].cells[m];let p=this.cells[m];n.removeAttribute("ewa-merged");n.removeAttribute("ewa-search-marked");b?b(p,n):n.innerHTML=p.innerHTML}g.push({before:k,current:l[0]})}}});e.remove();this.SearchMark();this.IsReShow&&this.ReShowWithNoButtons();
this._ReShowSearchQuick();this._IsDblClick!=null&&this.DblClick(this._IsDblClick);this.SubBottomsArray&&this._SubBottoms();this.ReloadAfter&&this.ReloadAfter(c);this.ReloadAfterApp&&this.ReloadAfterApp(c);d&&d(g)};this.DoAction=function(a,b,c,d,e,g){EWA.F.CID=this._Id;if(b){if(a&&$(a).parent().hasClass("scroll-delete")){var h=$(a).attr("do-action-time")||0,k=(new Date).getTime();if(k-h<1E3)return;$(a).attr("do-action-time",k)}this.lastAction=b;this._Ajax=new EWA_AjaxClass;this._Ajax.LoadingType="image";
this._Ajax.AddParameter("EWA_AJAX","1");this._Ajax.AddParameter("EWA_ACTION",b);this._Ajax.AddParameter("EWA_ID",this._Id);this._Ajax.AddParameter("EWA_NO_CONTENT","1");this._Ajax.AddParameter("EWA_ACTION_TIP",d);g!=null&&g.trim().length>0?(this._Ajax.AddParameter("EWA_AFTER_EVENT",g),this.StopAjaxAfterReload=!0,this._Ajax.AddParameter("EWA_ACTION_RELOAD","0")):this.StopAjaxAfterReload=!1;if(a&&a.getAttribute&&a.getAttribute("box_menu_item")=="yes"){if(this._Ajax.AddParameter("___CALL__FROM__","box"),
a=a.parentNode)a=a.getAttribute("json_ref"),a=JSON.parse(a),a.EWA_KEY&&this._Ajax.AddParameter("EWA_ACTION_KEY",a.EWA_KEY)}else(a=this.GetRowKey(a))&&this._Ajax.AddParameter("EWA_ACTION_KEY",a);a=this.SelectChecked();this._Ajax.AddParameter("IDS_SPLIT",a);if(e!=null&&e.length>0)for(a=0;a<e.length;a+=1)this._Ajax.AddParameter(e[a].Name,e[a].Value);e=new EWA.C.Url;e.SetUrl(this.Url);var l=e.RemoveParameter("EWA_ACTION"),m=this;c?((e=_EWA_INFO_MSG[c])||(e=c),$Confirm(e,"Confirm",function(){m._Ajax.PostNew(l,
function(){m._CallBackJs()})})):this._Ajax.PostNew(l,function(){m._CallBackJs()})}};this.NewPageSize=function(a){this._PageSize!=a&&(this._PageSize=a,this.Goto(1))};this.Goto=function(a,b){EWA.F.CID=this._Id;this._PageCurrent=a;this._Ajax=this.CreateAjax();a=new EWA_UrlClass;a.SetUrl(this.Url==null?document.location.href:this.Url);a.RemoveParameter("EWA_AJAX");var c=this;this._Ajax.PostNew(a.GetUrl(),function(){c._CallBack(b)});this.REPLACE_HISTORY_STATE&&this.replaceHistoryState()};this.createReplaceHistoryStateUrl=
function(){var a=new EWA_UrlClass;a.SetUrl(this.Url==null?document.location.href:this.Url);a.AddParameter(this._PageCurrentName,this._PageCurrent);this._PageSize&&a.AddParameter(this._PageSizeName,this._PageSize);this._Sort!=null&&a.AddParameter(this._SortName,this._Sort);var b=this.SearchGetExpInit();b&&a.AddParameter("EWA_SEARCH",b);if(this.GotoParas!=null&&this.GotoParas.length>0)for(b=0;b<this.GotoParas.length;b+=1)a.AddParameter(this.GotoParas[b].Name,this.GotoParas[b].Value);a.RemoveParameter("EWA_AJAX");
return a};this.replaceHistoryState=function(){let a=this.createReplaceHistoryStateUrl();window.history.replaceState("",null,a.GetUrl())};this.CreateAjax=function(){var a=new EWA.C.Ajax;a.LoadingType="image";a.AddParameter(this._PageCurrentName,this._PageCurrent);this._PageSize&&a.AddParameter(this._PageSizeName,this._PageSize);this._Sort!=null&&a.AddParameter(this._SortName,this._Sort);this._SearchExp!=null&&this._SearchExp!=""&&a.AddParameter("EWA_LF_SEARCH",this._SearchExp);a.AddParameter("EWA_AJAX",
"LF_RELOAD");if(this.GotoParas!=null&&this.GotoParas.length>0)for(var b=0;b<this.GotoParas.length;b+=1)a.AddParameter(this.GotoParas[b].Name,this.GotoParas[b].Value);return a};this.DownlodData=function(a,b){EWA.F.CID=this._Id;this._Ajax=new EWA.C.Ajax;this._Ajax.LoadingType="image";this._Sort!=null&&this._Ajax.AddParameter(this._SortName,this._Sort);this._SearchExp!=null&&this._SearchExp!=""&&this._Ajax.AddParameter("EWA_LF_SEARCH",this._SearchExp);this._Ajax.AddParameter("EWA_AJAX","DOWN_DATA");
this._Ajax.AddParameter("EWA_AJAX_DOWN_TYPE",a);b&&this._Ajax.AddParameter("EWA_ACTION",b);if(this.GotoParas!=null&&this.GotoParas.length>0)for(a=0;a<this.GotoParas.length;a+=1)this._Ajax.AddParameter(this.GotoParas[a].Name,this.GotoParas[a].Value);this._AjaxType="DOWN_DATA";a=new EWA_UrlClass;a.SetUrl(this.Url==null?document.location.href:this.Url);var c=this;this._Ajax.PostNew(a.GetUrl(),function(){c._CallBack()})};this.Get=function(a){EWA.F.CID=this._Id;this._Ajax=new EWA.C.Ajax;this._Ajax.LoadingType=
"image";var b=this;this._Ajax.Get(a,function(){b._CallBack()})};this.Post=function(a,b){EWA.F.CID=this._Id;this._Ajax=new EWA.C.Ajax;this._Ajax.LoadingType="image";var c=this;this._Ajax.Post(a,b,function(){c._CallBackJs()})};this._CallBack=function(a){var b=this._Ajax;if(b._Http.readyState==4){b.HiddenWaitting();if(top.EWA&&top.EWA.MQE){var c=new EWA_MqeClass;c.Data=b.GetRst();c.FromId=EWA.F.CID;c.Type="POST";top.EWA.MQE.AddMqe(c)}b._Http.status==200?(b=b._Http.responseText,EWA.F.CheckCallBack(b)&&
(this._AjaxType=="DOWN_DATA"?(this._AjaxType=null,b.trim()=="DENY"?alert(_EWA_INFO_MSG["EWA.LF.DOWN_DATA.DENY"]):window.location.href=b.trim()):(c=$X("EWA_LF_"+this._Id).parentNode,$(c).replaceWith(b),this.SearchMark(),this.IsReShow&&this.ReShowWithNoButtons(),this._ReShowSearchQuick(),this._IsDblClick!=null&&this.DblClick(this._IsDblClick),this._IsAddPreRow&&this.AddPreRow(),this.SubBottomsArray&&this._SubBottoms(),this._isStickyHeaders&&this.stickyHeaders(),this.ReloadAfter&&this.ReloadAfter(a),
this.ReloadAfterApp&&this.ReloadAfterApp(a),this._IsCheckedAll=!0))):alert("ERROR:\r\n"+b._Http.statusText);this.RewriteInfo()}};this._CallBackJs=function(){var a=this._Ajax;if(a._Http.readyState==4){if(top.EWA&&top.EWA.MQE){var b=new EWA_MqeClass;b.Data=a.GetRst();b.FromId=EWA.F.CID;b.Type="POST";top.EWA.MQE.AddMqe(b)}a.HiddenWaitting();a._Http.status==200?(a=a._Http.responseText,EWA.F.CheckCallBack(a)&&eval(a)):alert("ERROR:\r\n"+a._Http.statusText);this.EditAfterEvent&&this.EditAfterEvent()}};
this.EditAfterEvent=function(){this.getUrlClass().GetParameter("EWA_ROW_SIGN")&&this.refreshPage()};this._GetItem=function(a){for(var b=this.ItemList,c=0;c<b.length;c+=1){var d=b[c],e=this._GetSubItem("Name",d);if(this.Xml.GetElementAttribute(e,"Name")==a)return d}};this._GetSubItem=function(a,b){b=this.Xml.GetElements(a+"/Set",b);if(b==null||b.length==0)return null;if(a=="DescriptionSet")for(a=0;a<b.length;a+=1){var c=b[a].getAttribute("Lang");if(c!=null&&c.trim().toUpperCase()==EWA.LANG.trim().toUpperCase())return b[a]}return b[0]};
this._GetSubValue=function(a,b,c){a=this._GetSubItem(a,c);return a==null?null:this.Xml.GetElementAttribute(a,b)};this.AddColumns=function(a,b,c,d,e,g,h,k){var l=$X("EWA_LF_"+this._Id);k==null&&(k=l.rows[0].cells.length);for(var m=0;m<a.length;m++)for(var n=a[m],p=k+m,r=0;r<l.rows.length;r++){var q=l.rows[r].insertCell(p);q.title=n[d];if(r==0)q.className="EWA_TD_H ewa-add-column ewa-col-"+n[b],q.innerHTML='<nobr cellIdx="'+p+'" id="'+n[b]+'">'+n[c]+"</nobr>",q.title=n[d],q.width=100;else{var t=l.rows[r].getAttribute("EWA_KEY");
q.className="EWA_TD_M ewa-add-column ewa-col-"+n[b];t=t+"_"+n[b];var v=this._GetAddControl(n[g],n[c],n[d]);v==null&&(v=e);var u=h.replace("[ID]",n[b]);v=v.indexOf("<select")>=0?v.replace("!!",u.replace("onblur=","onchange=")):v.replace("!!",u);q.innerHTML=v;q.childNodes[0].id=t}}};this._GetAddControl=function(a,b,c){if(a==null)return null;a=a.toUpperCase().trim();b=b?b.replace(/</ig,"&lt;").replace(/>/ig,"&gt;").replace(/"/ig,"&quot;"):"";c=c?c.replace(/</ig,"&lt;").replace(/>/ig,"&gt;").replace(/"/ig,
"&quot;"):"";return a=="SELECT"?'<select des="'+b+'"  title="'+c+'" !!></select>':a=="DATE"?'<input type=text des="'+b+'" title="'+c+'" class=EWA_INPUT onclick="EWA.UI.Calendar.Pop(this,false);" readonly !!>':a=="TIME"?'<input type=text des="'+b+'" title="'+c+'"  class=EWA_INPUT onclick="EWA.UI.Calendar.Pop(this,true);" readonly !!>':a=="STRING"||a=="NUMBER"?'<input type=text des="'+b+'"  title="'+c+'" class=EWA_INPUT !!>':null};this.AddedValues=function(a,b,c,d,e){for(var g=0;g<a.length;g++){var h=
a[g],k=$X(h[b]+"_"+h[c]);if(!k)break;var l=k.tagName.toUpperCase();l=="INPUT"||l=="SELECT"||l=="TEXTAREA"?k.value=h[d]:k.innerHTML=h[d];e&&(this.GetRow(k).getElementsByTagName("input")[0].checked=!0)}};this.AddRow=function(a){for(var b=$X("EWA_LF_"+this._Id),c=b.insertRow(-1),d=0;d<b.rows[0].cells.length;d++){var e=c.insertCell(-1),g=b.rows[0].cells[d];e.className="EWA_TD_M";a[d]!=null&&(e.innerHTML=a[d]);e.style.display=g.style.display;e.id="ADD_ROW_"+g.childNodes[0].id}return c};this.Calc=function(a,
b,c,d){for(var e=$X("EWA_LF_"+this._Id),g={},h=0;h<a.length;h++)g[a[h]]=0;for(h=b;h<c;h++)for(a=e.rows[h],b=0;b<a.cells.length;b++)if(g[b]!=null){var k=a.cells[b],l=k.getElementsByTagName("input");l.length>0?g[b]+=l[0].value*1:(k=GetInnerText(k),k==""&&(k=0),g[b]+=k*1)}c=e.rows[d];for(h=0;h<c.cells.length;h++)g[h]!=null&&(k=Math.round(g[h]*100)/100,d=GetInnerText(c.cells[h]),k!=d*1&&(this.IsCalcChanged=!0),c.cells[h].innerHTML=k.fm())};this.mergeHeaders=function(a,b,c){var d=$($X("EWA_LF_"+this._Id)),
e=d.find('tr[ewa_tag="HEADER"]');if(e.length!=0&&(a=e.find('nobr[id="'+a+'"]').parent(),a.length!=0)){var g=d.find("tr[ewa_mearge]");g.length==0&&(g=$(d[0].insertRow(1)),g.attr("ewa_mearge","gdx"));d=-1;for(var h=0;h<e[0].cells.length;h++){var k=e[0].cells[h];k==a[0]&&(d=h,k.colSpan=c);if(d==-1)$(k).attr("ewa_tdmearged")!="1"&&(k.rowSpan=2);else if(d+c==h)d=-1,k.rowSpan=2;else{k.rowSpan=1;var l=g[0].insertCell(-1);l.innerHTML=k.innerHTML;l.className=k.className;l.style.cssText=k.style.cssText;k.style.display=
"none";$(k).attr("ewa_tdmearged",1)}k==a[0]&&(k.innerHTML=b,k.style.display="",k.style.width="")}}};this.MeargeHeader=function(a,b,c){console.log("\u62fc\u5199\u9519\u8bef\uff0c\u8bf7\u7528 mergeHeaders");this.mergeHeaders(a,b,c)};this.getUrlClass=function(){var a=new EWA_UrlClass;a.SetUrl(this.Url);return a}}
EWA_ListFrameClass.prototype.RESOURCES={search_text_items:[{Id:"lk",Txt:"\u5305\u542b",TxtEn:"Like"},{Id:"llk",Txt:"\u5de6\u5305\u542b",TxtEn:"Left like"},{Id:"rlk",Txt:"\u53f3\u5305\u542b",TxtEn:"Right like"},{Id:"eq",Txt:"\u7b49\u4e8e",TxtEn:"Equals"},{Id:"uneq",Txt:"\u4e0d\u7b49\u4e8e",TxtEn:"Not equals"},{Id:"nlk",Txt:"\u4e0d\u5305\u542b",TxtEn:"Not contains"},{Id:"blk",Txt:"\u7a7a\u767d",TxtEn:"Blank"},{Id:"nblk",Txt:"\u975e\u7a7a\u767d",TxtEn:"Not blank"}],search_date_items:[{Id:"Clear",Txt:"\u6e05\u7a7a",
TxtEn:"Clear",Img:"fa fa-eraser"},{Id:"Today",Txt:"\u4eca\u5929",TxtEn:"Today"},{Id:"Week",Txt:"\u672c\u5468",TxtEn:"Week"},{Id:"Today-Weekend",Txt:"\u4eca\u5929\u81f3\u5468\u65e5",TxtEn:"Today-Weekend"},{Id:"Month",Txt:"\u672c\u6708",TxtEn:"This Month"},{Id:"Today-EOM",Txt:"\u4eca\u5929\u81f3\u6708\u5e95",TxtEn:"Today-EOM"},{Id:"Quarter",Txt:"\u672c\u5b63\u5ea6",TxtEn:"This Quarter"},{Id:"Today-EOQ",Txt:"\u4eca\u5929\u81f3\u5b63\u672b",TxtEn:"Today-EOQ"},{Id:"Year",Txt:"\u672c\u5e74\u5ea6",TxtEn:"This Year"},
{Id:"Today-EOY",Txt:"\u4eca\u5929\u81f3\u5e74\u5e95",TxtEn:"Today-EOY"}]};EWA.F.L={CUR:null,C:EWA_ListFrameClass};
function EWA_ListFrame_CellResizeClass(a){this._Name=a;this._Cover=this._Table=null;this._CellResize=[];this.Init=function(b){this._Table=b;this._Table.style.tableLayout="fixed";this._Table.style.width=this._Table.clientWidth+"px";this._Cover=this._CreateElement("div","width:100%; height:100%;background-color:blue; position:absolute; top:0px; left:0px; display:block; filter:alpha(opacity=0);opacity:0",document.body);for(b=0;b<this._Table.rows[0].cells.length-1;b++)this._CreateMarker(b);this._SetLocation()};
this._ShowCover=function(b){this._Cover.style.display=b?"block":"none"};this._EventX=function(b){return b.x?b.x:b.pageX};this._OnMouseDown=function(b,c){this._ShowCover(!0);b.childNodes[0].style.borderLeft="1px solid black";b.setAttribute("D",1);c=c?c:event;var d=this._EventX(c);b.setAttribute("X",d);b.setAttribute("SX",d);typeof c.preventDefault!="undefined"&&c.preventDefault();typeof c.stopPropagation!="undefined"?c.stopPropagation():c.cancelBubble=!0};this._OnMouseUp=function(b,c){b.childNodes[0].style.borderLeft=
"1px";b.setAttribute("D",0);c=c?c:event;var d=this._EventX(c)-b.getAttribute("SX")*1;b=b.getAttribute("TDINDEX");b=this._Table.rows[0].cells[b];d=b.clientWidth+d;b.style.width=d<4?4:d+"px";this._SetLocation();typeof c.preventDefault!="undefined"&&c.preventDefault();typeof c.stopPropagation!="undefined"?c.stopPropagation():c.cancelBubble=!0};this._OnMouseOut=function(b,c){b.getAttribute("D")=="1"&&(b.style.left=b.getAttribute("SX")+"px",b.setAttribute("D",0),this._SetLocation(),b.childNodes[0].style.borderLeft=
"1px");this._ShowCover(!1)};this._OnMouseMove=function(b,c){this._ShowCover(!0);if(b.getAttribute("D")=="1"){c=c?c:event;var d=this._EventX(c),e=b.getAttribute("X")*1;e=d-e;b.style.left=b.style.left.replace("px","")*1+e+"px";b.setAttribute("X",d);typeof c.preventDefault!="undefined"&&c.preventDefault();typeof c.stopPropagation!="undefined"?c.stopPropagation():c.cancelBubble=!0}};this._CreateMarker=function(b){var c=this._CreateElement("div","width:40px; height:"+this._Table.clientHeight+"px; position:absolute;cursor:e-resize",
document.body);c.setAttribute("TDINDEX",b);c.setAttribute("instanceName",a);c.onmouseover=function(){var d=this.getAttribute("instanceName");eval("window."+d)._ShowCover(!0)};c.onmousedown=function(d){var e=this.getAttribute("instanceName");eval("window."+e)._OnMouseDown(this,d)};c.onmouseup=function(d){var e=this.getAttribute("instanceName");eval("window."+e)._OnMouseUp(this,d)};c.onmouseout=function(d){var e=this.getAttribute("instanceName");eval("window."+e)._OnMouseOut(this,d)};c.onmousemove=
function(d){var e=this.getAttribute("instanceName");eval("window."+e)._OnMouseMove(this,d)};this._CreateElement("div","width:1px;height:100%;position:absolute;top:0px;left:20px;border-Left:1px ;",c);this._CellResize[b]=c;c=null};this._SetLocation=function(){for(var b=0;b<this._Table.rows[0].cells.length-1;b++){var c=this._Table.rows[0].cells[b],d=this._Location(c);c.style.width!=""&&(c.style.width=c.clientWidth+"px");this._CellResize[b].style.left=d[0]+c.clientWidth-this._CellResize[b].clientWidth/
2+"px";this._CellResize[b].style.top=d[1]+"px"}};this._CreateElement=function(b,c,d){b=document.createElement(b);c!=null&&(b.style.cssText=c,b.setAttribute("style",c));d!=null&&d.appendChild(b);return b};this._Location=function(b){var c;var d=c=0;do d+=b.offsetLeft,c+=b.offsetTop,b=b.offsetParent;while(b.tagName!="BODY");return[d,c]}}
function EWA_ListFrame_ShowHideColumns(a){this._name=a;this.storageId=this.frameUnid="";this.inited=!1;this.notHideColsArr=[];this.defHideCols="";this.readme="\u5408\u5e76\u5217\u548c\u8bbe\u7f6e\u5b8c\u521d\u59cb\u67e5\u8be2\u6761\u4ef6\u540e\uff0c\u518d\u6267\u884cinit\u3002 \u53c2\u6570\u8bf4\u660e\uff1aSYS_FRAME_UNID;\u4e0d\u9690\u85cf\u7684\u5217\uff08\u9017\u53f7\u5206\u9694\uff09\uff0c\u590d\u9009\u5217\u4e0d\u9690\u85cf defHideCols \u9ed8\u8ba4\u9690\u85cf\u7684\u5217";this.wrap="";this.setWrap=
function(b){this.wrap="#"+b};this.initPart=function(b,c,d){if($(".grp-part").length>0){var e=$("#EWA_LF_"+b).parentsUntil(".grp-part").parent().attr("id");this.setWrap(e)}this.init(b,c,d);e&&$("#"+e+" .but-shc-gear b.fa-gear").css({"line-height":"100%","font-size":"14px"})};this.init=function(b,c,d){if(!this.inited){var e=this;this.frameUnid=b;this.wrap||(this.wrap="#"+b+"_RESHOW");this.defHideCols=d;this.storageId="LF_HIDE_COLS_"+this.frameUnid;c&&(this.notHideColsArr=c.split(","));d&&!window.localStorage.hasOwnProperty(this.storageId)&&
(window.localStorage[this.storageId]=d);c=$(this.wrap+" .ewa_lf_func_caption").parent();var g=!1;c.find(".but-shc-gear").length===0&&(g=!0,c.append('<div class="ewa_lf_func_dact ewa-lf-func-recycle but-shc-gear"><b class="fa fa-gear"  style="font-size: 16px;line-height: 30px;"></b></div>'),c.find(".but-shc-gear").on("click",function(){e.togglePanel()}));if(d=window.localStorage[this.storageId]){if(d=d.split(","),!g)for(g=0;g<d.length;g++)$("#EWA_LF_"+b+" .ewa-col-"+d[g]+".EWA_TD_H:hidden").show()}else d=
[];var h=[];$("#EWA_LF_"+b+" .EWA_TD_H:not(:hidden)").each(function(){if($(this).find("a[href*='CheckedAll']").length===0){var k=$(this).find("nobr").attr("id"),l=$(this).text();h.push({id:k,name:l})}});if(h.length===0){this.hideCols();return}b=[];b.push("<div class='custom-cols-panel-box' data-fid=\""+this.frameUnid+'">');g="";g=EWA.LANG.toLowerCase()=="enus"?"Show/Hide&nbsp;&nbsp;<a href='javascript:void(0)' class='but-default'>Default</a>":"\u663e\u793a/\u9690\u85cf\u5217&nbsp;&nbsp;<a href='javascript:void(0)' class='but-default'>\u9ed8\u8ba4</a>";
b.push("<div class='custom-cols-header'>"+(g+"<b class='fa fa-close but-close'></b></div>"));b.push("<div class='custom-cols-contain'>");b.push("<ul>");for(g=0;g<h.length;g++)b.push("<li><input type='checkbox' checked  value='"+h[g].id+"' id='custom_cols_id_"+h[g].id+"'><label for='custom_cols_id_"+h[g].id+"'>"+h[g].name.replace(/>/ig,"&gt")+"</label></li>");b.push("</ul>");b.push("</div>");b.push("</div>");c.append(b.join(""));c.find(".but-default").on("click",function(){e.setDefault()});c.find(".but-close").on("click",
function(){e.togglePanel()});c.find("li input[type=checkbox]").on("click",function(){e.setCol(this.value)});if(d.length>0)for(g=0;g<d.length;g++)$(this.wrap+" .custom-cols-panel-box input[value='"+d[g]+"']").length>0?$(this.wrap+" .custom-cols-panel-box input[value='"+d[g]+"']")[0].checked=!1:this.setCol(d[g]);if(this.notHideColsArr.length>0)for(g=0;g<this.notHideColsArr.length;g++)b=this.notHideColsArr[g],c=$(this.wrap+" .custom-cols-panel-box input[value='"+b+"']"),c.length>0&&(c.parent().addClass("not-hide-col"),
c[0].checked||(this.setCol(b),c[0].checked=!0),c[0].disabled=!0);this.inited=!0}this.hideCols()};this.adjustPanel=function(){var b=window.innerHeight-80;$(this.wrap+" .custom-cols-contain").height();$(this.wrap+" .but-shc-gear").offset();var c=window.innerWidth,d=$(this.wrap+" .custom-cols-panel-box").width();c=(c-d)/2;$(this.wrap+" .custom-cols-contain").css({"max-height":b});$(this.wrap+" .custom-cols-panel-box").css({right:c,top:"0"})};this.togglePanel=function(){this.inited||this.init(this.frameUnid);
$('.custom-cols-panel-box[data-fid!="'+this.frameUnid+'"]').hide();$(this.wrap+" .custom-cols-panel-box").toggle();$(this.wrap+" .custom-cols-panel-box").is("hide")||this.adjustPanel()};this.hideCols=function(){var b=window.localStorage[this.storageId];if(b){b=b.split(",");for(var c=0;c<b.length;c++)this.hide(b[c])}};this.show=function(b){$("#EWA_LF_"+this.frameUnid+" .ewa-col-"+b).show();$("#EWA_SEARCH_ITEM_"+this.frameUnid+" .ewa-lf-search-item [name='"+b+"']").parentsUntil(".ewa-lf-search-item").last().parent().show();
$("#EWA_LF_"+this.frameUnid+" #ADD_ROW_"+b).show();$("#EWA_LF_"+this.frameUnid+" #INS_ROW_"+b).show()};this.hide=function(b){var c=$("#EWA_SEARCH_ITEM_"+this.frameUnid+" .ewa-lf-search-item [name='"+b+"']").parentsUntil(".ewa-lf-search-item").last().parent();c.find("select").val("");c.find("input[type=text]").val("");c.find("input:checked").each(function(){this.checked=!1});$("#EWA_LF_"+this.frameUnid+" .ewa-col-"+b).hide();c.hide();$("#EWA_LF_"+this.frameUnid+" #ADD_ROW_"+b).hide();$("#EWA_LF_"+
this.frameUnid+" #INS_ROW_"+b).hide()};this.setCol=function(b){this.frameUnid||$Tip("not init");if(!($("#EWA_LF_"+this.frameUnid+" .ewa-col-"+b+" a[href*='CheckedAll']").length>0)){var c=window.localStorage[this.storageId];if(c){c=c.split(",");for(var d=[],e=0;e<c.length;e++)b==c[e]?this.show(b):d.push(c[e]);c.length==d.length&&(d.push(b),this.hide(b));window.localStorage[this.storageId]=d.join(",")}else window.localStorage[this.storageId]=b,this.hide(b)}};this.setDefault=function(){this.togglePanel();
window.localStorage[this.storageId]=this.defHideCols;for(var b=$(this.wrap+" .custom-cols-panel-box input"),c=0;c<b.length;c++)b[c].checked=!0;if(this.defHideCols)for(b=this.defHideCols.split(","),c=0;c<b.length;c++)$(this.wrap+" .custom-cols-panel-box input[value='"+b[c]+"']").length>0?$(this.wrap+" .custom-cols-panel-box input[value='"+b[c]+"']")[0].checked=!1:this.setCol(b[c]);EWA.F.FOS[this.frameUnid].Reload()}}
function EWA_MultiGridClass(a,b){this.ClassName=a;this.Url=b;this._Id=this.TransParent=null;this.Resources={};this.Init=function(c){this.Xml=new EWA.C.Xml;this.Xml.LoadXml(c);this.Resources=new EWA_FrameResoures;this.Resources.Init(this.Xml)};this.CollapseCol=function(c,d){var e="",g=d.parentNode;g.getAttribute("expand")==null||g.getAttribute("expand")==1?(g.setAttribute("expand",0),d.innerHTML="+",e="none",g.setAttribute("col_span",g.colSpan),g.colSpan=1,g.style.fontStyle="italic",g.style.color=
"blue"):(g.setAttribute("expand",1),d.innerHTML="-",g.colSpan=g.getAttribute("col_span"),g.style.fontStyle="",g.style.color="#000");var h=document.getElementsByTagName(c);c=[];var k=[];for(d=0;d<h.length;d++){var l=h[d],m=l.parentNode.parentNode.rowIndex;c[m]==null&&(c[m]=[]);l=l.parentNode;c[m].push(l);e=="none"&&l.style.display=="none"&&k.push(l.id)}if(e=="none")g.setAttribute("ids","["+k.join("][")+"]");else{var n=g.getAttribute("ids");n=n==null?"":n}for(d=0;d<c.length;d++)if(c[d]!=null){for(h=
g=0;h<c[d].length;h++)k=c[d][h],g+=k.getAttribute("val")*1,m="["+k.id+"]",h>0&&(e==""?n.indexOf(m)<0&&(k.style.display=e):k.style.display=e);k=c[d][0];e==""?(m="["+k.id+"]",n.indexOf(m)<0&&(k.childNodes[0].innerHTML=k.getAttribute("val"),k.style.fontStyle="",k.style.color="#000")):(k.childNodes[0].innerHTML=k.className=="EWA_GRID_H"?k.childNodes[0].innerHTML+"...":g,k.style.fontStyle="italic",k.style.color="blue")}};this.Trans=function(){var c=new EWA_UrlClass;c.SetUrl(this.Url);this.Url.indexOf("&EWA_GRID_TRANS=")>
0?c.RemoveParameter("EWA_GRID_TRANS"):c.AddParameter("EWA_GRID_TRANS","1");this.TransParent=$X("EWA_MG_"+this._Id).parentNode;this.Url=c.GetUrl();this._DoTrans(c.GetUrl())};this._DoTrans=function(c){EWA.F.CID=this._Id;this._Ajax=new EWA.C.Ajax;this._Ajax.LoadingType="image";this._Ajax.AddParameter("EWA_AJAX","1");this._Ajax.AddParameter("EWA_ID",this._Id);this._Ajax.PostNew(c,EWA.F.FOS[EWA.F.CID]._CallBackJs)};this.Reload=function(){var c=new EWA_UrlClass;c.SetUrl(this.Url);this.TransParent=$X("EWA_MG_"+
this._Id).parentNode;this.Url=c.GetUrl();this._DoTrans(c.GetUrl())};this.ReloadAfter=function(){};this.getUrlClass=function(){var c=new EWA_UrlClass;c.SetUrl(this.Url);return c};this._CallBackJs=function(){var c=EWA.F.FOS[EWA.F.CID]._Ajax;c._Http.readyState==4&&(c.HiddenWaitting(),c._Http.status==200?(c=c._Http.responseText,EWA.F.CheckCallBack(c)&&(EWA.F.FOS[EWA.F.CID].TransParent.innerHTML=c,EWA.F.FOS[EWA.F.CID].ReloadAfter&&EWA.F.FOS[EWA.F.CID].ReloadAfter())):alert("ERROR:\r\n"+c._Http.statusText))}}
EWA.UI.MultiGrid={COLOR_BG:"rgba(173, 216, 230, 0.25)",COLOR_FOCUS:"gold",MTbId:null,MTbs:{},MOut:function(a){a=a||event;var b=a.srcElement||a.target;if(b!=null){a.stopPropagation?a.stopPropagation():a.cancelBubble();a=0;try{for(;!(b&&b.tagName&&b.tagName.toUpperCase()=="TD"&&b.id.indexOf("$MGC_")>0);)if(b=b.parentNode,a++,a>5)return}catch(m){return}var c=b.id;if(c!=EWA.UI.MultiGrid.MTbId){EWA.UI.MultiGrid.MTbId=c;var d=c.split("_"),e=d[2];a=d[1];var g=b.parentNode.parentNode.parentNode;this.MTbs[g.id]==
null&&(this.MTbs[g.id]=[]);b=this.MTbs[g.id];for(var h=0;h<b.length;h++)this._restoreBg(b[h]);for(h=b.length=0;h<1E3;h++){var k=d[0]+"_"+h+"_"+d[2],l=$X(k);if(!l)break;k==c?this._setBg(l,this.COLOR_FOCUS):this._setBg(l,this.COLOR_BG);b.push(l)}for(h=0;h<1E3;h++){k=d[0]+"_"+d[1]+"_"+h;l=$X(k);if(!l)break;k!=c&&(b.push(l),this._setBg(l,this.COLOR_BG))}c=$(g).find("#MGA_"+e+"_0");c.length>0&&(l=c[0],this._setBg(l,this.COLOR_BG),b.push(l));a=$(g).find("#MGB_"+a+"_0");a.length>0&&(l=a[0],this._setBg(l,
this.COLOR_BG),b.push(l))}}},_setBg:function(a,b){a.setAttribute("oldbg",a.style.backgroundColor);a.style.backgroundColor=b},_restoreBg:function(a){var b=a.getAttribute("oldbg");a.style.backgroundColor=b}};EWA.F.M={CUR:null,C:EWA_MultiGridClass};
function EWA_TreeNodeClass(){this.Next=this.Prev=this.Parent=this.MenuGroup=this.Text=this.Key=null;this.AddParas=[];this.Children=[];this.Cmd=this.ChildLast=null;this.tagName="TREE_NODE";this.Object=null;this.IsMoreChildren=!1;this.Mark=function(a){var b=$(this.GetObject().rows[0]);a?$(b).addClass("ewa-tree-node-marked"):$(b).removeClass("ewa-tree-node-marked")};this.SetKey=function(a){var b=this.GetObject();this.Key=a;b.id=a};this.SetText=function(a){this.Text=a;this.GetObject().rows[0].cells[2].childNodes[0].innerHTML=
a};this.SetAddParameters=function(a){this.AddParas=a.split(",");a=this.GetObject();for(var b=0;b<this.AddParas.length;b+=1)a.rows[0].cells[2].childNodes[0].setAttribute("EWA_P"+b,this.AddParas[b].trim())};this.SetMenuGroup=function(a){this.GetObject().setAttribute("EWA_MG",a)};this.AddChild=function(a){a.Parent=this;this.ChildLast=this.Children[this.Children.length]=a;this.IsMoreChildren=!1};this.GetObject=function(){this.Object==null&&(this.Object=document.getElementById(this.Key));return this.Object};
this.AddBackground=function(a){this.GetObject().rows[1].cells[0].background=a};this.SetBookIcon=function(a){this.GetObject().rows[0].cells[1].className=a};this.IsNodeOpen=function(){var a=this.GetObject().rows[0].cells[0];tag=this._GetTag(a);return tag=="B"};this.NodeShow=function(a){if(this.Key!="EWA_TREE_ROOT"){var b=this.GetObject(),c=b.rows[0].cells[0];if(a==null){var d=this._GetTag(c);if(d=="C"||d=="D")return;d=d=="A"?"B":"A"}else d=a?"B":"A";for(var e=c.className.split(" "),g=[this._GetClassNameNoTag(c)+
d],h=1;h<e.length;h++)g.push(e[h]);c.className=g.join(" ");b.rows.length==2&&b.rows[1].cells[1].childNodes.length>0&&(b.rows[1].style.display=d=="B"?"table-row":"none");this.BookShow(a);this.IsMoreChildren&&(this.Object.setAttribute("EWA_TREE_MORE","0"),a=new EWA.F.Cmd,a.EWA_ACTION="OnTreeNodeMore",a.EWA_TREE_KEY=this.Key,EWA.CurUI._PostChange(a));if(this.ewa&&this.ewa.OnBookShowAfter)try{this.ewa.OnBookShowAfter(d=="B",this)}catch(k){console.log(k)}}};this.BookShow=function(a){if(this.Key!="EWA_TREE_ROOT"){var b=
this.GetObject().rows[0].cells[1];a==null?(tag=this._GetTag(b),tag=tag=="A"?"B":"A"):tag=a?"B":"A";a=b.className.split(" ");for(var c=[this._GetClassNameNoTag(b)+tag],d=1;d<a.length;d++)c.push(a[d]);b.className=c.join(" ")}};this.NodeClose=function(){this.NodeShow(!1)};this.NodeOpen=function(){this.NodeShow(!0)};this.BookOpen=function(){this.BookShow(!0)};this.BookClose=function(){this.BookShow(!1)};this.NodeCross=function(a){var b=this.GetObject(),c=b.rows[0].cells[0];if(this._GetTag(c)=="D"||a)c.className=
this._GetClassNameNoTag(c)+"C";b.rows.length==1&&(a=b.insertRow(-1),a.insertCell(-1),a.insertCell(-1),a.cells[1].colSpan=2,a.style.display="none");c=b.rows[1].cells[0];c.className="TD10B"};this.NodeCrossEnd=function(a){var b=this.GetObject(),c=b.rows[0].cells[0],d=this._GetTag(c);if(b.rows.length==1){var e=b.insertRow(-1);e.insertCell(-1);e.insertCell(-1);e.cells[1].colSpan=2}b.rows[1].style.display="none";if(d=="C"||a)c.className=this._GetClassNameNoTag(c)+"D";c=b.rows[1].cells[0];c.className="TD10A"};
this._GetTag=function(a){a=a.className.split(" ")[0];return a.substring(a.length-1)};this._GetClassNameNoTag=function(a){a=a.className.split(" ")[0];return a.substring(0,a.length-1)}}
function EWA_TreeClass(a,b,c){this.ParentObject=a;this.ClassName=b;this.Url=this._Url=c;this.Resources={};this.Icons=this.Menu=this._Ajax=null;this._CurNewNode=0;this.Fields={};this._LastFocus=this._Id=null;this._TempNode=document.createElement("DIV");this._MoveNode=document.createElement("DIV");this._HtmlTemplate1="<div oncontextmenu='"+this.ClassName+".ShowMenu(event);return false;' onclick='"+this.ClassName+".Click(event)'><table border=0 cellspacing=0 [ID] cellpadding=0 width=100% style='table-layout:fiexed'>";
this._HtmlTemplate1+="<tr><TD></TD><td class=CAPTION>&nbsp;&nbsp;&nbsp;</td><td width=99%><SPAN style='padding-left:4px'>[B]</SPAN></td></tr>";this._HtmlTemplate1+="<tr><td></td><td colspan=2></td></tr></table></div>";this._HtmlTemplate1+="<div style='display:none'><input style='margin:0px' type=text onblur='"+this.ClassName+".RenameBlur(this)'></div>";this._HtmlTemplate="<table class='ewa-tree-node ewa-tree-lvl-[LVL]' border=0 EWA_MG=\"[EWA_MENU_GROUP]\" EWA_T=1 [EWA_MORE_CHILDREN] cellspacing=0 [ID] cellpadding=0 width=100%>";
this._HtmlTemplate+="<tr class='ewa-node-row-0'><td nowrap class='[A] ewa-node-open-close'><div>&nbsp;</div></td><td nowrap class='[B] ewa-node-icon'><div>&nbsp;</div></td><td class='ewa-node-caption'><SPAN EWA_CMD=1 [TMP_ADD_PARAS]>[C]</SPAN></td>[TEMP_NODE_ADD_FIELDS]";this._HtmlTemplate+="</tr><tr class='ewa-node-row-1' style='display:none'><td class='[A1]'></td><td colspan=13></td></tr></table>";this.OpenAll=function(){this._OpenOrClose(".TD00A")};this.CloseAll=function(){this._OpenOrClose(".TD00B")};
this._OpenOrClose=function(d){var e=this;$("#EWA_TREE_"+this._Id).find(d).each(function(){e.Click({srcElement:this})})};this.DoAction=function(d,e,g,h,k,l){EWA.F.CID=this._Id;if(e==null||e.trim()=="")alert("action not value");else{if(g!=null&&g.trim().length>0)if(d=_EWA_INFO_MSG[g],d!=null&&d!=""){if(!window.confirm(d))return}else if(!window.confirm(g))return;this._Ajax=new EWA.C.Ajax;this._Ajax.LoadingType="image";this._Ajax.AddParameter("EWA_AJAX","1");this._Ajax.AddParameter("EWA_ACTION",e);this._Ajax.AddParameter("EWA_ID",
this._Id);this._Ajax.AddParameter("EWA_NO_CONTENT","1");this._Ajax.AddParameter("EWA_ACTION_TIP",h);l!=null&&l.trim().length>0?(this._Ajax.AddParameter("EWA_AFTER_EVENT",l),this.StopAjaxAfterReload=!0,this._Ajax.AddParameter("EWA_ACTION_RELOAD","0")):this.StopAjaxAfterReload=!1;if(k!=null&&k.length>0)for(e=0;e<k.length;e+=1)this._Ajax.AddParameter(k[e].Name,k[e].Value);k=new EWA.C.Url;k.SetUrl(this.Url);k=k.RemoveParameter("EWA_ACTION");this._Ajax.PostNew(k,EWA.F.FOS[EWA.F.CID]._PostChangeCallback)}};
this.OnMouseDown=function(d){};this.OnMouseUp=function(d){};this.OnMouseMove=function(d){};this.OnMouseOut=function(d){};this.MoveNode=function(d){};this.GetParentNode=function(d){if(d==null||d.Key=="EWA_TREE_ROOT")return null;d=d.GetObject().parentNode;d=this.GetNode(d);return d==null?null:d.Key=="EWA_TREE_ROOT"?null:d};this.CreateByXml=function(d){for(var e=d.GetElements("FrameData/Row"),g={},h,k=0;k<e.length;k+=1){var l=this._CreateNodeFromXml(e[k],d);g[l.Key]=l;if(k==0)h=l;else{var m=g[l.ParentKey==
""?"EWA_TREE_ROOT":l.ParentKey];m!=null&&m.AddChild(l)}}treeFirstNode=h;this.Create(h)};this.OnSelect=function(d){return d.srcElement.tagName!="INPUT"?!1:!0};this.InitMenu=function(d){d!=null&&(this.Menu=new EWA_UI_MenuClass(b+".Menu"),this.Menu.Create(d))};this._PostChange=function(d){this.PostChangeType=d.EWA_ACTION;this.PostChangeKey=d.EWA_TREE_KEY;EWA.CurUI=this;this._Ajax=new EWA.C.Ajax;this.PostChangeType=="OnTreeNodeMore"&&(d.EWA_AJAX="XML",d.EWA_TREE_MORE="1");for(var e in d)this._Ajax.AddParameter(e,
d[e]);this._Ajax.PostNew(this._Url,EWA.CurUI._PostChangeCallback);this.IsPostChange=!0};this._PostChangeCallback=function(){var d=EWA.CurUI._Ajax;d._Http.readyState==4&&(d.HiddenWaitting(),d._Http.status==200?(d=d._Http.responseText,EWA.F.CheckCallBack(d)&&(EWA.CurUI.PostChangeType=="OnTreeNodeMore"?EWA.CurUI.LoadChildrenAfter(d):EWA.CurUI.PostChangeType=="OnTreeNodeStatus"?EWA.CurUI.LoadChildrenStatus(d):EWA.CurUI.PostChangeType=="OnTreeNodeDelete"?EWA.CurUI.DeleteAfter():eval(d))):alert("ERROR:\r\n"+
d._Http.statusText),EWA.CurUI.IsPostChange=!1,EWA.SHOW_ERROR=!0)};this.LoadChildrenStatus=function(d){var e=new EWA.C.Xml;e.LoadXml(d);var g=e.GetElements("FrameData/Row");if(g!=null){d=[];for(var h={},k=0;k<g.length;k=1+k){var l=this._CreateNodeFromXml(g[k],e);l.Key==""||$[l.ParentKey]||(d.push(l),h[l.Key]=l)}if(d.length!=0&&(e=this.GetNodeById(d[0].ParentKey),e!=null)){h[e.Key]=e;for(k=0;k<d.length;k+=1)h[d[k].ParentKey].AddChild(d[k]);e.GetObject().setAttribute("EWA_TREE_MORE","0");e.IsMoreChildren=
!1;for(k=0;k<e.Children.length;k+=1)this.Create(e.Children[k]);e.NodeShow(!0);this.ShowNode(this.PostChangeKey)}}};this.LoadChildrenAfter=function(d){var e=new EWA.C.Xml;e.LoadXml(d);d=e.GetElements("FrameData/Row");if(d!=null&&d.length!=0){var g=this.GetNodeById(this.PostChangeKey),h={};h[g.Key]=g;for(var k=0;k<d.length;k=1+k){var l=this._CreateNodeFromXml(d[k],e);if(l.Key!="EWA_TREE_ROOT"){if(l.ParentKey==null||l.ParentKey=="")l.ParentKey=g.Key;h[l.Key]=l;var m=l.ParentKey;h[m]!=null&&h[m].AddChild(l)}}if(g.Children.length>
0)for(k=0;k<g.Children.length;k=1+k)this.Create(g.Children[k]);g.NodeShow(!0)}};this._CreateNodeFromXml=function(d,e){var g=new EWA_TreeNodeClass;g.ewa=this;g.Key=e.GetElementAttribute(d,"Key");g.ParentKey=e.GetElementAttribute(d,"ParentKey");g.Text=e.GetElementAttribute(d,"Text");g.IsMoreChildren=e.GetElementAttribute(d,"IsMoreChildren")=="1"?!0:!1;g.MenuGroup=e.GetElementAttribute(d,"MenuGroup");for(var h=0;h<3;h+=1)g.AddParas[g.AddParas.length]=e.GetElementAttribute(d,"AddPara"+h);return g};this.Rename=
function(d,e,g,h){d==null&&(d=this._LastFocus);d!=null&&(this._RenameActionCmd=e,this._RenameRegex=g,this._RenameInfo=h,this._RenameNode=d.tagName=="TREE_NODE"?d:this.GetNode(d),this._RenameNode.Key=="EWA_TREE_ROOT"?this._RenameNode=null:(d=this._RenameNode.GetObject(),d=d.rows[0].cells[d.rows[0].cells.length-1].childNodes[0],e=GetInnerText(d),d.style.display="none",g=this._GetInput(),d.parentNode.appendChild(g),g.value=e,g.setAttribute("EWA_OLD_VAL",e),g.style.width="300px",g.focus()))};this._GetInput=
function(){for(var d=this.ParentObject.getElementsByTagName("INPUT"),e=d.length-1;e>=0;e--){var g=d[e];if(g.getAttribute("onblur")&&g.getAttribute("onblur").indexOf("RenameBlur(")>0)return this._InputDiv=g.parentNode,g}};this.RenameBlur=function(d){var e=this._RenameBlurT0||0,g=(new Date).getTime();if(!(g-e<100)){this._RenameBlurT0=g;g=d.getAttribute("EWA_OLD_VAL");e=this._RenameNode;for(var h=this.GetNode(e.GetObject().parentNode),k=0;k<h.Children.length;k+=1){var l=h.Children[k];if(l.Key!=e.Key&&
l.Text.trim()==d.value.trim()){alert(_EWA_EVENT_MSG.OnTreeNodeNameRepeat);d.focus();return}}h=d.parentNode.childNodes[0];this._InputDiv.appendChild(d);h.style.display="";if(e.RenameType=="NEW"||g!=d.value){h.innerHTML=d.value;g=this._RenameActionCmd;g==null&&(g=new EWA.F.Cmd);if(g.EWA_ACTION==null||g.EWA_ACTION.trim()=="")g.EWA_ACTION=e.RenameType=="NEW"?"OnTreeNodeNew":"OnTreeNodeRename";e.RenameType=="NEW"&&(g.EWA_AFTER_EVENT==""&&(g.EWA_AFTER_EVENT='EWA.F.FOS["'+this._Id+'"].NewNodeAfter;'),h=
this.GetNode(e.GetObject().parentNode),g.EWA_TREE_PARENT_KEY=h.Key);g.EWA_TREE_TEXT=d.value;g.EWA_TREE_KEY=e.Key;this._PostChange(g);this._RenameActionCmd=null}}};this.RenameKeyDown=function(d,e){d=d.keyCode?d.keyCode:d.which;d==13&&this.RenameBlur(e);d==27&&(d=e.getAttribute("EWA_OLD_VAL"),e.value=d,this.RenameBlur(e))};this.Delete=function(d,e){var g=this.GetNode(this._LastFocus);g!=null&&g.Key!="EWA_TREE_ROOT"&&window.confirm(_EWA_EVENT_MSG.OnTreeNodeDelete)&&(!d&&(g.Children.length>0||g.IsMoreChildren)?
(g.NodeShow(!0),alert(_EWA_EVENT_MSG.OnTreeNodeDeleteHaveChildren)):(d=e,d==null&&(d=new EWA.F.Cmd,d.EWA_ACTION="OnTreeNodeDelete"),d.EWA_AFTER_EVENT==""&&(d.EWA_AFTER_EVENT='EWA.F.FOS["'+this._Id+'"].DeleteAfter();'),d.EWA_TREE_KEY=g.Key,this._PostChange(d)))};this.DeleteNoConfirmById=function(d,e){e&&(e.cancelBubble=!0,e.stopPropagation());d=this.GetNodeById(d);d!=null&&d.Key!="EWA_TREE_ROOT"&&(this._LastFocus=d.GetObject(),this.DeleteAfter())};this.DeleteAfter=function(){var d=this.GetNode(this._LastFocus).GetObject(),
e=d.parentNode;e.removeChild(d);d=this.GetNode(e);d.Children.length==0?this.GetNode(d.GetObject().parentNode).ChildLast.Key==d.Key?d.NodeCrossEnd(!0):d.NodeCross(!0):d.ChildLast.NodeCrossEnd();this._LastFocus=null};this.NewNode=function(d,e,g,h){this._LastFocus!=null&&(this._NewNodeTemp={TEXT:d,CMD:e,REGEX:g,INFO:h},this.GetNode(this._LastFocus).NodeShow(!0),this.IsPostChange?this._NewNodeTimer=window.setInterval(function(){EWA.CurUI.IsPostChange||(window.clearInterval(EWA.CurUI._NewNodeTimer),EWA.CurUI._NewNode())},
100):this._NewNode())};this._NewNode=function(){var d=this._NewNodeTemp.TEXT,e=this._NewNodeTemp.CMD,g=this._NewNodeTemp.REGEX,h=this._NewNodeTemp.INFO;this._NewNodeTemp=null;var k=new EWA_TreeNodeClass;k.ewa=this;this._CurNewNode+=1;k.Key="NEW_NODE_"+this._Id+"__"+this._CurNewNode;k.RenameType="NEW";var l=_EWA_EVENT_MSG.OnTreeNodeNew+this._CurNewNode;d!=null&&d.trim().length>0&&(l=d.trim());k.Text=l;d=this.GetNode(this._LastFocus);d.Children.length>0&&d.Children[d.Children.length-1].NodeCross();
d.AddChild(k);this.Create(k);d.NodeShow(!0);this.Rename(k,e,g,h)};this.NewNodeAfter=function(d,e,g){var h=this.GetNodeById("NEW_NODE_"+this._Id+"__"+this._CurNewNode);h.SetKey(d);h.SetAddParameters(e==null?"":e);h.SetMenuGroup(g==null?"":g);d=this.TestIcon(h);h.SetBookIcon(d)};this.GetNodeById=function(d){d=$("#EWA_TREE_"+this._Id+' .ewa-tree-node[id="'+d+'"]');return d.length==0?null:this.GetNode(d[0])};this.GetFocusNode=function(){return this.GetNode(this._LastFocus)};this.GetNode=function(d){if(d==
null||d.tagName==null)return null;var e=d;for(d=0;(e.tagName!="TABLE"||e.getAttribute("EWA_T")!="1")&&e.id!="EWA_TREE_ROOT";)if(e=e.parentNode,d++,d>33||e.tagName=="BODY")return null;d=new EWA_TreeNodeClass;d.ewa=this;d.Key=e.id;d.MenuGroup=e.getAttribute("EWA_MG");d.Object=e;var g=e.rows[0].cells[2];d.Text=GetInnerText(g);for(var h=0;h<3;h+=1)d.AddParas[h]=g.childNodes[0].getAttribute("EWA_P"+h);h=e.getAttribute("EWA_TREE_MORE");d.IsMoreChildren=h=="1"?!0:!1;if(e.rows.length>1){e=e.rows[1].cells[e.rows[1].cells.length-
1];for(h=0;h<e.childNodes.length;h=1+h)g=e.childNodes[h],g.nodeType!=3&&g.tagName=="TABLE"&&g.getAttribute("EWA_T")=="1"&&d.Children.push(this.GetNode(g));d.Children.length>0&&(d.ChildLast=d.Children[d.Children.length-1])}return d};this.Click=function(d,e){if(!this.IsPostChange&&(EWA.CurUI=this,d=d.srcElement?d.srcElement:d.target,d.tagName!="INPUT"))if(d.tagName=="DIV"&&(d=d.parentNode),d.tagName=="TD"&&d.className.indexOf("TD00")==0){var g=this.GetNode(d);g.NodeShow()}else{for(;(d.tagName!="SPAN"||
d.getAttribute("EWA_CMD")==null)&&d.getAttribute("EWA_TREE_TOP")!="1";)if(d=d.parentNode,d.tagName=="BODY")return;g=this.GetNode(d);if(d.tagName=="SPAN"&&(d.getAttribute("EWA_CMD")!=null||d.getAttribute("EWA_TREE_TOP")=="1")){this._LastFocus!=null&&(this.GetNode(this._LastFocus).Mark(!1),this._LastFocus=null);d.getAttribute("EWA_TREE_TOP")!="1"&&g.Mark(!0);this._LastFocus=d;if(e)return d;this.Url.toUpperCase().indexOf("EWA_TREE_SKIP_GET_STATUS")<0&&EWA.F.ST.SaveStatus(g.Key,"TREE");this._RunCmd(g);
this.MoveNode(g.GetObject())}}};this._RunCmd=function(d){var e=this.GetNode(d.GetObject().parentNode);if(this.link)this.link(d.Key,d);else{console.warn('\u5efa\u8bae\u91c7\u7528\u5b9a\u4e49 EWA.F.FOS["xx"].link = function(nodeKey, node){}');e='link("'+d.Key+'","'+e.Key+'","'+d.Text.replace(/\n/mig,"\\n").replace(/\r/mig,"\\r").replace(/"/mig,"&quot;")+'"';for(var g=0;g<d.AddParas.length;g+=1)e=d.AddParas[g]==null?e+",null":e+(',"'+d.AddParas[g]+'"');EWA.C.Utils.RunCmd(e+");")}};this.ShowMenu=function(d){EWA.CurUI=
this;var e=this.Click(d,!0);this.Menu!=null&&e!=null&&(e=this.GetNode(e),this.Menu.ShowByMouse(d,e.MenuGroup))};this.TestIcon=function(d){if(this.Icons==null)return"TD01A";for(var e in this.Icons){var g=this.Icons[e],h=null;switch(g.TEST.toUpperCase()){case "KEY":h=d.Key;break;case "PARENTKEY":h=d.Parent.Key;break;case "TEXT":h=d.Text;break;case "P0":h=d.AddParas[0];break;case "P1":h=d.AddParas[1];break;case "P2":h=d.AddParas[2];break;case "MG":h=d.MenuGroup}if(h!=null&&eval("/"+g.FILTER+"/ig").test(h))return g.NAME+
"A"}return"TD01A"};this.Create=function(d,e){if(d!=null)if(d.Parent==null)this._CreateFirst(d);else{var g=this._HtmlTemplate.replace("[ID]",'id="'+d.Key+'"');g=g.replace("[TEMP_NODE_ADD_FIELDS]",this.AddCols||"");for(var h="",k=0;k<d.AddParas.length;k+=1)d.AddParas[k]&&(h+="EWA_P"+k+'="'+(d.AddParas[k]+"").replace(/"/ig,"&quot;").replace(/</ig,"&lt;").replace(/</ig,"&gt;")+'" ');g=g.replace("[TMP_ADD_PARAS]",h);g=g.replace("[EWA_MENU_GROUP]",d.MenuGroup);h=this.TestIcon(d);g=g.replace("[B]",h);g=
g.replace("[C]",d.Text);g=d.IsMoreChildren?g.replace("[EWA_MORE_CHILDREN]","EWA_TREE_MORE='1'"):g.replace("[EWA_MORE_CHILDREN]","");d.Children.length>0||d.IsMoreChildren?(g=g.replace("[A]","TD00A"),g=d!=d.Parent.ChildLast?g.replace("[A1]","TD10B"):g.replace("[A1]","TD10A")):g=d==d.Parent.ChildLast?g.replace("[A]","TD00D"):g.replace("[A]","TD00C");h=d.Parent.GetObject();h.rows.length==1&&(k=h.insertRow(-1),k.insertCell(-1),k.insertCell(-1),k.cells[1].colSpan=2);k=this.GetNodeLvl(d.Parent);g=g.replace("[LVL]",
k+1);this._TempNode.innerHTML=g;g=this._TempNode.childNodes[0];h.rows[1].cells[h.rows[1].cells.length-1].appendChild(g);h.parentNode.childNodes[h.parentNode.childNodes.length-1]!=h&&(h.rows[1].cells[0].className="TD10B");d.Parent.NodeShow(!0);e&&e(g,this);for(k=0;k<d.Children.length;k+=1)this.Create(d.Children[k],e)}};this.GetNodeLvl=function(d){var e=d;if(d.Object.getAttribute("tree_lvl"))return d.Object.getAttribute("tree_lvl")*1;for(var g=0;g<100;g++)if(e=this.GetParentNode(e),e==null)return d.Object.setAttribute("tree_lvl",
g+1),g+1};this._CreateFirst=function(d,e){var g=this._HtmlTemplate1.replace("[ID]","id='"+d.Key+"'");g=g.replace("[B]",d.Text);this.ParentObject.innerHTML=g;for(g=0;g<d.Children.length;g+=1)this.Create(d.Children[g],e)};this.Init=function(d){var e=new EWA.C.Xml;e.LoadXml(d);this.Resources=new EWA_FrameResoures;this.Resources.Init(e);this.Url.toUpperCase().indexOf("EWA_TREE_INIT_KEY")!=-1||this.Url.toUpperCase().indexOf("EWA_TREE_SKIP_GET_STATUS")>0||EWA.F.ST.GetStatus("TREE",this)};this.LoadStatus=
function(){EWA.SHOW_ERROR=!1;this.ShowNode(_EWA_STATUS_VALUE)};this.ShowNode=function(d){if(d!=null&&d!=""&&d!="EWA_TREE_ROOT"){var e=this.GetNodeById(d);e==null?(e=new EWA.F.Cmd,e.EWA_ACTION="OnTreeNodeStatus",e.EWA_AJAX="XML",e.EWA_TREE_KEY=d,e.EWA_TREE_STATUS="1",this._PostChange(e)):(this._StatusNode=e,this.ShowNodeA())}};this.ShowNodeA=function(){var d=this._StatusNode;this._StatusNode=null;for(var e=d.GetObject().parentNode,g=this.GetNode(e);g.Key!="EWA_TREE_ROOT";)g.NodeShow(!0),g=this.GetNode(g.GetObject().parentNode);
d.Mark(!0);this._LastFocus=d.GetObject();this._RunCmd(d);window.setTimeout(function(){e.focus()},0)};this.getUrlClass=function(){var d=new EWA_UrlClass;d.SetUrl(this.Url);return d};this.Reload=function(){}}function EWA_Treelink(a,b,c,d,e,g){alert("key="+a+"\r\nparentKey="+b+"\r\ntext="+c+"\r\naddPara1="+d+"\r\naddPara2="+e+"\r\naddPara3="+g+"\r\n\r\n\u60a8\u9700\u8981\u8986\u76d6\u8fd9\u4e2a\u65b9\u6cd5\r\nlink(key, parentKey, text, addPara1, addPara2, addPara3)")}
typeof link=="undefined"&&(link=EWA_Treelink);EWA.F.T={CUR:null,C:EWA_TreeClass,Node:EWA_TreeNodeClass};
function EWA_Html5UploadClass(){this.uploadIframes=[];this.files=[];this.UPLOAD_STATUS=this.POST_REF=this.POST_NAME=this.POST_ITEMNAME=this.POST_XMLNAME="";this.WAIT_ID=EWA_Utils.tempId("ht5upload_wait_");this.loadFiles=function(a,b,c,d,e){let g=this;$J(a,function(h){for(let k in h)g.loadFile(h[k],b,c,d,e)})};this.loadFile=function(a,b,c,d,e){c=this.showPreviewUrl(a[c]);if(d){let g=$("<a class='ewa_app_upload_remove'></a>").attr(a);g.on("click",function(){d(this)});$(c).css("position","relative").append(g)}if(e)$(c).find("img").css("cursor",
"pointer").attr(a).on("click",function(){e(this)});$(c).find(".name div").attr("title",a[b]).text(a[b])};this.remove=function(a){$(a).parent().remove()};this.changeUpExts=function(a){$("#"+this.INPUT_FILE_ID).attr("accept",a)};this.changeUpSizeLimit=function(a){this.UpLimit=a};this.haveFile=function(){for(var a=0;a<this.files.length;a++)if(this.files[a].value!="")return!0;return!1};this.getValue=function(){if(this.uploadIframes.length==0&&this.files.length==0)return"";for(var a=[],b=0;b<this.uploadIframes.length;b++){var c=
this.uploadIframes[b];if(typeof c=="string"){c=JSON.parse(c);for(var d in c)a.push(c[d])}}return JSON.stringify(a)};this.fileIco=function(a,b){a=EWA.UI.Ext.FileExt(a.name);$X(b).onerror=function(){};$X(b).src=EWA.UI.Ext.FileIco(a)};this.showPreview=function(a,b){if(a.files.length>10)EWA.LANG=="enus"?EWA.UI.Msg.ShowError("Upload up to 10 files at a time","limts"):EWA.UI.Msg.ShowError("\u4e00\u6b21\u6700\u591a\u4e0a\u4f2010\u4e2a\u6587\u4ef6","\u6587\u4ef6\u6570\u91cf\u9650\u5236"),a.value="";else{this.UpLimit||
(this.UpLimit="10M");b=(this.UpLimit+"").toLocaleLowerCase().replace(/,/ig,"").replace(/ /ig,"");if(b.endsWith("m")){b=b.substring(0,b.length-1);if(isNaN(b)){alert("Invalid sizeLimit parameter:"+this.sizeLimit);return}var c=b*1024*1024}else if(b.endsWith("k")){b=b.substring(0,b.length-1);if(isNaN(b)){alert("Invalid sizeLimit parameter:"+this.sizeLimit);return}c=b*1024}else{if(isNaN(b)){alert("Invalid sizeLimit parameter:"+this.sizeLimit);return}c=b*1}var d=[];if(c>0)for(b=0;b<a.files.length;b++){var e=
a.files[b];if(e.size>c){let g=EWA.UI.Ext.getFileLen(e.size,2);d.push(e.name.replace(/</ig,"%lt;").replace(/>/ig,"%gt;")+" ["+g+"]")}}if(d.length>0)a.value="",EWA.LANG=="enus"?(d.push("Exceed "+this.UpLimit+" limit"),EWA.UI.Msg.ShowError(d.join("<br>"),"Exceed "+this.UpLimit+" limit")):(d.push("\u8d85\u8fc7"+this.UpLimit+"\u5927\u5c0f\u9650\u5236"),EWA.UI.Msg.ShowError(d.join("<br>"),"\u8d85\u8fc7"+this.UpLimit+"\u5927\u5c0f\u9650\u5236"));else{c=a.parentNode;d=c.outerHTML;c.style.display="none";a.setAttribute("ok",
1);gFileReaders={};for(b=0;b<a.files.length;b++)e=a.files[b],this.showPreview1(c,e),this.files.push(e);this.UpMulti=="yes"&&$(c).before(d)}}};this.addOther=function(a){for(var b=$X(this.POST_NAME).parentNode.getElementsByTagName("input")[1].parentNode,c=0;c<a.length;c++)this.showPreview1(b,a[c]);this.uploadIframes.push(JSON.stringify(a))};this.createPreviewBox=function(a){var b=a||$("#EWA_FRAME_"+this.SYS_FRAME_UNID+" input#"+this.POST_NAME).parent().find(".ewa_app_upload_form")[0],c="_upload_"+Math.random();
c=c.replace(".","G");a=document.createElement("img");a.id=c;c=document.createElement("table");c.cellPadding=0;c.cellSpacing=0;c.className="ewa_app_upload_form1";b.parentNode.appendChild(c);b=c.insertRow(-1).insertCell(-1);b.align="center";b.appendChild(a);b.className="img";b.vAlign="middle";c.insertRow(-1).insertCell(-1).className="name";var d=this;a.onerror=function(e){console.log(e);d.fileIco({name:this.src},this.id)};return c};this.showPreviewExists=function(){var a=$("#EWA_FRAME_"+this.SYS_FRAME_UNID+
" input#"+this.POST_NAME).val();if(a!=""){try{EWA.F.FOS[this.SYS_FRAME_UNID].setUnMust(this.POST_NAME)}catch(b){}this.showPreviewUrl(a)}};this.showPreviewUrl=function(a){var b=this.createPreviewBox(),c=$(b).find("td")[1],d=a.split("/");d=d[d.length-1];c.innerHTML="<div title='"+d+"'>"+d+"</div>";$(b).find("img")[0].src=a;return b};this.showPreview1=function(a,b){var c=this.createPreviewBox(a),d=$(c).find("td")[1],e=$(c).find("img")[0];a=e.id;b.ref=a;d.innerHTML="<div>"+b.name+"</div><div id='"+a+
"_process1' class='ewa-app-upload-process1'></div><div id='"+a+"_process' class='ewa-app-upload-process'>0%</div>";d.className="name";$(c).attr("file_name",b.name);$(c).attr("file_type",b.type);$(c).attr("file_size",b.size);if(b.type&&b.type.indexOf("image/")==0){e.src=(EWA.RV_STATIC_PATH||"/EmpScriptV2")+"/EWA_STYLE/images/loading2.gif";c=new FileReader;gFileReaders[a]=c;var g=this;c.onloadend=function(h){for(var k in gFileReaders)gFileReaders[k]==h.target&&($X(k).src=h.target.result,g.showPreviewAfter&&
g.showPreviewAfter($X(k),b))};c.readAsDataURL(b)}else this.fileIco(b,a),this.showPreviewAfter&&this.showPreviewAfter($X(a),b)};this.submitUploads=function(a){if(window.FormData){this.uploadIframes=[];var b=this;this.UPLOAD_STATUS="start";this.action=EWA.CP+"/EWA_STYLE/cgi-bin/_up_/?xmlname="+this.POST_XMLNAME+"&ITEMNAME="+this.POST_ITEMNAME+"&NAME="+this.POST_NAME+"&EWA_UP_TYPE=SWFUPLOAD&EWA_UP_REF="+this.POST_REF;try{$("input[type=file][ok=1]").each(function(){var c=this.id.split("_1_2_3_4_5_")[1];
if(b.POST_NAME==c)for(c=0;c<this.files.length;c++){let d=this.files[c];d.isDeleted?console.log(d):b.uploadIframes.push({file:d})}})}catch(c){alert(c)}this.uploadIframes.length>0?($("#f_"+this.SYS_FRAME_UNID).find(".ewa-app-upload-process,.ewa-app-upload-process1").show(),b.UPLOAD_STATUS="checking",this.asyncUpload()):this.UPLOAD_STATUS="nofile"}else this.submitUploads_old(a)};this.asyncUpload=function(){var a=this,b=null,c;for(c in this.uploadIframes){var d=this.uploadIframes[c];if(typeof d!="string"){b=
d;break}}b!=null?(b.submitting||(b.submitting=!0,this.submitUpload(b)),setTimeout(function(){a.asyncUpload()},111)):this.uploadsCompleted&&this.uploadsCompleted(this.uploadIframes)};this.createFormData=function(){var a=new FormData,b=new EWA_UrlClass;b.SetUrl(EWA.F.FOS[this.SYS_FRAME_UNID].Url);for(var c in b._Paras)c.toUpperCase().indexOf("EWA")!=0&&a.append(c,b._Paras[c]);if(b=$X("f_"+this.SYS_FRAME_UNID))for(c=0;c<b.length;c++){var d=b[c],e=d.name||d.id;d.type!="file"&&d.type!="button"&&d.type!=
"submit"&&(d.type!="radio"&&d.type!="checkbox"||d.checked)&&$(d).attr("ewa_tag")!="ht5upload"&&a.append(e,d.value)}return a};this.submitUpload=function(a){var b=a.file,c=this.createFormData();c.append(this.POST_NAME,b,b.name);var d=$('img[id="'+b.ref+'"]');this.createNewSizes(d[0],c);var e=this,g=$('div[id="'+b.ref+'_process"]');g.show().html("0%");var h=$('div[id="'+b.ref+'_process1"]');h.css("width",0).show();b=new XMLHttpRequest;b.upload.addEventListener("progress",function(k){k.lengthComputable?
(k=Math.round(k.loaded*100/k.total-10),k<0&&(k=0),g.html(k.toString()+"%"),h.css("width",k.toString()+"%")):g.html("unable to compute")},!1);b.addEventListener("load",function(k){g.html("100%");h.css("width","100%");for(var l in e.uploadIframes)if(e.uploadIframes[l].xhr==k.target){e.uploadIframes[l]=k.target.responseText;break}e.chkAllXhrComplete()},!1);b.addEventListener("error",function(k){console.log(k);g.html(k);e.UPLOAD_STATUS="error"},!1);b.addEventListener("abort",function(k){g.html("The upload has been canceled by the user or the browser dropped the connection.");
console.log(k);e.UPLOAD_STATUS="abort"},!1);b.open("POST",this.action,!0);b.send(c);a.xhr=b;delete a.file};this.createNewSizes=function(a,b){if(this.NewSizesIn==="client"){if(!this.siezs){var c=this.UpNewSizes.split(",");this.siezs=[];for(var d in c){var e=c[d],g=e.split("x");g.length==2&&(e=g[0],g=g[1],isNaN(e)||isNaN(g)||this.siezs.push({w:e*1,h:g*1}))}}if(this.siezs.length!=0)for(d in this.siezs)e=this.siezs[d],c=EWA_ImageCalss.resizeAsBlob(a,e.w,e.h),b.append(this.POST_NAME,c,"resized$"+e.w+"x"+
e.h+".jpg")}};this.chkAllXhrComplete=function(){for(var a=0,b=0;b<this.uploadIframes.length;b++)typeof this.uploadIframes[b]=="string"&&a++;if(!(a<this.uploadIframes.length)){a=[];for(b=0;b<this.uploadIframes.length;b++){let d=JSON.parse(this.uploadIframes[b]);d.ERR&&a.push(d.ERR)}if(a.length===0)this.UPLOAD_STATUS="ok";else{b=[];var c=this;b[0]={Text:_EWA_INFO_MSG["BUT.OK"],Event:function(){c.UPLOAD_STATUS="error"},Default:!0};EWA.UI.Msg.Show(a.join("<br>"),b,"","ERR_ICON");this.removeWaitBox()}}};
this.createWaitBox=function(){if(!$X(this.WAIT_ID)){var a=document.createElement("div");a.id=this.WAIT_ID;var b=$("body");$(a).css({width:300,height:100,"line-height":"100px","font-size":"16px",position:"fixed",top:b.height()*.5-35,left:b.width()*.5-150,"z-index":12838,"background-color":"f0f0f0",color:"#08c","border-radius":"10px",opacity:.9}).addClass("ewa-upload-wait-box");a.innerHTML="<table height=100% align=center><tr><td><img src='"+((EWA.RV_STATIC_PATH||"/EmpScriptV2")+"/EWA_STYLE/images/loading2.gif'></td><td>")+
(EWA.LANG=="enus"?"Please waitting ...":"\u8bf7\u7b49\u5f85\u6587\u4ef6\u4e0a\u4f20\u5b8c\u6bd5...")+"</td></table>";b.append(a);this.noWaitBox&&$(a).hide()}};this.removeWaitBox=function(){$("#"+this.WAIT_ID).remove()};this.submitUploads_old=function(a){this.uploadIframes=[];var b=this;this.UPLOAD_STATUS="start";try{$("input[type=file][ok=1]").each(function(c){var d=this.id.split("$")[1];b.POST_NAME==d&&b.submitUpload_old(c,this)})}catch(c){alert(c)}this.uploadIframes.length>0?window.setTimeout(function(){b.UPLOAD_STATUS=
"checking";b.chkframeSubmt()},400):this.UPLOAD_STATUS="nofile"};this.submitUpload_old=function(a,b){a="GDX"+a;var c=document.createElement("iframe");c.id=a;c.name=a;document.body.appendChild(c);c=$(c);c.hide();var d=document.createElement("form");document.body.appendChild(d);d.method="post";d.enctype="multipart/form-data";d.innerHTML="<input type=submit>";var e=$(d);e.hide();d=EWA.CP+"/EWA_STYLE/cgi-bin/_up_/?xmlname="+this.POST_XMLNAME+"&ITEMNAME="+this.POST_ITEMNAME+"&NAME="+this.POST_NAME+"&EWA_UP_TYPE=SWFUPLOAD&EWA_UP_REF="+
this.POST_REF;var g=b.id.split("_")[1].split("$")[0],h=EWA.F.FOS[g].Url,k=new EWA_UrlClass;k.SetUrl(h);for(var l in k._Paras)l.toUpperCase().indexOf("EWA")!=0&&(d+="&"+l+"="+k._Paras[l]);if(l=$X("f_"+g))for(g=0;g<l.length;g++)h=l[g],h.type!="file"&&h.type!="button"&&h.type!="submit"&&(h.type!="radio"&&h.type!="checkbox"||h.checked)&&(d+="&"+(h.name||h.id)+"="+h.value.toURL());e.attr("action",d);e.append(b);e.attr("target",a);this.uploadIframes.push(c[0]);setTimeout(function(){e.submit()},400)};this.chkframeSubmt=
function(){for(var a=0,b=0;b<this.uploadIframes.length;b++){var c=this.uploadIframes[b];if(typeof c=="string")a++;else if(c.contentDocument&&c.contentDocument.body){var d=GetInnerText(c.contentDocument.body);if(d.indexOf("]")>=0&&d.indexOf("[")>=0)$("form[target="+c.id+"]").remove(),$(c).remove(),this.uploadIframes[b]=d;else if(d.trim()!=""){alert("\u7cfb\u7edf\u6267\u884c\u9519\u8bef\uff1a"+d);return}}}if(a==this.uploadIframes.length)this.UPLOAD_STATUS="ok";else{var e=this;window.setTimeout(function(){e.chkframeSubmt()},
100)}}}
function EWA_Html5TakePhotoClass(){this._wait_end=!0;this.UPLOAD_STATUS="NO";this.H5_UPLOAD=new EWA_Html5UploadClass;this.res={zhcn:{TAKE_PHOTO:"\u70b9\u51fb\u83b7\u53d6\u7167\u7247",RE_TAKE:"\u91cd\u65b0\u83b7\u53d6"},enus:{TAKE_PHOTO:"Take photo",RE_TAKE:"Re take"}};this.getRes=function(){return EWA.LANG=="enus"?this.res.enus:this.res.zhcn};this.getValue=function(){return this.responseText?this.responseText:""};this.init=function(a){this.objName=a;var b="#h5TakePhoto_"+a,c="h5TakePhotoVod_"+a;a=
$X("h5TakePhotoCan_"+a);a.height=$(b).height();a.width=$(b).width();this.context=a.getContext("2d");this.video=$X(c);$(this.video).show();c={video:!0};var d=this;navigator.getUserMedia?navigator.getUserMedia(c,function(e){d.video.src=e;d.video.play()},d.errBack):navigator.webkitGetUserMedia?navigator.webkitGetUserMedia(c,function(e){d.video.src=(window.URL||window.webkitURL).createObjectURL(e);d.video.play()},d.errBack):navigator.mozGetUserMedia&&navigator.mozGetUserMedia(c,function(e){d.video.src=
window.URL.createObjectURL(e);d.video.play()},d.errBack);$(b).find("button").html(this.getRes().TAKE_PHOTO)};this.errBack=function(a){EWA.UI.Msg.ShowError("\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u5728\u7ebf\u62cd\u6444<br>"+a.message,"\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u5728\u7ebf\u62cd\u6444");console.log(a)};this.takePhoto=function(a){if(this._wait_end){var b="#h5TakePhotoVod_"+this.objName,c=$(b).width();b=$(b).height();this.context.drawImage(this.video,0,0,c,b);this.createPic();this.setPhotoStatus("img");
if(a){var d=this;a.innerHTML=this.getRes().RE_TAKE;a.onclick=function(){d.showVideo(this)};$(a).show();$(a).parent().show()}}else $Tip("\u8fd0\u884c\u4e2d...")};this.showVideo=function(a){if(this._wait_end){if(this.setPhotoStatus("video"),a){var b=this;a.innerHTML=this.getRes().TAKE_PHOTO;a.onclick=function(){b.takePhoto(this)};$(a).show();$(a).parent().show()}}else $Tip("\u8fd0\u884c\u4e2d...")};this.setPhotoStatus=function(a){var b="#h5TakePhoto_"+this.objName,c="#h5TakePhotoCan_"+this.objName,
d="#h5TakePhotoVod_"+this.objName,e="#h5TakePhotoImg_"+this.objName;$(b).find("*").hide();a=="img"?(this._photo_status="img",$(b).css({border:"1px solid green"}),$(e).show()):a=="video"?(this._photo_status="video",$(b).css({border:"1px solid red"}),$(d).show()):a=="canvas"&&(this._photo_status="canvas",$(b).css({border:"1px solid blue"}),$(c).show())};this.createPic=function(){var a="#h5TakePhotoImg_"+this.objName,b=$X("h5TakePhotoCan_"+this.objName).toDataURL("image/jpeg",.7);$(a).attr("src",b);
this.setPhotoStatus("img");return $(a)[0]};this.submitUpload=function(){var a="#h5TakePhotoImg_"+this.objName,b=this.H5_UPLOAD.createFormData();a=$(a)[0];a=EWA_ImageCalss.resizeAsBlob(a,a.width,a.height);b.append(this.objName,a,this.objName+".jpg");a="#h5TakePhoto_"+this.objName;var c=this,d=$(a).find(".ewa-h5-take-photo-process");d.show();d.find("span").show().html("0%");var e=$(a).find(".ewa-h5-take-photo-process1");e.css("width",0).show();var g=new XMLHttpRequest;c=this;g.upload.addEventListener("progress",
function(k){k.lengthComputable?(k=Math.round(k.loaded*100/k.total-10),k<0&&(k=0),d.find("span").html(k.toString()+"%"),e.css("width",k.toString()+"%")):d.html("unable to compute")},!1);g.addEventListener("load",function(k){d.find("span").html("100%");e.css("width","100%");$("#EWA_FRAME_"+c.H5_UPLOAD.SYS_FRAME_UNID+" #"+c.objName).val(k.target.responseText);c.responseText=k.target.responseText;c.UPLOAD_STATUS="ok"},!1);g.addEventListener("error",function(k){console.log(k);d.html(k);c.UPLOAD_STATUS=
"error"},!1);g.addEventListener("abort",function(k){d.html("The upload has been canceled by the user or the browser dropped the connection.");console.log(k);c.UPLOAD_STATUS="abort"},!1);var h=EWA.CP+"/EWA_STYLE/cgi-bin/_up_/?xmlname="+this.H5_UPLOAD.POST_XMLNAME+"&ITEMNAME="+this.H5_UPLOAD.POST_ITEMNAME+"&NAME="+this.H5_UPLOAD.POST_NAME+"&EWA_UP_TYPE=SWFUPLOAD&EWA_UP_REF="+this.H5_UPLOAD.POST_REF;$(a).find("button").hide();g.open("POST",h,!0);g.send(b);this.xhr=g}}
function EWA_UI_BoxClass(){this._ClassName=("_eWAbOX"+Math.random()).replace(".","$");window[this._ClassName]=this;this._Cfg=this._JSON_URL=this._REF_DATA=null;this.Create=function(a){this._Cfg=a;if(EWA.F&&EWA.F.FOS)for(var b in EWA.F.FOS)a=EWA.F.FOS[b],a.BOX_CLASS==this&&(this.FOS=a);this.FOS&&(a=new EWA_UrlClass(this.FOS.Url),a.GetParameter("EWA_BOX_PARENT_ID")&&(a=a.GetParameter("EWA_BOX_PARENT_ID"),$X(a)&&(this._Cfg.parent_id=a)));if(this._Cfg.parent_id){a=this._Cfg.parent_id.split(",");for(var c=
0;c<a.length;c++){var d=a[c].trim();if($X(d)){$($X(d)).html("waiting...");this._Cfg.parent_id_init=this._Cfg.parent_id;this._Cfg.parent_id=d;break}}if(this._Cfg.parent_id_init){this.initBoxSize();a=new EWA_UrlClass;a.SetUrl(this.FOS.Url);c=a.GetParameter("EWA_PAGESIZE");d=a.GetParameter("EWA_PAGECUR");c&&!isNaN(c)?this._Cfg.EWA_PAGESIZE=c:this._Cfg.EWA_PAGESIZE=this._Cfg.EWA_PAGESIZE||10;d&&!isNaN(d)?this._Cfg.EWA_PAGECUR=d:this._Cfg.EWA_PAGECUR=this._Cfg.EWA_PAGECUR||1;c={};for(b in a._Paras)c["@"+
b.toUpperCase()]=a._Paras[b];this._REF_DATA=c;this.load_box_data()}else alert("parent_id["+this._Cfg.parent_id+"]\u627e\u4e0d\u5230\u5b9a\u4e49\u7684\u5bf9\u8c61")}else alert("parent_id\u672a\u5b9a\u4e49")};this.initBoxSize=function(){if(this._Cfg.page_width){if(isNaN(this._Cfg.page_width)){var a=this._ClassName+"_check_size";var b="<div id='"+a+"' style='height:1px;width:"+this._Cfg.page_width+"'></div>";$("body").append(b);b=$($X(a));a=b.width();b.remove()}else a=this._Cfg.page_width*1;if(!(a<=
50)){b={};b.width=a;var c=a-10-20-5;b.box_title=c;b.box_title_img=c-30-5;a-=10;b.box_txt=a;b.box_des1=a-2-58;this._Cfg._Fix=b}}};this.load_box_data=function(){var a;if(this.FOS==null){var b=[EWA.CP+"/EWA_STYLE/cgi-bin/?EWA_AJAX=JSON_EXT1&ewa_frameset_no=1"];for(a in this._Cfg){var c=a.toUpperCase();if(c=="XMLNAME"||c=="ITEMNAME"||c.indexOf("EWA_")==0){var d=this._Cfg[a];d&&b.push(c+"="+d)}}b.push($U());this._JSON_URL=a=b.join("&")}else{b=new EWA_UrlClass;b.SetUrl(this.FOS.Url);b.AddParameter("EWA_AJAX",
"JSON_EXT1");b.AddParameter("ewa_frameset_no","1");for(a in this._Cfg)c=a.toUpperCase(),c.indexOf("EWA_")==0&&(d=this._Cfg[a])&&b.AddParameter(c,d);this._JSON_URL=a=b.GetUrl()}$J(a,this.load_box_data1,this)};this.load_box_data1=function(a,b){var c=b[b.length-1];b=c._Cfg;var d=c._Cfg.parent_id;EWA.F.FOS[a.FRAME_UNID]||(EWA_Utils.JsRegister(a.JSFRAME),EWA_Utils.JsRegister(a.JS));EWA.F.FOS[a.FRAME_UNID].Reload=function(){c.Create(c._Cfg)};EWA.F.FOS[a.FRAME_UNID].Goto=function(h){var k=new EWA_UrlClass;
k.SetUrl(c._JSON_URL);k.RemoveParameter("ewa_pagecur");k.AddParameter("ewa_pagecur",h);h=k.GetUrl();console.log(h);$J(h,c.load_box_data1,c._REF_DATA,h,c);this._JSON_URL=h};var e="___NeW_____"+b.parent_id;$X(e)||(b.new_parent_id=e,c.createToolbar(a));c.setPageInfo(a);c.enq_op_main_sub_boxs(a);b.autofocus==1&&(a=$X(d),a=$(a).offset().top,$("body").animate({scrollTop:a-30},300));if(b.callback)try{typeof b.callback=="function"?b.callback(c):eval(b.callback)}catch(h){console.log("EWA_UI_BoxClass->tmp.callback"+
h),console.log(b.callback)}if(EWA&&EWA.F&&EWA.F.FOS)for(var g in EWA.F.FOS)if(b=EWA.F.FOS[g],b.BOX_CLASS==c&&b.ReloadAfter)try{b.ReloadAfter(c)}catch(h){console.log("EWA_UI_BoxClass->EWA->ReloadAfter"+h),console.log(b.ReloadAfter)}};this.createToolbar=function(a){var b=this._Cfg,c=$($X(b.parent_id)),d=[];d.push('<div onselectstart="return false;" class="box-tool-bar">');for(var e=" onclick='"+this._ClassName+".toolBarClick(this)' ",g=["fa-table","fa-list aa","fa-sort aa","fa-search aa"],h=0;h<g.length;h++)d.push("<i class='fa "+
g[h]+"' "+e+"></i>");d.push("&nbsp;&nbsp;");g=["fa-fast-backward aa","fa-backward aa","fa-forward aa","fa-fast-forward aa"];for(h=0;h<g.length;h++)d.push("<i class='fa "+g[h]+"' "+e+"></i>"),h==1&&(d.push("<span class='aa' id='"+this._ClassName+"_records'></span>"),d.push("<select class='aa' id='"+this._ClassName+"_page' onchange='"+this._ClassName+".do_page(this)'><option value=5>5</option><option value=10>10</option><option value=20>20</option><option value=50>50</option><option value=100>100</option><option value=150>150</option><option value=200>200</option><option value=300>300</option><option value=500>500</option></select>"));
h=this.create_filter(a);e=h[0];h=h[1];d.push("<div class='sort_items' id='"+this._ClassName+"_search'>");d.push(e.join(""));d.push(h.join(""));d.push("</div>");a=this.create_sort(a);d.push("<div class='sort_items' id='"+this._ClassName+"_sort'>");d.push(a);d.push("</div>");d.push('</div><div id="'+b.new_parent_id+'"></div>');c.html(d.join(""));$X(this._ClassName+"_page").value=this._Cfg.EWA_PAGESIZE};this.setPageInfo=function(a){var b=a.RECORDS*1/this._Cfg.EWA_PAGESIZE,c=Math.round(b);c<b&&c++;this._Cfg._TOTALPAGE=
c;a=" ["+this._Cfg.EWA_PAGECUR+"/ <b >"+c+"</b> ("+a.RECORDS+")] ";if(b=$X(this._ClassName+"_records"))b.innerHTML=a};this.create_sort=function(a){var b=$J2MAP(a.CFG,"NAME"),c=[];for(d in EWA.F.FOS[a.FRAME_UNID].ItemList.Items)$(EWA.F.FOS[a.FRAME_UNID].ItemList.Items[d]).find("OrderSearch Set").attr("IsOrder")=="1"&&c.push(d);var d=[];d.push('<p class="sort-item" onclick="'+this._ClassName+'.do_sort(null,this)">\u6e05\u9664\u6392\u5e8f<b class="fa fa-times"></b></p>');for(var e=0;e<c.length;e++){var g=
c[e];b[g]&&(a=b[g].DES,d.push('<div  class="sort-item" onclick="'+this._ClassName+".do_sort(&quot;"+g+'&quot;,this)"><nobr><i class="fa fa-circle-o"></i>&nbsp;'+a+'&nbsp;<b class="fa"></b></nobr></div>'))}return d.join("")};this.do_sort=function(a,b){var c=$(".sort_items")[1];$(c).find(".sort-item i").attr("class","fa fa-circle-o");$(c).find(".sort-item b").attr("class","fa");if(a){var d=$(b).attr("desc");d==null||d==""?(a+=" DESC",$(b).attr("desc","desc"),d="fa fa-caret-down"):($(b).attr("desc",
""),d="fa fa-caret-up");$(b).find("i").attr("class","fa fa-dot-circle-o");$(b).find("b").attr("class",d)}this._Cfg.EWA_LF_ORDER=a;this._Cfg.EWA_PAGECUR=1;this.load_box_data();c.style.display="none";c.setAttribute("show","")};this.create_filter=function(a){var b=EWA.F.FOS[a.FRAME_UNID]._SearchJson,c=[],d=$J2MAP(a.CFG,"NAME"),e=[],g;for(g in b){var h=b[g];try{if(h.T=="fix"){c.push("<select onchange='"+this._ClassName+".do_filter(this)' search_type='"+h.T+"' search_tag='"+g+"'>");c.push("<option value=''>--"+
d[g].DES+"--</option>");for(var k=0;k<h.D.length;k++)a=h.D[k],c.push('<option value="'+a[0]+'">'+a[1]+"</option>");c.push("</select>")}else if(h.T=="text")e.push("<div class='search_input'><input search_type='"+h.T+"' old='' onblur='"+this._ClassName+".checkTextChange(this)' search_tag='"+g+"' type=text placeholder=\""+d[g].DES+'"/></div>');else if(h.T=="date"){var l=("D"+Math.random()).replace(".","A");e.push("<div class='search_input'><input style='width:43%' id='"+l+"' onclick=\"EWA.UI.Calendar.Pop(this)\" search_tag='"+
g+"' search_type='"+h.T+"' old='' onblur='"+this._ClassName+".checkTextChange(this)' type=text placeholder=\""+d[g].DES+"\"/> <input style='width:43%' id='"+l+"_1' old='' onblur='"+this._ClassName+'.checkTextChange(this)\' onclick="EWA.UI.Calendar.Pop(this)" type=text placeholder="'+d[g].DES+'"/></div>')}}catch(m){console.log(m),console.log(g),console.log(h)}}return[c,e]};this.toolBarClick=function(a){var b=a.className;if(b.indexOf("fa-table")>0)this.last_but!=a&&(this.last_but=a,$(a).parent().find(".aa").show(),
this.load_box_data());else if(b.indexOf("fa-list")>0)this.last_but!=a&&(this.last_but=a,$(a).parent().find(".aa").hide(),a=new EWA_UrlClass,a.SetUrl(this._JSON_URL),a.RemoveParameter("ewa_ajax"),a.AddParameter("ewa_ajax","install"),a.RemoveParameter("ewa_box"),a.RemoveParameter("xmlname"),a.AddParameter("xmlname","|"+this._Cfg.xmlname),(new EWA.C.Ajax).Install(a.GetUrl(),"",this._Cfg.new_parent_id,function(){}));else if(b.indexOf("fa-search")>0){b=this._ClassName+"_search";b=$($X(b));var c=$(a).offset(),
d=c.left;a=c+$(a).height+20;b.css({top:a,left:d,"z-index":1E4}).show()}else b.indexOf("fa-sort")>0?(b=this._ClassName+"_sort",b=$($X(b)),c=$(a).offset(),d=c.left,a=c+$(a).height+20,b.css({top:a,left:d,"z-index":1E4}).show()):b.indexOf("fa-fast-forward")>0?(this._Cfg.EWA_PAGECUR=this._Cfg._TOTALPAGE,this.load_box_data()):b.indexOf("fa-forward")>0?(a=this._Cfg.EWA_PAGECUR*1+1,a>this._Cfg._TOTALPAGE?$Tip("\u5df2\u7ecf\u5230\u9875\u5c3e\u4e86"):(this._Cfg.EWA_PAGECUR=a,this.load_box_data())):b.indexOf("fa-backward")>
0?(a=this._Cfg.EWA_PAGECUR*1-1,a==0?$Tip("\u5df2\u7ecf\u5230\u9875\u5934\u4e86"):(this._Cfg.EWA_PAGECUR=a,this.load_box_data())):b.indexOf("fa-fast-backward")>0&&(this._Cfg.EWA_PAGECUR=1,this.load_box_data())};this.checkTextChange=function(a){var b=a.getAttribute("old"),c=a.value.trim();b!=c&&(a.setAttribute("old",c),this.do_filter(a.parentNode))};this.do_page=function(a){a=a.value;this._Cfg.EWA_PAGESIZE=a;this.FOS&&(this.FOS._PageSize=a);this._Cfg.EWA_PAGECUR=1;this.load_box_data()};this.do_filter=
function(a){a=$(".sort_items")[0];for(var b=$(a).find("[search_tag]"),c={},d=0;d<b.length;d++){var e=b[d],g=e.getAttribute("search_type");if(e.value!=""||g=="date")if(g=="date"){var h=e.value,k=$X(e.id+"_1").value;if(h!=""||k!="")g="@!@"+e.getAttribute("search_tag")+"~!~"+g,c[g]||(c[g]=""),c[g]+="~!~"+h+"~!~"+k}else g="@!@"+e.getAttribute("search_tag")+"~!~"+g,c[g]||(c[g]=""),c[g]+="~!~"+e.value}b=[];for(var l in c)b.push(l),b.push(c[l]);this._Cfg.EWA_LF_SEARCH=b.join("");console.log(this.filterExp);
a.style.display="none";a.setAttribute("show","");this._Cfg.EWA_PAGECUR=1;this.load_box_data()};this.enq_op_main_sub_boxs=function(a){var b=$J2MAP(a.CFG,"NAME"),c=a.DATA,d=a.WF,e=this._Cfg,g=this._REF_DATA,h=$X(e.new_parent_id);if(h){h.innerHTML="";if(e.first){var k=this.enq_op_main_sub_tb();h.appendChild(k);var l=$(k.rows[0].cells[0]);l.attr({valign:"",align:"center"});l.append(e.first);$(k).addClass("ewa-box-first")}else this.enq_op_main_sub_box_but(h);h.setAttribute("sys_frame_unid",a.FRAME_UNID);
for(l=0;l<c.length;l++){k=this.enq_op_main_sub_tb();k.id=a.FRAME_UNID+"$"+c[l].EWA_KEY;h.appendChild(k);k=$(k.rows[0].cells[0]);if(e.chk&&e.chk_icons){var m=this.enq_op_main_sub_box_chk(b,c[l],e,g,d,a.FRAME_UNID);k.append(m)}m=this.enq_op_main_sub_title(b,c[l],e,g);k.append(m);m=this.enq_op_main_sub_box(b,c[l],e,g);k.append(m[0]);k.attr("json",JSON.stringify(m[1]));k.attr("json_ref",JSON.stringify(c[l]))}$(h).find(".box_des1").each(function(){this.title=GetInnerText(this)});$(h).append('<div style="clear:both"></div>')}};
this.enq_op_main_sub_box_but=function(a){var b=$(a).parentsUntil("table[id=Test1]").find(".ewa_lf_func_dact"),c=this.enq_op_main_sub_tb();a.appendChild(c);var d=$(c.rows[0].cells[0]),e=d.width()/3-10;d.attr("valign","middle");b.each(function(){var g=document.createElement("div");g.innerHTML=this.innerHTML;g.className="box_but";this.id=this.id||("sdo"+Math.random()).replace(".","P");g.id="K"+this.id;$(g).attr("fid",this.id);$(g).attr("onclick","$X(this.getAttribute('fid')).click()");$(g).css("width",
e);d.append(g)});return c};this.enq_op_main_sub_box_chk=function(a,b,c,d,e,g){var h=document.createElement("div");h.className="status";if(c.chk&&c.chk instanceof Function)try{var k=c.chk(b);var l=c.chk_icons[k];typeof l=="function"&&(l=l())}catch(m){l=m}if(l==null||l=="")l=c.icon;if(l==null||l=="")l="fa fa-gear";c=c.icon_color;typeof l=="object"&&(c=l.color,l=l.icon);l.trim().indexOf("fa")==0?h.innerHTML="<li class='"+l+"' "+(c?" style='color:"+c+"'":"")+"></li>":h.innerHTML=l;a=this.enq_op_main_sub_menu(a,
b,d,e,g);a.childNodes.length>0&&(h.setAttribute("onclick",this._ClassName+".enq_op_main_sub_menu_show(this)"),h.appendChild(a));return h};this.enq_op_main_sub_menu_show=function(a){var b=$(a).find(".box_menus")[0];if(!this.enq_op_main_sub_last_menu){var c=document.createElement("div");c.className="box_menus";c.setAttribute("onselectstart","return false");document.body.appendChild(c);this.enq_op_main_sub_last_menu=$(c);this.enq_op_main_sub_last_menu.css("z-index",1E6)}this.enq_op_main_sub_last_menu.html(b.innerHTML);
this.enq_op_main_sub_last_menu.attr("json_ref",a.parentNode.getAttribute("json_ref"));a=$(a).offset();this.enq_op_main_sub_last_menu.show();b=this.enq_op_main_sub_last_menu.height();c=$("body").height();this.enq_op_main_sub_last_menu.css({left:a.left-110,top:a.top+b>c?a.top-b-10:a.top,width:110})};this.enq_op_main_sub_menu=function(a,b,c,d,e){var g=document.createElement("div");g.className="box_menus";$(g).hide();var h=null;for(n in a){var k=a[n],l=k._ONCLICK||k.EWA_ONCLICK||k.EWA_CLICK;if(l!=null&&
l!="")if(k.NAME.toUpperCase()=="BUTDELETE")h=k;else{var m=k.NAME.toUpperCase()=="BUTMODIFY"?"<b class='fa fa-edit'></b>"+k.DES:k.NAME.toUpperCase()=="BUTADD"?"<b class='fa fa-plus'></b>"+k.DES:"<b class='fa'></b>"+k.DES;l=this.replace_parameter(b,l,c);m=this.enq_op_main_sub_menu_item(m,l);m.setAttribute("refid",k.NAME);g.appendChild(m)}}if(h){var n=document.createElement("hr");g.appendChild(n);m="<b class='fa fa-trash-o'></b>&nbsp;"+h.DES;l=this.replace_parameter(b,h._ONCLICK,c);m=this.enq_op_main_sub_menu_item(m,
l);g.appendChild(m)}d&&(l=this.enq_op_main_wf_js(a,b,c,d,e)[0],m=enq_op_main_sub_menu_item("\u6d41\u7a0b\u63a7\u5236/\u5ba1\u6279",l),m.setAttribute("flow",1),m.setAttribute("onclick",this._ClassName+".enq_op_main_close_menu(event,this);eval('window.___wf_json_para='+this.parentNode.parentNode.parentNode.getAttribute('json'))"),g.appendChild(m));a="<b onclick='"+this._ClassName+".enq_op_main_close_menu(event,this)' class='fa fa-power-off close'></b>";g.setAttribute("onselectstart","return false;");
$(g).append(a);return g};this.enq_op_main_wf_js=function(a,b,c,d,e){for(var g=d.P,h=[],k=0;k<d.RID.length;k++)h.push("@"+d.RID[k]);g=g.replace(/\[RID\]/ig,h.join(","));d="EWA.UI.Dialog.OpenReloadClose('"+e+"','"+d.X+"','"+d.I+"',false,'"+(g+"&fjson=___wf_json_para')");d=this.replace_parameter(b,d,c);c=[];for(k=a.length-1;k>=0;k--)e=a[k],g=e.NAME,(g=b[g+"_HTML"]||b[g])&&c.push({DES:e.DES,VAL:g});return[d,c]};this.enq_op_main_sub_menu_item=function(a,b){var c=document.createElement("a");c.innerHTML=
a;c.href="javascript:void(0)";c.setAttribute("onclick",b+";"+this._ClassName+".enq_op_main_close_menu(event,this);");c.setAttribute("box_menu_item","yes");return c};this.enq_op_main_close_menu=function(a,b){a=a||window.event;a.stopPropagation();a.cancelBubble=!0;b.parentNode.style.display="none"};this.enq_op_main_sub_box=function(a,b,c,d){d=["<table  onselectstart='return true' class='box_txt' "+(this._Cfg._Fix?"style='width:"+this._Cfg._Fix.box_txt+"px'":"")+" cellspacing=0 cellpadding=0>"];for(var e=
this._Cfg._Fix?"style='width:"+this._Cfg._Fix.box_des1+"px'":"",g=[],h=0;h<c.txt.length;h++){var k=c.txt[h],l=k.t;k=k.n;if(k.indexOf("<hr")==0)d.push("<tr><td class='box_subject' colspan=2>"),d.push(k),d.push("</td></tr>");else{if((l=this.replace_parameter(b,l))&&l.indexOf("(")>=0&&l.indexOf(")")>0)try{l=eval(l)}catch(n){}var m=a[k]?a[k].DES:k;d.push("<tr class='ewa-box-"+k+"'><td class='box_subject'><div class='box_subject1'><nobr>");d.push(m);d.push("</nobr><i class='fa fa-caret-right' style='color:#ccc'></i></div></td>");
d.push("<td class='box_des'><div class='box_des1' "+e+">");d.push(l+"</div></td></tr>");g.push({DES:m,VAL:l})}}return[d.join(""),g]};this.enq_op_main_sub_tb=function(){var a=document.createElement("table");a.className="box";a.cellSpacing=0;a.cellPadding=0;a.insertRow(-1).insertCell(-1).vAlign="top";a.setAttribute("onselectstart","return false;");this._Cfg._Fix&&$(a).css("width",this._Cfg._Fix.width);this._Cfg.page_color&&$(a).css("background",this._Cfg.page_color);this._Cfg.page_radius&&$(a).css("border-radius",
this._Cfg.page_radius);this._Cfg.page_height&&$(a).css("height",this._Cfg.page_height);return a};this.replace_parameter=function(a,b,c){var d=b,e=[];for(g in a)e["@"+g.toUpperCase()]=a[g];if(c)for(g in c)e[g]||(e[g]=c[g]);if(a=b.match(/@[a-zA-Z0-9\-\._:]*\b/ig))for(b=0;b<a.length;b++){c=a[b];var g=c.toUpperCase();d=d.replace(c,e[g+"_HTML"]||e[g]||"")}return d};this.enq_op_main_sub_title=function(a,b,c,d){if(!c.title)return"";a=[];if(c.img){a.push("<div class='box_img'>");var e=typeof c.img=="function"?
c.img(b):b[c.img];var g="",h="_blank",k="";e&&e!=""?g=e.replace("_SMAILL",""):e=EWA.RV_STATIC_PATH+"/EWA_STYLE/images/pic_no.jpg";c.img_click&&(k=this.replace_parameter(b,c.img_click.toString(),d),h="");a.push("<a class='imgtb' style='background-image:url("+e+")' ");k?a.push(" href='javascript:void(0)' onclick=\""+k+'" '):g!=""&&a.push(" target='"+h+"' href=\""+g+'" ');a.push("></a>");a.push("</div>")}c.title&&(d="box_title",e="",c.img&&(d="box_title_img"),this._Cfg._Fix&&(e="width:"+this._Cfg._Fix[d]+
"px; "),c.title_color&&(e+="color:"+c.title_color),a.push("<div class='"+d+"' style='"+e+"'>"),b=this.replace_parameter(b,c.title),a.push(b),a.push("</div>"));return a.join("")};this.add_box_style=function(){}}
var EWA_UI_BoxExt={getFileLen:function(a){return a==null||isNaN(a)?a||"":a>1073741824?Math.round(a/1073741824*100)/100+"G":a>1048576?Math.round(a/1048576*100)/100+"M":a>1024?Math.round(a/1024*100)/100+"K":a+"B"},openInBox:function(a,b,c){if(!$X("EWA_UI_BoxExt_OpenInBox")){var d=[];d.push("#EWA_UI_BoxExt_OpenInBox {left: 10px;right: 10px;bottom: 10px;top: 10px;position: fixed; background-color: rgba(127, 127, 127, 0.7);display: none;padding: 5px;z-index: 1010;}");d.push("#EWA_UI_BoxExt_OpenInBox .title {height: 30px;background-color: #cdcdcd;font-size: 14px;padding: 4px;}");
d.push("#open_box .title b {color: #08c;cursor: pointer;}");var e=document.createElement("style");e.textContent=d.join("\n");document.getElementsByTagName("head")[0].appendChild(e);d=[];d.push("<div id='EWA_UI_BoxExt_OpenInBox'>");d.push("<table width=100% height=100% cellpadding=0 cellspacing=0>");d.push("<tr>");d.push('<td class="title"><b class="fa fa-power-off fa-border"');d.push(" onclick=\"$('#EWA_UI_BoxExt_OpenInBox').hide();isStopMouseWheel = false;\"></b>&nbsp;<span></span></td>");d.push("</tr>");
d.push("<tr>");d.push("<td class=\"cnt\" valign=top><div id='open_box_cnt'");d.push(" style='overflow: auto; width: 100%; height: 100%'></div></td>");d.push("</tr>");d.push("</table>");d.push("</div>");$("body").append(d.join(""))}$("#EWA_UI_BoxExt_OpenInBox").show();$("#EWA_UI_BoxExt_OpenInBox .title span").html(b);a="<iframe width=100% height=100% src='"+a+"' frameborder=0></iframe>";$("#EWA_UI_BoxExt_OpenInBox .cnt").html(a);c&&c()}};
EWA_UI_BoxExt={getFileLen:function(a){return EWA.UI.Ext.FileLen(a)},openInBox:function(a,b,c){if(!$X("EWA_UI_BoxExt_OpenInBox")){var d=[];d.push("#EWA_UI_BoxExt_OpenInBox {left: 10px;right: 10px;bottom: 10px;top: 10px;position: fixed; background-color: rgba(127, 127, 127, 0.7);display: none;padding: 5px;z-index: 1010;}");d.push("#EWA_UI_BoxExt_OpenInBox .title {height: 30px;background-color: #cdcdcd;font-size: 14px;padding: 4px;}");d.push("#open_box .title b {color: #08c;cursor: pointer;}");var e=
document.createElement("style");e.textContent=d.join("\n");document.getElementsByTagName("head")[0].appendChild(e);d=[];d.push("<div id='EWA_UI_BoxExt_OpenInBox'>");d.push("<table width=100% height=100% cellpadding=0 cellspacing=0>");d.push("<tr>");d.push('<td class="title"><b class="fa fa-power-off fa-border"');d.push(" onclick=\"$('#EWA_UI_BoxExt_OpenInBox').hide();isStopMouseWheel = false;\"></b>&nbsp;<span></span></td>");d.push("</tr>");d.push("<tr>");d.push("<td class=\"cnt\" valign=top><div id='open_box_cnt'");
d.push(" style='overflow: auto; width: 100%; height: 100%'></div></td>");d.push("</tr>");d.push("</table>");d.push("</div>");$("body").append(d.join(""))}$("#EWA_UI_BoxExt_OpenInBox").show();$("#EWA_UI_BoxExt_OpenInBox .title span").html(b);a="<iframe width=100% height=100% src='"+a+"' frameborder=0></iframe>";$("#EWA_UI_BoxExt_OpenInBox .cnt").html(a);c&&c()}};
function EWA_UI_LeftClass(){this.searchExp=this.sortExp=this.instanceName=this.objContent=this.objRecords=this.objSearchGrp=this.objSearch=this.parentId=this.lastmd=this.map=this.crm_cfg=null;this.Create=function(a){this.parentId=("EWA_UI_LeftClass"+Math.random()).replace(".","m");EWA.F.FOS[this.parentId]=this;this._Id=this.parentId;this.map=a;this.map.des=this.map.des.split(",");this.map.order=this.map.order.split(",");window!=parent&&$("body").css("background-color","transparent");a=['<link rel="stylesheet" rev="stylesheet" type="text/css" href=\''+
EWA.RV_STATIC_PATH+"/EWA_STYLE/skins/complex.css' />"];a.push("<table cellpadding=0 cellspacing=0 width=100% height=100%>");a.push("<tr>");a.push("<td width=230><div id='div_"+this.parentId+'\' class="items"></div></td>');var b="";this.map["default"]&&(b=' src="'+this.map["default"]+'" ');a.push("<td id=\"cnt\"><iframe frameborder=0 id='a2a2' "+b+' name="a2a2"');a.push("height=100% width=100%></iframe></td>");a.push("</tr>");a.push("</table>");$("body").html(a.join(""));this.instanceName="EWA.F.FOS."+
this.parentId;this.objContent=$X("div_"+this.parentId);a='<div class="search_box" onselectstart="return false">'+this.create_grp()+'<div class=" fa fa-search" style="width:100%"><input class="search" onkeyup="'+this.instanceName+".do_search()\" placeholder=\"search\"  onselectstart=\"return true\"></div></div><div class='search_records'><b class='fa fa-quote-left'></b>&nbsp;\u8bb0\u5f55\u6570\uff1a<i></i><b class='fa fa-chevron-up records-gotop'></b></div>";$("body").append(a);this.objSearch=$(".search")[0];
this.map.grp&&this.map.grp.length>0?this.objSearchGrp=$(".search-grp")[0]:(this.objContent.style.top="31px",$(".search_box").css("height",30));this.objRecords=$(".search_records i")[0];$(".search_records .records-gotop").click(function(){$(".items").first().scrollTop(0)});this.page_size=50;this.page_size=this.map.page_size?this.map.page_size:50;this.load_data();this.current_page=1};this.scroll_check=function(a){a.scrollHeight-a.scrollTop>a.clientHeight*1.2||this.current_page*this.page_size>=this.total_records||
this.is_load_data||this.load_more()};this.load_more=function(){this.current_page?this.current_page++:this.current_page=2;this._load_datas()};this.create_grp=function(){if(!this.map.grp||this.map.grp.length==0)return"";for(var a=["<div ><i class='fa fa-filter'></i><select onchange='"+this.instanceName+".do_grp(this)' class='search-grp'>"],b=0;b<this.map.grp.length;b++){var c=this.map.grp[b];a.push("<option value='"+c[1]+"'>"+c[0]+"</option>")}a.push("</select></div>");return a.join("")};this.create_sort=
function(){if(this.map.order!=null&&this.map.order.length!=0){var a=$J2MAP(this.crm_cfg,"NAME"),b=["<div openbox=1 class='sort' onclick='"+this.instanceName+".show_sort(this.childNodes[0],event)'><i openbox=1 style='line-height:16px' class='fa fa-gear'></i><table cellpadding=1 cellspacing=1 class='sort_items'><tr><td valign=top>"];b.push('<p onclick="'+this.instanceName+'.do_sort(null,this)">\u6e05\u9664\u6392\u5e8f<b class="fa fa-times"></b></p>');for(var c=0;c<this.map.order.length;c++){var d=this.map.order[c];
a[d]&&b.push('<div  class="sort_item" onclick="'+this.instanceName+".do_sort(&quot;"+d+'&quot;,this)"><nobr><i class="fa fa-circle-o"></i>&nbsp;'+a[d].DES+'&nbsp;<b class="fa"></b></nobr></div>')}b.push("</td><td valign=top></td><td valign=top></td></tr></table></div><div onclick='"+this.instanceName+".hide(this)' class='hide_but'><b style='line-height:16px' class='fa fa-caret-left'></b></div>");return b.join("")}};this.hide=function(a){this.objContent.style.display="none";this.objContent.parentNode.style.backgroundColor=
"#f1f1f1";this.objSearch.parentNode.parentNode.style.display="none";this.objRecords.parentNode.style.display="none";var b=this;this.objContent.parentNode.onclick=function(){b.show()};this.objContent.parentNode.appendChild(a);this.hideButton=a;$(this.objContent.parentNode).animate({width:"30px"},300)};this.show=function(){this.objSearch.parentNode.appendChild(this.hideButton);var a=this;$(this.objContent.parentNode).animate({width:"230px"},300,function(){a.objContent.parentNode.style.backgroundColor=
"";a.objContent.style.display="";a.objRecords.parentNode.style.display="";a.objSearch.parentNode.parentNode.style.display=""})};this.do_sort=function(a,b){var c=$(".sort_items")[0];$(c).find(".sort_item i").attr("class","fa fa-circle-o");$(c).find(".sort_item b").attr("class","fa");if(a){var d=$(b).attr("desc");d==null||d==""?(a+=" DESC",$(b).attr("desc","desc"),d="fa fa-caret-down"):($(b).attr("desc",""),d="fa fa-caret-up");$(b).find("i").attr("class","fa fa-dot-circle-o");$(b).find("b").attr("class",
d)}this.sortExp=a;this.current_page=1;this._load_datas();c.style.display="none";c.setAttribute("show","")};this.do_grp=function(a){this.current_page=1;this._load_datas()};this.do_filter=function(a){a=$(".sort_items")[0];for(var b=$(a).find("[search_tag]"),c={},d=0;d<b.length;d++){var e=b[d],g=e.getAttribute("search_type");if(e.value!=""||g=="date")if(g=="date"){var h=e.value,k=$X(e.id+"_1").value;if(h!=""||k!="")g="@!@"+e.getAttribute("search_tag")+"~!~"+g,c[g]||(c[g]=""),c[g]+="~!~"+h+"~!~"+k}else g=
"@!@"+e.getAttribute("search_tag")+"~!~"+g,c[g]||(c[g]=""),c[g]+="~!~"+e.value}b=[];for(var l in c)b.push(l),b.push(c[l]);this.filterExp=b.join("");a.style.display="none";a.setAttribute("show","");this.current_page=1;this._load_datas()};this.do_search=function(){var a=$(this.objSearch),b=a.val(),c=a.attr("old_val");b!=c&&(a.attr("old_val",b),this.searchExp="@!@"+this.map.search+"~!~text~!~"+b,this.current_page=1,this._load_datas())};this._load_datas=function(){this.is_load_data=!0;var a=$U2(this.map.XMLNAME,
this.map.ITEMNAME,this.map._URL_PARAS,!0);this.sortExp&&this.sortExp!=""&&(a+="&EWA_LF_ORDER="+this.sortExp.toURL());var b="";this.searchExp&&this.searchExp!=""&&(b=this.searchExp);this.filterExp&&this.filterExp!=""&&(b+=this.filterExp);b!=""&&(a+="&EWA_LF_SEARCH="+b.toURL());this.objSearchGrp&&(a+="&"+this.objSearchGrp.value);this.current_page&&(a+="&EWA_PAGECUR="+this.current_page);a+="&EWA_PAGESIZE="+this.page_size;var c=this,d=(new Date).getTime();this._load_datas_post_time=d;$J(a,function(e){d==
c._load_datas_post_time&&(c.total_records=e.RECORDS,c.show_pages(),c.show_data(e.DATA,[!0]),c.is_load_data=!1)})};this.show_sort=function(a,b){b=b||event;(b.srcElement||b.target).getAttribute("openbox")==1&&(a=$(a).next(),a.attr("show")==null||a.attr("show")==""?(a.show(),a.css({top:20,right:4}),a.attr("show",1)):(a.hide(),a.attr("show","")))};this.load_data=function(){if(EWA&&EWA.F&&EWA.F.FOS)for(var a in EWA.F.FOS){var b=EWA.F.FOS[a];if(b.LEFT_CLASS==this){var c=b;break}}b={};if(c){c=c.Url;var d=
new EWA_UrlClass;d.SetUrl(c);for(a in d._Paras)a!="XMLNAME"&&a!="ITEMNAME"&&a!="EWA_LEFT"&&(b[a]=d._Paras[a])}d=new EWA_UrlClass;d.SetUrl(window.location.href);for(a in d._Paras)a!="XMLNAME"&&a!="ITEMNAME"&&a!="EWA_LEFT"&&(b[a]=d._Paras[a]);b.EWA_FRAMESET_NO=1;b.EWA_AJAX="json_ext1";c=[];for(a in b)c.push(a+"="+((b[a]||"")+"").toURL());this.map._URL_PARAS=c.join("&");a=$U2(this.map.XMLNAME,this.map.ITEMNAME,this.map._URL_PARAS,!0);this.objSearchGrp&&(a+="&"+this.objSearchGrp.value);a+="&EWA_PAGESIZE="+
this.page_size;$J(a,this.load_data1,this)};this.create_filter=function(a){var b=[],c=$J2MAP(this.crm_cfg,"NAME"),d=[],e;for(e in a){var g=a[e];if(g.T=="fix"){b.push("<select onchange='"+this.instanceName+".do_filter(this)' search_type='"+g.T+"' search_tag='"+e+"'>");b.push("<option value=''>--"+c[e].DES+"--</option>");for(var h=0;h<g.D.length;h++){var k=g.D[h];b.push('<option value="'+k[0]+'">'+k[1]+"</option>")}b.push("</select>")}else g.T=="text"?d.push("<div class='search_input'><input search_type='"+
g.T+"' old='' onblur='"+this.instanceName+".checkTextChange(this)' search_tag='"+e+"' type=text placeholder=\""+c[e].DES+'"/></div>'):g.T=="date"&&(h=("D"+Math.random()).replace(".","A"),d.push("<div class='search_input'><input style='width:43%' id='"+h+"' onclick=\"EWA.UI.Calendar.Pop(this)\" search_tag='"+e+"' search_type='"+g.T+"' old='' onblur='"+this.instanceName+".checkTextChange(this)' type=text placeholder=\""+c[e].DES+"\"/> <input style='width:43%' id='"+h+"_1' old='' onblur='"+this.instanceName+
'.checkTextChange(this)\' onclick="EWA.UI.Calendar.Pop(this)" type=text placeholder="'+c[e].DES+'"/></div>'))}return[b,d]};this.checkTextChange=function(a){var b=a.getAttribute("old"),c=a.value.trim();b!=c&&(a.setAttribute("old",c),this.do_filter(a.parentNode))};this.load_data1=function(a,b){b=b[0];a.DATA.length==0&&b.noDataFunc&&b.noDataFunc();b.crm_cfg=a.CFG;var c=$J2MAP(b.crm_cfg,"NAME");b.CFG_MAP=c;b.WF=a.WF;b.FRAME_UNID=a.FRAME_UNID;b.show_data(a.DATA);b.total_records=a.RECORDS;b.show_pages();
c=b.create_sort();$(b.objSearch).parent().append(c);c=a.FRAME_UNID;EWA_Utils.JsRegister(a.JSFRAME);a=b.create_filter(EWA.F.FOS[c]._SearchJson);c=1;var d=$(b.objSearch).parent().find(".sort_items");if(a[0].length>0){var e='<p on1click="'+this.instanceName+'.do_sort(null,this)">\u7b5b\u9009</p>';d.find("td:eq(1)").css("width",140).append(e+a[0].join(""));c++}else d.find("td:eq(1)").hide();a[1].length>0?(e='<p on1click="'+this.instanceName+'.do_sort(null,this)">\u68c0\u7d22</p>',d.find("td:eq(2)").css("width",
140).html(e+a[1].join("")),c++):d.find("td:eq(2)").hide();d.css("width",c*144);b.init_scroll||(b.init_scroll=!0,b.objContent.setAttribute("onscroll",b.instanceName+".scroll_check(this)"))};this.show_pages=function(){this.objRecords.innerHTML=this.total_records+", "+this.current_page+"/ "+Math.ceil(this.total_records/this.page_size)};this.load_after=function(){};this.show_data=function(a,b){var c=$(this.objContent);this.current_page==1&&b!=null&&b.length>0&&b[0]==1&&c.find(".item").remove();for(b=
0;b<a.length;b++){var d=this.show_data1(a[b],b);c.append(d)}this.load_after&&this.load_after()};this.show_data1=function(a,b){var c=document.createElement("div");c.setAttribute("fid",("ITEM_"+Math.random()).replace(".","k"));c.className="item";var d=document.createElement("h1"),e=this.replace_parameter(a,this.map.title),g=$(this.objSearch).val();g&&g!=""&&(e=e.replace(g,"<span style='color:red'>"+g+"</span>"));g=this.total_records?this.total_records:this.page_size;g=8*((g<10?10:g)+"").split("").length+
2;d.innerHTML="<span class=idx style='width:"+g+"px'>"+(b+1+(this.current_page-1)*this.page_size)+"</span>"+e;d.title=e;$(d).css({"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"});c.appendChild(d);b=document.createElement("ol");for(var h in this.map.des)if(d=this.map.des[h],this.CFG_MAP[d]){e=document.createElement("li");g=this.CFG_MAP[d].NAME;var k=a[g+"_HTML"];if(k==null||k=="")k=a[g];k!=null&&k!=""&&(e.innerHTML=this.CFG_MAP[d].DES+":&nbsp; "+k,b.appendChild(e))}c.appendChild(b);
$(b).css({"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis",margin:4,padding:"4px 18px"});h=this.replace_parameter(a,this.map.key);c.id=h;c.setAttribute("onmousedown",this.instanceName+".md(this)");this.WF&&(a=this.create_item_wf(a),c.appendChild(a));return c};this.create_item_wf=function(a){for(var b=this.WF,c=b.P,d=[],e=0;e<b.RID.length;e++)d.push("@"+b.RID[e]);c=c.replace(/\[RID\]/ig,d.join(","));c="EWA.UI.Dialog.OpenReloadClose('"+this.FRAME_UNID+"','"+b.X+"','"+b.I+"',false,'"+
(c+"&fjson=___wf_json_para')");c=this.replace_parameter(a,c);b=document.createElement("a");b.innerHTML="\u6d41\u7a0b\u63a7\u5236/\u5ba1\u6279";b.setAttribute("flow",1);b.setAttribute("onclick","eval('window.___wf_json_para='+this.getAttribute('json'));"+c);c=[];for(var g in this.crm_cfg)d=this.crm_cfg[g],d.TAG=="span"&&(d={DES:d.DES,VAL:a[d.NAME+"_HTML"]||a[d.NAME]},d.VAL&&c.push(d));b.setAttribute("json",JSON.stringify(c));b.style.display="none";return b};this.md=function(a){this.lastmd&&(this.lastmd.className=
this.lastmd.className.replace(" md",""));a.className+=" md";this.lastmd=a;var b=this.map.u;if(b){this.map.u.indexOf("()")>0&&(b=eval(this.map.u));b=b+(b.indexOf("?")>0?"&":"?")+a.id+"&_fid_="+a.getAttribute("fid");if(this.objSearchGrp){var c=this.objSearchGrp.value;c!=""&&(b+="&"+c)}(c=$U())&&(b+="&"+c);this.AddTab?(a=GetInnerText($(a).find("h1")[0]),this.AddTab(b,a)):window.frames.a2a2.location.href=b}else window.frames[0].document.body.innerHTML='<h1 style="color:Red">json.u\u6ca1\u5b9a\u4e49,\u4e0d\u77e5\u9053\u8981\u5bfc\u822a\u5230\u54ea\u91cc</h1>'};
this.replace_parameter=function(a,b,c){var d=b,e=[];if(!a.____S2){for(var g in a)e["@"+g.toUpperCase()]=a[g];if(c)for(g in c)e[g]||(e[g]=c[g]);a.____S2=e}e=a.____S2;a=b.match(/@[a-zA-Z0-9\-\._:]*\b/ig);for(b=0;b<a.length;b++)c=a[b],g=(g=e[c.toUpperCase()])||"-",d=d.replace(c,g);return d}}
function EWA_ComplexClass(){this.Resources={};this.edit=function(a,b){var c=$X(a);$(c).offset();if(c.getAttribute("is_open")!=1)this.changeEdit(a,!1),b.innerHTML='<i class="fa fa-save"></i>',c.setAttribute("is_open",1),b.setAttribute("_title",EWA.LANG=="enus"?"Save":"\u4fdd\u5b58");else{var d=$("#"+a).find("form")[0].id.replace("f_","");if(!EWA.F.FOS[d].DoPostBefore()||!EWA.F.FOS[d].CheckValidAll($("#f_"+d)[0]))return;$(c).find("input[id=butOk]").click();this.changeEdit(a,!0);b.innerHTML='<i class="fa fa-edit"></i>';
c.setAttribute("is_open",0);b.setAttribute("_title",EWA.LANG=="enus"?"Edit":"\u7f16\u8f91")}this.focusObject(c)};this.focusObject=function(a,b){var c=$(a).offset();b?$("body").animate({scrollTop:c.top-40},300,b):$("body").animate({scrollTop:c.top-40},300);$(".pop_title").hide();a=$(a).prev().find(".fa-expand");a.length>0&&a.click()};this.goItem=function(a,b){var c=$X(a);if(c==null)alert("EWA_ComplexClass.goItem "+a+" not found");else{var d=$(c).offset();$("body").animate({scrollTop:d.top+30},300);
b?b():window["__timer_"+a]=setInterval(function(){b&&(window.clearInterval(window["__timer_"+a]),b())},111);this.focusObject($(c))}};this.changeEdit=function(a,b){a=$X(a);b&&$(a).hasClass("disabled-true")||($(a).find(".EWA_TD_B").hide(),$(a).find("select").attr("disabled",b),$(a).find("input").attr("disabled",b),$(a).find("textarea").each(function(){var c=$(this).parent();c.hasClass("ewa_redraw_info")&&c.find(".textarea-tip").length==0&&(c.css("position","relative").append("<span class='textarea-tip'>"+
$(this).attr("placeholder")+"</span>"),c.hover(function(){c.find(".textarea-tip").show()},function(){c.find(".textarea-tip").hide()}));if(c.find(".hide-textarea-content").length==0){var d="<div class='hide-textarea-content' style='display:none;overflow:auto;height:"+$(this).height()+"'>"+$(this).val()+"</div>";$(this).after(d)}c.find(".hide-textarea-content").hover(function(){$(this).parent().find(".textarea-tip").show()},function(){$(this).parent().find(".textarea-tip").hide()})}),$(a).find(".EWA_DHTML").each(function(){var c=
$(this).parent();if(c.hasClass("ewa_redraw_info")&&c.find(".textarea-tip").length==0){var d=$("#cpx_tab1 .EWA_TABLE").prop("id").replace("EWA_FRAME_",""),e=EWA.LANG?EWA.LANG.toLowerCase():"zhcn";d=$(EWA.F.FOS[d].ItemList.Items[this.id]).find("DescriptionSet Set[Lang='"+e+"']").attr("Info");c.css("position","relative").append("<span class='textarea-tip'>"+d+"</span>");c.hover(function(){c.find(".textarea-tip").show()},function(){c.find(".textarea-tip").hide()})}c.find(".hide-textarea-content").length==
0&&(d="<div class='hide-textarea-content' style='display:none;overflow:auto;height:"+$(this).height()+"'>"+$(this).find("input").val()+"</div>",$(this).after(d));c.find(".hide-textarea-content").hover(function(){$(this).parent().find(".textarea-tip").show()},function(){$(this).parent().find(".textarea-tip").hide()})}),b?($(a).addClass("disabled-true"),$(a).find("input").css("background-color","#eee"),$(a).find("textarea").hide(),$(a).find(".EWA_DHTML").hide(),$(a).find(".hide-textarea-content").show()):
($(a).removeClass("disabled-true"),$(a).find("input").css("background-color",""),$(a).find('input[ewa_class="droplist"]').css("background-color","lightyellow"),$(a).find("textarea").show(),$(a).find(".EWA_DHTML").show(),$(a).find(".hide-textarea-content").remove()))};this.textareaTip=function(a){var b=$(a).parent();b.find(".textarea-tip").length>0||(b.css("position","relative").append("<span class='textarea-tip' style=''>"+$(a).attr("placeholder")+"</span>"),b.hover(function(){b.find(".textarea-tip").show()},
function(){b.find(".textarea-tip").hide()}))};this._init=function(){this.Xml=new EWA.C.Xml;this.Xml.LoadXml(window["EWA_ITEMS_XML_"+this._Id]);this.Resources=new EWA_FrameResoures;this.Resources.Init(this.Xml);var a=window["_EWA_MENU_"+this._Id];$(".caption-info").attr("onselectstart","return false");this.add_doc_buts(a);this.init_lazy_frames_top();var b=this;addEvent(window,"scroll",function(){b.lazy_load()});this.mark_loc();this.lazy_load();document.body.style.overflow="hidden";EWA.B.MOZILLA?addEvent(window,
"DOMMouseScroll",this.my_mousewheel):addEvent(window,"mousewheel",this.my_mousewheel);a=this.getlocalStorage();for(var c in a)if(c!="id"&&a[c]&&$X(c)){var d=$($X(c)).prev().find(".fa-compress");d.length>0&&this.hide_frame(d[0])}window.open_in_box||(window.open_in_box=this.open_in_box);parent!=window&&(document.body.style.backgroundColor="transparent")};this.add_doc_buts=function(a){parent==window&&$("body").css("background-color","#ccc");if(a&&a.length!=0){for(var b=[],c=0;c<a.length;c++)b[c]=a[c];
b.push({Id:this._Id+"_comress_all",Txt:EWA.LANG=="enus"?"Hide All":"\u9690\u542b\u5168\u90e8",Cmd:"EWA.F.FOS['"+this._Id+"'].compress_all(this)",Img:"fa-compress"});for(c=b.length-1;c>=0;c--)if(a=b[c],a!=null){var d=$X("controls").rows[0].insertCell(1);d.innerHTML="<div id='"+a.Id+"' tag='"+a.Id+"' idx='"+c+"' onmouseover='EWA.F.FOS[\""+this._Id+"\"].show_title(this)' onmouseout=\"$('.pop_title').hide()\" class='but' _title=\""+a.Txt+'" '+(a.paras||"")+"><i class='fa "+a.Img+"'></i></div>";a.Cmd.indexOf("function(")>=
0?(d.childNodes[0].setAttribute("cmd",a.Cmd),d.childNodes[0].onclick=function(){var e=this.getAttribute("cmd");eval("("+e+")")(this)}):d.childNodes[0].setAttribute("onclick",a.Cmd);d.className="tdbut"}b=$("#controls").width();$("#dock").css("width",b).css("left","50%").css("margin-left",-1*b/2)}else $("#dock").hide()};this.init_lazy_frames_top=function(){this.lazy_frames=this.lazy_frames||{};var a=this;$("div[x]").each(function(){var b=$(this).offset().top;a.lazy_frames[this.id]?a.lazy_frames[this.id].top=
b:a.lazy_frames[this.id]={top:b}})};this._getBodyHeight=function(){return document.compatMode=="CSS1Compat"?document.documentElement.clientHeight:document.body.clientHeight};this.lazy_load=function(){var a=(document.compatMode=="CSS1Compat"?document.documentElement.scrollTop:document.body.scrollTop)+this._getBodyHeight(),b;for(b in this.lazy_frames)this.lazy_frames[b].top<=a-10&&this.lazy_load_do(b);this.mark_loc()};this._getParas=function(){var a=new EWA_UrlClass(this.Url);a.RemoveEwa();return a.GetParas()};
this.lazy_load_do=function(a){if(!this.lazy_frames[a].ok){this.lazy_frames[a].ok=!0;var b=$("#"+a),c=b.attr("x"),d=this._getParas();d&&(d="&"+d);if(c!=null&&c.length>0){var e=b.attr("i"),g=b.attr("p"),h=b.attr("js");h==null||h.trim()==""?EWA.F.Install(a,c,e,g+d):EWA.F.Install(a,c,e,g+d,function(){if(h.indexOf("(")>0)eval(h);else window[h](b,this)})}else{c=b.attr("u")+d+"&NO_NAV=1";var k=("iframe_lazy_"+Math.random()).replace(".","A");d="<iframe id='"+k+"' name='"+k+"' width=100% height=100% frameborder=0 src='"+
c+"'></iframe>";$X(a).innerHTML=d;var l=-1,m=c.indexOf("combine.jsp")>0?!0:!1;setInterval(function(){var n=window.frames[k];if(n&&n.document&&n.document.readyState=="complete"&&n.$){var p=m?$("[id=crm_main_box]:visible").height():n.document.body.offsetHeight;Math.abs(l-p)<100||(l=p,$("#"+k).css("height",p+10),n.document.body.style.overflow="hidden")}},777)}}};this.mark_loc=function(){for(var a=$(".fcaption"),b=$("#nav_left .top"),c=$("#nav_left .bottom"),d=$("#nav_left"),e=this._getBodyHeight(),g=
0;g<a.length;g++){var h=a[g],k=this.mark_loc_ref(h,g);h=$(h);h=h.offset().top-(document.compatMode=="CSS1Compat"?document.documentElement.scrollTop:document.body.scrollTop);h>e-c.height()?c.append(k):h<b.height()?b.append(k):(k.css({bottom:"",top:h}),d.append(k))}};this.mark_loc_ref=function(a,b){if(a.id==null||a.id=="")a.id=Math.random();var c=a.id;a=$(a);var d=$X("zzz"+c),e='EWA.F.FOS["'+this._Id+'"].';if(!d){d="c"+b%5;a.attr("class",a.attr("class")+" "+d);a.html("<b onclick='"+e+"max_frame(this)' class='fa fa-thumb-tack '>&nbsp;</b>"+
a.html());var g=a.css("background-color");a.parent().css("border-bottom-color",g);d=document.createElement("div");d.style.backgroundColor=g;d.id="zzz"+c;$("#nav_left").append(d);d.onclick=function(){var h=this.id.replace("zzz","");h=$($X(h)).offset().top;document.compatMode=="CSS1Compat"?$(document.documentElement).animate({scrollTop:h},300):$("body").animate({scrollTop:h},300)};d.title=a.text();d.innerHTML=b+1;d.onmouseover=function(){$(".pop_title_left div").html(this.title);var h=$(this).offset();
$(".pop_title_left").show().css("top",h.top-10).css("right",45)};d.onmouseout=function(){$(".pop_title_left").hide()};a.append('&nbsp;<i class="fa fa-compress" onclick='+e+"hide_frame(this)></i>");a.append('&nbsp;<i class="fa fa-refresh" onclick='+e+"reload_frame(this)></i>")}return $(d)};window.isStopMouseWheel=!1;this.my_mousewheel=function(a){if(!isStopMouseWheel){a=a.wheelDelta||a.detail;var b=document.compatMode=="CSS1Compat"?document.documentElement:document.body;b.scrollTop=EWA.B.MOZILLA?b.scrollTop+
a*3:b.scrollTop-a}};this.show_title=function(a){if(a.getAttribute("_title")==""||a.getAttribute("_title")==null){var b=a.title;if(b==""||b==null)return;a.setAttribute("_title",b);a.title=""}$(".pop_title div").html(a.getAttribute("_title"));b=$(a).offset();a=$(a).width();var c=$(".pop_title").height(),d=$(".pop_title").width();$(".pop_title").css("top",b.top-c-8);$(".pop_title").show();$(".pop_title").css("left",b.left-(d-a)/2)};this.compress_all=function(a){a=$(a);if(a.attr("compress")==null||a.attr("compress")==
""){a.attr("compress",1);a.find("i").attr("class","fa fa-expand");var b="fa-compress";a.attr("_title",EWA.LANG=="enus"?"Show All":"\u663e\u793a\u5168\u90e8")}else a.attr("compress",""),a.find("i").attr("class","fa fa-compress"),b="fa-expand",a.attr("_title",EWA.LANG=="enus"?"Hide All":"\u9690\u542b\u5168\u90e8");var c=this;$(".fcaption ."+b).each(function(){c.hide_frame(this)})};this.getlocalStorage=function(){var a="ROBERT_"+location.pathname;if(a.indexOf("/cgi-bin/")>0){var b=new EWA_UrlClass;b.SetUrl(window.location.href);
var c=b.GetParameter("xmlname");b=b.GetParameter("itemname");c&&b&&(a="EWA_"+c+"GdX"+b)}c={};if(window.localStorage[a])try{c=eval("__json="+window.localStorage[a]+"; __json;")}catch(d){c={}}c.id=a;return c};this.hide_frame=function(a){var b=$(a.parentNode.parentNode);b=b.next();var c=$(a);a=!1;c.attr("compress")==null||c.attr("compress")==""?(c.attr("compress",1),c.attr("class","fa fa-expand"),b.hide(),this.init_lazy_frames_top(),this.lazy_load(),a=!0):(c.attr("compress",""),c.attr("class","fa fa-compress"),
this.init_lazy_frames_top(),b.show());c=this.getlocalStorage();c[b.attr("id")]=a;window.localStorage[c.id]=JSON.stringify(c)};this.max_frame=function(a){a=$(a.parentNode.parentNode);$('<p id="_MAX_FRAME___"></p>').insertBefore(a);var b=a.next();isStopMouseWheel=!0;if(!$X("MAX_FRAME___")){var c=document.createElement("div");c.id="MAX_FRAME___";$(c).css({position:"fixed",left:10,right:10,top:10,bottom:10,"background-color":"rgba(255,255,255,0.9)","z-index":1E7,"padding-top":5,overflow:"auto","border-radius":5});
c.innerHTML='<div style="position:fixed;left:15px;top:15px;font-size:16px;color:#fff;cursor:pointer;width:20px;height:20px;border-radius:10px;text-align:center;background-color:#111;"  onclick=EWA.F.FOS["'+this._Id+'"].remove_max()><b style="line-height:20px" class="fa fa-times"></b></div>';document.body.appendChild(c)}c=$("#MAX_FRAME___");c.append(a);a.find(".fa").hide();c.append(b);b.show();c.show()};this.remove_max=function(){for(var a=$X("MAX_FRAME___"),b=$("#_MAX_FRAME___"),c=0;a.childNodes.length>
1;){var d=a.childNodes[1];$(d).insertBefore(b);$(d).find(".fa").show();c++;if(c>5)break}b.remove();$(a).hide();isStopMouseWheel=!1};this.reload_frame=function(a){a=a.parentNode.parentNode;a=a.nextElementSibling?a.nextElementSibling:a.nextSibling;var b=a.getAttribute("r");b!=null&&b!=""?eval(b):(b=$(a).find(".EWA_TABLE"),b.length>0?(b=b[0].id.replace("EWA_LF_","").replace("EWA_FRAME_",""),EWA.F.FOS[b]instanceof EWA_FrameClass?(b=EWA.F.FOS[b].Url,(new EWA_AjaxClass).Install(b,"EWA_AJAX=INSTALL",a.id,
function(){change_edit("disabled")})):EWA.F.FOS[b].Reload()):a.id=="grp_fin_all"?load_grp_fin_total():(a=a.getElementsByTagName("iframe"),a.length>0&&(a[0].src=a[0].src)))};this.open_in_box=function(a,b){$("#open_box").show();$("#open_box .title span").html(b);a=a.replace(/\|/ig,"%7c");a="<iframe width=100% height=100% src='"+a+"' frameborder=0></iframe>";$("#open_box .cnt").html(a);isStopMouseWheel=!0}}
function focus_object(a,b){var c=$(a).offset();b?$("body").animate({scrollTop:c.top-40},300,b):$("body").animate({scrollTop:c.top-40},300);$(".pop_title").hide();a=$(a).prev().find(".fa-expand");a.length>0&&a.click()}
function EWA_UI_ADListClass(){this._TimeOut=3E3;this._Width=515;this._Height=223;this._List=[];this._Object=null;this._CurIndex=0;this._GotoIndex=-1;this.ClassName=null;this.Timer=-1;this._CssSize="";this.IsAutoPaly=!0;this.SetSize=function(a,b){this._Width=a;this._Height=b;this._CssSize="width:"+this._Width+(isNaN(this._Width)?"":"px")+";height:"+this._Height+(isNaN(this._Height)?"":"px")};this.AddAd=function(a,b,c,d){var e={};e.ImgUrl=a;e.AdUrl=b;e.AdText=c;e.Target=d;this._List.push(e)};this.Change=
function(){window.clearTimeout(this.Timer);var a=this._Object.getElementsByTagName("a"),b=this._Object.getElementsByTagName("table")[0].rows[0];b.cells[1].childNodes[this._CurIndex].style.backgroundColor="#000";b.cells[1].childNodes[this._CurIndex].style.color="#fff";var c=a[this._CurIndex];this._GotoIndex==-1?(this._CurIndex++,this._CurIndex==this._List.length&&(this._CurIndex=0)):(this._CurIndex=this._GotoIndex,this._GotoIndex=-1);a=a[this._CurIndex];b.cells[1].childNodes[this._CurIndex].style.backgroundColor=
"white";b.cells[1].childNodes[this._CurIndex].style.color="#000";EWA.UI.Utils.FadeIn(a,c,10,80,this)};this.ChangeAfter=function(){var a=this._Object.getElementsByTagName("table")[0].rows[0].cells[0].childNodes[0];a.innerHTML=this._List[this._CurIndex].AdText;a.href=this._List[this._CurIndex].AdUrl;a.target=this._List[this._CurIndex].Target;this.IsAutoPaly&&(window.clearTimeout(this.Timer),this.Timer=window.setTimeout(this.ClassName+".Change()",this._TimeOut))};this.CreateByUrl=function(a,b){this._ParentId=
b;EWA.UI.Utils.FADE_AJAX=new EWA.C.Ajax;EWA.UI.Utils.FADE_AJAX.Get(a,eval(this.ClassName+".AjaxCallBack"));EWA.UI.Utils.FADE=this};this.AjaxCallBack=function(){var a=EWA.UI.Utils.FADE_AJAX;a._Http.readyState==4&&(a.HiddenWaitting(),a._Http.status==200?(EWA.UI.Utils.FADE._List=eval(a._Http.responseText),EWA.UI.Utils.FADE.Create()):alert("ERROR:\r\n"+a._Http.statusText),EWA.SHOW_ERROR=!0)};this.Create=function(a){a==null&&(a=this._ParentId);var b=$X(a);if(b==null)alert("ID("+a+") Not Exists!");else{a=
document.createElement("DIV");a.style.width=this._Width+(isNaN(this._Width)?"":"px");a.style.height=this._Height+(isNaN(this._Height)?"":"px");a.style.overflow="hidden";var c=[];c.push('<div style="position: relative;'+this._CssSize+'"><div style="z-index:0;position: absolute;'+this._CssSize+'"></div>');c.push('<div style="position: absolute; height: 20px; width: '+this._Width+"px; left: 0px; top:"+(this._Height-22)+'px; border: 1px black solid; background-color: #000; filter: Alpha(Opacity=20); opacity: 0.2;z-index:1"></div>');
c.push('<table style="z-index:2;position:absolute;height:20px; width:'+this._Width+(isNaN(this._Width)?"":"px")+"; left: 0px;top:"+(this._Height-22)+'px; font-size: 12px;color: white" cellpadding="0" cellspacing="0"><tr><td align="center"><a style="color:white"></a></td><td style="width:'+this._List.length*24+'px;"></td></tr></table>');c.push("</div>");a.innerHTML=c.join("");b.innerHTML="";b.appendChild(a);this._Object=a;this._CreateList();this.ChangeAfter()}};this._CreateList=function(){for(var a=
this._Object.getElementsByTagName("table")[0].rows[0].cells[1],b=0;b<this._List.length;b++){var c=this._List[b],d=document.createElement("div");d.style.cssText="filter:Alpha(Opacity=70);width: 18px; height: 18px; float: left; text-align: center; color: #fff; margin-right: 2px; font-family: arial; cursor: pointer; opacity: 0.7; border-radius: 9px;line-height: 18px; background-color: #000;";d.innerHTML=b+1;a.appendChild(d);d.setAttribute("instancename",this.ClassName);d.onclick=function(){var g=eval("window."+
this.getAttribute("instancename"));window.clearTimeout(g.Timer);g._GotoIndex=this.innerHTML*1-1;g.Change()};d=document.createElement("div");d.style.cssText="background-image:url('"+c.ImgUrl+"');  "+this._CssSize+";background-repeat: no-repeat; background-size: cover;-moz-background-size: cover;-webkit-background-size: cover;background-position: center center;";d.title=c.AdText;var e=document.createElement("a");e.style.cssText=this._CssSize;e.style.position="absolute";e.style.top="0em";e.style.left=
"0em";b>0&&(e.style.display="none");e.style.zIndex=b;e.href=c.AdUrl;e.target=c.Target==null?"_blank":c.Target;e.appendChild(d);this._Object.childNodes[0].childNodes[0].appendChild(e)}}}
function EWA_UI_ADFlagClass(){this._ClassName=null;this._List=[];this._Ads=[];this.AddAd=function(a,b,c,d,e,g,h){var k={};k.IMG_SRC=a;k.URL=b;k.TOP=c;k.LEFT=d;k.IMG_WIDTH=e;k.IMG_HEIGHT=g;k.IS_FROM_CENTER=h;this._List.push(k)};this.Create=function(a){for(var b=0;b<this._List.length;b++)this._CreateObj(this._List[b]);if(a){var c=this;document.onscroll=function(){if(typeof window.pageYOffset!="undefined")var d=window.pageYOffset;else typeof document.compatMode!="undefined"&&document.compatMode!="BackCompat"?
d=document.documentElement.scrollTop:typeof document.body!="undefined"&&(d=document.body.scrollTop);for(var e=0;e<c._Ads.length;e++)c._Ads[e].style.top=c._List[e].TOP*1+d+"px"}}};this._CreateObj=function(a){var b=a.LEFT*1;a.IS_FROM_CENTER&&(b=window.document.body.offsetWidth/2+b);var c=document.createElement("div");c.style.position="absolute";c.style.left=b+"px";c.style.top=a.TOP+"px";c.style.width=a.IMG_WIDTH+"px";c.style.height=a.IMG_HEIGHT+"px";c.innerHTML="<a href='"+a.URL+"' target='_blank'><img src='"+
a.IMG_SRC+"' border='0' width='"+a.IMG_WIDTH+"px' height='"+a.IMG_HEIGHT+"px' /></a><div style='cursor:pointer;font-size:12px;text-align:right;padding-top:2px' onclick='this.parentNode.style.display=\"none\"'>\u5173\u95ed</div>";document.body.appendChild(c);this._Ads.push(c)}}
function EWA_CombineClass(){this.EWA_COMBINES_HTML=[];this.EWA_COMBINES=[];this.ewa_lf_func_index=this.curCombineIndex=0;this.MEAGER_ITEMS=[];this._init=function(){for(var a=0;a<this.EWA_COMBINES_HTML.length;a++)this.installCfgMoveButton1(this.EWA_COMBINES_HTML[a]);if(this.EWA_COMBINES.length==0){for(a=0;a<this.MEAGER_ITEMS.length;a++)this.meargeItems(this.MEAGER_ITEMS[a]);window.lastDo&&lastDo()}else this.installCfg()};this.installCfgMoveButton1=function(a){var b=$("#"+a).find(".ewa_lf_func");if(b.length!=
0&&(b=b[0],$X(a).getElementsByTagName("table")[0].style.height="",b.style.display="none",b=b.childNodes[1],b.getElementsByTagName("div").length>0))for(b.getElementsByTagName("div")[0].style.display="none";b.childNodes.length>0;)$X("DES_"+a).appendChild(b.childNodes[0])};this.installCfg=function(){if(this.curCombineIndex<this.EWA_COMBINES.length){if(this.curCombineIndex>0){if(!$X("EWA_FRAME_MAIN")){setTimeout(installCfg,51);return}$X("EWA_FRAME_MAIN").id="a"}var a=this.EWA_COMBINES[this.curCombineIndex],
b=this;EWA.F.Install(a.id,a.x,a.i,a.p,function(c,d,e,g){b.installOk(c,d,e,g)});this.curCombineIndex++}else{for(a=0;a<this.MEAGER_ITEMS.length;a++)this.meargeItems(this.MEAGER_ITEMS[a]);window.lastDo&&lastDo()}};this.installOk=function(a,b,c,d){this.installCfgMoveButton1(c);this.installCfg()};this.showFull=function(a){var b=$("#"+a).parent("div"),c=b.find(".left"),d=$("#"+a).find(".show"),e=b.attr("full");if(e!=null&&e=="1")b.attr("full","0"),$(document.body).css("overflow","auto"),eval("ori="+b.attr("ori")),
b.animate(q,"fast","swing",function(){b[0].style.cssText="";var t=b.attr("st")*1;document.body.scrollTop=t;$("#crm_left_box").attr("show")==1&&$("#crm_left_box").show();b.css("display",b.attr("dsp"));d.length>0&&a!="DES_plugin"?d[0].click():(t=$X(a.replace("DES_","")),t.style.width=t.parentNode.clientWidth-10+"px",t.style.height=q.height-30+"px",c.find('div[id="EWA_FRAME_MAIN"]').css("height",q.height-150))});else{b.attr("full","1");b.attr("st",document.body.scrollTop);b.attr("dsp",b.css("display"));
var g=document.documentElement.clientHeight;e=document.documentElement.clientWidth-10;var h=g-20,k=document.documentElement.clientWidth-30,l=g-20-20-15;g=b.offset();var m=b.position(),n=g.left-m.left,p=b.width(),r=b.height();var q={width:p,height:r,"margin-left":n,left:m.left,top:m.top};b.attr("ori",JSON.stringify(q));b.css({"margin-left":"0px",top:g.top,left:g.left,position:"absolute",display:"",overflow:"auto"});b.animate({width:e,height:h,left:10,top:0},"fast","swing",function(){c.css("width",
k);c.css("height",l);b.find("iframe").css("height",l);b.find('div[id="EWA_FRAME_MAIN"]').css("height",l-30);d.length>0&&a!="DES_plugin"&&d[0].click()});document.body.scrollTop=0;$("#crm_left_box").css("display")!="none"&&($("#crm_left_box").hide(),$("#crm_left_box").attr("show",1));$(document.body).css("overflow","hidden")}};this.meargeItems=function(a){a=a.split(",");for(var b,c,d,e=0;e<a.length;e++){var g=a[e].trim();if($X(g)){var h=$X(g.replace("DES_",""));$("#"+g);var k=[];if(e==0){b=$X(g);d=
document.createElement("div");d.id="KK_"+g;d.style.cssText="clear:both;height:25px;border-top:1px solid #cdcdcd";d.setAttribute("but","1");c=h;for(var l=1;l<$X(g).childNodes.length;l++)if(h=$X(g).childNodes[l],l>1)h.id="M"+Math.random(),k.push(h.id);else{var m=h;m.className="ewa_lf_func_caption show";if(m.id==null||m.id=="")m.id="MAx"+Math.random();m.parentNode.setAttribute("lid",m.id)}for(;$X(g).childNodes.length>2;)h=$X(g).childNodes[2],d.appendChild(h)}else for(h.parentNode.style.display="none",
c.parentNode.appendChild(h),h.style.display="none",l=0;$X(g).childNodes.length>1;)h=$X(g).childNodes[1],l>0?(h.style.display="none",h.id="M"+Math.random(),k.push(h.id),d.appendChild(h)):(m=h,b.appendChild(h)),l++;m.setAttribute("ids",k.join(","));m.setAttribute("lst",g);m.setAttribute("menu_id",d.id);var n=this;addEvent(m,"click",function(){n.meargeItems_ck(this)})}else if(e==0)return}d.childNodes.length>0&&(b.appendChild(d),b.style.height="50px")};this.meargeItems_ck=function(a){var b=a.getAttribute("menu_id"),
c=a.parentNode.getAttribute("lid");c!=null&&c.length>0&&($X(c).className="ewa_lf_func_caption hide");a.className="ewa_lf_func_caption show";if(a.id==null||a.id=="")a.id="MAx"+Math.random();a.parentNode.setAttribute("lid",a.id);$("#"+b).children("div").each(function(){$(this).hide()});$(a).parent("div").parent("div").children(".ewa_cb_left").each(function(){$(this).hide()});b=a.getAttribute("ids");if(b!="")for(b=b.split(","),c=0;c<b.length;c++)$X(b[c]).className!="ewa_lf_func_caption"&&($X(b[c]).style.display=
"");a=a.getAttribute("lst");a=$X(a.replace("DES_",""));a.style.display="";a.style.width=a.parentNode.clientWidth-20+"px"};this.actIframe=function(a){var b=$("#"+a).find("iframe");if(b.length==0)alert(a+" not iframe");else{var c=b[0].contentWindow,d=c.document.body.scrollHeight,e=c.document.body.scrollWidth;if(c.$){var g=0;c.document.body.innerHTML.indexOf("EWA.F.F.C")>0?(g=c.$("#Test1").height(),e=c.$("#Test1").width()):(c.$(".ewa_table").parent().parent().children().each(function(){g+=$(this).height()}),
e=c.$(".ewa_table").width());d=g}e>$("#"+a).width()&&(d+=40);d<300&&(d=330);$("#"+a).css("height",d);var h=this;b.attr("_src")!="0"?(b.attr("src",b.attr("_src")),b.attr("_src","0"),setTimeout(function(){h.chkFrameLazyLoaded(a)},199)):(h.setFrameCss(a,c),h.afterFrameLazyLoaded(a))}};this.setFrameCss=function(a,b){if($("#"+a).attr("lnk")!=1){var c=b.document.createElement("link");c.type="text/css";c.rel="stylesheet";c.rev="stylesheet";c.href="../../css/main.css";b.document.getElementsByTagName("head")[0].appendChild(c);
b.document.body.style.backgroundColor="#fff";$("#"+a).attr("lnk",1)}};this.afterFrameLazyLoaded=function(a){};this.chkFrameLazyLoaded=function(a){var b=$("#"+a).find("iframe")[0].contentWindow;if(b&&b.document&&b.document.body&&b.$&&b.document.readyState=="complete"){var c=[],d=$("#"+a).parent().find("div[but=1]");d.length>0&&(b.$(".ewa_lf_func_dact").each(function(g){var h=document.createElement("div");h.className="ewa_lf_func_dact";h.style.cursor="pointer";h.innerHTML=this.innerHTML;this.id==""&&
(this.id=a+"|"+Math.random());h.id=this.id;d[0].appendChild(h);h.onclick=function(){this.id.split("|");$("#"+a).find("iframe")[0].contentWindow.$X(this.id).click()};c.push(h.id);g==0&&(this.parentNode.parentNode.style.display="none")}),d.parent().find(".show").attr("ids",c.join(",")));this.actIframe(a)}else{var e=this;setTimeout(function(){e.chkFrameLazyLoaded(a)},101)}};this.showInPlugin=function(a,b){if(a.indexOf(".jsp")>0)a='<iframe width=100% height=100% frameborder=0 src="'+a+'"></iframe>',$("#plugin").html(a),
this.showFull("DES_plugin"),document.body.scrollTop=0,$X("subject_plugin").innerHTML=b;else{var c=this;(new EWA.C.Ajax).Install(a+"&EWA_AJAX=install&EWA_FRAMESET_NO=1","_r=1","plugin",function(){c.showFull("DES_plugin");document.body.scrollTop=0;$X("subject_plugin").innerHTML=b})}}}
installCfgMoveButton1=function(a){var b=$("#"+a).find(".ewa_lf_func");if(b.length!=0&&(b=b[0],$X(a).getElementsByTagName("table")[0].style.height="",b.style.display="none",b=b.childNodes[1],b.getElementsByTagName("div").length>0))for(b.getElementsByTagName("div")[0].style.display="none";b.childNodes.length>0;)$X("DES_"+a).appendChild(b.childNodes[0])};
(function(a,b){typeof module==="object"&&typeof module.exports==="object"?module.exports=b():b(a)})(typeof window!=="undefined"?window:this,function(a){function b(l){let m=[{number:0,scale:1,items:[]}];var n=null;for(let v=0;v<l.length;v++){var p=l[v],r=e[p],q=d[p];m[m.length-1].items.push([p,r,q]);if(r){v==0&&r.first?m[m.length-1].number=10:r.stop?(m[m.length-1].scale=r.value||1,m.push({number:0,scale:1,items:[]}),scale=1,n=null):(v==l.length-1&&(console.log(r),m[m.length-1].number.scale=r.value),
n=r);continue}if(q==null)throw"\u975e\u6570\u5b57\u6216\u5355\u4f4d\uff1a"+p;p=v==l.length-1?null:l[v+1];let u=v==l.length-1?null:e[p];u&&u.stop&&(u=null);p=m[m.length-1].number;var t=m[m.length-1].items;r=t[t.length-2];t=t[t.length-3];u==null?n==null?(n=!1,r&&r[2]===0?t&&t[1]!=null&&(n=!0):r&&r[1]&&r[1].value===10&&(n=!0),q=n?p+q:p*10+q):q=r&&r[1]&&r[1].value===10&&(t==null||t[2]===0||t[1]!=null)?p+q+10:p+q:q=p+q*u.value;m[m.length-1].number=q;n=null}return m}function c(l){if(!l)return l;if(!isNaN(l.toString()))return l.toString()*
1;var m=l.replace(/\uff0c|,| |\u5143|\u5706/ig,"").replace(/\u70b9|\u3002/ig,".").split(".");if(m.length>2)throw"\u975e\u6570\u5b57\u8868\u8fbe\u5f0f\uff1a"+l;var n=m[0].split("");l=(m.length==2?m[1]:"").split("");m=!1;var p=n[0];g[p]?(m=!0,n=n.splice(1)):h[p]&&(m=!1,n=n.splice(1));p=n[n.length-1];k[p]?n=n.splice(0,n.length-1):l.length>1&&(p=l[l.length-1],k[p]&&(l=l.splice(0,l.length-1)));p=n;var r=n=0;for(var q=p.length-1;q>=0;q-=2){var t=p[q],v=d[p[q-1]];t=v?t=="\u89d2"?("0."+v)*1:t=="\u5206"?("0.0"+
v)*1:t=="\u5398"?("0.00"+v)*1:t=="\u6beb"?("0.000"+v)*1:-1:-1;if(t===-1)break;else n+=t,r++}p=p.splice(0,p.length-r*2);p=b(p);r=0;q=1;for(t=p.length-1;t>=0;t--){v=p[t];var u=v.number;q*=v.scale;r+=u*q}n=r+n;if(l.length>0){p=1;r=0;for(q=l.length-1;q>=0;q--){t=e[l[q]];if(!t)break;p*=t.value;r++}l=p==1?l:l.splice(0,l.length-r);r=b(l);q=0;t=1;for(v=r.length-1;v>=0;v--){u=r[v];let w=u.number;t*=u.scale;q+=w*t}l=[("0."+q)*1,p,l.length]}else l=0;return l==0?n*(m?-1:1):((n+l[0])*l[1]).toFixed(l[2]<0?0:l[2])*
(m?-1:1)}let d={"\u96f6":0,0:0,"\uff10":0,o:0,O:0,"\u4e00":1,"\u58f9":1,1:1,"\uff11":1,"\u4e8c":2,"\u8d30":2,2:2,"\uff12":2,"\u4e24":2,"\u4fe9":2,"\u4e09":3,"\u53c1":3,3:3,"\uff13":3,"\u56db":4,"\u8086":4,4:4,"\uff14":4,"\u4e94":5,"\u4f0d":5,5:5,"\uff15":5,"\u516d":6,"\u9646":6,6:6,"\uff16":6,"\u4e03":7,"\u67d2":7,7:7,"\uff17":7,"\u516b":8,"\u634c":8,8:8,"\uff18":8,"\u4e5d":9,"\u7396":9,9:9,"\uff19":9},e={"\u5341":{value:10,first:!0},"\u62fe":{value:10,first:!0},"\u4ec0":{value:10,first:!0},"\u767e":{value:100},
"\u4f70":{value:100},"\u964c":{value:100},"\u5343":{value:1E3},"\u9621":{value:1E3},"\u4edf":{value:1E3},k:{value:1E3,stop:!0},K:{value:1E3,stop:!0},"\u4e07":{value:1E4,stop:!0},"\u842c":{value:1E4,stop:!0},w:{value:1E4,stop:!0},W:{value:1E4,stop:!0},M:{value:1E6,stop:!0},m:{value:1E6,stop:!0},"\u4ebf":{value:1E8,stop:!0},b:{value:1E9,stop:!0},B:{value:1E9,stop:!0}},g={"-":!0,"\u8d1f":!0,"\uff0d":!0},h={"+":!0,"\u6b63":!0},k={"\u6574":!0};if(typeof window!="undefined"&&window.EWA&&window.EWA_Utils)window.EWA_Utils.chineseToNumber=
c;else if(a)a.chineseToNumber=c;else return c});
var EWAC_WfOrg=function(){this.Depts={};this.Posts={};this.Users={};this.GetMaster=function(a){var b=this.Users[a];if(b==null)console.log((EWA.LANG=="enus"?"NONE of ":"\u6ca1\u6709\u554a")+a);else{a=b.Dept;for(var c in a.Users){b=a.Users[c];for(var d in b.Posts)if(b.Posts[d].IsMaster)return b}console.log(EWA.LANG=="enus"?"\tNo manager":"\u6ca1\u6709\u7ba1\u7406\u8005")}};this.IsMaster=function(a){var b=this.GetMaster(a);return b==null?!1:b.Id==a};this.InitDepts=function(a,b,c,d,e,g){for(var h=0;h<
a.length;h++){var k=a[h];if(this.Depts[k[b]]==null){var l={};l.Id=k[b];l.Name=k[c];l.Lvl=k[d];l.Ord=k[e];l.Pid=k[g];l.Posts={};l.Users={};l.Children={};this.Depts[l.Id]=l}}for(var m in this.Depts)k=this.Depts[m],this.Depts[k.Pid]?(a=this.Depts[k.Pid],k.Parent=a,a.Children[k.Id]=k):this.DeptRoot==null&&(this.DeptRoot=k)};this.InitPosts=function(a,b,c,d,e){for(var g=0;g<a.length;g++){var h=a[g],k=h[b];if(this.Posts[k]==null){var l={};l.Id=k;l.Name=h[c];l.DeptId=h[e];h=h[d];h=h==null?"":h.trim().toLowerCase();
l.IsMaster=h=="y"||h=="yes"||h=="true"||h=="1"?!0:!1;this.Depts[l.DeptId]&&(l.Dept=this.Depts[l.DeptId],l.Dept.Posts[l.Id]==null&&(l.Dept.Posts[l.Id]=l));this.Posts[k]=l}}};this.InitUsers=function(a,b,c,d,e){for(var g=0;g<a.length;g++){var h=a[g],k=h[b];if(this.Users[k]!=null)var l=this.Users[k];else l={},l.Id=k,l.Name=h[c],l.DeptId=h[d],l.Posts={},this.Depts[l.DeptId]&&(l.Dept=this.Depts[l.DeptId],l.Dept.Users[l.Id]==null&&(l.Dept.Users[l.Id]=l)),this.Users[k]=l;h=h[e];this.Posts[h]&&(l.Posts[h]=
this.Posts[h])}}};(function(){var a=[];a.push('<table gdx="LINE" style="border-collapse: collapse;width:100%;height:100%;font-size:0px" cellspacing="0" cellpadding="0"><tr>');a.push('<td style="font-size: 1px; width: 50%;" valign="top">&nbsp;</td>');a.push('<td style="font-size: 1px;" valign="top">&nbsp;</td></tr>');a.push('<tr><td style="font-size: 1px" valign="bottom">&nbsp;</td>');a.push('<td style="font-size: 1px;" valign="bottom">&nbsp;</td></tr></table>');EWAC_WF_CNN_TMP=a.join("")})();
function EWAC_WfUnit(a){this.Id=a;this.Type="normal";this.IsSelected=!1;this.tagName="wfunit";this.CnnsFrom={};this.CnnsFromLength=0;this.CnnsTo={};this.CnnsToLength=0;this.IsDelete=!1;this.ChangeType=function(b){var c=$X(this.Id),d="ewa_wf_unit_img";b=="control"?d="ewa_wf_unit_img1":b=="end"&&(d="ewa_wf_unit_img2");c.getElementsByTagName("img")[0].className=d};this.ChangeDes=function(b){var c=$X(this.Id);SetInnerText(c.getElementsByTagName("td")[1].childNodes[0],b)};this.GetDes=function(){return GetInnerText($X(this.Id).getElementsByTagName("span")[0]).trimEx()};
this.Delete=function(){if(!this.IsDelete){for(var b in this.CnnsFrom)this.CnnsFrom[b].Delete();for(b in this.CnnsTo)this.CnnsTo[b].Delete();b=$X(this.Id);b.parentNode.removeChild(b)}this.IsDelete=!0};this.Log=function(b,c,d){var e=EWA.RV_STATIC_PATH==null?EWA.CP:EWA.RV_STATIC_PATH;e+="/EWA_STYLE/";var g=$X(this.Id),h=g.getElementsByTagName("img")[0];h.src=e+"images/workflow/wf_ok.png?a=1";h.style.width="38px";h.style.height="38px";h.className="";e=h.nextSibling;d!=null&&d.trim().length>0&&(g.title=
d);d="";try{d=(new EWA_Utils.Date(c)).FormatDate()}catch(k){}e.innerHTML+='<div style="font-size:9px;color:darkblue">'+b+"<br><nobr>"+d+"</nobr></div>";g.style.backgroundColor="lightyellow"};this.LogCur=function(b){var c=$X(this.Id),d=c.getElementsByTagName("img")[0],e=d.nextSibling,g=null;b&&window.parent&&window.parent.$X(b)&&(g=window.parent.$X(b),g.options.length=0,g.options[g.options.length]=new Option("",""));b=!0;for(var h in this.CnnsFrom){b=!1;var k=this.CnnsFrom[h];k.IsStop||(k.Selected(),
k=EWAC_WfUtil.WF.Units[k.To],k.LogTo(),g&&(g.options[g.options.length]=new Option(k.GetDes(),k.Id)))}d.style.width="38px";d.style.height="38px";d.className="";h=EWA.RV_STATIC_PATH==null?EWA.CP:EWA.RV_STATIC_PATH;h+="/EWA_STYLE/";b?(e.innerHTML=EWA.LANG=="enus"?e.innerHTML+"<i><b>Finished</b></i>":e.innerHTML+"<i><b>\u6267\u884c\u7ed3\u675f</b></i>",d.src=h+"images/workflow/wf_no.png?A=1"):(e.innerHTML=EWA.LANG=="enus"?e.innerHTML+"<i><b>Current</b></i>":e.innerHTML+"<i><b>\u5f53\u524d\u8282\u70b9</b></i>",
g&&g.options.length==2&&(g.selectedIndex=1),c.style.backgroundColor="lightblue",c.style.color="white",d.src=h+"images/workflow/wf_cur.png?A=1")};this.LogTo=function(){var b=EWA.RV_STATIC_PATH==null?EWA.CP:EWA.RV_STATIC_PATH;b+="/EWA_STYLE/";var c=$X(this.Id);c.style.backgroundColor="lightyellow";c=c.getElementsByTagName("img")[0];c.src=b+"images/workflow/wf_next.png?A=2";c.style.width="38px";c.style.height="38px";c.className=""};this.Create=function(b){var c=EWAC_WfUtil.CUR_OBJ,d=document.createElement("TABLE");
d.id=this.Id;d.className="ewa_wf_box";var e=d.insertRow(-1);e=e.insertCell(-1);e.innerHTML='<img style="cursor:pointer" class="ewa_wf_unit_img" src="'+((EWA.RV_STATIC_PATH==null?EWA.CP:EWA.RV_STATIC_PATH)+'/EWA_STYLE//images/transparent.png" id="Atom_Img_')+a+'"><div a=1></div>';e.align="center";e=d.insertRow(-1);e=e.insertCell(-1);e.align="center";e.innerHTML='<span onselectstart="return true" onkeypress="EWAC_WfUtil.AtomNameKeyPress(this)" onblur="EWAC_WfUtil.AtomChangedName(this)" ondblclick="EWAC_WfUtil.AtomChangeName(this)">\u4e1a\u52a1\u5143'+
b+"</span>";document.body.appendChild(d);d.style.position="absolute";d.style.left=c?c.style.left:b*120+"px";d.style.top=c?c.style.top:"90px";c&&(c.style.position="static")};this.MoveTo=function(b,c){var d=this.GetObj();d.style.left=d.style.left.replace("px","")*1+b+"px";d.style.top=d.style.top.replace("px","")*1+c+"px";for(var e in this.CnnsFrom)this.CnnsFrom[e].IsDelete||(this.CnnsFrom[e].Show(),this.CnnsFrom[e].Disp());for(e in this.CnnsTo)this.CnnsTo[e].IsDelete||(this.CnnsTo[e].Show(),this.CnnsTo[e].Disp())};
this.GetObj=function(){return $X(this.Id)};this.UnSelect=function(){$X(this.Id).getElementsByTagName("img")[0].className="ewa_wf_unit_img";this.IsSelected=!1;EWAC_WfUtil.SELECTED=null};this.Selected=function(){$X(this.Id).getElementsByTagName("img")[0].className="ewa_wf_unit_img1";this.IsSelected=!0;EWAC_WfUtil.SELECTED=this}}
function EWAC_WfCnn(){this.IsSelect=!1;this.To=this.From=this.Type=this.Id=null;this.tagName="wfcnn";this.IsDelete=!1;this.ChangeStyle=function(a,b){a=$X(this.Id).getElementsByTagName("td");for(b=0;b<a.length;b++);};this.Delete=function(){var a=$X(this.Id);this.IsDelete||a.parentNode.removeChild(a);this.IsDelete=!0};this._CreateObject=function(a,b){a=document.createElement("div");a.id=this.Id;a.style.width=10;a.style.height=10;a.style.position="absolute";a.style.zIndex=0;a.innerHTML=EWAC_WF_CNN_TMP;
document.body.appendChild(a)};this.Create=function(a,b){this.Id=a.Id+"G"+b.Id;this.From=a.Id;this.To=b.Id;a.CnnsFrom[this.Id]=this;a.CnnsFromLength++;b.CnnsTo[this.Id]=this;b.CnnsToLength++;this._CreateObject(a,b);this.Show()};this.Show=function(){$X(this.Id);var a=$X(this.From),b=$X(this.To),c=a.offsetLeft,d=c+a.offsetWidth,e=a.offsetTop,g=e+a.offsetHeight,h=b.offsetLeft,k=h+b.offsetWidth,l=b.offsetTop,m=l+b.offsetHeight;a=0;d<h?(b=d,d=h-d,g<l?(c=g,g=l-g,e="0T,1L,3LBA"):g>l&&g<m?(c=e,g=m-e,e="0T,1L,3LBA"):
(e>m?(c=m,g=e-m):(c=l,g-=l),e="2B,3L,1LTA"),e+="\u7b2c\u4e00"):k<c?(b=k,d=c-k,g<l?(c=g,g=l-g,e="1T,0R,2RBA"):g>l&&g<m?(c=e,g=m-e,e="2BA,3L,1LT"):e>m?(c=m,g=e-m,e="0TA,1L,3LB(\u4e09)"):(c=l,g-=l,e="0TA,1L,3LB(\u56db)"),e+="\u7b2c\u4e8c"):c>h&&c<k?(b=k,d=d-k+20,g<l?(c=g,g=l-g,a=20,e="1TR,3RB,2BA(\u5927)"):(c=m,g=e-m,a=20,e="0TA,1TR,3RB(##)")):(b=d,d=k-d+20,g<l?(c=g,g=l-g,a=20,e="0T,1TR,3RBA(\u58eb)"):(c=m,g=e-m,a=20,e="1TRA,3RB,2B(#)"));e==null&&(e="\u672a\u53d1\u73b0");document.title=e;this.Drawline(e,
b,c,d,g,a);this.Disp(1)};this.Drawline=function(a,b,c,d,e,g){var h=$X(this.Id);d<0||e<0||(h.setAttribute("type",a),h.style.left=b+"px",h.style.top=c+"px",h.style.height=e+"px",h.style.width=d+"px",d==0||d-g<0||(a=h.childNodes[0].rows[0].cells[0],h=h.childNodes[0].rows[0].cells[1],g>0?(h.style.width=g+"px",a.style.width=d-g+"px"):(h.style.width="50%",a.style.width="50%")))};this.Disp=function(a,b){var c=$X(this.Id),d=a==null?1:a;a=c.getAttribute("type");var e=c.getAttribute("w");c.childNodes[0].setAttribute("type",
a);c.childNodes[0].setAttribute("w",e);for(e=c.getElementsByTagName("img");e.length>0;)e[0].parentNode.removeChild(e[0]),e=c.getElementsByTagName("img");for(var g=0;g<e.length;g++)e[g].style.display="none";e=c.getElementsByTagName("td");for(g=0;g<e.length;g++)e[g].style.border="0px";b=(b==null?"#000":b)+" "+d+"px solid";for(g=0;g<a.length;g++)if(c=a.substring(g,g+1),c.trim()!="")if(isNaN(c))c=="T"?h.style.borderTop=b:c=="L"?h.style.borderLeft=b:c=="R"?h.style.borderRight=b:c=="B"?h.style.borderBottom=
b:c=="A"&&(k==3?h.style.borderLeftWidth!="0px"?(c="arraw_t00.gif",h.style.textAlign="right"):(c="arraw_t01.gif",h.style.textAlign="left"):k==2?(c="arraw_t01.gif",h.style.textAlign="left"):k==1?h.style.borderLeftWidth!="0px"?(c="arraw_t10.gif",h.style.textAlign="right"):(c="arraw_t11.gif",h.style.textAlign="left"):(c="arraw_t11.gif",h.style.textAlign="left"),d=EWA.RV_STATIC_PATH==null?EWA.CP:EWA.RV_STATIC_PATH,d+="/EWA_STYLE/",h.innerHTML='<img src="'+d+"images/workflow/"+c+'" />');else{var h=e[c*
1];var k=c}};this.UnSelect=function(){this.Disp(1);this.IsSelected=!1;EWAC_WfUtil.SELECTED=null};this.Selected=function(){this.Disp(3);this.IsSelected=!0;EWAC_WfUtil.SELECTED=this}}
function EWAC_Wf(){this.Ids=null;this._CurIdx=0;this.Units={};this.Cnns={};this.GetUnid=function(){var a=this.Ids[this._CurIdx];this._CurIdx++;return a};this._LodIds=function(){var a=EWA.CP+"/EWA_DEFINE/cgi-bin/xml/?TYPE=GUNID&NUM=100",b=new EWA_AjaxClass;b.Get(a,function(){b.IsRunEnd()&&eval("c.Ids="+b.GetRst())})};this.ClearSelects=function(){for(var a in this.Units)this.Units[a].UnSelect();EWAC_WfUtil.CUR_OBJ=null;EWAC_WfUtil.TWO=[null,null]};this.GetUnit=function(a){var b;a.className=="ewa_wf_box"?
b=a.id:a.id.indexOf("Atom_Img_")>-1&&(b=a.id.replace("Atom_Img_",""));return b?this.Units[b]:null};this.CreateUnit=function(a){a||(a=this.GetUnid());var b=new EWAC_WfUnit(a);b.Create(this._CurIdx);return this.Units[a]=b};this.CreateCnn=function(){var a=EWAC_WfUtil.TWO[0],b=EWAC_WfUtil.TWO[1];if(a==null||b==null)alert("\u9700\u8981\u4e24\u4e2a\u4e1a\u52a1\u5143");else{var c=new EWAC_WfCnn;c.Create(a,b);this.Cnns[c.Id]=c}};this.GetCnn=function(a){return this.Cnns[a.parentNode.id]}}
var EWAC_WfUtil={CUR_OBJ:null,TWO:[null,null],SELECTED:null,MouseDown:function(a){a=a?a:event;var b=EWA.B.IE?a.srcElement:a.target,c=b.tagName.toUpperCase();if(c=="TD"&&b.parentNode.parentNode.parentNode.id=="Test1")EWAC_WfUtil.WF.ClearSelects();else{var d=EWA.UI.Utils.GetMousePosition(a);EWAC_WfUtil.M_X=d.X;EWAC_WfUtil.M_Y=d.Y;if(c=="IMG")if(b.id=="TEMP")EWAC_WfUtil.CUR_OBJ=b;else{if(b=EWAC_WfUtil.WF.GetUnit(b),EWAC_WfUtil.CUR_OBJ=b)EWA.UI.Utils.GetMousePosition(a),EWAC_WfUtil.objSelectedDown(b),
EWAC_WfUtil.ShowUnitPara(b)}else c=="TD"&&(a=b.parentNode.parentNode.parentNode,a.getAttribute("gdx")=="LINE"&&(a=EWAC_WfUtil.WF.GetCnn(a),a.IsSelected?a.UnSelect():a.Selected()))}},MouseUp:function(a){a=EWAC_WfUtil.CUR_OBJ;a!=null&&(a.id=="TEMP"&&EWAC_WfUtil.WF.CreateUnit(),EWAC_WfUtil.CUR_OBJ=null)},MouseMove:function(a){var b=EWAC_WfUtil.CUR_OBJ;if(b!=null){a=EWA.UI.Utils.GetMousePosition(a?a:event);var c=a.X-EWAC_WfUtil.M_X,d=a.Y-EWAC_WfUtil.M_Y;EWAC_WfUtil.M_X=a.X;EWAC_WfUtil.M_Y=a.Y;b.tagName==
"IMG"?(b.style.position="absolute",b.style.left=a.X+"px",b.style.top=a.Y+"px"):b.tagName=="wfunit"&&b.MoveTo(c,d)}},Delete:function(){var a=EWAC_WfUtil.SELECTED;a!=null&&(a.tagName.indexOf("wf")==0&&(a.Delete(),EWAC_WfUtil.TWO=[null,null],EWAC_WfUtil.SELECTED=null),EWAC_WfUtil.CUR_OBJ=null)},objSelectedDown:function(a){a.IsSelected?(a.UnSelect(),EWAC_WfUtil.TWO[0]==a&&(EWAC_WfUtil.TWO[0]=EWAC_WfUtil.TWO[1]),EWAC_WfUtil.TWO[1]=null):EWAC_WfUtil.TWO[1]==null&&(a.Selected(),EWAC_WfUtil.TWO[0]==null?
EWAC_WfUtil.TWO[0]=a:EWAC_WfUtil.TWO[1]=a)},AtomChangeName:function(a){a.contentEditable=!0;a.style.border="1px solid black"},AtomChangedName:function(a){a.contentEditable=!1;a.style.border=""},AtomNameKeyPress:function(a){event.keyCode==13&&AtomChangedName(a)},ShowUnitPara:function(a){}};function Init(){EWAC_WfUtil.WF=new EWAC_Wf;EWAC_WfUtil.WF._LodIds()}
function loadWfShow(a,b,c,d,e,g,h,k,l,m){_EWA_WF&&_EWA_WF.EN&&(_EWA_WF.EN1=$J2MAP(_EWA_WF.EN,"WF_UNIT_ID"));d=document.createElement("div");d.style.position="absolute";d.style.zIndex=123;d.innerHTML="ver: "+_EWA_WF.WF_DLV_VER;document.body.appendChild(d);var n=EWAC_WfUtil.WF,p=1000012,r=1000011;for(d=0;d<a.length;d++){var q=a[d],t=q.WF_UNIT_X,v=q.WF_UNIT_Y;t!=null&&t*1<p&&(p=t*1);v!=null&&v*1<r&&(r=v*1)}p==1000012&&(p=0);r==1000011&&(r=0);p-=10;r-=10;m={};var u;for(d=0;d<a.length;d++)q=a[d],n.Ids[d]=
q.WF_UNIT_ID,t=n.CreateUnit(),m[q.WF_UNIT_ID]=t,v=q.WF_UNIT_NAME,EWA.LANG=="enus"&&_EWA_WF.EN1&&_EWA_WF.EN1[q.WF_UNIT_ID]&&_EWA_WF.EN1[q.WF_UNIT_ID].WF_UNIT_NAME_EN&&(v=_EWA_WF.EN1[q.WF_UNIT_ID].WF_UNIT_NAME_EN),t.ChangeDes(v),t.ChangeType(q.WF_UNIT_TYPE),t.WF_UNIT_ADM=q.WF_UNIT_ADM,t.WF_UNIT_ADM_LST=q.WF_UNIT_ADM_LST,t=q.WF_UNIT_X,v=q.WF_UNIT_Y,q=$X(q.WF_UNIT_ID),t!=null&&(q.style.left=t-p+"px"),v!=null&&(q.style.top=v-r+"px");a={};for(d=0;d<b.length;d++)q=b[d],t=q.WF_UNIT_FROM,a[t]||(a[t]=[]),a[t].push(q);
for(d=0;d<b.length;d++)q=b[d],a=q.WF_UNIT_TO,t=q.WF_UNIT_FROM,t=n.Units[t],a=n.Units[a],p=new EWAC_WfCnn,p.Create(t,a),n.Cnns[p.Id]=p,q.IsHaveLogic&&!q.IsLogicOk&&(p.IsStop=!0);for(var w in n.Units)d=n.Units[w],u==null&&d.CnnsToLength==0&&(u=d);if(u==null)d=EWA.LANG=="enus"?"No startup node was found, process definition error":"\u672a\u53d1\u73b0\u542f\u52a8\u8282\u70b9,\u6d41\u7a0b\u5b9a\u4e49\u9519\u8bef",alert(d);else{c.length==0&&(n.CurUnit=u);var x=[];w={};for(d=0;d<c.length;d++)b=c[d],n=b.SYS_STA_TAG,
t=m[n],t!=null&&(q=b.ADM_NAME,EWA.LANG=="enus"&&b.ADM_NAME_EN&&(q=b.ADM_NAME_EN),t.Log(q,b.SYS_STA_CDATE,b.SYS_STA_MEMO),w[n]||(w[n]=1,x.push({ID:n,DES:t.GetDes()})),n=b.SYS_STA_TAG+"G"+b.SYS_STA_VAL,EWAC_WfUtil.WF.Cnns[n]&&(EWAC_WfUtil.WF.Cnns[n].Disp(3,"blue"),t==u&&(t.ADM_ID=b.ADM_ID),d==c.length-1&&(t=m[b.SYS_STA_VAL],t.WF_UNIT_ADM_LST=b.ROLE_IDS,t.WF_UNIT_ADM=b.ROLE_TYPE,EWAC_WfUtil.WF.CurUnit=t)));l!=null&&l.length>0&&m[l]&&(EWAC_WfUtil.WF.CurUnit=m[l]);EWAC_WfUtil.WF.CurUnit.LogCur(e);l=!1;
t=EWAC_WfUtil.WF.CurUnit;c=[];if(u==t)l=!0;else if(t.WF_UNIT_ADM=="WF_ADM_ADM")if(u=","+t.WF_UNIT_ADM_LST+",",u.indexOf(","+g+",")>=0)l=!0;else for(d in g=$J2MAP1(top.org,"ADM_ID"),h=t.WF_UNIT_ADM_LST.split(","),h){k=g[h[d]];for(var y in k)c.push(k[y].ADM_NAME)}else if(t.WF_UNIT_ADM=="WF_ADM_DEPT")if(u=","+t.WF_UNIT_ADM_LST+",",u.indexOf(","+h+",")>=0)l=!0;else for(d in g=$J2MAP1(top.org,"DEP_ID"),h=t.WF_UNIT_ADM_LST.split(","),h)for(y in k=g[h[d]],k)c.push(k[y].ADM_NAME);else if(t.WF_UNIT_ADM=="WF_ADM_POST"){u=
","+t.WF_UNIT_ADM_LST+",";g=k.split(",");for(h=0;h<g.length;h++)if(u.indexOf(","+g[h]+",")>=0){l=!0;break}if(!l)for(d in g=$J2MAP1(top.org,"DEP_POS_ID"),h=t.WF_UNIT_ADM_LST.split(","),u={},h)for(y in k=g[h[d]],k)m=k[y],u[m]||(u[m]=!0,c.push(k[y].ADM_NAME))}else if(t.WF_UNIT_ADM=="WF_ADM_START")if(u==t||g==u.ADM_ID)l=!0;else for(y in g=$J2MAP1(top.org,"ADM_ID"),k=g[u.ADM_ID],k)c.push(k[y].ADM_NAME);else t.WF_UNIT_ADM=="WF_ADM_MANAGER"&&(y=u.ADM_ID,top||top.ORG||(d=EWA.LANG=="enus"?"No organization":
"\u6ca1\u6709\u7ec4\u7ec7\u673a\u6784",alert(d),l=!1),l=top.ORG.GetMaster(y).Id==g?!0:!1);e&&window.parent&&window.parent.$X(e)&&(y=window.parent.$X(e).parentNode.parentNode.parentNode,l?x.length>0&&(d=y.rows[y.rows.length-1].cells[0],g=window.parent.document.createElement("input"),g.type="button",g.value=EWA.LANG=="enus"?"Back":"\u6253\u56de",g.onclick=function(){var z=window.parent.$X(e);z.options.length=1;for(var A=0;A<x.length;A++){var B=x[A];z.options[z.length]=new Option(B.DES,B.ID);this.style.display=
"none"}z.parentNode.parentNode.cells[0].innerHTML=EWA.LANG=="enus"?'<div style="color:red">Back steps</div>':'<div style="color:red">\u8fd4\u56de\u6b65\u9aa4</div>'},d.insertBefore(g,d.getElementsByTagName("input")[1])):(c.length==0?(d=EWA.LANG=="enus"?"Only view":"\u60a8\u53ea\u80fd\u67e5\u770b",window.parent.$X(e).parentNode.innerHTML="<b>"+d+"</b>"):(d=EWA.LANG=="enus"?"Waitting":"\u7b49\u5f85",g=EWA.LANG=="enus"?"or":"\u6216",window.parent.$X(e).parentNode.innerHTML="<b>"+d+':<span style="color:blue">'+
c.join("</span> "+g+' <span style="color:blue">')+"</span></b>"),window.parent.$X("butOk").style.display="none"),(d=_EWA_WF.WF_SHOW)&&showControls(y,d))}}
function showControls(a,b){for(var c=a.rows.length-5;c>=0;c--)a.rows[c].id.indexOf("_ewa_tr$EWA_WF_")!=0&&(a.rows[c].style.display="none");var d={},e=!1;for(c=0;c<b.length;c++)for(var g=b[c].XITEMS.split(","),h=0;h<g.length;h++){var k=g[h].trim();k==""||d[k]||(d[k]=1,e=!0)}if(e)for(var l in d)if(b=a.ownerDocument.getElementById("_ewa_tr$"+l))b.style.display=""}
function loadWf(a,b){for(var c=EWAC_WfUtil.WF,d=1000012,e=1000011,g=0;g<a.length;g++){var h=a[g],k=h.WF_UNIT_X,l=h.WF_UNIT_Y;k<d&&(d=k);l<e&&(e=l)}for(g=0;g<a.length;g++)h=a[g],c.Ids[g]=h.WF_UNIT_ID,k=c.CreateUnit(),k.ChangeDes(h.WF_UNIT_NAME),k.ChangeType(h.WF_UNIT_TYPE),k=h.WF_UNIT_X,l=h.WF_UNIT_Y,h=$X(h.WF_UNIT_ID),k!=null&&(h.style.left=k+"px"),l!=null&&(h.style.top=l+"px");for(g=0;g<b.length;g++){h=b[g];a=c.Units[h.WF_UNIT_FROM];h=c.Units[h.WF_UNIT_TO];k=new EWAC_WfCnn;try{k.Create(a,h),c.Cnns[k.Id]=
k}catch(m){alert(m)}}}
function loadByDefined(){for(var a=window.parent._EWAC_User.WorkflowTableSet,b=EWAC_WfUtil.WF,c=0;c<a.Count();c++){var d=a.GetItem(c);b.Ids[c]=d.Name;var e=b.CreateUnit(),g=d.Tables.GetItem("descriptionset").SearchValue("lang=zhcn","info");e.ChangeDes(g);d=d.Tables.GetItem("WfType").GetSingleValue();e.ChangeType(d)}for(c=0;c<a.Count();c++)e=a.GetItem(c),d=e.Tables.GetItem("WfType").GetSingleValue(),d!="end"&&(EWAC_WfUtil.TWO[0]=b.Units[e.Name],e=e.Tables.GetItem("WfAction"),d=e.GetValue("WFANextYes"),
d==null||d==""?(d=a.GetItem(c+1),EWAC_WfUtil.TWO[1]=b.Units[d.Name]):(alert(d),EWAC_WfUtil.TWO[1]=b.Units[d]),b.CreateCnn(),d=e.GetValue("WFANextNo"),d!=null&&d!=""&&(alert(d),EWAC_WfUtil.TWO[1]=b.Units[d]),b.CreateCnn());EWAC_WfUtil.TWO[0]=EWAC_WfUtil.TWO[1]=null}
function CreateExp(){var a=new EWA_XmlClass;a.LoadXml("<EwaWf><Units /><Cnns /><Draw /></EwaWf>");for(var b=a.GetElement("Units"),c=a.GetElement("Cnns"),d=document.getElementsByTagName("TABLE"),e=[],g=0;g<d.length;g++){var h=d[g];if(h.id.indexOf("Atom_Table_")==0||h.style.display=="none"){var k=a.NewChild("Unit",b);k.setAttribute("Unid",h.getAttribute("sid"));k.setAttribute("Type",h.getAttribute("type"));k.setAttribute("Des",GetInnerText(h).trim());e.push(GetOuterHTML(h))}}b=document.getElementsByTagName("DIV");
for(g=0;g<b.length;g++)if(d=b[g],d.id.indexOf("Atom_Table_")==0){k=d.id.split("G");h=k[0].replace("Atom_Table_","");var l=k[1].replace("Atom_Table_","");k=a.NewChild("Cnn",c);k.setAttribute("Unid",d.id);k.setAttribute("From",h);k.setAttribute("To",l);k.setAttribute("Logic","");e.push(GetOuterHTML(d))}c=a.GetElement("Draw");a.SetCData(e.join("\r\n"),c);alert(a.GetXml())}
function SetAtomName(a){CurSelectedID!=""&&(window.arrayAtoms[CurSelectedID][2]=a,$X("Atom_Table_"+CurSelectedID).rows[1].cells[0].innerText=a)}function SetAtomType(a){if(CurSelectedID!=""){var b=EWA.RV_STATIC_PATH==null?EWA.CP:EWA.RV_STATIC_PATH;b+="/EWA_STYLE/";window.arrayAtoms[CurSelectedID][1]=a;var c=$X("Atom_Table_"+CurSelectedID);c.type=a;c.rows[0].cells[0].childNodes[0].src=a==0?b+"images/workflow/nulla.gif":b+"images/workflow/nullaico.gif"}}
function loadParentInfoJson(a,b,c){a=a[b];for(var d in a){var e=c.insertRow(0);b=e.insertCell(-1);b.className="EWA_TD_L";e=e.insertCell(-1);e.className="EWA_TD_M";var g=a[d].VAL;b.innerHTML='<span style="color:111"><i>'+a[d].DES+"</i></span>";e.innerHTML=g}}
function loadParentInfo(){EWA.OW.Load();if(EWA.OW.PWin){for(var a,b=document.getElementsByTagName("table"),c=0;c<b.length;c++){var d=b[c];if(d.id.indexOf("EWA_FRAME_")==0){a=d;break}}if(a!=null)if(c=a.parentNode.parentNode.offsetHeight,b=a.offsetHeight,d=document.createElement("div"),d.style.height=c-b+"px",d.style.overflow="auto",d.innerHTML="<table broder=0 cellpadding=1 cellspacing=1 class=EWA_TABLE></table>",a.parentNode.insertBefore(d,a),a=d.childNodes[0],c=EWA.OW.PWin,b=new EWA_UrlClass,b.SetUrl(window.location.href),
d=b.GetParameter("fjson"),d!=null)loadParentInfoJson(c,d,a);else{b._Paras.COMBINE_ID&&c.$("#"+b._Paras.COMBINE_ID).find("li").each(function(m){m%2==0&&(h=a.insertRow(0),k=h.insertCell(-1),k.className="EWA_TD_L",k.innerHTML='<span style="color:111"><i>'+$(this).text()+"</i></span>");m%2==1&&(m=h.insertCell(-1),m.className="EWA_TD_M",m.innerHTML=$(this).text())});for(g in c.EWA.F.FOS)if(g==b.GetParameter("EWA_PARENT_FRAME")){var e=c.EWA.F.FOS[g];break}if(e&&(e=e.SelectCheckedRows(),e.length!=0)){e=
e[0];var g=e.parentNode.rows[0];for(c=e.cells.length-1;c>=0;c--)if(!(e.cells[c].getElementsByTagName("input")>0)&&(b=GetInnerText(g.cells[c]),d=GetInnerText(e.cells[c]),b!=null&&b.trim()!=""&&d!=null&&d.trim()!=""&&(b=b.replace("?","").trim(),b.trim()!=d.trim()))){var h=a.insertRow(0),k=h.insertCell(-1);k.className="EWA_TD_L";var l=h.insertCell(-1);l.className="EWA_TD_M";k.innerHTML='<span style="color:111"><i>'+b+"</i></span>";l.innerHTML=d}}}}else window.setTimeout(loadParentInfo,300)}
function getSpJson(){for(var a=null,b=document.getElementsByTagName("table"),c=0;c<b.length;c++)if(b[c].id.indexOf("EWA_FRAME_")==0){a=b[c];break}c="EWA_ITEMS_XML_"+a.id.replace("EWA_FRAME_","");a=[];a.push("[");b=new EWA_XmlClass;b.LoadXml(window[c]);b=b.XmlDoc.getElementsByTagName("XItem");for(c=0;c<b.length;c++){c>0&&a.push(",");var d=getSpItem(b[c]);eval("o="+d);if((void 0).TAG=="select"){for(var e=$X((void 0).NAME),g=[],h=0;h<e.options.length;h++){var k=e.options[h];g.push(k.text+"gdx|z"+k.value.replace(/"/ig,
""))}d=d.replace('"} ','"A":"'+g.join("!@1`")+"}");$X("EWA_WF_UMSG").value=d}a.push(d)}a.push("]");alert(a.join(""))}
function getSpItem(a){var b=a.getElementsByTagName("Tag")[0].getElementsByTagName("Set")[0].getAttribute("Tag"),c=a.getElementsByTagName("Name")[0].getElementsByTagName("Set")[0].getAttribute("Name");a=a.getElementsByTagName("DescriptionSet")[0].getElementsByTagName("Set")[0].getAttribute("Info");return'{"TAG":"'+b+'", "NAME":"'+c.replace(/"/ig,"")+'", "DES":"'+a.replace(/"/ig,"")+'"} '}
function EWA_OdtDocWordClass(){this.docks=[];this.pics=[];this.liNum=0;this.start=!1;this.defaultFontEnglish="Century Gothic";this.defaultFontChinese="Microsoft YaHei";this.walker=function(a){this.fixTable();this.walker1(a);this.unFixTable()};this.walker1=function(a){a.nodeType==3?this.walkerTxt(a):a.nodeType==1&&this.walkerEle(a)};this.walkerEle=function(a){if(a.style.display!="none")if(a.id=="pp"&&a.tagName=="CENTER")console.log("skip->",a.outerHTML);else{var b=a.tagName,c=!1;if(b=="DIV"&&(a.className.indexOf("page-next-before")>=
0||a.className.indexOf("page-next-after")>=0)){var d=this.createBreak();b=this.docks[0];console.log("break",d);b.appendChild(d);c=!0}else if(b=="UL"||b=="OL")d=this.createUl(a),b=this.getDockTable(),b.appendChild(d),this.docks.push(d),c=!0;else if(b=="LI")d=this.createLi(a),b=this.getDock(),b.appendChild(d),this.docks.push(d),c=!0;else if(b=="BR")if(d=this.createBr(a),b=this.getDock(),b.tagName!="text:p"){var e=this.createP(a.parentNode);b.appendChild(e);e.appendChild(d);this.docks.push(e)}else b.appendChild(d);
else if(b=="IMG")b=this.getDock(),console.log(b),d=this.createPic(a),b.tagName!="text:p"?(e=this.createP(a.parentNode),e.appendChild(d),b.appendChild(e),this.docks.push(e),c=!0,d=e):b.appendChild(d),this.lastWR=null;else if(b=="TABLE")b=this.getDockTable(),d=this.createTable(a),c=!0,b.appendChild(d),this.docks.push(d);else if(b!="TBODY")if(b=="TR")d=this.createTr(a),this.getDock().appendChild(d),this.docks.push(d),c=!0;else if(b=="TD"){d=this.createTd(a);this.getDock().appendChild(d);if(d.tagName==
"table:covered-table-cell")return;this.docks.push(d);c=!0}else if(b=="HR"){b=this.getDockTable();d=this.createP(a);e=this.createSpan(a);d.appendChild(e);var g=this.createHr();e.appendChild(g);this.lastWR=null;b.appendChild(d)}else if(b=="H1"||b=="H2"||b=="H3"||b=="P"||b=="CENTER"||b=="DIV")b=this.getDockTable(),d=this.createP(a),b.appendChild(d),this.docks.push(d),c=!0;else if(b=="SCRIPT")return;for(b=0;b<a.childNodes.length;b++)this.walker1(a.childNodes[b]);c&&(this.docksPop(d),this.lastWR=null)}};
this.walkerTxt=function(a){if(a.nodeValue.trimEx()==""&&a.nodeValue.indexOf("\u3000")==-1)this.lastWR=null;else{var b=this.createSpan(a.parentNode),c=a.nodeValue.replace(/\u00a0/ig," ");if(a.parentNode.tagName=="TD"||a.parentNode.tagName=="P"){var d=a.nodeValue.indexOf("\u3000")>=0;if(d){let e=eval("/\u3000/g");c=c.replace(e,"\u3010zwer\u4e2d\uff0cwer,\u6587_\u5168`\u89d2=\u7a7a\u683cwerwe\u3011")}c=c.trim();d&&(d=eval("/\u3010zwer\u4e2d\uff0cwer,\u6587_\u5168`\u89d2=\u7a7a\u683cwerwe\u3011/g"),c=
c.replace(d,"\u3000"))}EWA.B.IE?b.text=c:b.textContent=c;c=this.getDock();c.tagName!="text:p"?(a=this.createP(a.parentNode),a.appendChild(b),c.appendChild(a),this.docks.push(a)):c.appendChild(b)}};this.fixTable=function(){for(var a=$("td[colspan]").toArray(),b=0;b<a.length;b++){var c=a[b],d=c.parentNode,e=c.colSpan;c.setAttribute("m_colspan",e);for(var g=0;g<e-1;g++){var h=d.insertCell(c.cellIndex+g+1);h.innerHTML=g;h.bgColor="blue";h.className="colspan";h.setAttribute("fixed","1");h.style.display=
"none"}}$("td[rowspan]").each(function(){for(var k=this.rowSpan,l=this.parentNode,m=l.parentNode.parentNode,n=0;n<k-1;n++){var p=m.rows[l.rowIndex+n+1].insertCell(this.cellIndex);p.innerHTML=n;p.bgColor="green";p.className="rowspan";p.setAttribute("fixed","1")}$(this).attr("m_rowspan",k);this.rowSpan=""})};this.unFixTable=function(){$("td[fixed]").each(function(){this.parentNode.removeChild(this)});$("td[m_colspan]").each(function(){this.colSpan=this.getAttribute("m_colspan")});$("td[m_rowspan]").each(function(){this.rowSpan=
this.getAttribute("m_rowspan")})};this.createEle=function(a){return this.doc.XmlDoc.createElement(a)};this.createEles=function(a){a=a.split(",");for(var b=[],c=0;c<a.length;c++){var d=this.createEle(a[c].trim());b.push(d);c>0&&b[0].appendChild(d)}return b};this.createElesLvl=function(a){a=a.split(",");for(var b=[],c=0;c<a.length;c++){var d=this.createEle(a[c].trim());b.push(d);c>0&&b[c-1].appendChild(d)}return b};this.createElesSameLvl=function(a,b){a=a.split(",");for(var c=[],d=0;d<a.length;d++){var e=
this.createEle(a[d].trim());c.push(e);b.appendChild(e)}return c};this.createHr=function(){var a=this.createElesLvl("w:pict,v:rect");a[0].setAttribute("w14:anchorId",this.getParaId());this.setAtts(a[1],{style:"width:.05pt;height:1pt","o:hralign":"center","o:hrstd":"t","o:hrnoshade":"t","o:hr":"t",fillcolor:"black [3213]",stroked:"f"});return a[0]};this.createUl=function(a){var b=this.createEle("text:list");b.setAttribute("text:style-name",a.tagName=="OL"?"L1":"L2");return b};this.createLi=function(a){return this.createEle("text:list-item")};
this.createStyle=function(a){var b=this.createEle("style:style");b.setAttribute("style:family","text");a=$(a);var c=this.createEle("style:text-properties");b.appendChild(c);if(a.css("font-family")!=""){a.css("font-family").replace(/'/ig,"").split(",");var d=this.defaultFontEnglish,e=this.defaultFontChinese,g=this.fontSize(a.css("font-size"));this.setAtts(c,{"style:font-name":d,"style:font-name-asian":e,"fo:font-size":g,"style:font-size-complex":g,"style:font-size-asian":g})}a.css("color")!=""&&(d=
"#"+this.rgb1(a.css("color")).toLowerCase(),c.setAttribute("fo:color",d));d=a.css("font-weight");if(a.tagName=="B"||d!=""&&d!="normal"&&d!="400")c.setAttribute("fo:font-weight","bold"),c.setAttribute("style:font-weight-complex","bold"),c.setAttribute("style:font-weight-asian","bold");a.tagName=="I"&&(c.setAttribute("fo:font-style","italic"),c.setAttribute("style:font-style-complex","italic"),c.setAttribute("style:font-style-asian","italic"));return this.checkExistsStyle(b)};this.createStyleBreak=
function(){var a=this.createEle("style:style");a.setAttribute("style:family","paragraph");var b=this.createEle("style:paragraph-properties");a.appendChild(b);this.setAtts(b,{"fo:break-before":"page"});return this.checkExistsStyle(a)};this.createStyleP=function(a){var b=this.createEle("style:style");b.setAttribute("style:family","paragraph");var c=this.createEle("style:paragraph-properties");b.appendChild(c);a=$(a);var d=a.css("text-align");d=d==null?"":d;d=d.indexOf("center")>=0?"center":d.indexOf("right")>=
0?"end":"";d!=""&&this.setAtts(c,{"fo:text-align":d});d=a.css("margin-left").replace("px","");a=a.css("margin-right").replace("px","");d=this.px2cm(d)+"cm";a=this.px2cm(a)+"cm";this.setAtts(c,{"fo:margin-left":d,"fo:margin-right":a,"fo:text-indent":"0cm","style:justify-single-word":"false"});return this.checkExistsStyle(b)};this.checkExistsStyle=function(a){var b=a.outerHTML;if(this.fontMap[b])return this.fontMap[b];var c=this.getStyleName();this.setAtts(a,{"style:name":c});this.fontMap[b]=c;b=this.doc.XmlDoc.getElementsByTagName("automatic-styles");
b.length==0&&(b=this.doc.XmlDoc.getElementsByTagName("office:automatic-styles"));b[0].appendChild(a);return c};this.createStyleTd=function(a){var b=this.createEle("style:style");this.setAtts(b,{"style:family":"table-cell","style:data-style-name":"NO"});var c=this.createEle("style:table-cell-properties");b.appendChild(c);this.setAtts(c,{"fo:background-color":"transparent","fo:padding":"0.097cm"});for(var d=0;d<this.EWA_DocTmp.borders.length;d++){var e=this.EWA_DocTmp.borders[d],g=this.createBorder(a,
e);c.setAttribute("fo:border-"+e,g)}a=$(a).css("vertical-align");a=="middle"?c.setAttribute("style:vertical-align","middle"):a=="bottom"&&c.setAttribute("style:vertical-align","bottom");return this.checkExistsStyle(b)};this.createStyleCol=function(a){var b=this.createEle("style:style");this.setAtts(b,{"style:family":"table-column"});var c=this.createEle("style:table-column-properties");b.appendChild(c);a=$(a).width();a=this.px2cm(a);c.setAttribute("style:column-width",a+"cm");return this.checkExistsStyle(b)};
this.createStyleTable=function(a){var b=this.createEle("style:style");this.setAtts(b,{"style:family":"table"});var c=this.createEle("style:table-properties");b.appendChild(c);a=$(a).width();a=this.px2cm(a);c.setAttribute("style:width",a+"cm");c.setAttribute("style:shadow","none");return this.checkExistsStyle(b)};this.getStyleName=function(){this.fontIndex++;return"ST"+this.fontIndex};this.fontIndex=0;this.fontMap={};this.createSpan=function(a){var b=this.createEle("text:span");a=this.createStyle(a);
b.setAttribute("text:style-name",a);return b};this.createBr=function(a){return this.createEle("text:line-break")};this.createTable=function(a){var b=this.createEle("table:table");b.setAttribute("table:name","gdx"+Math.random());for(var c=null,d=-1,e=0;e<a.rows.length;e++){for(var g=a.rows[e],h=0,k=0;k<g.cells.length;k++)g.cells[k].getAttribute("fixed")||h++;h>d&&(d=h,c=g)}if(c)for(e=0;e<c.cells.length;e++)d=this.createEle("table:table-column"),g=this.createStyleCol(c.cells[e]),d.setAttribute("table:style-name",
g),b.appendChild(d);a=this.createStyleTable(a);b.setAttribute("table:style-name",a);return b};this.createTr=function(a){return this.createEle("table:table-row")};this.paraId=0;this.getParaId=function(){var a="0000"+this.paraId;a=a.substring(a.length-4);this.paraId++;return"F0C0"+a};this.createTd=function(a){if(a.className=="rowspan"||a.className=="colspan")return this.createEle("table:covered-table-cell");var b=this.createEle("table:table-cell");a.getAttribute("m_rowspan")>1&&b.setAttribute("table:number-rows-spanned",
a.getAttribute("m_rowspan"));a.getAttribute("m_colspan")>1&&b.setAttribute("table:number-columns-spanned",a.getAttribute("m_colspan"));b.setAttribute("office:value-type","string");a=this.createStyleTd(a);b.setAttribute("table:style-name",a);return b};this.createWidth=function(a,b){b=this.createEle("w:"+b);a=$(a).width()*15;b.setAttribute("w:w",a);b.setAttribute("w:type","dxa");return b};this.createHeight=function(a,b){b=this.createEle("w:"+b);a=$(a).height()*15;b.setAttribute("w:val",a);return b};
this.createBorder=function(a,b){var c=$(a).css("border-"+b+"-width");this.createEle("w:"+b);c=="0px"?c="none":(c="0.002cm "+$(a).css("border-"+b+"-style"),a=$(a).css("border-"+b+"-color"),a=this.rgb1(a).toLowerCase(),c+=" #"+a);return c};this.createPVanish=function(){return this.createElesLvl("w:p,w:pPr,w:rPr,w:vanish")};this.createP=function(a){var b=this.createEle("text:p");a=this.createStyleP(a);b.setAttribute("text:style-name",a);return b};this.createBreak=function(){var a=this.createEle("text:p"),
b=this.createStyleBreak();a.setAttribute("text:style-name",b);return a};this.createPic=function(a){var b=$(a),c=a.src;this.pics.push(a.src);a=c.lastIndexOf("/");c.substring(a+1);c=this.px2cm(b.width());b=this.px2cm(b.height());a=this.createElesLvl("draw:frame,draw:image");this.setAtts(a[0],{"svg:width":c+"cm","svg:height":b+"cm","draw:z-index":"0","draw:style-name":"fr1","text:anchor-type":"as-char"});this.setAtts(a[1],{"xlink:type":"simple","xlink:show":"embed","xlink:actuate":"onLoad","xlink:href":"{[PIC"+
(this.pics.length-1)+"]}"});return a[0]};this.createEleNs=function(a,b){return this.doc.XmlDoc.createElementNS(b,a)};this.setAtts=function(a,b){for(var c in b)a.setAttribute(c,b[c])};this.fontSize=function(a){a.indexOf("px")>0&&(a=this.EWA_DocTmp.f[a],a=a==null?"9pt":a);return a.replace("pt","")};this.rgb1=function(a){a=a.replace("rgb(","").replace(")","").split(",");return this.rgb(a[0]*1,a[1]*1,a[2]*1).toUpperCase()};this.rgb=function(a,b,c){a=a.toString(16);b=b.toString(16);c=c.toString(16);return(a.length<
2?"0":"")+a+(b.length<2?"0":"")+b+(c.length<2?"0":"")+c};this.init=function(){this.doc=new EWA_XmlClass;this.doc.LoadXml(this.EWA_DocTmp.document);var a=this.doc.XmlDoc.getElementsByTagName("text");a.length==0&&(a=this.doc.XmlDoc.getElementsByTagName("office:text"));this.docks.push(a[0])};this.getDock=function(){return this.docks[this.docks.length-1]};this.idx=0;this.docksPop=function(a){for(;this.docks.length!=1&&this.docks.pop()!=a;);};this.getDockTable=function(){for(var a=this.docks.length-1;a>=
0;a--){var b=this.docks[a];if(b&&(b.tagName=="office:text"||b.tagName=="table:table-cell"||b.tagName=="text:list-item"))return b}};this.px2cm=function(a){return a==null||a==""?0:a/96*2.539999918};this.EWA_DocTmp={document:'<?xml version="1.0" encoding="UTF-8"?><office:document-content xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0"   xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0"   xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0"  xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0"   xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0"  xmlns:math="http://www.w3.org/1998/Math/MathML" xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0"  xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" xmlns:ooo="http://openoffice.org/2004/office" xmlns:ooow="http://openoffice.org/2004/writer" xmlns:oooc="http://openoffice.org/2004/calc" xmlns:dom="http://www.w3.org/2001/xml-events" xmlns:xforms="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:rpt="http://openoffice.org/2005/report" xmlns:of="urn:oasis:names:tc:opendocument:xmlns:of:1.2" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:grddl="http://www.w3.org/2003/g/data-view#" xmlns:tableooo="http://openoffice.org/2009/table" xmlns:field="urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0" office:version="1.2"><office:scripts/> <office:font-face-decls><style:font-face style:name="OpenSymbol" svg:font-family="OpenSymbol"/><style:font-face style:name="\u5fae\u8f6f\u96c5\u9ed1" svg:font-family="\u5fae\u8f6f\u96c5\u9ed1"/><style:font-face style:name="Lucida Sans1" svg:font-family="&apos;Lucida Sans&apos;" style:font-family-generic="swiss"/><style:font-face style:name="\u5b8b\u4f53" svg:font-family="\u5b8b\u4f53" style:font-pitch="variable"/><style:font-face style:name="\u9ed1\u4f53" svg:font-family="\u9ed1\u4f53" style:font-pitch="variable"/><style:font-face style:name="Times New Roman" svg:font-family="&apos;Times New Roman&apos;"  style:font-family-generic="roman" style:font-pitch="variable"/><style:font-face style:name="Century Gothic" svg:font-family="Century Gothic" style:font-family-generic="swiss" style:font-pitch="variable"/><style:font-face style:name="Lucida Sans" svg:font-family="&apos;Lucida Sans&apos;" style:font-family-generic="system" style:font-pitch="variable"/><style:font-face style:name="\u5fae\u8f6f\u96c5\u9ed11" svg:font-family="\u5fae\u8f6f\u96c5\u9ed1" style:font-family-generic="system" style:font-pitch="variable"/></office:font-face-decls><office:automatic-styles><style:style style:name="fr1" style:family="graphic" style:parent-style-name="Graphics"><style:graphic-properties style:vertical-pos="top" style:vertical-rel="baseline" style:horizontal-pos="center" style:horizontal-rel="paragraph" style:shadow="none" style:mirror="none" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:luminance="0%" draw:contrast="0%" draw:red="0%" draw:green="0%" draw:blue="0%" draw:gamma="100%" draw:color-inversion="false" draw:image-opacity="100%" draw:color-mode="standard"/></style:style><text:list-style style:name="L1"><text:list-level-style-number text:level="1" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1"><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="1.27cm" fo:text-indent="-0.635cm" fo:margin-left="1.27cm"/></style:list-level-properties></text:list-level-style-number><text:list-level-style-number text:level="2" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1"><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"> <style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="1.905cm" fo:text-indent="-0.635cm" fo:margin-left="1.905cm"/></style:list-level-properties></text:list-level-style-number><text:list-level-style-number text:level="3" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1"> <style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="2.54cm" fo:text-indent="-0.635cm" fo:margin-left="2.54cm"/></style:list-level-properties></text:list-level-style-number><text:list-level-style-number text:level="4" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1"><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="3.175cm" fo:text-indent="-0.635cm"  fo:margin-left="3.175cm"/></style:list-level-properties></text:list-level-style-number><text:list-level-style-number text:level="5" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1"><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"> <style:list-level-label-alignment text:label-followed-by="listtab"  text:list-tab-stop-position="3.81cm" fo:text-indent="-0.635cm" fo:margin-left="3.81cm"/></style:list-level-properties></text:list-level-style-number><text:list-level-style-number text:level="6" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1"> <style:list-level-properties text:list-level-position-and-space-mode="label-alignment"> <style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="4.445cm" fo:text-indent="-0.635cm" fo:margin-left="4.445cm"/> </style:list-level-properties></text:list-level-style-number><text:list-level-style-number text:level="7" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1"><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="5.08cm" fo:text-indent="-0.635cm"  fo:margin-left="5.08cm"/> </style:list-level-properties></text:list-level-style-number><text:list-level-style-number text:level="8" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1"><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="5.715cm" fo:text-indent="-0.635cm" fo:margin-left="5.715cm"/> </style:list-level-properties></text:list-level-style-number><text:list-level-style-number text:level="9" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1"> <style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="6.35cm" fo:text-indent="-0.635cm" fo:margin-left="6.35cm"/> </style:list-level-properties></text:list-level-style-number><text:list-level-style-number text:level="10" text:style-name="Numbering_20_Symbols" style:num-suffix="." style:num-format="1"><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="6.985cm" fo:text-indent="-0.635cm" fo:margin-left="6.985cm"/></style:list-level-properties></text:list-level-style-number></text:list-style><text:list-style style:name="L2"><text:list-level-style-bullet text:level="1" text:style-name="Bullet_20_Symbols" text:bullet-char="\u2022"><style:list-level-properties text:list-level-position-and-space-mode="label-alignment"><style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="1.27cm" fo:text-indent="-0.635cm" fo:margin-left="1.27cm"/></style:list-level-properties></text:list-level-style-bullet> <text:list-level-style-bullet text:level="2" text:style-name="Bullet_20_Symbols" text:bullet-char="\u25e6">     <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">         <style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="1.905cm" fo:text-indent="-0.635cm" fo:margin-left="1.905cm"/>     </style:list-level-properties> </text:list-level-style-bullet> <text:list-level-style-bullet text:level="3" text:style-name="Bullet_20_Symbols" text:bullet-char="\u25aa">     <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">         <style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="2.54cm" fo:text-indent="-0.635cm" fo:margin-left="2.54cm"/>     </style:list-level-properties> </text:list-level-style-bullet> <text:list-level-style-bullet text:level="4" text:style-name="Bullet_20_Symbols" text:bullet-char="\u2022">     <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">         <style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="3.175cm" fo:text-indent="-0.635cm" fo:margin-left="3.175cm"/>     </style:list-level-properties> </text:list-level-style-bullet> <text:list-level-style-bullet text:level="5" text:style-name="Bullet_20_Symbols" text:bullet-char="\u25e6">     <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">         <style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="3.81cm" fo:text-indent="-0.635cm" fo:margin-left="3.81cm"/>     </style:list-level-properties> </text:list-level-style-bullet> <text:list-level-style-bullet text:level="6" text:style-name="Bullet_20_Symbols" text:bullet-char="\u25aa">     <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">         <style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="4.445cm" fo:text-indent="-0.635cm" fo:margin-left="4.445cm"/>     </style:list-level-properties> </text:list-level-style-bullet> <text:list-level-style-bullet text:level="7" text:style-name="Bullet_20_Symbols" text:bullet-char="\u2022">     <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">         <style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="5.08cm" fo:text-indent="-0.635cm" fo:margin-left="5.08cm"/>     </style:list-level-properties> </text:list-level-style-bullet> <text:list-level-style-bullet text:level="8" text:style-name="Bullet_20_Symbols" text:bullet-char="\u25e6">     <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">         <style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="5.715cm" fo:text-indent="-0.635cm" fo:margin-left="5.715cm"/>     </style:list-level-properties> </text:list-level-style-bullet> <text:list-level-style-bullet text:level="9" text:style-name="Bullet_20_Symbols" text:bullet-char="\u25aa">     <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">         <style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="6.35cm" fo:text-indent="-0.635cm" fo:margin-left="6.35cm"/>     </style:list-level-properties> </text:list-level-style-bullet> <text:list-level-style-bullet text:level="10" text:style-name="Bullet_20_Symbols" text:bullet-char="\u2022">     <style:list-level-properties text:list-level-position-and-space-mode="label-alignment">         <style:list-level-label-alignment text:label-followed-by="listtab" text:list-tab-stop-position="6.985cm" fo:text-indent="-0.635cm" fo:margin-left="6.985cm"/>     </style:list-level-properties> </text:list-level-style-bullet>        </text:list-style><number:number-style style:name="N0"> <number:number number:min-integer-digits="1"/></number:number-style></office:automatic-styles><office:body><office:text /></office:body></office:document-content>',
f:{"9px":"7pt","10px":"7.5pt","11px":"8.5pt","12px":"9pt","13px":"10pt","14px":"10.5pt","14.8px":"10.5pt","15px":"11.5pt","16px":"12pt","17px":"13pt","18px":"13.5pt","19px":"14.5pt","20px":"15pt","21px":"16pt","22px":"16.5pt","23px":"17.5pt","24px":"18pt","25px":"19pt","26px":"19.5pt","27px":"20.5pt","28px":"21pt","29px":"22pt","30px":"22.5pt","31px":"23.5pt","32px":"24pt","33px":"25pt","34px":"25.5pt","35px":"26.5pt","36px":"27pt","37px":"28pt","38px":"28.5pt","39px":"29.5pt","40px":"30pt","41px":"31pt",
"42px":"31.5pt","43px":"32.5pt","44px":"33pt","45px":"34pt","46px":"34.5pt","47px":"35.5pt","48px":"36pt","49px":"37pt","50px":"37.5pt","51px":"38.5pt","52px":"39pt","53px":"40pt","54px":"40.5pt","55px":"41.5pt","56px":"42pt","57px":"43pt","58px":"43.5pt","59px":"44.5pt","60px":"45pt","61px":"46pt","62px":"46.5pt","63px":"47.5pt","64px":"48pt","65px":"49pt","66px":"49.5pt","67px":"50.5pt","68px":"51pt","69px":"52pt","70px":"52.5pt","71px":"53.5pt","72px":"54pt","73px":"55pt","74px":"55.5pt","75px":"56.5pt",
"76px":"57pt","77px":"58pt","78px":"58.5pt","79px":"59.5pt","80px":"60pt","81px":"61pt","82px":"61.5pt","83px":"62.5pt","84px":"63pt","85px":"64pt","86px":"64.5pt","87px":"65.5pt","88px":"66pt","89px":"67pt","90px":"67.5pt","91px":"68.5pt","92px":"69pt","93px":"70pt","94px":"70.5pt","95px":"71.5pt","96px":"72pt","97px":"73pt","98px":"73.5pt","99px":"74.5pt"},borders:["top","bottom","right","left"]};this.postData=function(){return{xml:this.xml(),pics:this.pics.join(","),ols:this.liNum}};this.init();
this.xml=function(){return this.doc.GetXml()}}
function EWA_DocWordClass(){this.docks=[];this.pics=[];this.liNum=0;this.defaultFontEnglish="Century Gothic";this.defaultFontChinese="Microsoft YaHei";this.walker=function(a,b){a.nodeType==3?this.walkerTxt(a):a.nodeType==1&&this.walkerEle(a)};this.walkerEle=function(a){if(a.style.display!="none"){var b=a.tagName,c=!1;if(b=="LI"){var d=this.createP(a);var e=this.getDockTable();e.appendChild(d);this.docks.push(d);c=!0;this.createLi(a)}else if(b=="BR"){d=this.createBr(a);e=this.getDock();if(e.tagName!=
"w:p"){var g=this.createP(a.parentNode),h=this.createSpan(a.parentNode);g.appendChild(h);g.appendChild(d);e.appendChild(g);this.docks.push(g)}else e.appendChild(d);this.lastWR=null}else if(b=="IMG")e=this.getDock(),d=this.createPic(a),e.tagName!="w:p"?(g=this.createP(a.parentNode),h=this.createSpan(a.parentNode),g.appendChild(h),g.appendChild(d),e.appendChild(g),this.docks.push(g),c=!0,d=g):e.appendChild(d),this.lastWR=null;else if(b=="TABLE")h=this.getDockTable(),d=a.previousElementSibling,d!=null&&
d.tagName=="TABLE"&&(e=this.createPVanish(),h.appendChild(e[0])),d=this.createTable(a),d!=null&&(c=!0,h.appendChild(d),this.docks.push(d));else if(b=="TBODY")d=this.createTbody(a),this.getDock().appendChild(d);else if(b=="TR")d=this.createTr(a),this.getDock().appendChild(d),this.docks.push(d),c=!0;else if(b=="TD")d=this.createTd(a),this.getDock().appendChild(d),this.docks.push(d),c=!0;else if(b=="HR")e=this.getDockTable(),d=this.createP(a),h=this.createSpan(a),d.appendChild(h),g=this.createHr(),h.appendChild(g),
this.lastWR=null,e.appendChild(d);else if(a.parentNode.tagName=="LI"||b!="H1"&&b!="H2"&&b!="H3"&&b!="P"&&b!="CENTER"&&b!="DIV"){if(b=="SCRIPT")return;b!="BODY"&&b!="OL"&&b!="UL"&&(e=this.getDock(),d=this.createSpan(a),e.tagName!="w:p"?(g=this.createP(a.parentNode),g.appendChild(d),e.appendChild(g),this.docks.push(g)):e.appendChild(d))}else e=this.getDockTable(),d=this.createP(a),e.appendChild(d),this.docks.push(d),c=!0;for(e=0;e<a.childNodes.length;e++)this.walker(a.childNodes[e]);c&&(this.docksPop(d),
this.lastWR=null);b=="TD"&&d.childNodes.length==1?(g=this.createEle("w:p"),d.appendChild(g)):b=="TABLE"&&d.nextSibling==null&&d.parentNode.tagName=="w:tc"&&(g=this.createEle("w:p"),d.parentNode.appendChild(g))}};this.walkerTxt=function(a){if(a.nodeValue.trimEx()!=""||a.nodeValue.indexOf("\u3000")!=-1){var b=this.createText(a),c=this.getDock();if(c.tagName!="w:p"){var d=this.createP(a.parentNode);a=this.createSpan(a.parentNode);d.appendChild(a);a.appendChild(b);c.appendChild(d);this.docks.push(d)}else this.lastWR||
(a=this.createSpan(a.parentNode),c.appendChild(a)),this.lastWR.parentNode.appendChild(b)}this.lastWR=null};this.createEle=function(a){return this.doc.XmlDoc.createElement(a)};this.createEles=function(a){a=a.split(",");for(var b=[],c=0;c<a.length;c++){var d=this.createEle(a[c].trim());b.push(d);c>0&&b[0].appendChild(d)}return b};this.createElesLvl=function(a){a=a.split(",");for(var b=[],c=0;c<a.length;c++){var d=this.createEle(a[c].trim());b.push(d);c>0&&b[c-1].appendChild(d)}return b};this.createElesSameLvl=
function(a,b){a=a.split(",");for(var c=[],d=0;d<a.length;d++){var e=this.createEle(a[d].trim());c.push(e);b.appendChild(e)}return c};this.createText=function(a){if(a.nodeValue.trim()!=""||a.nodeValue.indexOf("\u3000")!=-1){var b=a.nodeValue;if(a=a.nodeValue.indexOf("\u3000")>=0){let c=eval("/\u3000/g");b=b.replace(c,"\u3010zwer\u4e2d\uff0cwer,\u6587_\u5168`\u89d2=\u7a7a\u683cwerwe\u3011")}b=b.trim();a&&(a=eval("/\u3010zwer\u4e2d\uff0cwer,\u6587_\u5168`\u89d2=\u7a7a\u683cwerwe\u3011/g"),b=b.replace(a,
"\u3000"));a=this.createEle("w:t");EWA.B.IE?a.text=b:a.textContent=b;return a}};this.createHr=function(){var a=this.createElesLvl("w:pict,v:rect");a[0].setAttribute("w14:anchorId",this.getParaId());this.setAtts(a[1],{style:"width:.05pt;height:1pt","o:hralign":"center","o:hrstd":"t","o:hrnoshade":"t","o:hr":"t",fillcolor:"black [3213]",stroked:"f"});return a[0]};this.createLi=function(a){var b=this.createEles("w:numPr,w:ilvl,w:numId");a.parentNode.tagName=="OL"?(a==a.parentNode.getElementsByTagName("li")[0]&&
this.liNum++,b[1].setAttribute("w:val",0),b[2].setAttribute("w:val",this.liNum)):(b[1].setAttribute("w:val",0),b[2].setAttribute("w:val",22));a=this.createEle("w:spacing");a.setAttribute("w:line",270);a.setAttribute("w:lineRule","atLeast");var c=this.getDock();c.getElementsByTagName("w:pPr")[0].appendChild(b[0]);c.getElementsByTagName("w:pPr")[0].appendChild(a)};this.createSpan=function(a){var b=this.createEle("w:r");a=$(a);var c=this.createEle("w:rPr");this.lastWR=c;b.appendChild(c);if(a.css("color")!=
""){var d=this.createEle("w:color"),e=this.rgb1(a.css("color"));d.setAttribute("w:val",e);c.appendChild(d)}if(a.css("font-family")!=""){a.css("font-family").replace(/'/ig,"").split(",");d=this.createEle("w:rFonts");var g=/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/gi.test(a.text())?this.defaultFontChinese:this.defaultFontEnglish;this.setAtts(d,{"w:ascii":g,"w:eastAsia":g,"w:hAnsi":g,"w:hint":"eastAsia","w:cs":this.defaultFontEnglish});c.appendChild(d)}a.css("font-size")!=""&&(d=a.css("font-size"),g=this.fontSize(d),
g!=null&&(d=this.createEle("w:sz"),d.setAttribute("w:val",g*2),c.appendChild(d),e=this.createEle("w:szCs"),e.setAttribute("w:val",g*2),c.appendChild(e)));d=a.css("font-weight");if(a.tagName=="B"||d!=""&&d!="normal"&&d!="400")d=this.createEle("w:b"),c.appendChild(d);a.tagName=="I"&&(d=this.createEle("w:i"),c.appendChild(d));return b};this.createBr=function(a){a=this.createEle("w:r");var b=this.createEle("w:br");a.appendChild(b);return a};this.createTable=function(a){var b=this.createEle("w:tbl"),c=
this.createEle("w:tblPr"),d=this.createEle("w:tblStyle");d.setAttribute("w:val","a4");c.appendChild(d);d=this.createWidth(a,"tblW");c.appendChild(d);a.setAttribute("ww",d.getAttribute("w:w"));b.appendChild(c);return b};this.createTbody=function(){return this.createEle("w:tblGrid")};this.createTr=function(a){var b=this.createElesLvl("w:tr,w:trPr");this.setAtts(b[0],{"w:rsidR":"003D2D54","w14:textId":"77777777","w14:paraId":this.getParaId()});a=this.createHeight(a,"trHeight");b[1].appendChild(a);return b[0]};
this.paraId=0;this.getParaId=function(){var a="0000"+this.paraId;a=a.substring(a.length-4);this.paraId++;return"F0C0"+a};this.createTd=function(a){thisTr=a.parentNode;var b=thisTr.parentNode.parentNode,c=a.getAttribute("vmerge"),d=0;if(c!=null&&c!=""){var e=this.createEle("w:tc"),g=this.createEle("w:tcPr"),h=this.createEle("w:vMerge");g.appendChild(h);e.appendChild(g);this.getDock().appendChild(e);d=this.createEle("w:p");e.appendChild(d);e=c.split(",");e=b.rows[e[0]].cells[e[1]];g.appendChild(this.createTdBorders(e));
d=e.getAttribute("wwtd")*1}e=this.createEle("w:tc");g=this.createEle("w:tcPr");e.appendChild(g);if(a.rowSpan>1)for(h=this.createEle("w:vMerge"),h.setAttribute("w:val","restart"),g.appendChild(h),h=0;h<a.rowSpan-1;h++)(c=b.rows[h+1+thisTr.rowIndex])&&(c=c.cells[a.cellIndex])&&c.setAttribute("vmerge",thisTr.rowIndex+","+a.cellIndex);a.colSpan>1&&(b=this.createEle("w:gridSpan"),b.setAttribute("w:val",a.colSpan),g.appendChild(b));g.appendChild(this.createTdBorders(a));h=this.createWidth(a,"tcW");c=a.parentNode;
b=c.getAttribute("wwtr");if(b==null||b=="")b=c.parentNode.parentNode,b=b.getAttribute("ww");var k=h.getAttribute("w:w");a!=a.parentNode.cells[a.parentNode.cells.length-1]?(a.setAttribute("wwtd",k),c.setAttribute("wwtr",b*1-k*1-d)):(h.setAttribute("w:w",0),h.setAttribute("w:type","auto"));g.appendChild(h);a=$(a).css("vertical-align");a=="middle"?(a=this.createEle("w:vAlign"),a.setAttribute("w:val","center"),g.appendChild(a)):a=="bottom"&&(a=this.createEle("w:vAlign"),a.setAttribute("w:val","bottom"),
g.appendChild(a));return e};this.createWidth=function(a,b){b=this.createEle("w:"+b);a=$(a).width()*15;b.setAttribute("w:w",a);b.setAttribute("w:type","dxa");return b};this.createHeight=function(a,b){b=this.createEle("w:"+b);a=$(a).height()*15;b.setAttribute("w:val",a);return b};this.createTdBorders=function(a){for(var b=this.createEle("w:tcBorders"),c=0;c<this.EWA_DocTmp.borders.length;c++){var d=this.createBorder(a,this.EWA_DocTmp.borders[c]);b.appendChild(d)}return b};this.createBorder=function(a,
b){var c=$(a).css("border-"+b+"-width"),d=this.createEle("w:"+b);c=="0px"?d.setAttribute("w:val","nil"):(d.setAttribute("w:val","single"),a=$(a).css("border-"+b+"-color"),a=this.rgb1(a),d.setAttribute("w:color",a),d.setAttribute("w:sz",6));return d};this.createPVanish=function(){return this.createElesLvl("w:p,w:pPr,w:rPr,w:vanish")};this.createP=function(a){var b=this.createEle("w:p"),c=this.createEle("w:pPr");b.appendChild(c);c=this.createElesSameLvl("w:pStyle,w:jc",c);var d=c[1],e=$(a).css("text-align");
e=e==null?"":e;e.indexOf("center")>=0?d.setAttribute("w:val","center"):e.indexOf("right")>=0?d.setAttribute("w:val","right"):d.setAttribute("w:val","left");d=c[0];d.setAttribute("w:val","a");a.tagName.indexOf("H")==0&&d.setAttribute("w:val",a.tagName.replace("H",""));this.createElesLvl("w:rFonts",c[2])[0].setAttribute("w:hint","eastAsia");this.lastWR=null;this.setAtts(b,{"w:rsidR":"003D2D54","w14:textId":"77777777","w14:paraId":this.getParaId(),"w:rsidRDefault":"0057281A"});return b};this.createPic=
function(a){var b=$(a),c=a.src;this.pics.push(a.src);a=c.lastIndexOf("/");c=c.substring(a+1);a=this.px2emu(b.width());b=this.px2emu(b.height());var d=this.createElesLvl("w:r,w:rPr,w:noProof")[0],e=this.createElesLvl("w:drawing,wp:inline,wp:extent");d.appendChild(e[0]);wExtent=e[2];this.setAtts(wExtent,{cx:a,cy:b});e=e[1];this.setAtts(e,{distT:"0",distB:"0",distL:"0",distR:"0"});var g=this.createElesSameLvl("wp:effectExtent,wp:docPr,wp:cNvGraphicFramePr",e);this.setAtts(g[0],{l:"0",t:"0",r:"0",b:"0"});
this.setAtts(g[1],{id:"0",name:c});var h=this.createEleNs("a:graphicFrameLocks","http://schemas.openxmlformats.org/drawingml/2006/main");g[2].appendChild(h);this.setAtts(h,{noChangeAspect:1});g=this.createEleNs("a:graphic","http://schemas.openxmlformats.org/drawingml/2006/main");h=this.createEle("a:graphicData");h.setAttribute("uri","http://schemas.openxmlformats.org/drawingml/2006/picture");var k=this.createEleNs("pic:pic","http://schemas.openxmlformats.org/drawingml/2006/picture");g.appendChild(h);
h.appendChild(k);e.appendChild(g);e=this.createElesSameLvl("pic:nvPicPr,pic:blipFill,pic:spPr",k);this.setAtts(e[1],{rotWithShape:"1"});this.setAtts(e[2],{bwMode:"auto"});g=this.createElesSameLvl("pic:cNvPr,pic:cNvPicPr",e[0]);this.setAtts(g[0],{id:"0",name:c});g=this.createElesSameLvl("a:blip,a:srcRect,a:stretch",e[1]);this.setAtts(g[0],{"r:embed":"pic"+(this.pics.length-1)});this.setAtts(g[1],{l:"0",t:"0",r:"0",b:"0"});c=this.createEles("a:extLst,a:ext");g[0].appendChild(c[0]);c[1].setAttribute("uri",
"{28A0092B-C50C-407E-A947-70E740481C1C}");g=this.createEleNs("a14:useLocalDpi","http://schemas.microsoft.com/office/drawing/2010/main");g.setAttribute("val",0);c[1].appendChild(g);c=this.createElesSameLvl("a:xfrm,a:prstGeom,a:ln,a:extLst",e[2]);this.setAtts(c[1],{prst:"rect"});e=this.createElesSameLvl("a:off,a:ext",c[0]);this.setAtts(e[0],{x:0,y:0});this.setAtts(e[1],{cx:a,cy:b});this.createElesSameLvl("a:avLst",c[1]);this.createElesSameLvl("a:noFill",c[2]);return d};this.createEleNs=function(a,b){return this.doc.XmlDoc.createElementNS(b,
a)};this.setAtts=function(a,b){for(var c in b)a.setAttribute(c,b[c])};this.fontSize=function(a){a.indexOf("px")>0&&(a=this.EWA_DocTmp.f[a],a=a==null?"9pt":a);return a.replace("pt","")};this.rgb1=function(a){a=a.replace("rgb(","").replace(")","").split(",");return this.rgb(a[0]*1,a[1]*1,a[2]*1).toUpperCase()};this.rgb=function(a,b,c){a=a.toString(16);b=b.toString(16);c=c.toString(16);return(a.length<2?"0":"")+a+(b.length<2?"0":"")+b+(c.length<2?"0":"")+c};this.init=function(){this.doc=new EWA_XmlClass;
this.doc.LoadXml(this.EWA_DocTmp.document);EWA.B.IE?this.docks.push(this.doc.XmlDoc.getElementsByTagName("w:body")[0]):this.docks.push(this.doc.XmlDoc.childNodes[0].childNodes[0])};this.getDock=function(){return this.docks[this.docks.length-1]};this.idx=0;this.docksPop=function(a){for(;this.docks.length!=1&&this.docks.pop()!=a;);};this.getDockTable=function(){for(var a=this.docks.length-1;a>=0;a--){var b=this.docks[a];if(b.tagName=="w:body"||b.tagName=="w:tc")return b}};this.px2emu=function(a){return parseInt(a/
96*914400)};this.EWA_DocTmp={document:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><w:document\t\t\t\txmlns:wpc="http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas"\t\t\t\txmlns:mo="http://schemas.microsoft.com/office/mac/office/2008/main"\t\t\t\txmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"\t\t\t\txmlns:mv="urn:schemas-microsoft-com:mac:vml" xmlns:o="urn:schemas-microsoft-com:office:office"\t\t\t\txmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"\t\t\t\txmlns:m="http://schemas.openxmlformats.org/officeDocument/2006/math"\t\t\t\txmlns:v="urn:schemas-microsoft-com:vml"\t\t\t\txmlns:wp14="http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing"\t\t\t\txmlns:wp="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"\t\t\t\txmlns:w10="urn:schemas-microsoft-com:office:word"\t\t\t\txmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main"\t\t\t\txmlns:w14="http://schemas.microsoft.com/office/word/2010/wordml"\t\t\t\txmlns:wpg="http://schemas.microsoft.com/office/word/2010/wordprocessingGroup"\t\t\t\txmlns:wpi="http://schemas.microsoft.com/office/word/2010/wordprocessingInk"\t\t\t\txmlns:wne="http://schemas.microsoft.com/office/word/2006/wordml"\t\t\t\txmlns:wps="http://schemas.microsoft.com/office/word/2010/wordprocessingShape"\t\t\t\tmc:Ignorable="w14 wp14"><w:body></w:body></w:document>',
r:'<w:r w:rsidR="00A0061C" w:rsidRPr="00A0061C"><w:rPr><w:rFonts w:ascii="[FONT]" w:eastAsia="[FONT]" w:hAnsi="[FONT]" w:hint="eastAsia" /><w:b /><w:i /><w:color w:val="FF0000" /><w:sz w:val="36" /><w:szCs w:val="36" /><w:u w:val="single" /></w:rPr><w:t>\u770b\u770b</w:t></w:r>',f:{"9px":"7pt","10px":"7.5pt","11px":"8.5pt","12px":"9pt","13px":"10pt","14px":"10.5pt","15px":"11.5pt","16px":"12pt","17px":"13pt","18px":"13.5pt","19px":"14.5pt","20px":"15pt","21px":"16pt","22px":"16.5pt","23px":"17.5pt",
"24px":"18pt","25px":"19pt","26px":"19.5pt","27px":"20.5pt","28px":"21pt","29px":"22pt","30px":"22.5pt","31px":"23.5pt","32px":"24pt","33px":"25pt","34px":"25.5pt","35px":"26.5pt","36px":"27pt","37px":"28pt","38px":"28.5pt","39px":"29.5pt","40px":"30pt","41px":"31pt","42px":"31.5pt","43px":"32.5pt","44px":"33pt","45px":"34pt","46px":"34.5pt","47px":"35.5pt","48px":"36pt","49px":"37pt","50px":"37.5pt","51px":"38.5pt","52px":"39pt","53px":"40pt","54px":"40.5pt","55px":"41.5pt","56px":"42pt","57px":"43pt",
"58px":"43.5pt","59px":"44.5pt","60px":"45pt","61px":"46pt","62px":"46.5pt","63px":"47.5pt","64px":"48pt","65px":"49pt","66px":"49.5pt","67px":"50.5pt","68px":"51pt","69px":"52pt","70px":"52.5pt","71px":"53.5pt","72px":"54pt","73px":"55pt","74px":"55.5pt","75px":"56.5pt","76px":"57pt","77px":"58pt","78px":"58.5pt","79px":"59.5pt","80px":"60pt","81px":"61pt","82px":"61.5pt","83px":"62.5pt","84px":"63pt","85px":"64pt","86px":"64.5pt","87px":"65.5pt","88px":"66pt","89px":"67pt","90px":"67.5pt","91px":"68.5pt",
"92px":"69pt","93px":"70pt","94px":"70.5pt","95px":"71.5pt","96px":"72pt","97px":"73pt","98px":"73.5pt","99px":"74.5pt"},borders:["top","bottom","right","left"]};this.postData=function(){return{xml:this.xml(),pics:this.pics.join(","),ols:this.liNum}};this.init();this.xml=function(){return this.doc.GetXml()}};
//# sourceMappingURL=ewa.min.map
